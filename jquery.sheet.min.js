var jQuery=window.jQuery||{};var Sheet=(function(d,m,f,a,q,t,u,g,b,r){var l={defaultTheme:0,themeRollerTheme:0,bootstrapTheme:1,customTheme:2,excelSelectModel:0,googleDriveSelectModel:1,openOfficeSelectModel:2,defaultColumnWidth:120,defaultRowHeight:20,calcStack:0};l.Cell=(function(){var v=undefined;function w(x,A,z,y){this.td=(A!==undefined?A:null);this.dependencies=[];this.formula="";this.cellType=null;this.value="";this.calcCount=0;this.sheetIndex=x;this.rowIndex=null;this.columnIndex=null;this.jS=(z!==undefined?z:null);this.state=[];this.needsUpdated=true;this.uneditable=false;this.id=null;this.loader=null;this.loadedFrom=null;this.cellHandler=y}w.prototype={addDependency:function(x){if(x===undefined||x===null){return}if(x.type!==l.Cell){throw new Exception("Wrong Type")}if(this.dependencies.indexOf(x)<0){this.dependencies.push(x)}},updateValue:function(){if(!this.needsUpdated){return this.value}if((this.value+"").length<1||(!this.hasOperator.test(this.value)&&this.formula.length<1)){if(this.td!==null){this.td.innerHTML=this.value}this.value=new q(this.value);this.value.cell=this;this.updateDependencies();return this.value}var E,y,G=this.value,D=this.formula,F=this.cellType,z,x=this.defer,A=this.td,H,B;switch(this.state[0]){case"updating":G=new q();G.cell=this;G.html="#VAL!";return G;case"updatingDependencies":return(this.valueOverride!=v?this.valueOverride:this.value)}if(x!==v){if(G.length>0){G=new q();G.cell=this;A.innerHTML="#REF!";return G}G=x.updateValue().valueOf();switch(typeof(result)){case"number":G=new t(G);break;case"boolean":G=new u(G);break;case"string":G=new q(G);break}G.cell=this;this.updateDependencies();return this.value=G}this.oldValue=G;this.state.unshift("updating");this.fnCount=0;delete this.valueOverride;this.calcCount++;if(D.length>0){if(D.charAt(0)==="="){this.formula=D=D.substring(1)}H=l.calcStack;B=this.cellHandler.formulaParser(H);l.calcStack++;B.setObj(this);try{G=B.parse(D)}catch(C){G=C.toString()}this.needsUpdated=false;l.calcStack--;if(G!==v&&G!==null&&F!==null&&(z=l.CellTypeHandlers[F])!==v){G=z(this,G)}}else{if(G!==v&&G!==null&&F!==null&&(z=l.CellTypeHandlers[F])!==v){G=z(this,G)}else{switch(typeof G){case"string":E=this.startOperators[G.charAt(0)];if(E!==v){this.valueOverride=E.call(this,G)}else{E=this.endOperators[G.charAt(G.length-1)];if(E!==v){this.valueOverride=E.call(this,G)}}break;case"undefined":G="";break}}}if(G===v||G===null){G=new q()}if(G.cell===v){switch(typeof(G)){case"number":G=new t(G);break;case"boolean":G=new u(G);break;case"string":G=new q(G);break}G.cell=this}this.value=G;y=this.displayValue();if(this.loader!==null){this.loader.setCellAttributes(this.loadedFrom,{cache:y,formula:this.formula,value:this.value+"",cellType:this.cellType,uneditable:this.uneditable})}this.needsUpdated=false;this.state.shift();this.updateDependencies();return(this.valueOverride!==v?this.valueOverride:this.value)},updateDependencies:function(){var z,x,y;z=this.dependencies;this.dependencies=[];y=z.length-1;if(y>-1){this.state.unshift("updatingDependencies");do{x=z[y];x.updateValue()}while(y-->0);this.state.shift()}if(this.dependencies.length===0){this.dependencies=z}},displayValue:function(){var z=this.value,B=this.td,x,A=typeof z,y=z.html;if(A==="string"||(z!==null&&A==="object"&&z.toUpperCase!==v)&&z.length>0){x=this.encode(z)}if(B===null){return z}if(y===v){if(x!==v){y=x}else{y=z}}switch(typeof y){case"object":if(y===null){B.innerHTML=""}else{if(y.appendChild!==v){if(y.parentNode!==null){B.innerHTML=z.valueOf();return""}B.innerHTML="";B.appendChild(y);break}}case"string":default:B.innerHTML=y}return B.innerHTML},recurseDependencies:function(A){var z=0,B=this.dependencies,y,x=B.length;for(;z<x;z++){y=B[z];A.call(y);y.recurseDependencies(A)}},getAllDependencies:function(){var x=[];this.recurseDependencies(function(){x.push(this)});return x},setNeedsUpdated:function(){this.needsUpdated=true;this.recurseDependencies(function(){this.needsUpdated=true})},encode:function(x){switch(typeof x){case"object":if(x.getMonth!==v){return globalize.format(x,"d")}return x}if(!x){return x||""}if(!x.replace){return x||""}return x.replace(/&/gi,"&amp;").replace(/>/gi,"&gt;").replace(/</gi,"&lt;").replace(/\n/g,"\n<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp ").replace(/  /g,"&nbsp; ")},hasOperator:/(^[$£])|([%]$)/,startOperators:{"$":function(y,x){return this.cellHandler.fn.DOLLAR.call(this,y.substring(1).replace(Globalize.culture().numberFormat[","],""),2,x||"$")},"£":function(x){return this.startOperators["$"].call(this,x,"£")}},endOperators:{"%":function(x){return x.substring(0,this.value.length-1)/100}},type:w,typeName:"Sheet.Cell"};return w})();l.CellHandler=(function(w){function z(A){return !isNaN(A)}var v=undefined,x=NaN;function y(C,A,B){this.jS=C;this.jSE=A;this.fn=B}y.prototype={variable:function(E){if(arguments.length){var D=arguments[0],B=arguments[1],F=this.jS.s.formulaVariables,C,A;switch(D.toLowerCase()){case"true":A=new u(true);A.html="TRUE";return A;case"false":A=new u(false);A.html="FALSE";return A}if(C=F[D]&&!B){return C}else{if(C&&B){return C[B]}else{return""}}}},time:function(B,A){return i.fromString(B,A)},number:function(A){switch(typeof A){case"number":return A;case"string":if(z(A)){return A*1}case"object":if(A.getMonth){return e.toCentury(A)}}return A},numberInverted:function(C){var B=this.number(C),A=new t(B.valueOf()*-1);if(B.html){A.html=B.html}return A},performMath:function(G,F,E){if(F===v||F===null){F=0}if(E===v||E===null){E=0}var D,C,H=true,A=true,J=[],I,B=function(K){return K};switch(D=(typeof F.valueOf())){case"number":break;case"string":if(z(F)){F*=1}else{H=false}break;case"object":if(F.getMonth){F=e.toCentury(F);B=e.get}else{H=false}break;default:H=false}switch(C=(typeof E.valueOf())){case"number":break;case"string":if(z(E)){E*=1}else{A=false}break;case"object":if(E.getMonth){E=e.toCentury(E)}else{A=false}break;default:A=false}if(!H&&G!=="+"){J.push("not a number: "+F);F=0}if(!A){J.push("not a number: "+E);E=0}if(J.length){}switch(G){case"+":I=F+E;break;case"-":I=F-E;break;case"/":I=F/E;if(I==Infinity||I==x){I=0}break;case"*":I=F*E;break;case"^":I=w.pow(F,E);break}return B(I)},cellValue:function(C,B){var D=this.jS,E=h.parseLocation(B.colString,B.rowString),A;A=D.getCell(C.sheetIndex,E.row,E.col);if(A!==null){A.addDependency(C);return A.updateValue()}else{return""}},cellRangeValue:function(C,D,F){var N=C.sheetIndex,E=h.parseLocation(D.colString,D.rowString),H=h.parseLocation(F.colString,F.rowString),J=w.max(E.row,H.row),K=w.min(E.row,H.row),B=w.max(E.col,H.col),A=w.min(E.col,H.col),G=this.jS,I=G.spreadsheets[N],P=[],M,L,O;if(I===v){G.spreadsheets[N]=I={}}if(J>=K||B>=A){P.rowCount=(K-J)+1;P.columnCount=(A-B)+1;do{M=B;O=(I[J]!==v?I[J]:null);do{if(O===null||(L=O[M])===v){L=G.getCell(N,J,M)}else{L.sheetIndex=N;L.rowIndex=J;L.columnIndex=M}if(L!==null){C.addDependency(L);P.unshift(L.updateValue())}}while(M-->A)}while(J-->K);return P}return P},fixedCellValue:function(A,B){return this.cellValue(A,B)},fixedCellRangeValue:function(B,C,A){return this.cellRangeValue(B,C,A)},remoteCellValue:function(F,E,C){var D=this.jSE,G=this.jS,H=D.parseLocation(C.colString,C.rowString),B=D.parseSheetLocation(E),A;if(B<0){B=G.getSpreadsheetIndexByTitle(E)}A=G.getCell(B,H.row,H.col);if(A!==null){A.addDependency(F);return A.updateValue()}else{return""}},remoteCellRangeValue:function(A,I,B,E){var G=this.jS,C=this.jSE,D=C.parseLocation(B.colString,B.rowString),H=C.parseLocation(E.colString,E.rowString),N=C.parseSheetLocation(I),M,L=H.col,J,F=H.row,O=[],K;if(N<0){N=G.getSpreadsheetIndexByTitle(I)}O.rowCount=(F-D.row)+1;O.columnCount=(L-D.col)+1;for(M=D.col;M<=L;M++){for(J=D.row;J<=F;J++){K=G.getCell(N,J,M);if(K!==null){O.push(K.updateValue());K.addDependency(A)}}}return O},callFunction:function(D,C,B){C=C.toUpperCase();B=B||[];var E=this.fn[C],A;if(E!==v){D.fnCount++;A=E.apply(D,B)}else{A=new q();A.html="Function "+C+" Not Found"}return A},spareFormulaParsers:{},formulaParser:function(B){var A;if(B>-1){A=this.spareFormulaParsers[B];if(A===v){A=this.spareFormulaParsers[B]=Formula(this)}}else{A=this.jS.formulaParser}return A}};return y})(g);l.CellTypeHandlers=(function(){var v=isNaN;return{percent:function(x,z){var y=(v(z)?Globalize.parseFloat(z):z*1),w;if(!v(y)){w=new t(y);w.html=Globalize.format(y,"p");return w}return z},date:function(w,y){var x=Globalize.parseDate(y);if(x===null){return y}else{x.html=Globalize.format(x,"d");return x}},time:function(w,y){var x=Globalize.parseDate(y);if(x===null){return y}else{x.html=Globalize.format(x,"t");return x}},currency:function(x,z){var y=(v(z)?Globalize.parseFloat(z):z*1),w;if(!v(y)){w=new t(y);w.html=Globalize.format(y,"c");return w}return z},number:function(x,z){var y,w;if(!settings.endOfNumber){y=Globalize.culture().numberFormat["."];settings.endOfNumber=new b("(["+(y=="."?".":y)+"])([0-9]*?[1-9]+)?(0)*$")}if(!v(z)){w=new t(z);w.html=Globalize.format(z+"","n10").replace(settings.endOfNumber,function(C,B,A){return(A?B:"")+(A||"")});return w}return z}}})();l.CellRange=(function(){function v(w){this.cells=w||[]}v.prototype={clone:function(){var A=[],y=this.cells,x=y.length,w,B;for(var z=0;z<x;z++){w=y[z];B={value:w.value,formula:w.formula,td:w.td,dependencies:w.dependencies,needsUpdated:w.needsUpdated,calcCount:w.calcCount,sheetIndex:w.sheetIndex,rowIndex:w.rowIndex,columnIndex:w.columnIndex,html:w.html,state:w.state,jS:w.jS,style:w.style,cl:w.cl,id:w.id,cellType:w.cellType,type:w.type,uneditable:w.uneditable};A.push(B)}return new v(A)},type:v,typeName:"Sheet.CellRange"};return v})();l.ActionUI=(function(v,y,w,x,z){var A=function(G,Q,H,C,M){this.enclosure=G;this.pane=v.createElement("div");this.table=Q;this.max=M;this.xIndex=0;this.yIndex=0;this.scrollAxis={x:{},y:{}};this.scrollSize={};this.hiddenColumns=[];this.hiddenRows=[];if(!(this.frozenAt=C)){this.frozenAt={row:0,col:0}}this.frozenAt.row=w.max(this.frozenAt.row,0);this.frozenAt.col=w.max(this.frozenAt.col,0);this.scrolledArea={row:w.max(this.frozenAt.row,1),col:w.max(this.frozenAt.col,1)};var F=this,K=this.pane,J="#"+Q.getAttribute("id"),R=this.scrollUI=K.scrollOuter=v.createElement("div"),O=K.scrollInner=v.createElement("div"),E=K.scrollStyleX=this.scrollStyleX=new l.StyleUpdater(function(V,W){if(F.xIndex===V){return false}if(V===undefined||V===null){V=F.xIndex}F.xIndex=V;if(W===undefined){var U=F.frozenAt.col;W=J+" tr > *:nth-child(-n+"+V+") {display: none;}"+J+" col:nth-child(-n+"+V+") {display: none;}"+J+" tr > *:nth-child(-n+"+(U+1)+") {display: table-cell;}"+J+" col:nth-child(-n+"+(U+1)+") {display: table-column;}"+J+" tr > *:nth-child("+(V+20)+") ~ * {display: none;}"+J+" col:nth-child("+(V+20)+") ~ col {display: none;}"}this.setStyle(W);F.scrolledArea.col=w.max(V||1,1);return true},M),D=K.scrollStyleY=this.scrollStyleY=new l.StyleUpdater(function(U,V){if(F.yIndex===U){return false}if(U===undefined||U===null){U=F.yIndex}F.yIndex=U;if(V===undefined){var W=F.frozenAt.row;V=J+" tr:nth-child(-n+"+U+") {display: none;}"+J+" tr:nth-child(-n+"+(F.frozenAt.row+1)+") {display: table-row;}"+J+" tr:nth-child("+(U+40)+") ~ tr {display: none;}"}this.setStyle(V);F.scrolledArea.row=w.max(U||1,1);return true});R.setAttribute("class",H);R.appendChild(O);z(R).disableSelectionSpecial();K.appendChild(E.styleElement);K.appendChild(D.styleElement);var N,S,P,T,I,L,B=Q.tBody.children[0];K.resizeScroll=function(U){if(U){N=E.getStyle();S=D.getStyle()}else{N=(Q.clientWidth<=G.clientWidth?"":E.getStyle());S=(Q.clientHeight<=G.clientHeight?"":D.getStyle())}E.update(null," ");D.update(null," ");if(B===undefined){B=Q.tBody.children[0]}P=(B.clientWidth||Q.clientWidth)+"px";T=Q.clientHeight+"px";I=G.clientWidth+"px";L=G.clientHeight+"px";O.style.width=P;O.style.height=T;R.style.width=I;R.style.height=L;F.scrollStart("x");F.scrollStart("y");E.update(null,N);D.update(null,S);if(K.inPlaceEdit){K.inPlaceEdit.goToTd()}};new MouseWheel(K,R)};A.prototype={putTdInView:function(G){var C=0,B=0,F=0,E,D;this.xIndex=0;this.yIndex=0;while((E=this.directionToSeeTd(G))!==null){D=this.scrolledArea;if(E.left){B--;this.scrollTo("x",0,D.col-1)}else{if(E.right){B++;this.scrollTo("x",0,D.col+1)}}if(E.up){F--;this.scrollTo("y",0,D.row-1)}else{if(E.down){F++;this.scrollTo("y",0,D.row+1)}}C++;if(C<25){break}this.scrollStop()}},directionToSeeTd:function(C){var B=this.pane,L={top:0,bottom:B.clientHeight,left:0,right:B.clientWidth},H=C.clientWidth,F=C.clientHeight,J={top:C.offsetTop,bottom:C.offsetTop+F,left:C.offsetLeft,right:C.offsetLeft+H},D=C.parentNode,I=this.scrolledArea;if(!C.col){return null}var K=C.barTop.cellIndex<I.col,E=D.rowIndex<I.row,G={up:E,down:J.bottom>L.bottom&&F<=B.clientHeight,left:K,right:J.right>L.right&&H<=B.clientWidth};if(G.up||G.down||G.left||G.right){return G}return null},redraw:function(){var B=this.pane.style;B.opacity=0.9999;setTimeout(function(){B.opacity=1},0)},hide:function(D,C){var F="#"+this.table.getAttribute("id"),E=this.pane,B=this;if(this.toggleHideStyleX===null){this.toggleHideStyleX=new l.StyleUpdater(function(){var G=this.nthCss("col",F,B.hiddenColumns,0)+this.nthCss("> td",F+" tr",B.hiddenColumns,0)+this.nthCss("> th",F+" tr",B.hiddenColumns,0);this.setStyle(G)});this.toggleHideStyleY=new l.StyleUpdater(function(){var G=this.nthCss("tr",F,B.hiddenRows,0);this.setStyle(G)})}E.appendChild(this.toggleHideStyleX.styleElement);E.appendChild(this.toggleHideStyleY.styleElement);this.hiddenRows=(D!==null?D:[]);this.hiddenColumns=(C!==null?C:[]);this.toggleHideStyleY.update();this.toggleHideStyleX.update()},toggleHideRow:function(B){var C;if((C=this.hiddenRows.indexOf(B))>-1){this.hiddenRows.splice(C,1)}else{this.hiddenRows.push(B)}this.toggleHideStyleY.update()},toggleHideRowRange:function(I,G){if(!I){return}if(!G){G=I}var H=this.hiddenRows,F=[],C=H.length,D,E=0,B=null;for(;E<C;E++){D=H[E];if(D>=I&&D<=G){if(B===null){B=true}}else{F.push(D)}}if(B===null){for(E=I;E<=G;E++){F.push(E)}}this.hiddenRows=F;this.toggleHideStyleY.update()},rowShowAll:function(){this.toggleHideStyleY.setStyle("");this.hiddenRows=[]},toggleHideColumn:function(B){var C;if((C=this.hiddenColumns.indexOf(B))>-1){this.hiddenColumns.splice(C,1)}else{this.hiddenColumns.push(B)}this.toggleHideStyleX.update()},toggleHideColumnRange:function(I,H){if(!I){return}if(!H){H=I}var G=this.hiddenColumns,E=[],D=G.length,C,F=0,B=null;for(;F<D;F++){C=G[F];if(C>=I&&C<=H){if(B===null){B=true}}else{E.push(C)}}if(B===null){for(F=I;F<=H;F++){E.push(F)}}this.hiddenColumns=E;this.toggleHideStyleX.update()},columnShowAll:function(){this.toggleHideStyleX.setStyle("");this.hiddenColumns=[]},remove:function(){},scrollStart:function(G){var H=this.pane,E=H.scrollOuter,F=this.scrollAxis[G],D=this.scrollSize=H.size();F.v=[];F.name=G;switch(G||"x"){case"x":F.value=0;F.max=D.cols;F.min=0;F.size=D.cols;H.scrollStyleX.update();F.scrollStyle=H.scrollStyleX;F.area=E.scrollWidth-E.clientWidth;F.sheetArea=H.table.clientWidth-H.table.corner.clientWidth;F.scrollUpdate=function(){E.scrollLeft=(F.value)*(F.area/F.size)};F.gridSize=100/F.size;break;case"y":F.value=0;F.max=D.rows;F.min=0;F.size=D.rows;H.scrollStyleY.update();F.scrollStyle=H.scrollStyleY;F.area=E.scrollHeight-E.clientHeight;F.sheetArea=H.table.clientHeight-H.table.corner.clientHeight;F.scrollUpdate=function(){E.scrollTop=(F.value)*(F.area/F.size)};F.gridSize=100/F.size;break}var C=F.max;do{var B=new x(F.gridSize*C);B.index=C+1;F.v.unshift(B)}while(C--)},scrollTo:function(C,D,G){var F=this.scrollAxis[C],B,E;if(G===undefined){G=c.closest(F.v,w.abs(D/F.area)*100,F.min).index}B=F.max;F.value=G;E=G>B?B:G;return F.scrollStyle.update(E)},scrollStop:function(){if(this.scrollAxis.x.scrollUpdate){this.scrollAxis.x.scrollUpdate()}if(this.scrollAxis.y.scrollUpdate){this.scrollAxis.y.scrollUpdate()}},toggleHideStyleX:null,toggleHideStyleY:null};return A})(m,f,g,t,d);l.SpreadsheetUI=(function(){var v=[];function w(y,A,z,x){x=x||{};this.i=y;this.ui=A;this.table=z;this.isLast=x.lastIndex===y;this.enclosure=null;this.pane=null;this.spreadsheet=null;this.sizeCheck=x.sizeCheck||function(){};this.initChildren=x.initChildren||function(){};this.done=x.done||function(){};this.sizeCheck(this)}w.prototype={load:function(){var x=this.table;this.initChildren(this.ui,x,this.i);x.pane.ui=this.ui;this.enclosure=x.enclosure;this.pane=x.pane;this.spreadsheet=x.spreadsheet;v.push(this.i);if(this.isLast){this.loaded()}},loaded:function(){this.done(v,this)}};return w})();l.Theme=(function(v){function w(x){x=x||l.defaultTheme;switch(x){case l.customTheme:this.cl=w.customClasses;break;case l.bootstrapTheme:this.cl=w.bootstrapClasses;break;default:case l.themeRollerTheme:this.cl=w.themeRollerClasses;break}v.extend(this,this.cl)}w.themeRollerClasses={autoFiller:"ui-state-active",bar:"ui-widget-header",barHighlight:"ui-state-active",barHandleFreezeLeft:"ui-state-default",barHandleFreezeTop:"ui-state-default",barMenuTop:"ui-state-default",tdActive:"ui-state-active",tdHighlighted:"ui-state-highlight",control:"ui-widget-header ui-corner-top",controlTextBox:"ui-widget-content",fullScreen:"ui-widget-content ui-corner-all",inPlaceEdit:"ui-state-highlight",menu:"ui-widget-header",menuFixed:"",menuUl:"ui-widget-header",menuLi:"ui-widget-header",menuHover:"ui-state-highlight",pane:"ui-widget-content",parent:"ui-widget-content ui-corner-all",table:"ui-widget-content",tab:"ui-widget-header",tabActive:"ui-state-highlight",barResizer:"ui-state-highlight",barFreezer:"ui-state-highlight",barFreezeIndicator:"ui-state-highlight"};w.bootstrapClasses={autoFiller:"btn-info",bar:"bg-primary",barHighlight:"label-info",barHandleFreezeLeft:"bg-warning",barHandleFreezeTop:"bg-warning",barMenuTop:"bg-warning",tdActive:"active",tdHighlighted:"bg-info",control:"bg-primary",controlTextBox:"form-control",fullScreen:"",inPlaceEdit:"form-control",menu:"panel panel-default",menuFixed:"nav navbar-nav",menuUl:"panel-info",menuLi:"active",menuHover:"bg-primary active",pane:"well",parent:"panel panel-default",table:"table table-bordered table-condensed",tab:"btn-default btn-xs",tabActive:"active",barResizer:"bg-info",barFreezer:"bg-warning",barFreezeIndicator:"bg-warning"};w.customClasses={autoFiller:"",bar:"",barHighlight:"",barHandleFreezeLeft:"",barHandleFreezeTop:"",barMenuTop:"",tdActive:"",tdHighlighted:"",control:"",controlTextBox:"",fullScreen:"",inPlaceEdit:"",menu:"",menuFixed:"",menuUl:"",menuLi:"",menuHover:"",pane:"",parent:"",table:"",tab:"",tabActive:"",barResizer:"",barFreezer:"",barFreezeIndicator:""};return w})(jQuery);l.Highlighter=(function(v,w,x){var y=function(A,C,z,B){this.cssClass=A;this.cssClassBars=C;this.cssClassTabs=z;this.callBack=B||function(){};this.last=x([]);this.lastTop=x([]);this.lastLeft=x([]);this.lastTab=x([]);this.start={row:0,col:0};this.end={row:0,col:0}};y.prototype={set:function(B){if(B.parentNode!==undefined){B=[B]}var z,A=this.last;if(A&&A.length>0){z=A.length-1;do{A[z].isHighlighted=false}while(z-->0)}if(B.length>0){z=B.length-1;do{if(!B[z].isHighlighted){B[z].isHighlighted=true;if(!B[z].className.match(this.cssClass)){B[z].className+=" "+this.cssClass}}}while(z-->0)}this.clear(A);this.last=B;this.callBack();return this},is:function(){return this.last.length>0},clear:function(A){if(this.is()){A=A||this.last;if(A&&A.length){var z=A.length-1;do{if(!A[z].isHighlighted){A[z].className=A[z].className.replace(this.cssClass,"");A[z].isHighlighted=false}}while(z-->0)}}this.last=x([]);return this},setBar:function(z,A){switch(z){case"top":this.lastTop.removeClass(this.cssClassBars);this.lastTop=x(A).addClass(this.cssClassBars);break;case"left":this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=x(A).addClass(this.cssClassBars);break}return this},clearBar:function(){this.lastTop.removeClass(this.cssClassBars);this.lastTop=x([]);this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=x([]);return this},setTab:function(z){this.clearTab();this.lastTab=z.addClass(this.cssClassTabs);return this},clearTab:function(){this.lastTab.removeClass(this.cssClassTabs);return this},setStart:function(z){this.start=z;return this},setEnd:function(z){this.end=z;return this}};return y})(m,f,jQuery);l.ColumnAdder=(function(){function v(){this.qty=-1;this.addedFinishedFn=null;this.createBarFn=null;this.createCellFn=null}v.prototype={setQty:function(y,x){var w=d.sheet.max;if(w){if(w>x.cols&&w<=x.cols+y){this.qty=w-x.cols}else{if(w&&w<=x.cols+y){return false}}}else{this.qty=y}return true},setAddedFinishedFn:function(w){this.addedFinishedFn=w},setCreateBarFn:function(w){this.createBarFn=w},setCreateCellFn:function(w){this.createCellFn=w},createCells:function(B,E,A){var z=(A?0:1),w=E.rows||1,y=B+this.qty,D,x=B,C;for(;x<y;x++){C=this.createBarFn(x+z);for(D=1;D<=w;D++){this.createCellFn(D,x+z,C)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:0,col:this.qty})}}};return v})();l.RowAdder=(function(){function v(){this.qty=-1;this.addedFinishedFn=null;this.createBar=null;this.createCell=null}v.prototype={setQty:function(z,x,y){var w=d.sheet.max;if(w){if(w>x.rows&&w<=x.rows+z){this.qty=w-x.rows}else{if(w&&w<=x.rows+z){return false}}}else{this.qty=z}return true},setAddedFinishedFn:function(w){this.addedFinishedFn=w},setCreateBarFn:function(w){this.createBar=w},setCreateCellFn:function(w){this.createCell=w},createCells:function(B,E,A){var z=(A?0:1),w=B+this.qty,y=E.cols||1,C,D=B,x;for(;D<w;D++){C=this.createBar(D+z);for(x=1;x<=y;x++){this.createCell(D+z,x,C)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:this.qty,col:0})}}};return v})();l.StyleUpdater=(function(v){function w(x){var y=this.styleElement=v.createElement("style");y.styleUpdater=this;this._update=x}w.prototype={setStyle:null,getStyle:null,nthCss:function(x,D,z,B,A){var C=[],y=z.length;A=A||"{display: none;}";do{if(z[y]>B){C.unshift(D+" "+x+":nth-child("+(z[y]+1)+")")}}while(y--);if(C.length){return C.join(",")+A}return""},repeat:function(z,y){var x="";while(y>0){if(y&1){x+=z}y>>=1;z+=z}return x},update:function(){return this._update.apply(this,arguments)}};if(v.createElement("style").styleSheet){w.prototype.setStyle=function(y){var z=this.styleElement,x=z.styleSheet;x.disabled=false;if(!x.disabled){x.cssText=y}};w.prototype.getStyle=function(){var y=this.styleElement,x=y.styleSheet;x.disabled=false;if(!x.disabled){return x.cssText}return""}}else{w.prototype.setStyle=function(x){var y=this;y.styleElement.innerHTML=x};w.prototype.getStyle=function(){return this.styleElement.innerHTML}}return w})(m);l.JSONLoader=(function(x,v,w){function y(z){if(z!==undefined){this.json=z;this.count=z.length}else{this.json=[];this.count=0}}y.prototype={size:function(C){var B={cols:0,rows:0},A=this.json,E,D,F,z;if((E=A[C])===undefined){return B}if((D=E.rows)===undefined){return B}if((F=D[0])===undefined){return B}if((z=F.columns)===undefined){return B}return{rows:D.length,cols:z.length}},getWidth:function(z,D){var B=this.json,F=B[z]||{},A=F.metadata||{},E=A.widths||[],C=E[D]||l.defaultColumnWidth;return C},getHeight:function(A,F){var B=this.json,D=B[A]||{},C=D.rows||[],E=C[F]||{},z=E.height||l.defaultRowHeight;return z},setupCell:function(B,G,D,A){var F=v.createElement("td"),E=this.getCell(B,G,D),z,C;if(E!==null){if(E.getCell!==undefined){z=E.getCell();if(z.formula!==undefined){F.setAttribute("data-formula",z.formula||"");if(z.hasOwnProperty("value")&&z.value!==null){C=z.value.hasOwnProperty("html")?z.value.html:z.value;switch(typeof C){case"object":if(C.appendChild!==undefined){F.appendChild(C);break}case"string":default:F.innerHTML=C;break}}}else{F.innerHTML=z.value}}else{z=A(F);z.value=E.value;if(E.formula){z.formula=E.formula||"";F.setAttribute("data-formula",E.formula||"")}else{F.innerHTML=E.value}}if(z.loadedFrom===null){z.loadedFrom=E;z.loader=this}if(E["class"]!==undefined){F.className=E["class"]}if(E.style!==undefined){F.setAttribute("style",E.style)}if(E.rowspan!==undefined){F.setAttribute("rowspan",E.rowspan)}if(E.colspan!==undefined){F.setAttribute("colspan",E.colspan)}if(E.uneditable!==undefined){F.setAttribute("data-uneditable",E.uneditable)}if(E.cellType!==undefined){F.setAttribute("data-celltype",E.cellType);z.cellType=E.cellType}if(E.id!==undefined){F.setAttribute("id",E.id);z.id=E.id}}else{z=A(F)}F.jSCell=z;z.td=F;z.sheetIndex=B;z.rowIndex=G;z.columnIndex=D;return z},getCell:function(A,G,C){var B=this.json,E,D,F,z;if((E=B[A])===undefined){return null}if((D=E.rows)===undefined){return null}if((F=D[G-1])===undefined){return null}if((z=F.columns[C-1])===undefined){return null}return z},jitCell:function(N,H,F,E,C){var A=this.getCell(N,H,F);if(A===null){return null}if(A.getCell!==undefined){return A.getCell()}var M,z,K,G,I,P,L,O,B,J,D;z=A.id;K=A.value;G=A.formula;I=A.cellType;P=A.uneditable;L=(z!==undefined&&z!==null);O=(K!==undefined&&K!==null);B=(G!==undefined&&G!==null);J=(I!==undefined&&I!==null);D=(P!==undefined&&P!==null);M=new l.Cell(N,null,E,C);M.rowIndex=H;M.columnIndex=F;M.loadedFrom=A;M.loader=this;M.needsUpdated=B;if(J){M.cellType=I}if(B){M.formula=G}if(D){M.uneditable=P}if(L){M.id=z}if(O){M.value=new w(K)}else{M.value=new w()}M.value.cell=M;A.getCell=function(){return M};return M},title:function(z){var A=this.json,B;if((B=A[z])===undefined){return""}return B.title||""},hiddenRows:function(C){var E=this.json[C].metadata||{},B=E.hiddenRows||[],A=B.length,z=[],D=0;for(;D<A;D++){z.push(B[D])}return z},hiddenColumns:function(B){var D=this.json[B].metadata||{},E=D.hiddenColumns||[],A=E.length,z=[],C=0;for(;C<A;C++){z.push(E[C])}return z},hasSpreadsheetAtIndex:function(z){return(this.json[z]!==undefined)},getSpreadsheetIndexByTitle:function(C){var B=this.json,z=this.count,A=0;for(;A<z;A++){if(B[A].title==C){return A}}return -1},addSpreadsheet:function(A,z){if(z===undefined){this.json.push(A)}else{this.json.splice(z,0,A)}this.count=this.json.length},getCellAttribute:function(z,A){return z[A]},setCellAttribute:function(z,A,B){z[A]=B},setCellAttributes:function(z,A){var B;for(B in A){if(A.hasOwnProperty(B)){z[B]=A[B]}}},cycleCells:function(F,E){var G=this.json,C,I,A,z,H,D,B;if((C=G[F])===undefined){return}if((D=(I=C.rows).length)<1){return}if(I[0].columns.length<1){return}D--;do{H=I[D];A=H.columns;B=A.length-1;do{z=A[B];E.call(this.jitCell(F,D,B,z),F,D,B)}while(B-->0)}while(D-->0)},cycleCellsAll:function(B){var A=this.json,z=A.length-1;if(z<0){return}do{this.cycleCells(z,B)}while(z-->0)},toTables:function(){var S=this.json,I=x([]),E,K,F,B,C,M,L,O,z,U,H,N,T,J,D,A,G,R,Q,P;for(R=0;R<S.length;R++){E=S[R];T=x(v.createElement("table"));if(E.title){T.attr("title",E.title||"")}I=I.add(T);K=E.rows;for(Q=0;Q<K.length;Q++){F=K[Q];if(N=(F.height+"").replace("px","")){A=x(v.createElement("tr")).attr("height",N).css("height",N+"px").appendTo(T)}B=F.columns;for(P=0;P<B.length;P++){C=B[P];G=x(v.createElement("td")).appendTo(A);if(C["class"]){G.attr("class",C["class"]||"")}if(C.style){G.attr("style",C.style||"")}if(C.formula){G.attr("data-formula",(C.formula?"="+C.formula:""))}if(C.cellType){G.attr("data-celltype",C.cellType||"")}if(C.value){G.html(C.value||"")}if(C.uneditable){G.html(C.uneditable||"")}if(C.rowspan){G.attr("rowspan",C.rowspan||"")}if(C.colspan){G.attr("colspan",C.colspan||"")}if(C.id){G.attr("id",C.id||"")}if(C.cache){G.html(C.cache)}}}if(M=E.metadata){if(L=M.widths){J=x(v.createElement("colgroup")).prependTo(T);for(P=0;P<L.length;P++){O=(L[P]+"").replace("px","");D=x(v.createElement("col")).attr("width",O).css("width",O+"px").appendTo(J)}}if(z=M.frozenAt){if(z.row){T.attr("data-frozenatrow",z.row)}if(z.col){T.attr("data-frozenatcol",z.col)}}if(U=M.hiddenRows){T.attr("data-hiddenrows",U.join(","))}if(H=M.hiddenColumns){T.attr("data-hiddencolumns",H.join(","))}}}return I},fromSheet:function(I,D){D=(D==undefined?false:D);var L=[],R=1*I.i,N,E=I.spreadsheets.length-1,S,G,H,C,J,Q,B,z,O,K,M,P,F,A;if(E<0){return L}do{P=false;I.i=E;I.evt.cellEditDone();N=I.obj.pane();S={title:(I.obj.table().attr("title")||""),rows:[],metadata:{widths:[],frozenAt:{row:N.actionUI.frozenAt.row,col:N.actionUI.frozenAt.col}}};L.unshift(S);G=I.spreadsheets[E];H=G.length-1;do{F=G[H][1].td[0].parentNode;A=F.style.height;Q={columns:[],height:(A?A.replace("px",""):I.s.colMargin)};C=G[H].length-1;do{z=G[H][C];B={};O=z.td[0].attributes;if(D||P||O["class"]||z.formula||z.value||O.style){P=true;K=(O["class"]?x.trim((O["class"].value||"").replace(I.cl.uiCellActive,"").replace(I.cl.uiCellHighlighted,"")):"");M=z.td[0].parentNode;Q.columns.unshift(B);if(!Q.height){Q.height=(M.style.height?M.style.height.replace("px",""):I.s.colMargin)}if(z.formula){B.formula=z.formula}if(z.cellType){B.cellType=z.cellType}if(z.value){B.value=z.value}if(z.uneditable){B.uneditable=z.uneditable}if(z.cache){B.cache=z.cache}if(z.id){B.id=z.id}if(O.style&&O.style.value){B.style=O.style.value}if(K.length){B["class"]=K}if(O.rowspan){B.rowspan=O.rowspan.value}if(O.colspan){B.colspan=O.colspan.value}if(H*1==1){S.metadata.widths.unshift(x(I.col(null,C)).css("width").replace("px",""))}}}while(C-->1);if(P){S.rows.unshift(Q)}}while(H-->1)}while(E--);I.i=R;return this.json=L},type:y,typeName:"Sheet.JSONLoader"};return y})(jQuery,m,q);l.XMLLoader=(function(w,v){function x(y){if(y!==undefined){this.xml=w.parseXML(y);this.spreadsheets=this.xml.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet");this.count=this.xml.length}else{this.xml=null;this.spreadsheets=null;this.count=0}}x.prototype={size:function(A){var y=this.xml[A],B=y.rows,C=B[0],z=C.columns;return{rows:B.length,cols:z.length}},setWidth:function(G,D,B){var C=this.spreadsheets,F=C[G],E=F.getElementsByTagName("metadata")[0]||{},z=E.getElementsByTagName("width")||[],A=z[D],y=(A.textContent||A.text);B.style.width=y+"px"},setRowHeight:function(z,F,D){var B=this.spreadsheets,A,C,E,y;if((A=B[z])===undefined){return}if((C=A.getElementsByTagName("rows")[0].getElementsByTagName("row"))===undefined){return}if((E=C[F])===undefined){return}if((y=E.attributes.height.nodeValue)===undefined){return}D.style.height=y+"px"},setupCell:function(G,B,A,y,C){var z=this.spreadsheets,F,H,D,E;if((F=z[G])===undefined){return false}if((H=F.getElementsByTagName("rows")[0].getElementsByTagName("row")[B-1])===undefined){return false}if((D=H.getElementsByTagName("columns")[0].getElementsByTagName("column")[A-1])===undefined){return false}y.cellType=D.attributes.cellType.nodeValue||"";if((E=D.jitCell)!==undefined){y.html=E.html;y.state=E.state;y.calcLast=E.calcLast;y.calcDependenciesLast=E.calcDependenciesLast;y.cellType=E.cellType;y.value=E.value;y.uneditable=E.uneditable;y.sheet=E.sheet;y.dependencies=E.dependencies}if(D.attributes.formula){y.formula=D.attributes.formula.nodeValue||"";C.setAttribute("data-formula",D.attributes.formula.nodeValue||"")}else{C.innerHTML=y.value=D.attributes.value.nodeValue||""}C.className=D.attributes["class"].nodeValue||"";C.setAttribute("style",D.attributes.style.nodeValue||"");if(D.attributes.rowspan){C.setAttribute("rowspan",D.attributes.rowspan.nodeValue||"")}if(D.attributes.colspan){C.setAttribute("colspan",D.attributes.colspan.nodeValue||"")}return true},getCell:function(y,A,z){return null},jitCell:function(z,E,C){var B=this.spreadsheets,A,D,y;if((A=B[z])===undefined){return false}if((D=A.getElementsByTagName("rows")[0].getElementsByTagName("row")[E-1])===undefined){return false}if((y=D.getElementsByTagName("columns")[0].getElementsByTagName("column")[C-1])===undefined){return false}return{td:{cellIndex:C,parentNode:{rowIndex:E},html:function(){}},html:[],state:[],calcLast:-1,calcDependenciesLast:-1,cellType:y.attributes.cellType.nodeValue||"",formula:y.attributes.formula.nodeValue||"",value:y.attributes.value.nodeValue||"",type:"cell",sheet:z,id:null}},title:function(z){var A=this.spreadsheets,y;if((y=A[z])===undefined){return""}return(y.attributes.title?y.attributes.title.nodeValue:"")},getSpreadsheetIndexByTitle:function(y){},addSpreadsheet:function(y,z){if(z===undefined){this.spreadsheets.append.push(jsonSpreadsheet)}else{this.json.splice(z,0,jsonSpreadsheet)}this.count=this.json.length},setCellAttribute:function(y,z,A){},toTables:function(){var F=this.xml,J=w([]),D=F.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet"),G,N,H,B,E,W,Q,ac,P,M,O,T,R;for(var Z=0;Z<D.length;Z++){G=D[Z];var ab=w(v.createElement("table")).attr("title",(G.attributes.title?G.attributes.title.nodeValue:"")),L=w(v.createElement("colgroup")).appendTo(ab),z=w(v.createElement("tbody")).appendTo(ab);J=J.add(ab);N=G.getElementsByTagName("rows")[0].getElementsByTagName("row");Q=G.getElementsByTagName("metadata")[0];for(var X=0;X<N.length;X++){H=N[X];var A=w(v.createElement("tr")).appendTo(z);if(R=H.attributes.height){R=(R.nodeValue||"").replace("px","");A.css("height",R).attr("height",R+"px")}B=H.getElementsByTagName("columns")[0].getElementsByTagName("column");for(var V=0;V<B.length;V++){E=B[V];var I=w(v.createElement("td")).appendTo(A),y=E.getElementsByTagName("formula")[0],Y=E.getElementsByTagName("cellType")[0],U=E.getElementsByTagName("value")[0],aa=E.getElementsByTagName("style")[0],K=E.getElementsByTagName("class")[0],ad=E.getElementsByTagName("rowspan")[0],C=E.getElementsByTagName("colspan")[0],S=E.getElementsByTagName("id")[0];if(y){I.attr("data-formula","="+(y.textContent||y.text))}if(Y){I.attr("data-celltype",Y.textContent||Y.text)}if(U){I.html(U.textContent||U.text)}if(aa){I.attr("style",aa.textContent||aa.text)}if(K){I.attr("class",K.textContent||K.text)}if(ad){I.attr("rowspan",ad.textContent||ad.text)}if(C){I.attr("colspan",C.textContent||C.text)}if(S){I.attr("id",S.textContent||S.text)}}}O=Q.getElementsByTagName("width");for(var X=0;X<O.length;X++){T=(O[X].textContent||O[X].text).replace("px","");w(v.createElement("col")).attr("width",T).css("width",T+"px").appendTo(L)}ac=Q.getElementsByTagName("frozenAt")[0];if(ac){M=ac.getElementsByTagName("col")[0];P=ac.getElementsByTagName("row")[0];if(M){ab.attr("data-frozenatcol",(M.textContent||M.text)*1)}if(P){ab.attr("data-frozenatrow",(P.textContent||P.text)*1)}}}return J},fromSheet:function(K,E,F){E=(E==undefined?false:E);var N="",U=1*K.i,G=K.spreadsheets.length-1,z,I,J,D,L,S,T,B,A,Q,M,O,y,R,P,H,C;if(G<0){return N}do{R=false;K.i=G;K.evt.cellEditDone();y=w.extend({},K.obj.pane().actionUI.frozenAt);P=[];I=K.spreadsheets[G];J=I.length-1;S="";do{B="";D=I[J].length-1;do{T="";A=I[J][D];Q=A.td[0].attributes;M=(Q["class"]?w.trim((Q["class"].value||"").replace(K.cl.uiCellActive,"").replace(K.cl.uiCellHighlighted,"")):"");if(E||R||M||A.formula||A.value||Q.style){R=true;T+="<column>";if(A.formula){T+="<formula>"+A.formula+"</formula>"}if(A.cellType){T+="<cellType>"+A.cellType+"</cellType>"}if(A.value){T+="<value>"+A.value+"</value>"}if(Q.style){T+="<style>"+Q.style.value+"</style>"}if(M){T+="<class>"+M+"</class>"}if(Q.rowspan){T+="<rowspan>"+Q.rowspan.value+"</rowspan>"}if(Q.colspan){T+="<colspan>"+Q.colspan.value+"</colspan>"}if(Q.id){T+="<id>"+Q.id.value+"</id>"}T+="</column>";B=T+B;if(J*1==1){P[D]="<width>"+w(K.col(null,D)).css("width").replace("px","")+"</width>"}}}while(D-->1);if(B){H=I[J][1].td[0].parentNode;C=H.style.height;S='<row height="'+(C?C.replace("px",""):K.s.colMargin)+'"><columns>'+B+"</columns></row>"+S}}while(J-->1);z='<spreadsheet title="'+(K.obj.table().attr("title")||"")+'"><rows>'+S+"</rows><metadata>"+(y.row||y.col?"<frozenAt>"+(y.row?"<row>"+y.row+"</row>":"")+(y.col?"<col>"+y.col+"</col>":"")+"</frozenAt>":"")+"<widths>"+P.join("")+"</widths></metadata></spreadsheet>";N=z+N}while(G--);K.i=U;N='<?xml version="1.0" encoding="UTF-8"?><spreadsheets xmlns="http://www.w3.org/1999/xhtml">'+N+"</spreadsheets>";if(F!==true){this.xml=w.parseXML(N)}return N},type:x,typeName:"Sheet.XMLLoader"};return x})(jQuery,m);d.fn.extend({sheet:function(w){var x=isNaN,v=d.sheet.events;w=w||{};d(this).each(function(){var B=d(this),D={editable:true,editableNames:true,barMenus:true,freezableCells:true,allowToggleState:true,menuLeft:null,menuRight:null,newColumnWidth:120,title:null,calcOff:false,lockFormulas:false,parent:B,colMargin:20,boxModelCorrection:2,formulaFunctions:{},formulaVariables:{},cellSelectModel:l.excelSelectModel,autoAddCells:true,resizableCells:true,resizableSheet:true,autoFiller:true,minSize:{rows:1,cols:1},error:function(E){return E.error},endOfNumber:false,frozenAt:[],contextmenuTop:{"Insert column after":function(E){E.controlFactory.addColumn(E.colLast);return false},"Insert column before":function(E){E.controlFactory.addColumn(E.colLast,true);return false},"Add column to end":function(E){E.controlFactory.addColumn();return false},"Delete this column":function(E){E.deleteColumn();return false},"Hide column":function(E){E.toggleHideColumn();return false},"Show all columns":function(E){E.columnShowAll()},"Toggle freeze columns to here":function(G){var E=G.getTdLocation(G.obj.tdActive()).col,F=G.obj.pane().actionUI;F.frozenAt.col=(F.frozenAt.col==E?0:E)}},contextmenuLeft:{"Insert row after":function(E){E.controlFactory.addRow(E.rowLast);return false},"Insert row before":function(E){E.controlFactory.addRow(E.rowLast,true);return false},"Add row to end":function(E){E.controlFactory.addRow();return false},"Delete this row":function(E){E.deleteRow();return false},"Hide row":function(E){E.toggleHideRow();return false},"Show all rows":function(E){E.rowShowAll()},"Toggle freeze rows to here":function(F){var G=F.getTdLocation(F.obj.tdActive()).row,E=F.obj.pane().actionUI;E.frozenAt.row=(E.frozenAt.row==G?0:G)}},contextmenuCell:{"Insert row after":function(E){E.controlFactory.addRow(E.rowLast);return false},"Insert row before":function(E){E.controlFactory.addRow(E.rowLast,true);return false},"Add row to end":function(E){E.controlFactory.addRow();return false},"Delete this row":function(E){E.deleteRow();return false},line2:"line","Insert column after":function(E){E.controlFactory.addColumn(E.colLast);return false},"Insert column before":function(E){E.controlFactory.addColumn(E.colLast,true);return false},"Add column to end":function(E){E.controlFactory.addColumn();return false},"Delete this column":function(E){E.deleteColumn();return false},line3:"line","Add spreadsheet":function(E){E.addSheet()},"Delete spreadsheet":function(E){E.deleteSheet()}},hiddenRows:[],hiddenColumns:[],alert:function(E){alert(E)},prompt:function(F,G,E){G(prompt(F,E))},confirm:function(G,E,F){if(confirm(G)){E()}else{if(F){F()}}},initCalcRows:40,initCalcCols:10,initScrollRows:0,initScrollCols:0,loader:null};var C=this.jS;if(C){var z=B.children().detach();C.kill();B.html(z);for(var A in v){if(v.hasOwnProperty(A)){B.unbind(v[A])}}}if((this.className||"").match(/\bnot-editable\b/i)!=null){w.editable=false}for(var y in v){if(v.hasOwnProperty(y)){B.bind(v[y],w[v[y]])}}if(!d.sheet.instance.length){d.sheet.instance=[]}this.jS=C=d.sheet.createInstance(d.extend(D,w),d.sheet.instance.length);d.sheet.instance.push(C)});return this},disableSelectionSpecial:function(){this.each(function(){this.onselectstart=function(){return false};this.unselectable="on";this.style["-moz-user-select"]="none"});return this},getSheet:function(){var v=this[0],w=(v.jS||{});return w},getCellValue:function(w,A,x){var y=this[0],z=(y.jS||{}),v;if(z.getCell){v=z.getCell(w,A,x);if(v!==null){return v.updateValue()}}return null},setCellValue:function(A,C,x,w){var y=this[0],z=(y.jS||{}),v;w=(w||0);if(z.getCell&&(v=z.getCell(w,C,x))){try{if((A+"").charAt(0)=="="){v.valueOverride=v.value="";v.formula=A.substring(1)}else{v.value=A;v.valueOverride=v.formula=""}v.updateValue();return true}catch(B){}}return false},setCellFormula:function(C,B,x,w){var y=this[0],z=(y.jS||{}),v;w=(w||0);if(z.getCell){try{v=z.getCell(w,B,x);if(v!==null){v.formula=C;v.valueOverride=v.value="";v.updateValue()}}catch(A){}}return this},isSheetFullScreen:function(){var v=this[0],w=(v.jS||{});if(w.obj){return w.obj.fullScreen().is(":visible")}return false},serializeCellInputs:function(w){var x=this[0],y=(x.jS||{}),v=y.obj.tables().find(":input");if(w){return v.serializeArray()}else{return v.serialize()}},viewSource:function(v){var w="";d(this).each(function(){if(v){w+=d(this).toPrettySource()}else{w+=d(this).toCompactSource()}});d.printSource(w);return w},toCompactSource:function(){var z=this[0];var w="";if(z.nodeType==1){w+="<"+z.tagName.toLowerCase();var B=z.attributes.length;for(var y=0;y<B;y++){var x=z.attributes[y].name,A=z.getAttribute(x);if(A){if(x=="contentEditable"&&A=="inherit"){continue}if(typeof(A)=="string"){w+=" "+x+'="'+A.replace(/"/g,"'")+'"'}else{if(x=="style"&&A.cssText){w+=' style="'+A.cssText+'"'}}}}if(z.tagName=="COL"){w+="/>"}else{w+=">";var v="";d(z.childNodes).each(function(){v+=d(this).toCompactSource()});w+=v;w+="</"+z.tagName.toLowerCase()+">"}}else{if(z.nodeType==3){w+=z.data.replace(/^\s*(.*)\s*$/g,"$1")}}return w},toPrettySource:function(A){var z=this[0],C,y;A=A||"";var w="";if(z.nodeType==1){w+="\n"+A+"<"+z.tagName.toLowerCase();C=z.attributes.length;for(y=0;y<C;y++){var x=z.attributes[y].name,B=z.getAttribute(x);if(B){if(x=="contentEditable"&&B=="inherit"){continue}if(typeof(B)=="string"){w+=" "+x+'="'+d.trim(B.replace(/"/g,"'"))+'"'}else{if(x=="style"&&B.cssText){w+=' style="'+d.trim(B.cssText)+'"'}}}}if(z.childNodes.length<=0){if(z.tagName=="COL"){w+="/>"}else{w+="></"+z.tagName.toLowerCase()+">"}}else{w+=">";var v="";C=z.childNodes.length;for(y=0;y<C;y++){v+=d(z.childNodes[y]).toPrettySource(A+"  ")}w+=v;if(v.indexOf("\n")>=0){w+="\n"+A}w+="</"+z.tagName.toLowerCase()+">"}}else{if(z.nodeType==3){w+=z.data.replace(/^\s*(.*)\s*$/g,"$1")}}return w}});d.sheet={instance:[],dependencies:{coreCss:{css:"jquery.sheet.css"},jQueryUI:{script:"jquery-ui/jquery-ui.min.js",thirdParty:true},jQueryUIThemeRoller:{css:"jquery-ui/themes/smoothness/jquery-ui.min.css",thirdParty:true},globalize:{script:"globalize/lib/globalize.js",thirdParty:true},nearest:{script:"jquery-nearest/src/jquery.nearest.min.js",thirdParty:true},mousewheel:{script:"MouseWheel/MouseWheel.js",thirdParty:true}},optional:{advancedFn:{script:"plugins/jquery.sheet.advancedfn.js"},financeFn:{script:"plugins/jquery.sheet.financefn.js"},colorPicker:{css:"really-simple-color-picker/colorPicker.css",script:"really-simple-color-picker/jquery.colorPicker.min.js",thirdParty:true},elastic:{script:"jquery-elastic/jquery.elastic.source.js",thirdParty:true},globalizeCultures:{script:"globalize/lib/cultures/globalize.cultures.js",thirdParty:true},raphael:{script:"raphael/raphael-min.js",thirdParty:true},gRaphael:{script:"graphael/g.raphael.js",thirdParty:true},gRaphaelBar:{script:"graphael/g.bar.js",thirdParty:true},gRaphaelDot:{script:"graphael/g.dot.js",thirdParty:true},gRaphaelLine:{script:"graphael/g.line.js",thirdParty:true},gRaphaelPie:{script:"graphael/g.pie.js",thirdParty:true},thaw:{script:"thaw.js/thaw.js",thirdParty:true},undoManager:{script:"Javascript-Undo-Manager/js/undomanager.js",thirdParty:true},zeroClipboard:{script:"zeroclipboard/dist/ZeroClipboard.min.js",thirdParty:true}},events:["sheetAddRow","sheetAddColumn","sheetSwitch","sheetRename","sheetTabSortStart","sheetTabSortUpdate","sheetCellEdit","sheetCellEdited","sheetCalculation","sheetAdd","sheetDelete","sheetDeleteRow","sheetDeleteColumn","sheetOpen","sheetAllOpened","sheetSave","sheetFullScreen","sheetFormulaKeydown"],preLoad:function(y,x){y=y||"";x=d.extend({skip:["globalizeCultures"],thirdPartyDirectory:"bower_components/"},x);var w=function(){if(this.script!==undefined){m.write('<script src="'+y+(this.thirdParty?x.thirdPartyDirectory:"")+this.script+'"><\/script>')}if(this.css!==undefined){m.write('<link rel="stylesheet" type="text/css" href="'+y+(this.thirdParty?x.thirdPartyDirectory:"")+this.css+'"></link>')}};for(var v in x.skip){if(this.dependencies[x.skip[v]]){delete this.dependencies[x.skip[v]]}if(this.optional[x.skip[v]]){delete this.optional[x.skip[v]]}}d.each(this.dependencies,function(){w.call(this)});d.each(this.optional,function(){w.call(this)})},createInstance:function(F,C){var H=this,M=function(P,I){var O=I.parentNode;if(O.lastchild==I){O.appendChild(P)}else{O.insertBefore(P,I.nextSibling)}},G=d(f),N=d(m),D=m.body,L=d(D),A=function(){},E=undefined,w=g,K=isNaN,z=NaN,x=f.thaw,J=f.Formula,B={version:"4.x",i:0,I:C,sheetCount:0,spreadsheets:[],controls:{autoFiller:[],bar:{helper:[],corner:[],x:{controls:[],handleFreeze:[],menu:[],menuParent:[],parent:[],th:[],ths:function(){var O=[],Q=0,P=this.th[B.i],I=P.length;for(;Q<I;Q++){O.push(P[Q])}return O}},y:{controls:[],handleFreeze:[],menu:[],parent:[],th:[],ths:function(){var O=[],Q=0,P=this.th[B.i],I=P.length;for(;Q<I;Q++){O.push(P[Q])}return O}}},barMenuLeft:[],barMenuTop:[],barLeft:[],barTop:[],barTopParent:[],chart:[],tdMenu:[],cellsEdited:[],enclosure:[],enclosures:null,formula:null,fullScreen:null,header:null,inPlaceEdit:[],inputs:[],label:null,menuLeft:[],menuRight:[],menus:[],pane:[],panes:null,scrolls:null,sheetAdder:null,table:[],tables:null,tab:[],tabContainer:null,tabs:null,title:null,toggleHide:{x:[],y:[]},ui:null},obj:{autoFiller:function(){return B.controls.autoFiller[B.i]||d([])},barCorner:function(){return B.controls.bar.corner[B.i]||d([])},barHelper:function(){return B.controls.bar.helper[B.i]||(B.controls.bar.helper[B.i]=d([]))},barLeft:function(I){return(B.controls.bar.y.th[B.i]&&B.controls.bar.y.th[B.i][I]?B.controls.bar.y.th[B.i][I]:[])},barLeftControls:function(){return B.controls.bar.y.controls[B.i]||d([])},barLefts:function(){return B.controls.bar.y.ths()},barHandleFreezeLeft:function(){return B.controls.bar.y.handleFreeze[B.i]||d([])},barMenuLeft:function(){return B.controls.bar.y.menu[B.i]||d([])},barTop:function(I){return(B.controls.bar.x.th[B.i]&&B.controls.bar.x.th[B.i][I]?B.controls.bar.x.th[B.i][I]:[])},barTopControls:function(){return B.controls.bar.x.controls[B.i]||d([])},barTops:function(){return B.controls.bar.x.ths()},barTopParent:function(){return B.controls.bar.x.parent[B.i]||d([])},barHandleFreezeTop:function(){return B.controls.bar.x.handleFreeze[B.i]||d([])},barMenuParentTop:function(){return B.controls.bar.x.menuParent[B.i]||d([])},barMenuTop:function(){return B.controls.bar.x.menu[B.i]||d([])},tdActive:function(){return B.cellLast.td||null},tdMenu:function(){return B.controls.tdMenu[B.i]||d([])},cellsEdited:function(){return(B.controls.cellsEdited!==E?B.controls.cellsEdited:B.controls.cellsEdited=[])},chart:function(){return B.controls.chart[B.i]||d([])},enclosure:function(){return B.controls.enclosure[B.i]||d([])},enclosures:function(){return B.controls.enclosures||d([])},formula:function(){return B.controls.formula||d([])},fullScreen:function(){return B.controls.fullScreen||d([])},header:function(){return B.controls.header||d([])},highlighted:function(){return B.highlighter.last||d([])},menuRight:function(){return B.controls.menuRight[B.i]||d([])},inPlaceEdit:function(){return B.controls.inPlaceEdit[B.i]||d([])},inputs:function(){return B.controls.inputs[B.i]||d([])},label:function(){return B.controls.label||d([])},menus:function(){return B.controls.menus[B.i]||d([])},menuLeft:function(){return B.controls.menuLeft[B.i]||d([])},pane:function(){return B.controls.pane[B.i]||{}},panes:function(){return B.controls.panes||d([])},parent:function(){return F.parent},scrolls:function(){return B.controls.scrolls||d([])},sheetAdder:function(){return B.controls.sheetAdder||d([])},table:function(){return B.controls.table[B.i]||d([])},tables:function(){return B.controls.tables||d([])},tab:function(){return B.controls.tab[B.i]||d([])},tabs:function(){return B.controls.tabs||d([])},tabContainer:function(){return B.controls.tabContainer||d([])},title:function(){return B.controls.title||d([])}},id:"jS_"+C+"_",cl:{autoFiller:"jSAutoFiller",autoFillerHandle:"jSAutoFillerHandle",autoFillerCover:"jSAutoFillerCover",barCorner:"jSBarCorner",barController:"jSBarController",barControllerChild:"jSBarControllerChild",barHelper:"jSBarHelper",barLeft:"jSBarLeft",barHandleFreezeLeft:"jSBarHandleFreezeLeft",barTop:"jSBarTop",barTopMenuButton:"jSBarTopMenuButton",barHandleFreezeTop:"jSBarHandleFreezeTop",barTopParent:"jSBarTopParent",chart:"jSChart",formula:"jSFormula",formulaParent:"jSFormulaParent",header:"jSHeader",fullScreen:"jSFullScreen",inPlaceEdit:"jSInPlaceEdit",menu:"jSMenu",menuFixed:"jSMenuFixed",parent:"jSParent",scroll:"jSScroll",sheetAdder:"jSSheetAdder",table:"jS",label:"jSLoc",pane:"jSEditPane",tab:"jSTab",tabContainer:"jSTabContainer",tabContainerScrollable:"jSTabContainerScrollable",tdMenu:"jSTdMenu",title:"jSTitle",enclosure:"jSEnclosure",ui:"jSUI"},msg:{addRowMulti:"How many rows would you like to add?",addColumnMulti:"How many columns would you like to add?",cellFind:"What are you looking for in this spreadsheet?",cellNoFind:"No results found.",dragToFreezeCol:"Drag to freeze column",dragToFreezeRow:"Drag to freeze row",addSheet:"Add a spreadsheet",openSheet:"Are you sure you want to open a different sheet?  All unsaved changes will be lost.",toggleHideRow:"No row selected.",toggleHideColumn:"No column selected.",loopDetected:"Loop Detected",newSheetTitle:"What would you like the sheet's title to be?",notFoundColumn:"Column not found",notFoundRow:"Row not found",notFoundSheet:"Sheet not found",setCellRef:"Enter the name you would like to reference the cell by.",sheetTitleDefault:"Spreadsheet {index}",maxRowsBrowserLimitation:"You've reached the maximum amount of rows this browser supports. Try using Chrome, FireFox, or Internet Explorer 9+",maxColsBrowserLimitation:"You've reached the maximum amount of columns this browser supports. Try using Chrome, FireFox, or Internet Explorer 9+",maxSizeBrowserLimitationOnOpen:"The spreadsheet you are loading is larger than the maximum size of cells this browser supports. Try using Chrome, Firefox, or Internet Explorer 9+. You can an proceed, but the spreadsheet may not work as intended."},kill:function(){if(!B){return false}d(m).unbind("keydown");this.obj.fullScreen().remove();(this.obj.inPlaceEdit().destroy||A)();F.parent.trigger("sheetKill").removeClass(B.theme.parent).html("");delete F.parent[0].jS;this.obj.menus().remove();var I=d.sheet.events.length;for(var O=0;O<I;O++){F.parent.unbind(d.sheet.events[O])}d.sheet.instance.splice(C,1);return true},trigger:function(I,O){O=O||[];return F.parent.triggerHandler(I,[B].concat(O))},spreadsheetsToArray:function(I){if(I||B.spreadsheets.length==0){B.cycleCellsAll(function(P,Q,O){B.createCell(P,Q,O)})}return B.spreadsheets},spreadsheetToArray:function(O,I){I=(I?I:B.i);if(!B.spreadsheets[I]){B.cycleCells(function(Q,R,P){B.createCell(Q,R,P)})}return B.spreadsheets[I]},createCell:function(S,V,X,ab){var P,T,W,ac,Z,Q,R,O,U,ae,ad,I,aa,af,Y;if((P=B.spreadsheets[S])===E){P=B.spreadsheets[S]=[]}if((T=P[V])===E){T=P[V]=[]}if((ac=B.controls.tables[S])===E||(R=ac.tBody)===E||(O=R.children[V])===E||(U=O.children[X])===E){return}W=T[X]=U.jSCell=new l.Cell(S,U,B,B.cellHandler);I=U.getAttribute("data-formula");aa=U.getAttribute("data-celltype");af=U.getAttribute("data-uneditable");Y=U.getAttribute("id");if(I!==null){W.formula=I}if(aa!==null){W.cellType=aa}if(af!==null){W.uneditable=af}if(Y!==null){W.id=Y}W.value=U.textContent||U.innerText;W.calcCount=ab||0;W.needsUpdated=W.formula.length>0;if(W.formula.length>0&&W.formula.charAt(0)=="="){W.formula=W.formula.substring(1)}Z=ac.colGroup;if((Q=Z.children[X])===E){Q=m.createElement("col");Q.setAttribute("style","width:"+B.s.newColumnWidth+"px;");Z.appendChild(Q)}B.shortenCellLookupTime(X,W,U,Q,O,R,ac);if((ad=B.controls.bar.y.th[S])===E){ad=B.controls.bar.y.th[S]=[]}if(ad[V]===E){ad[V]=O.children[0]}if((ae=B.controls.bar.x.th[S])===E){ae=B.controls.bar.x.th[S]=[]}if(ae[X]!==E){ae[X]=R.children[0].children[X]}return W},shortenCellLookupTime:function(P,S,U,O,T,I,R){var Q;if((Q=O.jSCells)===E){Q=O.jSCells=[]}Q.unshift(S);U.col=O;U.type="cell";U.barLeft=U.barLeft||T.children[0];U.barTop=U.barTop||I.children[0].children[P];if(T.jSCells===E){T.jSCells=[]}T.jSCells.unshift(S);if(T.tds===E){T.tds=[]}T.tds.unshift(U);if(R.jSCells===E){R.jSCells=[]}R.jSCells.unshift(S);if(!R.tds){R.tds=[]}R.tds.unshift(U);U.table=R},getCell:function(P,S,Q){var O,R,I;if((O=B.spreadsheets[P])===E||(R=O[S])===E||(I=R[Q])===E){if(F.loader!==null){I=F.loader.jitCell(P,S,Q,B,B.cellHandler)}}if(I===E||I===null){return null}I.sheetIndex=P;I.rowIndex=S;I.columnIndex=Q;return I},nav:false,setNav:function(P){var I=d.sheet.instance;for(var O=0;O<I.length;O++){(I[O]||{}).nav=false}B.nav=P},controlFactory:{addRowMulti:function(Q,T,P,I,S){var O=(S?"row-init":"row");function R(U){if(U){if(!K(U)){B.controlFactory.addCells(Q,P,parseInt(U),O,I);B.trigger("sheetAddRow",[Q,P,U])}}}if(!T){F.prompt(B.msg.addRowMulti,R)}else{R(T)}},addColumnMulti:function(Q,T,P,I,S){var O=(S?"col-init":"col");function R(U){if(U){if(!K(U)){B.controlFactory.addCells(Q,P,parseInt(U),O,I);B.trigger("sheetAddColumn",[Q,P,U])}}}if(!T){F.prompt(B.msg.addColumnMulti,R)}else{R(T)}},rowAdder:new l.RowAdder(),columnAdder:new l.ColumnAdder(),addCells:function(ai,al,V,R,aa){B.autoFillerHide();B.setDirty(true);B.setChanged(true);B.obj.barHelper().remove();var Y=B.obj.table(),aj=Y[0],S=aj.tBody,ag=aj.colGroup,Z=false,ae=B.obj.tdActive(),U=B.spreadsheets[B.i]||(B.spreadsheets[B.i]=[]),af,T,ac=B.cl.barLeft+" "+B.theme.bar,ak=B.cl.barTop+" "+B.theme.bar,W,X=(F.loader!==null?F.loader:null),P=(X!==null?function(an,am){return X.getWidth(an,am)}:function(){return F.newColumnWidth}),ab=(X!==null?function(am,an){return X.getHeight(am,an)}:function(){return F.colMargin}),ad=(X!==null?X.setupCell:null),Q=B.controls.bar.x.th[B.i]||(B.controls.bar.x.th[B.i]=[]),O=B.controls.bar.y.th[B.i]||(B.controls.bar.y.th[B.i]=[]),ah=aj.size(),I=m.createDocumentFragment();V=V||1;R=R||"col";switch(R){case"row":ad=null;case"row-init":if(ai===E||ai===null||ai>ah.rows){ai=ah.rows;Z=true}else{if(ai===0){al=false}}W={row:ai,col:0};af=this.rowAdder;if(af.setQty(V,ah)===false){if(!B.isBusy()){F.alert(B.msg.maxRowsBrowserLimitation)}return}af.setCreateBarFn(function(am){var an=m.createElement("tr"),ao=m.createElement("th");ao.className=ac;ao.entity="left";ao.type="bar";ao.style.height=ab(B.i,am)+"px";ao.innerHTML=ao.label=an.rowIndex;an.appendChild(ao);I.appendChild(an);O.splice(am,0,ao);U.splice(am,0,[]);return an});if(ad!==null){af.setCreateCellFn(function(aq,ao,an){var am=ad.call(X,B.i,aq,ao,function(at){return at.jSCell=new l.Cell(B.i,at,B,B.cellHandler)}),ar=am.td,ap=U[aq];ap[ao]=am;am.updateValue();an.insertBefore(ar,an.children[ao]);B.shortenCellLookupTime(ao,am,ar,ag.children[ao],an,S,aj)})}else{af.setCreateCellFn(function(ap,an,am){var aq=m.createElement("td"),ao=U[ap];if(ao===undefined){U[ap]=ao=[]}am.insertBefore(aq,am.children[an]);B.createCell(B.i,ap,an)})}af.setAddedFinishedFn(function(am){S.insertBefore(I,al?S.children[ai]:S.children[ai].nextSibling);B.refreshRowLabels(ai);T=am});break;case"col":ad=null;case"col-init":if(ai===E||ai===null||ai>ah.cols){ai=ah.cols;Z=true}else{if(ai===0){al=false}}W={row:0,col:ai};af=this.columnAdder;if(af.setQty(V,ah)===false){if(!B.isBusy()){F.alert(B.msg.maxColsBrowserLimitation)}return}af.setCreateBarFn(function(ao){var ap=S.children[0],aq=m.createElement("col"),ar=m.createElement("th"),an,am=S.children[1];aq.style.width=P(B.i,ao)+"px";ar.entity="top";ar.type="bar";ar.innerHTML=ar.label=h.columnLabelString(ao);ar.className=ak;if(am===undefined){an=m.createElement("th");an.setAttribute("class",ac);an.entity="left";an.type="bar";am=m.createElement("tr");am.style.height=ab(B.i,ao)+"px";am.appendChild(an);S.appendChild(am);an.innerHTML=am.rowIndex;O.splice(0,0,an)}ag.insertBefore(aq,ag.children[ao]);ap.insertBefore(ar,ap.children[ao]);Q.splice(ao,0,ar);return{bar:ar,col:aq,barParent:ap}});if(ad!==null){af.setCreateCellFn(function(ar,ao,ap){var an=ad.call(X,B.i,ar,ao,function(at){return at.jSCell=new l.Cell(B.i,at,B,B.cellHandler)}),au=an.td,am=S.children[ar],aq=U[ar];if(aq===undefined){U[ar]=aq=[]}aq[ao]=an;an.updateValue();am.insertBefore(au,am.children[ao]);B.shortenCellLookupTime(ao,an,au,ap.col,am,S,aj)})}else{af.setCreateCellFn(function(aq,an,ao){var ar=m.createElement("td"),am=S.children[aq],ap=U[aq];if(ap===undefined){U[aq]=ap=[]}am.insertBefore(ar,am.children[an]);B.createCell(B.i,aq,an)})}af.setAddedFinishedFn(function(am){B.refreshColumnLabels(ai);T=am});break}af.createCells(ai,ah,al);if(!aa&&Z!=true){B.offsetFormulas(W,T,al)}B.obj.pane().resizeScroll(true);if(ae&&ae[0]&&ae[0].cellIndex&&ae[0].parentNode){B.colLast=ae[0].cellIndex;B.rowLast=ae[0].parentNode.rowIndex}return true},addRow:function(O,I){B.controlFactory.addCells(O,I,1,"row");B.trigger("sheetAddRow",[O,I,1])},addColumn:function(O,I){B.controlFactory.addCells(O,I,1,"col");B.trigger("sheetAddColumn",[O,I,1])},barLeft:function(O){var P=O.tBody.children,I=P.length-1;if(I>0){do{P[I].insertBefore(m.createElement("th"),P[I].children[0])}while(I-->1)}},barTop:function(W){var O=W.colGroup,V=O.children,R,P=W.tBody.children[0],T=m.createElement("col"),U=m.createElement("th"),S=m.createElement("tr"),Q=0;if(P===undefined){O.innerHTML=""}else{Q=P.children.length;while(V.length>Q){O.removeChild(V[V.length-1])}}T.style.width=T.style.minWidth=F.colMargin+"px";O.insertBefore(T,O.children[0]);S.appendChild(U);S.className=B.cl.barTopParent;W.tBody.insertBefore(S,W.tBody.children[0]);W.barTopParent=S;W.corner=U;U.col=T;B.controls.barTopParent[B.i]=d(S);R=g.min(Q,F.initCalcCols);if(R>0){do{var I=m.createElement("th");if(!V[R]){V[R]=m.createElement("col");O.insertBefore(V[R],T.nextSibling)}V[R].bar=I;I.col=V[R];S.insertBefore(I,U.nextSibling)}while(R-->1)}W.barTop=B.controls.barTopParent[B.i].children();return S},barHandleFreeze:{top:function(P){if(B.isBusy()){return false}var I=B.obj.pane().actionUI,Z=I.frozenAt,V=I.scrolledArea;if(!(V.col<=(Z.col+1))){return false}B.obj.barHelper().remove();var aa=P.table,Y=aa.tBody,Q=Y.children[0],S=Q.children,U=d(S[Z.col+1]),X=U.position(),W,R=d(P).offset(),T=m.createElement("div"),O=P.freezeHandleTop=d(T).appendTo(P).addClass(B.theme.barHandleFreezeTop+" "+B.cl.barHelper+" "+B.cl.barHandleFreezeTop).height(U.height()).css("left",(X.left-T.clientWidth)+"px").attr("title",B.msg.dragToFreezeCol);B.controls.bar.helper[B.i]=B.obj.barHelper().add(T);B.controls.bar.x.handleFreeze[B.i]=O;B.draggable(O,{axis:"x",start:function(){B.setBusy(true);W=d(m.createElement("div")).appendTo(P).css("position","absolute").addClass(B.theme.barFreezeIndicator+" "+B.cl.barHelper).height(P.table.corner.clientHeight).fadeTo(0,0.33)},drag:function(){var ab=B.nearest(O,S).prev();if(ab.length&&ab.position){W.width(ab.position().left+ab.width())}},stop:function(ad,ab){W.remove();B.setBusy(false);B.setDirty(true);var ac=B.nearest(O,S);B.obj.barHelper().remove();V.col=I.frozenAt.col=B.getTdLocation(ac[0]).col-1;B.autoFillerHide();I.scrollStart("x",B.sheetSize(P.table))},containment:[R.left,R.top,w.min(R.left+P.table.clientWidth,R.left+P.clientWidth-f.scrollBarSize.width),R.top]});return true},left:function(P){if(B.isBusy()){return false}var P=B.obj.pane(),I=P.actionUI,Y=I.frozenAt,U=I.scrolledArea;if(!(U.row<=(Y.row+1))){return false}B.obj.barHelper().remove();var Z=P.table,X=Z.tBody,T=d(X.children[Y.row+1].children[0]),W=T.position(),V,Q=d(P).offset(),S=m.createElement("div"),R=X.children,O=P.freezeHandleLeft=d(S).appendTo(P).addClass(B.theme.barHandleFreezeLeft+" "+B.cl.barHelper+" "+B.cl.barHandleFreezeLeft).width(T.width()).css("top",(W.top-S.clientHeight+1)+"px").attr("title",B.msg.dragToFreezeRow);B.controls.bar.helper[B.i]=B.obj.barHelper().add(S);B.controls.bar.y.handleFreeze[B.i]=O;B.draggable(O,{axis:"y",start:function(){B.setBusy(true);V=d(m.createElement("div")).appendTo(P).css("position","absolute").addClass(B.theme.barFreezeIndicator+" "+B.cl.barHelper).width(S.clientWidth).fadeTo(0,0.33)},drag:function(){var aa=B.nearest(O,R).prev();if(aa.length&&aa.position){V.height(aa.position().top+aa.height())}},stop:function(ac,aa){V.remove();B.setBusy(false);B.setDirty(true);var ab=B.nearest(O,R);B.obj.barHelper().remove();U.row=I.frozenAt.row=w.max(B.getTdLocation(ab.children(0)[0]).row-1,0);B.autoFillerHide();P.actionUI.scrollStart("y",B.sheetSize(P.table))},containment:[Q.left,Q.top,Q.left,w.min(Q.top+P.table.clientHeight,Q.top+P.clientHeight-f.scrollBarSize.height)]});return true},corner:function(){}},menu:function(P,I){var S,O=d([]),R=B.theme.menuHover;switch(P){case"top":S=d(m.createElement("div")).addClass(B.theme.menu+" "+B.cl.tdMenu);B.controls.bar.x.menu[B.i]=S;break;case"left":S=d(m.createElement("div")).addClass(B.theme.menu+" "+B.cl.tdMenu);B.controls.bar.y.menu[B.i]=S;break;case"cell":S=d(m.createElement("div")).addClass(B.theme.menu+" "+B.cl.tdMenu);B.controls.tdMenu[B.i]=S;break}B.controls.menus[B.i]=B.obj.menus().add(S);S.mouseleave(function(){S.hide()}).bind("contextmenu",function(){return false}).appendTo(L).hide().disableSelectionSpecial();for(var Q in I){if(I[Q]){if(d.isFunction(I[Q])){O.pushStack(d(m.createElement("div")).text(Q).data("msg",Q).click(function(){I[d(this).data("msg")].call(this,B);S.hide();return false}).appendTo(S).hover(function(){O.removeClass(R);d(this).addClass(R)},function(){d(this).removeClass(R)}))}else{if(I[Q]=="line"){d(m.createElement("hr")).appendTo(S)}}}}return S},barMenu:{top:function(P,I,O){if(B.isBusy()){return false}var R=B.obj.barMenuTop().hide();if(!R.length){R=B.controlFactory.menu("top",F.contextmenuTop)}B.obj.menus().hide();if(!O){R.css("left",(P.pageX-5)+"px").css("top",(P.pageY-5)+"px").show();return R}var Q=B.obj.barMenuParentTop().hide();if(!Q.length){Q=d(m.createElement("div")).addClass(B.theme.barMenuTop+" "+B.cl.barHelper+" "+B.cl.barTopMenuButton).append(d(m.createElement("span")).addClass("ui-icon ui-icon-triangle-1-s")).mousedown(function(S){Q.parent().mousedown().mouseup();var T=Q.offset();R.css("left",(S.pageX-5)+"px").css("top",(S.pageY-5)+"px").show()}).blur(function(){if(R){R.hide()}});Q.get(0).destroy=function(){Q.remove();B.controls.bar.x.menuParent[B.i]=null};B.controls.bar.x.menuParent[B.i]=Q}Q.prependTo(O).show()},left:function(O,I){if(B.isBusy()){return false}B.obj.barMenuLeft().hide();if(I){B.obj.barHandleFreezeLeft().remove()}var P;P=B.obj.barMenuLeft();if(!P.length){P=B.controlFactory.menu("left",F.contextmenuLeft)}B.obj.menus().hide();P.css("left",(O.pageX-5)+"px").css("top",(O.pageY-5)+"px").show();return true},corner:function(){}},tdMenu:function(I){if(B.isBusy()){return false}B.obj.tdMenu().hide();var O=B.obj.tdMenu();if(!O.length){O=B.controlFactory.menu("cell",F.contextmenuCell)}B.obj.menus().hide();O.css("left",(I.pageX-5)+"px").css("top",(I.pageY-5)+"px").show();return true},header:function(){B.obj.header().remove();B.obj.sheetAdder().remove();B.obj.tabContainer().remove();var V=m.createElement("div"),P=m.createElement("table"),S=m.createElement("tr"),Y,Q,Z=m.createElement("td"),aa,R,O,W,I;V.appendChild(P);P.appendChild(S);V.className=B.cl.header+" "+B.theme.control;B.controls.header=d(V);if(F.title){if(d.isFunction(F.title)){F.title=B.title(B,C)}Z.className=B.cl.title;B.controls.title=d(Z).html(F.title)}else{d(Z).hide()}S.appendChild(Z);function X(ac){if(d.isFunction(ac)){ac=d(ac.call(B))}else{ac=d(ac)}if(ac.is("ul")){ac.find("ul").hide().addClass(B.theme.menuUl);ac.find("li").addClass(B.theme.menuLi).hover(function(){d(this).find("ul:first").hide().show()},function(){d(this).find("ul:first").hide()})}return ac}if(B.isSheetEditable()){if(F.menuLeft){R=m.createElement("td");R.className=B.cl.menu+" "+B.cl.menuFixed+" "+B.theme.menuFixed;S.insertBefore(R,Z);B.controls.menuLeft[B.i]=d(R).append(X(F.menuLeft)).children().addClass(B.theme.menuFixed);B.controls.menuLeft[B.i].find("img").load(function(){B.sheetSyncSize()})}if(F.menuRight){O=m.createElement("td");O.className=B.cl.menu+" "+B.cl.menuFixed;S.appendChild(O);B.controls.menuRight[B.i]=d(O).append(X(F.menuRight)).children().addClass(B.theme.menuFixed);B.controls.menuRight[B.i].find("img").load(function(){B.sheetSyncSize()})}aa=m.createElement("td");aa.className=B.cl.label+" "+B.theme.control;B.controls.label=d(aa);W=m.createElement("textarea");W.className=B.cl.formula+" "+B.theme.controlTextBox;W.onkeydown=B.evt.formula.keydown;W.onkeyup=function(){B.obj.inPlaceEdit().value=this.value};W.onchange=function(){B.obj.inPlaceEdit().value=this.value};W.onpaste=B.evt.pasteOverCells;W.onfocus=function(){B.setNav(false)};W.onfocusout=function(){B.setNav(true)};W.onblur=function(){B.setNav(true)};B.controls.formula=d(W);var U=m.createElement("span");U.appendChild(W);Y=m.createElement("table");Q=m.createElement("tr");Y.appendChild(Q);V.appendChild(Y);I=m.createElement("td");I.className=B.cl.formulaParent;I.appendChild(U);Q.appendChild(aa);Q.appendChild(I);Q.appendChild(m.createElement("td"));B.resizableSheet(d(U),{minHeight:B.controls.formula.height(),maxHeight:78,handles:"s",resize:function(ad,ac){B.controls.formula.height(ac.size.height)},stop:function(){B.sheetSyncSize()}});var ab=d.sheet.instance;for(var T=0;T<ab.length;T++){(ab||{}).nav=false}B.setNav(true);d(m).keydown(B.evt.document.keydown)}return V},ui:function(){var I=m.createElement("div");I.setAttribute("class",B.cl.ui);B.obj.ui=I;return I},sheetAdder:function(){var I=m.createElement("span");if(B.isSheetEditable()){I.setAttribute("class",B.cl.sheetAdder+" "+B.cl.tab+" "+B.theme.tab);I.setAttribute("title",B.msg.addSheet);I.innerHTML="+";I.onmousedown=function(){B.addSheet();return false};I.i=-1}return B.controls.sheetAdder=d(I)},tabContainer:function(){var I=m.createElement("span"),O;I.setAttribute("class",B.cl.tabContainer);I.onmousedown=function(Q){Q=Q||f.event;var P=(Q.target||Q.srcElement).i;if(P>=0){B.trigger("sheetSwitch",[P])}return false};I.ondblclick=function(Q){Q=Q||f.event;var P=(Q.target||Q.srcElement).i;if(P>=0){B.trigger("sheetRename",[P])}return false};if(B.isSheetEditable()&&d.fn.sortable){return B.controls.tabContainer=d(I).sortable({placeholder:"ui-state-highlight",axis:"x",forceHelperSize:true,forcePlaceholderSize:true,opacity:0.6,start:function(Q,P){O=P.item.index();B.trigger("sheetTabSortStart",[Q,P])},update:function(Q,P){B.trigger("sheetTabSortUpdate",[Q,P,O])}})}return B.controls.tabContainer=d(I)},sheetUI:function(X,Y,R){B.i=R;B.tuneTableForSheetUse(Y);B.readOnly[R]=(Y.className||"").match(/\breadonly\b/i)!=null;var T=Y.tBody.children.length>0,S=B.controlFactory.enclosure(Y),Q=B.s,O=Q.hiddenRows[R],W=Q.hiddenColumns[R],P=S.pane,I=d(P),U=function(ac){ac=ac||f.event;if(B.isBusy()){return false}if(B.isBar(ac.target)){var aa=ac.target.entity,ab=B.getBarIndex[aa](ac.target);if(ab<0){return false}if(B.evt.barInteraction.first==B.evt.barInteraction.last){B.controlFactory.barMenu[aa](ac,ab)}}else{B.controlFactory.tdMenu(ac)}return false};X.appendChild(S);B.controlFactory.barTop(Y);B.controlFactory.barLeft(Y);P.appendChild(Y);if(B.isSheetEditable()){B.controlFactory.autoFiller(P)}if(B.isSheetEditable()){var V=B.obj.formula(),Z="";I.mousedown(function(aa){B.setNav(true);if(B.isBusy()){return false}if(B.isCell(aa.target)){if(aa.button==2){U.call(this,aa);B.evt.cellOnMouseDown(aa);return true}B.evt.cellOnMouseDown(aa);return false}if(B.isBar(aa.target)){if(aa.button==2){U.call(this,aa)}Z=aa.target.entity;B.evt.barInteraction.select(aa.target);return false}return true});P.onmouseup=function(){Z=""};P.onmouseover=function(ae){ae=ae||f.event;var ad=ae.target||ae.srcElement;if(B.isBusy()){return false}if(!B.isBar(ad)){return false}var ac=d(ad),aa=ad.entity,ab=B.getBarIndex[aa](ad);if(ab<0){return false}if(B.evt.barInteraction.selecting&&aa==Z){B.evt.barInteraction.last=ab;B.cellSetActiveBar(aa,B.evt.barInteraction.first,B.evt.barInteraction.last)}else{B.resizeBar[aa](ac,ab,P,Y);if(B.isSheetEditable()){B.controlFactory.barHandleFreeze[aa](P);if(aa=="top"){B.controlFactory.barMenu[aa](ae,ab,ac)}}}return true};P.ondblclick=B.evt.cellOnDblClick;I.bind("contextmenu",U).disableSelectionSpecial().bind("cellEdit",B.evt.cellEdit)}B.createSpreadsheet(Y,R);B.checkMinSize(Y);B.controlFactory.tab();if(Q.loader!==null){O=Q.loader.hiddenRows(R);W=Q.loader.hiddenColumns(R)}else{if(O===E||O.length>0){O=Y.getAttribute("data-hiddenrows");if(O!==null){O=c.toNumbers(O.split(","))}}if(W===E||W.length>0){W=Y.getAttribute("data-hiddencolumns");if(W!==null){W=c.toNumbers(W.split(","))}}}S.actionUI.hide(O,W);B.setChanged(true)},enclosure:function(ab){var X=m.createElement("div"),T=d(X),I=new l.ActionUI(X,ab,B.cl.scroll,B.s.frozenAt[B.i],d.sheet.max),aa=I.scrollUI,P=I.pane,ac=ab.tBody.children,S=ab.colGroup.children,Q=(F.loader!==null),W,V,Y,R,O,Z,U;ab.size=function(){return B.tableSize(ab)};P.size=function(){return B.sheetSize(ab)};if(Q){W=[function(){U=false;O=aa.scrollTop;if(Y!=O){Y=O;U=I.scrollTo("y",O)}},function(){if(Z&&I.scrollAxis.x.size>=(S.length-1)){B.calcVisibleCol(I)}},function(){if(U){if(I.scrollAxis.y.size>=(ac.length-1)){B.calcVisibleRow(I)}B.updateYBarWidthToCorner(I)}},function(){if(Z&&U){B.obj.barHelper().remove();B.autoFillerGoToTd();if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}}}]}else{W=[function(){R=aa.scrollLeft;if(V!==R){V=R;Z=I.scrollTo("x",R)}},function(){O=aa.scrollTop;if(Y!==O){Y=O;U=I.scrollTo("y",O)}},function(){if(Z){B.calcVisibleCol(I)}},function(){if(U){B.calcVisibleRow(I);B.updateYBarWidthToCorner(I)}},function(){if(Z&&U){B.obj.barHelper().remove();B.autoFillerGoToTd();if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}}}]}aa.onscroll=function(){x(W)};setTimeout(function(){aa.scrollTop=0;aa.scrollLeft=0},0);aa.onmousedown=function(){B.obj.barHelper().remove()};X.actionUI=P.actionUI=I;X.scrollUI=P.scrollUI=aa;X.appendChild(aa);aa.scrollTop=0;aa.scrollLeft=0;P.setAttribute("class",B.cl.pane+" "+B.theme.pane);X.appendChild(P);X.setAttribute("class",B.cl.enclosure);X.pane=P;X.table=ab;P.table=ab;P.enclosure=X;P.$enclosure=T;ab.pane=P;ab.enclosure=X;ab.$enclosure=T;B.controls.pane[B.i]=P;B.controls.panes=B.obj.panes().add(P);B.controls.enclosure[B.i]=T;B.controls.enclosures=B.obj.enclosures().add(X);return X},tab:function(){var I=m.createElement("span"),O=B.controls.tab[B.i]=d(I).appendTo(B.obj.tabContainer());I.setAttribute("class",B.cl.tab+" "+B.theme.tab);B.sheetTab(true,function(P){I.innerHTML=P});I.i=B.i;B.controls.tabs=B.obj.tabs().add(O);return I},customTab:function(P){var I=m.createElement("span"),O=d(I).appendTo(B.obj.tabContainer());I.setAttribute("class",B.cl.tab+" "+B.theme.tab);I.innerHTML=P;return O},inPlaceEdit:function(T,O){T=T||B.obj.tdActive();if(T===null){T=B.rowTds(null,1)[1];B.cellEdit(T)}if(T===null){return}(B.obj.inPlaceEdit().destroy||A)();var S=B.obj.formula(),P=S.val(),I,R,Q=B.obj.pane();if(!T.isHighlighted){return}I=m.createElement("textarea");R=d(I);Q.inPlaceEdit=I;I.i=B.i;I.className=B.cl.inPlaceEdit+" "+B.theme.inPlaceEdit;I.td=T;I.goToTd=function(){this.offset=d(T).position();if(!this.offset.left&&!this.offset.right){d(I).hide()}else{this.setAttribute("style","left:"+(this.offset.left-1)+"px;top:"+(this.offset.top-1)+"px;width:"+this.td.clientWidth+"px;height:"+this.td.clientHeight+"px;min-width:"+this.td.clientWidth+"px;min-height:"+this.td.clientHeight+"px;")}};I.goToTd();I.onkeydown=B.evt.inPlaceEdit.keydown;I.onchange=I.onkeyup=function(){S[0].value=I.value};I.onfocus=function(){B.setNav(false)};I.onblur=I.onfocusout=function(){B.setNav(true)};I.onpaste=B.evt.pasteOverCells;I.destroy=function(){Q.inPlaceEdit=null;B.cellLast.isEdit=(I.value!=P);I.parentNode.removeChild(I);B.controls.inPlaceEdit[I.i]=false};Q.appendChild(I);I.onfocus();B.controls.inPlaceEdit[B.i]=I;R.focus().val("").val(S[0].value);if(O){R.select()}if(d.fn.elastic){d(I).elastic()}},autoFiller:function(Q){if(!F.autoFiller){return false}var O=m.createElement("div"),I=m.createElement("div"),P=m.createElement("div");O.i=B.i;O.className=B.cl.autoFiller+" "+B.theme.autoFiller;I.className=B.cl.autoFillerHandle;P.className=B.cl.autoFillerCover;O.onmousedown=function(){var S=B.obj.tdActive();if(S){var R=B.getTdLocation(S);B.cellSetActive(S,R,true,B.autoFillerNotGroup,function(){var U=B.highlighted(),T=B.getTdLocation(U.last());B.fillUpOrDown(T.row<R.row||T.col<R.col);B.autoFillerGoToTd(S);B.autoFillerNotGroup=false})}return false};Q.autoFiller=B.controls.autoFiller[B.i]=d(O);Q.appendChild(O);return true}},autoFillerNotGroup:true,tsv:new TSV(),updateCellsAfterPasteToFormula:function(W){var V=0,U=B.obj.formula(),Y=new a();W=W||U.val();var T={row:B.cellLast.row,col:B.cellLast.col},O=U.val(),Q=O;if(T.row==0&&T.col==0){return false}var Z=B.tsv.parse(O);if(!d.isArray(Z)){U.val(Z);B.fillUpOrDown(false,Z);return true}for(var S=0;S<Z.length;S++){B.cellLast.isEdit=true;var I=Z[S];for(var R=0;R<I.length;R++){V++;var P=B.getTd(-1,S+T.row,R+T.col);P.row=T.row;P.col=T.col;if(P.length){if(!B.spreadsheets[B.i]||!B.spreadsheets[B.i][S+T.row]||!B.spreadsheets[B.i][S+T.row][R+T.col]){continue}var X=B.spreadsheets[B.i][S+T.row][R+T.col];if(X){F.parent.one("sheetPreCalculation",function(){if((I[R]+"").charAt(0)=="="){X.formula=I[R].substring(1);X.value="";P.setAttribute("data-formula",I[R])}else{X.formula="";X.value=I[R];P.removeData("formula")}});B.calcDependencies.call(X);if(S==0&&R==0){Q=I[R]}}}}}if(O!=Q){U.val(Q)}B.fillUpOrDown(false,Q);B.evt.cellEditDone(true);return true},evt:{inPlaceEdit:{enter:function(I){if(I.shiftKey){return true}return B.evt.cellSetActiveFromKeyCode(I,true)},tab:function(I){if(I.shiftKey){return true}return B.evt.cellSetActiveFromKeyCode(I,true)},keydown:function(I){I=I||f.event;B.trigger("sheetFormulaKeydown",[true]);switch(I.keyCode){case s.ENTER:return B.evt.inPlaceEdit.enter(I);break;case s.TAB:return B.evt.inPlaceEdit.tab(I);break;case s.ESCAPE:B.evt.cellEditAbandon();return false;break}}},formula:{keydown:function(I){I=I||f.event;if(B.readOnly[B.i]){return false}if(B.cellLast.row<0||B.cellLast.col<0){return false}B.trigger("sheetFormulaKeydown",[false]);switch(I.keyCode){case s.C:if(I.ctrlKey){return B.evt.document.copy(I)}case s.X:if(I.ctrlKey){return B.evt.document.cut(I)}case s.Y:if(I.ctrlKey){B.evt.document.redo(I);return false}break;case s.Z:if(I.ctrlKey){B.evt.document.undo(I);return false}break;case s.ESCAPE:B.evt.cellEditAbandon();return true;break;case s.ENTER:B.evt.cellSetActiveFromKeyCode(I,true);return false;break;case s.UNKNOWN:return false}B.cellLast.isEdit=true},If:function(O,I){if(O){B.obj.tdActive().dblclick();return true}return false}},document:{enter:function(I){if(!B.cellLast.isEdit&&!I.ctrlKey){B.obj.tdActive().dblclick()}return false},tab:function(I){B.evt.cellSetActiveFromKeyCode(I)},findCell:function(I){if(I.ctrlKey){B.cellFind();return false}return true},redo:function(I){if(I.ctrlKey&&!B.cellLast.isEdit){B.undo.manager.redo();return false}return true},undo:function(I){if(I.ctrlKey&&!B.cellLast.isEdit){B.undo.manager.undo();return false}return true},copy:function(R,O){var Q=B.highlighted(true),S=B.obj.formula(),P=S.val(),I=B.toTsv(Q,O);S.val(I).focus().select();N.one("keyup",function(){if(O){S.val("")}else{S.val(P)}});return true},cut:function(I){return this.copy(I,true)},pageUpDown:function(I){var Q=B.sheetSize(),U=B.obj.pane(),P=U.clientHeight,R=0,S=0,T,O;if(I){for(O=B.cellLast.row;O>0&&R<P;O--){T=B.getTd(-1,O,1);if(!T.getAttribute("data-hidden")&&T.is(":hidden")){T.show()}R+=T.parent().height()}}else{for(O=B.cellLast.row;O<Q.rows&&R<P;O++){T=B.getTd(-1,O,1);R+=T.parent().height()}}B.cellEdit(T);return false},keydown:function(I){I=I||f.event;if(B.readOnly[B.i]){return false}if(B.cellLast.row<0||B.cellLast.col<0){return false}var O=B.cellLast.td;if(B.nav){switch(I.keyCode){case s.DELETE:B.toTsv(null,true);B.obj.formula().val("");break;case s.TAB:B.evt.document.tab(I);break;case s.ENTER:B.evt.cellSetActiveFromKeyCode(I);break;case s.LEFT:case s.UP:case s.RIGHT:case s.DOWN:(I.shiftKey?B.evt.cellSetHighlightFromKeyCode(I):B.evt.cellSetActiveFromKeyCode(I));break;case s.PAGE_UP:B.evt.document.pageUpDown(true);break;case s.PAGE_DOWN:B.evt.document.pageUpDown();break;case s.HOME:case s.END:B.evt.cellSetActiveFromKeyCode(I);break;case s.V:if(I.ctrlKey){return B.evt.formula.If(!B.evt.pasteOverCells(I),I)}else{d(O).trigger("cellEdit");return true}break;case s.Y:if(I.ctrlKey){B.evt.document.redo(I);return false}else{d(O).trigger("cellEdit");return true}break;case s.Z:if(I.ctrlKey){B.evt.document.undo(I);return false}else{d(O).trigger("cellEdit");return true}break;case s.ESCAPE:B.evt.cellEditAbandon();break;case s.F:if(I.ctrlKey){return B.evt.formula.If(B.evt.document.findCell(I),I)}else{d(O).trigger("cellEdit");return true}break;case s.CAPS_LOCK:case s.SHIFT:case s.ALT:break;case s.CONTROL:B.obj.formula().focus().select();return true;break;default:d(O).trigger("cellEdit");return true;break}return false}}},pasteOverCells:function(O){O=O||f.event;if(O.ctrlKey||O.type=="paste"){var I=function(){B.updateCellsAfterPasteToFormula()};var P=N.one("keyup",function(){I();I=function(){};P.mouseup()}).one("mouseup",function(){I();I=function(){};P.keyup()});B.setDirty(true);B.setChanged(true);return true}return false},cellEditDone:function(Q){(B.obj.inPlaceEdit().destroy||A)();if(B.cellLast.isEdit||Q){var S=B.obj.formula(),R=B.obj.tdActive();if(B.isFormulaEditable(R)){if(R&&B.cellLast.row>0&&B.cellLast.col>0){var O=S.val(),I=R.jSCell,P=0;if(!I.edited){I.edited=true;B.obj.cellsEdited().push(I)}F.parent.one("sheetPreCalculation",function(){if(O.charAt(0)=="="){R.setAttribute("data-formula",O);I.formula=O}else{R.removeAttribute("data-formula");I.value=O;I.formula=""}I.setNeedsUpdated()});B.calcDependencies.call(I);B.cellLast.isEdit=false;B.trigger("sheetCellEdited",[I])}}}},cellEditAbandon:function(I){(B.obj.inPlaceEdit().destroy||A)();B.highlighter.clearBar().clear();if(!I){B.calc()}B.cellLast.td=null;B.cellLast.row=0;B.cellLast.col=0;B.rowLast=0;B.colLast=0;B.highlighter.start={row:0,col:0};B.highlighter.end={row:0,col:0};B.labelUpdate("",true);B.obj.formula().val("").blur();B.autoFillerHide();return false},cellSetHighlightFromKeyCode:function(R){var Q=B.highlightedLastOrdered(),P=B.sheetSize(),U=B.obj.tdActive(),S=B.getTdLocation(U),T=Q.start,I=Q.end,O=B.highlighter;switch(R.keyCode){case s.UP:if(T.row<S.row){T.row--;T.row=w.max(T.row,1);break}I.row--;I.row=w.max(I.row,1);break;case s.DOWN:if(T.row===T.end){T.row++;T.row=w.min(T.row,P.rows);break}if(T.row<S.row){T.row++;T.row=w.max(T.row,1);break}I.row++;I.row=w.min(I.row,P.rows);break;case s.LEFT:if(T.col<S.col){T.col--;T.col=w.max(T.col,1);break}I.col--;I.col=w.max(I.col,1);break;case s.RIGHT:if(T.col<S.col){T.col++;T.col=w.min(T.col,P.cols);break}I.col++;I.col=w.min(I.col,P.cols);break}B.highlighter.start=T;B.highlighter.end=I;B.cycleCellArea(function(V){O.set(V.td)},T,I);return false},cellSetActiveFromKeyCode:function(R,I){var S={row:B.cellLast.row,col:B.cellLast.col},Q=false,P,O=false;switch(R.keyCode){case s.UP:S.row--;break;case s.DOWN:S.row++;break;case s.LEFT:S.col--;break;case s.RIGHT:S.col++;break;case s.ENTER:S=B.evt.incrementAndStayInGrid(B.highlightedLastOrdered(),S,"row","col",R.shiftKey);Q=true;P=B.highlighted();if(P.length>1){O=true}else{if(!I){S.row+=(R.shiftKey?-1:1)}if(F.autoAddCells&&S.row>B.sheetSize().rows){B.controlFactory.addRow()}}break;case s.TAB:S=B.evt.incrementAndStayInGrid(B.highlightedLastOrdered(),S,"col","row",R.shiftKey);Q=true;P=B.highlighted();if(P.length>1){O=true}else{if(!I){S.col+=(R.shiftKey?-1:1)}if(F.autoAddCells&&S.col>B.sheetSize().cols){B.controlFactory.addColumn()}}break;case s.HOME:S.col=1;break;case s.END:S.col=B.obj.tdActive().parent().children("td").length-1;break}S.col=S.col||1;S.row=S.row||1;if(!B.cellLast.isEdit||Q){var T=B.getTd(-1,S.row,S.col);if(T){B.cellEdit(T,null,O);return false}}return true},incrementAndStayInGrid:function(Q,R,O,I,P){if(P){R[O]--;if(R[O]<Q.start[O]){R[O]=Q.end[O];R[I]--}if(R[I]<Q.start[I]){R[I]=Q.end[I]}}else{R[O]++;if(R[O]>Q.end[O]){R[O]=Q.start[O];R[I]++}if(R[I]>Q.end[I]){R[I]=Q.start[I]}}return R},cellOnMouseDown:function(I){B.obj.formula().blur();if(I.shiftKey){B.getTdRange(I,B.obj.formula().val())}else{B.cellEdit(I.target,true)}},cellOnDblClick:function(I){if(B.isBusy()){return false}B.controlFactory.inPlaceEdit();return true},cellEdit:function(I){if(B.isBusy()){return false}B.controlFactory.inPlaceEdit(null,true);return true},barInteraction:{first:0,last:0,selecting:false,select:function(P){if(!P){return}if(!P.type=="bar"){return}var I=P.entity,O=B.getBarIndex[I](P);if(O<0){return false}B[I+"Last"]=O;B.evt.barInteraction.last=B.evt.barInteraction.first=O;B.cellSetActiveBar(I,B.evt.barInteraction.first,B.evt.barInteraction.last);B.evt.barInteraction.first=B.evt.barInteraction.last=B[I+"Last"]=O;B.evt.barInteraction.selecting=true;N.one("mouseup",function(){B.evt.barInteraction.selecting=false});return false}}},refreshColumnLabels:function(S){S=S||0;var O=B.obj.barMenuParentTop();if((O)&&(O.length)){var R=O.get(0);if(d.isFunction(R.destroy)){R.destroy()}}var I=B.controls.bar.x.th[B.i],Q;if(!I){return}for(var P=g.max(S,0);P<I.length;P++){if(P>0){Q=I[P];Q.innerHTML=Q.label=h.columnLabelString(Q.cellIndex)}}},refreshRowLabels:function(R,I){R=R||0;var O=B.controls.bar.y.th[B.i],Q;if(!O){return}I=I||O.length;for(var P=R;P<I;P++){if(P>0){Q=O[P];Q.innerHTML=Q.label=Q.parentNode.rowIndex}}},isCell:function(I){if(I&&I.tagName&&I.tagName=="TD"&&I.type&&I.type=="cell"){return true}return false},isBar:function(I){if(I&&I.tagName&&I.tagName=="TH"&&I.type&&I.type=="bar"){return true}return false},readOnly:[],isSheetEditable:function(I){I=I||B.i;return(F.editable==true&&!B.readOnly[I])},isFormulaEditable:function(I){if(F.lockFormulas){if(I.data("formula")!==E){return false}}return true},toggleFullScreen:function(){if(!B){return}B.evt.cellEditDone();var P=B.obj.fullScreen(),S=B.obj.pane();if(P.is(":visible")){G.unbind("jSResize");L.removeClass("bodyNoScroll");F.parent=P[0].origParent;F.parent.prepend(P.children());P.remove();B.sheetSyncSize();S.resizeScroll();B.trigger("sheetFullScreen",[false])}else{L.addClass("bodyNoScroll");var Q=d(F.parent),P=m.createElement("div"),O=d._data(F.parent[0],"events");P.className=B.cl.fullScreen+" "+B.theme.fullScreen+" "+B.cl.parent;P.origParent=Q;F.parent=B.controls.fullScreen=d(P).append(Q.children()).appendTo(L);G.bind("resize",function(){G.trigger("jSResize")}).bind("jSResize",function(){this.w=G.width();this.h=G.height();F.parent.width(this.w).height(this.h);B.sheetSyncSize();S.resizeScroll()}).trigger("jSResize");Q.trigger("sheetFullScreen",[true]);for(var R in O){for(var I=0;I<O[R].length;I++){F.parent.bind(R,O[R][I].handler)}}}},renameSheet:function(I){if(K(I)){return false}if(I>-1){B.sheetTab()}return true},switchSheet:function(I){if(K(I)){return false}if(I==-1){B.addSheet()}else{if(I!=B.i){B.setActiveSheet(I);if(F.loader===null){B.calc(I)}}}return true},tuneTableForSheetUse:function(P){var O=d(P);B.controls.table[B.i]=O.addClass(B.cl.table).addClass(B.theme.table).attr("id",B.id+B.i).attr("border","1px").attr("cellpadding","0").attr("cellspacing","0");P.spreadsheetIndex=B.i;B.formatTable(P);B.sheetDecorateRemove(false,O);B.controls.tables=B.obj.tables().add(P);var Q=O.attr("data-frozenatrow")*1,I=O.attr("data-frozenatcol")*1;if(!B.s.frozenAt[B.i]){B.s.frozenAt[B.i]={row:0,col:0}}if(Q){B.s.frozenAt[B.i].row=Q}if(I){B.s.frozenAt[B.i].col=I}},createSpreadsheet:function(O,I){this.createSpreadsheetForArea(O,I)},createSpreadsheetForArea:function(Y,T,R,V,S,Z,U){var ab=B.rows(Y),aa,O,X=(F.loader!==null?F.loader:null),I=F.colMargin+"px",Q=(X!==null?X.setRowHeight:function(ad,ah,ag){var af,ae,ac=I;if((af=ag.nextSibling)===undefined){return ac}if((ae=af.style)===undefined){return ac}if(ae.height!==undefined){ac=ae.height}ag.style.height=ac});R=R||0;V=V||ab.length-1;S=S||0;Z=Z||ab[0].children.length-1;if(R===0&&S===0){Y.spreadsheet=B.spreadsheets[T]=[]}aa=V;if(aa<0||O<0){return}do{var W=ab[aa];O=Z;if(W===undefined){if(U){B.controlFactory.addCells(null,false,aa-(ab.length-1),"row-init");W=ab[aa]}else{continue}}do{var P=W.children[O];if(P===undefined){if(U){B.controlFactory.addCells(null,false,O-(ab[0].children.length-1),"col-init");P=W.children[O]}else{continue}}if(aa>0&&O>0){if(!P.jSCell){B.createCell(T,aa,O)}}else{if(O==0&&aa>0){P.type="bar";P.entity="left";P.innerHTML=aa;P.className=B.cl.barLeft+" "+B.cl.barLeft+"_"+B.i+" "+B.theme.bar;Q.call(X,T,aa,P)}if(aa==0&&O>0){P.type="bar";P.entity="top";P.innerHTML=h.columnLabelString(O);P.className=B.cl.barTop+" "+B.cl.barTop+"_"+B.i+" "+B.theme.bar}if(aa==0&&O==0){P.type="bar";P.entity="corner";P.className=B.theme.bar+" "+B.cl.barCorner;B.controls.bar.corner[B.i]=P}}}while(O-->S)}while(aa-->R)},updateYBarWidthToCorner:function(I){var S=I.scrolledArea,X=I.table,U=X.tBody,V=X.corner,R=g.min(F.initCalcRows+S.row,S.row+20,U.lastChild.rowIndex),T=U.children[R],O,W,Q,P=V.col;if(T===E){return}O=T.children[0];W=O.label+"";Q=f.defaultCharSize.width*W.length;if(Q!==P._width||P._width===E){P._width=Q;P.style.width=(Q)+"px"}},toggleHideRow:function(I){I=I||B.rowLast;if(!I){return}var O=B.obj.pane().actionUI;O.toggleHideRow(I);B.autoFillerGoToTd()},toggleHideRowRange:function(P,O){var I=B.obj.pane().actionUI;I.toggleHideRowRange(P,O);B.autoFillerGoToTd()},toggleHideColumn:function(I){I=I||B.colLast;if(!I){return}var O=B.obj.pane().actionUI;O.toggleHideColumn(I);B.autoFillerGoToTd()},toggleHideColumnRange:function(P,O){var I=B.obj.pane().actionUI;I.toggleHideColumnRange(P,O);B.autoFillerGoToTd()},rowShowAll:function(){B.obj.pane().actionUI.rowShowAll()},columnShowAll:function(){B.obj.pane().actionUI.columnShowAll()},merge:function(T){T=T||B.highlighted();if(!T.length){return}var R=[],I=T[0],Q=T[T.length-1],Y=B.getTdLocation(I),O=B.getTdLocation(Q),aa={},W={},V=0,X=0,S=T.length-1,Z,ab,P,U;if(Y.row){B.setDirty(true);B.setChanged(true);if(Y.row<O.row){aa.row=Y.row;W.row=O.row;P=I}else{aa.row=O.row;W.row=Y.row;P=Q}if(P.getAttribute("rowSpan")||P.getAttribute("colSpan")){return false}if(Y.col<O.col){aa.col=Y.col;W.col=O.col}else{aa.col=O.col;W.col=Y.col}X=(W.row-aa.row)+1;V=(W.col-aa.col)+1;U=B.getTdLocation(P);do{ab=T[S];Z=ab.jSCell;if(Z.formula||Z.value){R.unshift(Z.formula?"("+Z.formula.substring(1)+")":Z.value)}F.parent.one("sheetPreCalculation",function(){if(ab.cellIndex!=U.col||ab.parentNode.rowIndex!=U.row){Z.formula=null;Z.value="";Z.defer=P.jSCell;ab.removeAttribute("data-formula");ab.removeAttribute("data-celltype");ab.innerHTML="";ab.style.display="none";ab.colSpan=V-(ab.cellIndex-P.cellIndex);ab.rowSpan=X-(ab.parentNode.rowIndex-P.parentNode.rowIndex)}});B.calcDependencies.call(Z)}while(S--);P.jSCell.value=R.join(" ");P.jSCell.formula=(P.jSCell.formula?R.join(" "):"");P.style.display="";P.setAttribute("rowSpan",X);P.setAttribute("colSpan",V);B.calcDependencies.call(P.jSCell);B.evt.cellEditDone();B.autoFillerGoToTd(P);B.cellSetActive(P,U)}return true},unmerge:function(O){O=O||B.highlighted();if(!O){return}var S=B.getTdLocation(O),T=new a(),V=w.max(O.getAttribute("rowSpan")*1,1)-1,I=w.max(O.getAttribute("colSpan")*1,1)-1,R=V+S.row,P,U,Q=[];if(V==0&&I==0){return false}do{P=S.col+I;do{U=B.getTd(-1,R,P);U.style.display="";U.removeAttribute("colSpan");U.removeAttribute("rowSpan");delete U.jSCell.defer;B.calcDependencies.call(U.jSCell,T);Q.push(U)}while(P-->S.col)}while(R-->S.row);B.evt.cellEditDone();B.autoFillerGoToTd(O);B.cellSetActive(O,S);B.highlighter.set(Q);return true},fillUpOrDown:function(U,V,X){B.evt.cellEditDone();X=X||B.highlighted(true);if(X.length<1){return false}var R=B.obj.tdActive();if(X.length<1){return false}var S=B.getTdLocation(X[0].td),Y=B.getTdLocation(X[X.length-1].td),I=B.getTdLocation(R),P={row:0,col:0},O=V||R.jSCell.value,W=false,Q=X.length-1,T=function(){};V=V||R.jSCell.value;if(Q>=0){if(V.charAt&&V.charAt(0)=="="){if(Q>=0){do{if(!U){P.row=I.row-Y.row;P.col=I.col-Y.col}else{P.row=I.row-S.row;P.col=I.col-S.col}O=B.reparseFormula(V,P);F.parent.one("sheetPreCalculation",function(){X[Q].formula=O;X[Q].value="";X[Q].td.setAttribute("data-formula",O)});B.calcDependencies.call(X[Q])}while(Q--);return true}}else{if((W=!K(O))||O.length>0){if(W&&O!=""){O*=1;if(U){O-=X.length-1}T=function(){O++}}}do{F.parent.one("sheetPreCalculation",function(){X[Q].formula="";X[Q].value=O+"";X[Q].td.removeAttribute("data-formula")});B.calcDependencies.call(X[Q]);T()}while(Q--);return true}}return false},toTsv:function(X,Q,V){X=X||B.highlighted(true);if(X.type){X=[X]}V=V||function(aa,Z){if(Q){F.parent.one("sheetPreCalculation",function(){Z.formula="";Z.value=""});B.calcDependencies.call(Z)}};var T=[],W,S,O={},P=X.length-1,Y,I;if(P>=0){W=B.getTdLocation(X[0].td);S=B.getTdLocation(X[X.length-1].td);O.row=w.min(W.row,S.row);O.col=w.min(W.col,S.col);do{var R=B.getTdLocation(X[P].td),U=(X[P].formula?"="+X[P].formula:X[P].value);Y=w.abs(R.row-O.row);I=w.abs(R.col-O.col);if(!T[Y]){T[Y]=[]}if((U+="").match(/\n/)){U='"'+U+'"'}T[Y][I]=(U||"");V.call(X[P].td,R,X[P])}while(P-->0);P=T.length-1;do{T[P]=T[P].join("\t")}while(P-->0);return T.join("\n")}return""},offsetFormulas:function(T,S,P,R){var O=B.sheetSize(),Q={first:{row:1,col:1},last:{row:O.rows,col:O.cols}},I=[];B.cycleCells(function(){var U=this;if(this.formula&&typeof this.formula=="string"&&B.isFormulaEditable(this.td)){this.formula=B.reparseFormula(this.formula,S,T,P,R);this.td.setAttribute("data-formula","="+this.formula)}I.push(function(){B.calcDependencies.call(U,true)})},Q.first,Q.last);while(I.length){I.pop()()}B.evt.cellEditDone()},reparseFormula:function(R,Q,P,I,O){return R.replace(h.regEx.cell,function(T,U,Y,Z){if(U=="SHEET"){return T}Q=Q||{loc:0,row:0};var S={row:Y*1,col:h.columnLabelIndex(U)},X,W,V={row:Y,col:U,use:false};if(P){if(O){if(I){if(S.col&&S.col==P.col-1){V.col="#REF!";V.use=true}if(S.row&&S.row==P.row-1){V.row="#REF!";V.use=true}if(S.col>=P.col){X=true}if(S.row>=P.row){W=true}}else{if(P.col&&S.col==P.col){V.col="#REF!";V.use=true}if(P.row&&S.row==P.row){V.row="#REF!";V.use=true}if(P.col&&S.col>P.col){X=true}if(P.row&&S.row>P.row){W=true}}if(V.use){return V.col+V.row}if(X){S.col+=Q.col;return B.makeFormula(S)}if(W){S.row+=Q.row;return B.makeFormula(S)}}else{if(I){if(P.col&&S.col>=P.col){X=true}if(P.row&&S.row>=P.row){W=true}}else{if(P.col&&S.col>P.col){X=true}if(P.row&&S.row>P.row){W=true}}if(X){S.col+=Q.col;return B.makeFormula(S)}if(W){S.row+=Q.row;return B.makeFormula(S)}}}else{return B.makeFormula(S,Q)}return T})},makeFormula:function(O,I){I=d.extend({row:0,col:0},I);O.col+=I.col;O.row+=I.row;if(O.col<0){O.col=0}if(O.row<0){O.row=0}return h.parseCellName(O.col,O.row)},cycleCells:function(R,U,P,O){O=O||B.i;U=U||{row:1,col:1};if(!P){var W=B.sheetSize();P={row:W.rows,col:W.cols}}var I=B.spreadsheets[O],Q=P.row,T,V,S;if(Q<U.row){return}do{T=P.col;V=I[Q];do{S=V[T];R.call(S,O,Q,T)}while(T-->U.col)}while(Q-->U.row)},cycleCellsAll:function(Q){var R=B.i,P,O,I;for(P=0;P<=B.sheetCount;P++){B.i=P;O=B.sheetSize();I={row:O.rows,col:O.cols};B.cycleCells(Q,{row:0,col:0},I,P)}B.i=R},cycleCellArea:function(V,Z,S,R,W){var I={start:{},end:{}},U,Y,aa,X,Q=B.i,O={cell:[],td:[]},T=B.spreadsheets[Q],P=(W?"unshift":"push");if(R){I.start=Z;I.end=S}else{I.start.row=w.max(w.min(Z.row,S.row),1);I.start.col=w.max(w.min(Z.col,S.col),1);I.end.row=w.max(Z.row,S.row,1);I.end.col=w.max(Z.col,S.col,1)}U=I.end.row;do{Y=I.end.col;aa=T[U]||null;do{if(aa){X=aa[Y]||null;if(X){O.cell[P](X);O.td[P](X.td)}}}while(Y-->I.start.col)}while(U-->I.start.row);if(V){V(O)}},formatTable:function(aa){var Y=F.newColumnWidth+"px",T=F.colMargin+"px",O=aa.children,R=O.length-1,Q,P,W,I,U,Z,S,X=(F.loader!==null?F.loader:null),V=(X!==null?X.getWidth:function(ab,ac){return F.newColumnWidth});if(R>-1){do{switch(O[R].nodeName){case"TBODY":Z=true;W=O[R];break;case"COLGROUP":S=true;I=O[R];break}}while(R--)}else{}if(!W){W=m.createElement("tbody");if(O.length>0){do{W.appendChild(O[0])}while(O.length)}}if(!I||I.children.length<1){I=m.createElement("colgroup");aa.appendChild(I);aa.appendChild(W);if(W.children.length>0){U=W.children[0];for(R=0,Q=g.min(U.children.length,F.initCalcCols);R<Q;R++){P=m.createElement("col");P.style.width=V(B.i,R)+"px";I.appendChild(P)}for(R=0,Q=g.min(W.children.length,F.initCalcRows);R<Q;R++){W.children[R].style.height=T}}}aa.tBody=W;aa.colGroup=I;aa.removeAttribute("width");aa.style.width=""},checkMinSize:function(R){var P=B.tableSize(R),S=F.minSize.rows||0,I=F.minSize.cols||0,Q=B.obj.pane().actionUI,O=Q.frozenAt;S=g.max((O.row>S?O.row+1:S),1,F.initScrollRows);I=g.max((O.col>I?O.col+1:I),1,F.initScrollCols);if(P.cols<I){I-=P.cols;B.controlFactory.addColumnMulti(null,I,false,true,true)}P=B.tableSize(R);if(P.rows<S){S-=P.rows;B.controlFactory.addRowMulti(null,S,false,true,true)}},theme:null,highlighter:null,resizable:function(O,I){if(!O.data("resizable")){O.resizable(I)}},busy:[],setBusy:function(I){if(I){B.busy.push(I)}else{B.busy.pop()}},isBusy:function(){return(B.busy.length>0)},draggable:function(O,I){if(!O.data("jSdraggable")){O.data("jSdraggable",true).draggable(I)}},nearest:function(O,I){return d(O).nearest(I)},resizeBar:{top:function(S,P,U,O){B.obj.barTopControls().remove();var Q=m.createElement("div"),T=d(Q).addClass(B.cl.barController+" "+B.theme.barResizer).width(S.width()).prependTo(S),I,R;B.controls.bar.x.controls[B.i]=B.obj.barTopControls().add(T);B.resizableCells(T,{handles:"e",start:function(W,V){B.autoFillerHide();B.setBusy(true);I=B.col(O,P);if(U.freezeHandleTop){U.freezeHandleTop.remove()}I.removeAttribute("width")},resize:function(W,V){I.style.width=V.size.width+"px";if(U.inPlaceEdit){U.inPlaceEdit.goToTd()}},stop:function(W,V){B.setBusy(false);U.resizeScroll();B.followMe();B.setDirty(true)},minWidth:32});R=Q.children[0];R.style.height=S.outerHeight()+"px";R.style.position="absolute"},left:function(Q,T,P,X){B.obj.barLeftControls().remove();var S=Q.offset(),Y=m.createElement("div"),V=d(Y).addClass(B.cl.barController+" "+B.theme.barResizer).prependTo(Q).offset({top:S.top,left:S.left}),W=Q[0],R=Q.next()[0],Z=R.parentNode,O=m.createElement("div"),I=d(O).addClass(B.cl.barControllerChild).height(Q.height()).prependTo(V),U;B.controls.bar.y.controls[B.i]=B.obj.barLeftControls().add(V);B.resizableCells(I,{handles:"s",start:function(){B.autoFillerHide();B.setBusy(true);if(P.freezeHandleLeft){P.freezeHandleLeft.remove()}Z.removeAttribute("height");W.removeAttribute("height");R.removeAttribute("height")},resize:function(ab,aa){Y.style.height=R.style.height=W.style.height=Z.style.height=aa.size.height+"px";if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}},stop:function(ab,aa){B.setBusy(false);P.resizeScroll();B.followMe();B.setDirty(true)},minHeight:15});U=O.children[0];U.style.width=Q.outerWidth()+"px";U.style.position="absolute"},corner:function(){}},sheetDecorateRemove:function(O,I){I=I||B.obj.tables();I=(O?I.clone():I);I.find("td."+B.theme.tdActive).removeClass(B.theme.tdActive);I.find("td."+B.theme.tdHighlighted).removeClass(B.theme.tdHighlighted);return I},labelUpdate:function(O,I){if(!I){O=h.parseCellName(O.col,O.row);if(O){B.obj.label().text(O)}}else{B.obj.label().text(O)}},cellEdit:function(S,Q,P){B.autoFillerNotGroup=true;B.evt.cellEditDone();if(S===null){return}var R=B.getTdLocation(S),I=S.jSCell,O;if(I===E||I===null){return}if(I.uneditable){return}B.trigger("sheetCellEdit",[I]);if(S!==B.cellLast.td){B.followMe(S)}else{B.autoFillerGoToTd(S)}B.labelUpdate(R);if(I.formula.length>0){O="="+I.formula}else{O=I.value}B.obj.formula().val(O).blur();B.cellSetActive(S,R,Q,false,null,P)},cellSetActive:function(R,T,O,V,S,P){T=T||B.getTdLocation(R);if(T.col!=E){B.cellLast.td=R;B.cellLast.row=B.rowLast=T.row;B.cellLast.col=B.colLast=T.col;if(!P){B.highlighter.set(R).setStart(T).setEnd(T)}if(R===null){return}B.highlighter.setBar("left",R.barLeft).setBar("top",R.barTop);var U,W;switch(F.cellSelectModel){case l.excelSelectModel:case l.googleDriveSelectModel:U=function(){};W=function(){};break;case l.openOfficeSelectModel:U=function(X){if(B.isCell(X)){B.cellEdit(X)}};W=function(){};break}if(O){var I={},Q=B.obj.pane();I.last=T;Q.onmousemove=function(af){af=af||f.event;var ag=af.target||af.srcElement;if(B.isBusy()){return false}var X=B.highlighter.end=B.getTdLocation(ag),ah=true,ai=B.highlighter;if(X.col<1||X.row<1||X.col==z||X.row==z){return false}if(V){ah=false;if(T.col==X.col||T.row==X.row){ah=true}}if((I.last.col!=X.col||I.last.row!=X.row)&&ah){U(ag);B.cycleCellArea(function(ak){ai.set(ak.td)},T,X,false,true)}B.followMe(ag);var aa=af.clientY,ab=af.clientX,ac=Q.$enclosure.offset(),aj=B.getTdLocation(ag),ad=aj.row,Z=aj.col,Y=false,ae;if(K(ad)||K(Z)){return false}if(aa>ac.top){Y=true;ad--}if(ab>ac.left){Y=true;Z--}if(Y){if(ad<1||Z<1){return false}ae=B.spreadsheets[B.i][ad][Z];B.followMe(ae.td,true)}I.last=X;return true};m.onmouseup=function(){Q.onmousemove=null;Q.onmousemove=null;Q.onmouseup=null;m.onmouseup=null;if(S){S()}}}}},colLast:0,rowLast:0,cellLast:{td:[],row:0,col:0,isEdit:false},highlightedLastOrdered:function(){var O=this.highlighter,I={start:{},end:{}};I.start.row=g.min(O.start.row,O.end.row);I.start.col=g.min(O.start.col,O.end.col);I.end.row=g.max(O.start.row,O.end.row);I.end.col=g.max(O.start.col,O.end.col);return I},cellStyleToggle:function(T,S,Q){Q=Q||B.highlighted();if(Q.length<1){return false}B.setDirty(true);var U,R,P=Q.length-1,I=B.obj.cellsEdited(),O;if(P>=0){O=Q[0].className.match(T);do{U=Q[P];R=d(U);if(S){R.removeClass(S)}if(O){R.removeClass(T)}else{R.addClass(T)}if(!U.jSCell.edited){U.jSCell.edited=true;I.push(U.jSCell)}}while(P--);return true}return false},cellTypeToggle:function(R,P){P=P||B.highlighted(true);if(P.length<1){return}var Q=P.length-1,O=P[Q].cellType==R,I;if(Q>=0){do{I=P[Q];if(O){I.cellType=null}else{I.cellType=R}I.updateValue()}while(Q--)}},fontReSize:function(S,R){R=R||B.highlighted();if(R.length<1){return false}var O=0;switch(S){case"up":O=1;break;case"down":O=-1;break}var U,T,Q=R.length-1,P,I=B.obj.cellsEdited();if(Q>=0){do{U=R[Q];T=d(U);P=(T.css("font-size")+"").replace("px","")*1;T.css("font-size",((P||10)+O)+"px");if(!U.jSCell.edited){U.jSCell.edited=true;I.push(U.jSCell)}}while(Q--);return true}return false},cellHandler:null,calc:function(I,P){I=I||B.i;if(B.readOnly[I]||B.isChanged(I)===false&&!P||!B.formulaParser){return false}if(F.loader!==null){F.loader.cycleCells(I)}else{var O=B.spreadsheetToArray(null,I);h.calc(I,O);B.trigger("sheetCalculation",[{which:"spreadsheet",sheet:O,index:I}])}B.setChanged(false);return true},calcAll:function(P){var O=0,I;if(F.loader){I=F.loader.count;for(;O<I;O++){B.calc(O,P)}}else{I=B.spreadsheets.length;for(;O<I;O++){B.calc(O,P)}}},calcVisiblePos:{row:-1,col:-1},calcVisibleInit:function(W){W=W||B.i;var O=B.spreadsheetToArray(null,W)||[],P=g.min,Q=F.initCalcRows,I=F.initCalcCols,U=P(O.length-1,Q),X,R,T={row:-1,col:-1},S=[],V=function(){this.cell.rowIndex=this.rowIndex;this.cell.columnIndex=this.columnIndex;this.cell.updateValue()};if(U>0){T.row=U;do{if(U>0&&(X=O[U])!==undefined){T.col=R=P(X.length-1,I);if(R>0){do{S.push({cell:X[R],rowIndex:U,columnIndex:R})}while(R-->1)}}}while(U-->1)}x(S,{each:V,done:function(){B.trigger("sheetCalculation",[{which:"spreadsheet",sheet:O,index:W}])}});this.calcVisiblePos=T;B.setChanged(false)},calcVisibleRow:function(X,U){U=U||B.i;var T=B.spreadsheetToArray(null,U)||[],Y=X.scrolledArea,ac=X.pane.size(),Z=F.initCalcRows,ab=F.initCalcCols,R=(Y.row+Z)-1,P=(Y.col+ab)-1,aa,V,ad,ae=this.calcVisiblePos,O={row:aa,col:ae.col},I,W=[],Q=function(){if(this.row===E){while(this.offset>0&&T[this.offset]===undefined){B.createSpreadsheetForArea(X.table,U,this.offset,this.offset,this.colIndex,this.colIndex,true);this.offset--}}else{if((this.cell=this.row[this.colIndex])===undefined){B.createCell(B.i,this.rowIndex,this.colIndex);this.cell=T[this.rowIndex][this.colIndex]}}if(this.cell!==E){this.cell.updateValue()}};R=R<ac.rows?R:ac.rows;P=P<ac.cols?P:ac.cols;aa=R;if(aa>0){do{ad=P;if(ad>0){do{var S=aa;W.push({row:V,cell:V!==E?V[ad]:E,rowIndex:aa,colIndex:ad,offset:S,})}while(ad-->1)}}while(aa-->ae.row)}this.calcVisiblePos=O;x(W,{each:Q});B.trigger("sheetCalculation",[{which:"spreadsheet",sheet:T,index:U}]);B.setChanged(false)},calcVisibleCol:function(I,ac){ac=ac||B.i;var S=B.spreadsheetToArray(null,ac)||[],P=I.scrolledArea,O=I.pane.size(),V=F.initCalcRows,Q=F.initCalcCols,R=(P.row+V)-1,U=(P.col+Q)-1,Y,ad,ab,aa,T=this.calcVisiblePos,W={row:T.row,col:T.col},X=[],Z=function(){if(this.row===undefined||this.cell===undefined){B.createSpreadsheetForArea(I.table,ac,this.rowIndex,this.rowIndex,this.colIndex,this.colIndex,true);this.row=S[this.rowIndex]}aa=this.row[this.colIndex];aa.updateValue()};R=R<O.rows?R:O.rows;U=U<O.cols?U:O.cols;Y=R;if(Y>0&&U>0){do{ab=U;ad=S[Y];X.push({row:ad,cell:ad!==E?ad[ab]:E,rowIndex:Y,colIndex:ab})}while(Y-->1)}this.calcVisiblePos=W;x(X,{each:Z});B.trigger("sheetCalculation",[{which:"spreadsheet",sheet:S,index:ac}]);B.setChanged(false)},calcDependencies:function(O){if(!O){var I=this;B.undo.createCells([this],function(P){B.trigger("sheetPreCalculation",[{which:"cell",cell:I}]);B.setDirty(true);B.setChanged(true);I.updateValue();B.trigger("sheetCalculation",[{which:"cell",cell:I}]);return P})}else{B.trigger("sheetPreCalculation",[{which:"cell",cell:this}]);B.setDirty(true);B.setChanged(true);this.updateValue();B.trigger("sheetCalculation",[{which:"cell",cell:this}])}},addSheet:function(I){I=I||{rows:25,cols:10};B.evt.cellEditAbandon();B.setDirty(true);B.controlFactory.sheetUI(B.obj.ui,d.sheet.makeTable(I),B.sheetCount);B.setActiveSheet(B.sheetCount);B.sheetCount++;B.sheetSyncSize();B.obj.pane().resizeScroll();B.trigger("sheetAdd",[B.i])},insertSheet:null,deleteSheet:function(O){var R=O||B.i,Q=B.controls.enclosures.toArray(),I;Q.splice(R,1);B.obj.barHelper().remove();B.obj.enclosure().remove();B.controls.enclosures=d(Q);B.obj.menus().remove();B.obj.tabContainer().children().eq(B.i).remove();B.spreadsheets.splice(R,1);B.controls.autoFiller.splice(R,1);B.controls.bar.helper.splice(R,1);B.controls.bar.corner.splice(R,1);B.controls.bar.x.controls.splice(R,1);B.controls.bar.x.handleFreeze.splice(R,1);B.controls.bar.x.controls.splice(R,1);B.controls.bar.x.menu.splice(R,1);if(B.controls.bar.x.menuParent&&B.controls.bar.x.menuParent[R]){B.controls.bar.x.menuParent.splice(R,1)}B.controls.bar.x.parent.splice(R,1);B.controls.bar.x.th.splice(R,1);B.controls.bar.y.controls.splice(R,1);B.controls.bar.y.handleFreeze.splice(R,1);B.controls.bar.y.controls.splice(R,1);B.controls.bar.y.menu.splice(R,1);if(B.controls.bar.y.menuParent&&B.controls.bar.y.menuParent[R]){B.controls.bar.y.menuParent.splice(R,1)}B.controls.bar.y.parent.splice(R,1);B.controls.bar.y.th.splice(R,1);B.controls.barMenuLeft.splice(R,1);B.controls.barMenuTop.splice(R,1);B.controls.barLeft.splice(R,1);B.controls.barTop.splice(R,1);B.controls.barTopParent.splice(R,1);B.controls.chart.splice(R,1);B.controls.tdMenu.splice(R,1);B.controls.enclosure.splice(R,1);B.controls.fullScreen=null;B.controls.inPlaceEdit.splice(R,1);B.controls.menus.splice(R,1);B.controls.menuLeft.splice(R,1);B.controls.menuRight.splice(R,1);B.controls.pane.splice(R,1);B.controls.tables.splice(R,1);B.controls.table.splice(R,1);for(I=R+1;I<B.controls.tab.length;++I){var P=B.controls.tab[I].get(0);P.i--}B.controls.tab.splice(R,1);B.controls.toggleHide.x.splice(R,1);B.controls.toggleHide.y.splice(R,1);B.readOnly.splice(R,1);B.i=0;B.sheetCount--;B.sheetCount=w.max(B.sheetCount,0);if(B.sheetCount==0){B.addSheet()}B.setActiveSheet(B.i);B.setDirty(true);B.setChanged(true);B.trigger("sheetDelete",[R])},deleteRow:function(S,R){var Q,I,P,U,W=B.sheetSize(),V,O=B.obj.pane(),T=O.table.tBody;if(S){I=P=S}else{I=w.min(B.highlighter.start.row,B.highlighter.end.row);P=w.max(B.highlighter.start.row,B.highlighter.end.row)}U=(P-I)+1;if(I<1||W.cols<2||U>=W.rows){return}Q=P;do{V=B.getTd(-1,Q,1).parentNode;T.removeChild(V)}while(I<Q--);B.controls.bar.y.th[B.i].splice(I,U);B.spreadsheets[B.i].splice(I,U);B.refreshRowLabels(I);B.setChanged(true);B.offsetFormulas({row:I,col:0},{row:-U,col:0},false,true);B.setDirty(true);B.evt.cellEditAbandon();B.obj.pane().resizeScroll();B.trigger("sheetDeleteRow",Q)},deleteColumn:function(R){var Q,I,P,S,V=B.sheetSize(),U;if(R){I=P=R}else{I=w.min(B.highlighter.start.col,B.highlighter.end.col);P=w.max(B.highlighter.start.col,B.highlighter.end.col)}S=(P-I)+1;if(I<1||V.cols<2||S>=V.cols){return}Q=P;B.obj.barHelper().remove();do{var T=B.obj.table(),O=B.col(T[0],Q);d(B.obj.barTop(Q)).remove();d(O).remove()}while(I<Q--);B.controls.bar.x.th[B.i].splice(I,S);k=B.spreadsheets[B.i].length-S;do{U=B.spreadsheets[B.i][k].splice(I,S);while(U.length>0){d(U.pop().td).remove()}}while(k-->1);B.refreshColumnLabels(I);B.setChanged(true);B.offsetFormulas({row:0,col:I},{row:0,col:-S},false,true);B.setDirty(true);B.evt.cellEditAbandon();B.obj.pane().resizeScroll();B.trigger("sheetDeleteColumn",Q)},sheetTab:function(O,Q){var I="",P;if(O){P=B.obj.table();I=P.attr("title")||B.msg.sheetTitleDefault.replace(/[{]index[}]/gi,B.i+1);if(Q){P.attr("title",I);Q(I)}return I}else{if(B.isSheetEditable()&&F.editableNames){F.prompt(B.msg.newSheetTitle,function(R){if(!R){I=B.obj.table().attr("title");R=(I?I:B.msg.sheetTitleDefault.replace(/[{]index[}]/gi,B.i+1))}else{B.setDirty(true);B.obj.table().attr("title",R);B.obj.tab().html(R);I=R}if(Q){Q(d(m.createElement("div")).text(I).html())}},B.sheetTab(true));return null}}},followMe:function(Q,I){Q=Q||B.obj.tdActive();if(Q===null){return}var P=B.obj.pane(),O=P.actionUI;B.setBusy(true);O.putTdInView(Q);B.setBusy(false);if(!I){B.autoFillerGoToTd(Q)}},autoFillerGoToTd:function(Q,O,I){if(!F.autoFiller){return}if(Q===E){Q=B.obj.tdActive()}if(Q&&Q.type=="cell"){O=O||Q.clientHeight;I=I||Q.clientWidth;if(!Q.offsetHeight||!Q.offsetWidth||!Q.clientHeight||!Q.clientWidth){B.autoFillerHide();return}var P=d(Q).position();B.obj.autoFiller().show().css("top",((P.top+(O||Q.clientHeight)-3)+"px")).css("left",((P.left+(I||Q.clientWidth)-3)+"px"))}},autoFillerHide:function(){if(!F.autoFiller){return}B.obj.autoFiller().hide()},setActiveSheet:function(Q,I){if(I!==E){Q=I.i}else{Q=Q||0}if(B.cellLast.row>0||B.cellLast.col>0){B.evt.cellEditDone();B.obj.formula().val("")}var P=B.obj.enclosures(),O=P.length-1,R;B.autoFillerHide();if(O>0){do{if(Q!=O){R=P[O];R._scrollLeft=R._scrollLeft||R.scrollUI.scrollLeft;R._scrollTop=R._scrollTop||R.scrollUI.scrollTop;R.style.display="none"}}while(O-->0)}B.i=Q;if(I!==undefined){R=I.enclosure}else{R=B.controls.enclosure[Q][0]}R.style.display="";B.highlighter.setTab(B.obj.tab());B.readOnly[Q]=(R.table.className||"").match(/\breadonly\b/i)!=null;R.pane.resizeScroll(true);R.scrollUI.scrollLeft=R._scrollLeft||R.scrollUI.scrollLeft;R.scrollUI.scrollTop=R._scrollTop||R.scrollUI.scrollTop;R._scrollLeft=R._scrollTop=null;R.scrollUI.onscroll()},getSpreadsheetIndexByTitle:function(S){if(F.loader!==null){var R=F.loader.getSpreadsheetIndexByTitle(S);return R}var P=B.obj.tables(),I=P.length,Q,O=0;for(;O<I;O++){Q=P[O];if(Q.getAttribute("title")==S){return Q.spreadsheetIndex}}return null},openSheet:function(O){var P=O.length-1,I=function(){B.setBusy(true);var W=B.controlFactory.header(),V=B.controlFactory.ui(),Q=B.controlFactory.sheetAdder(),S=B.controlFactory.tabContainer(),U,T={sizeCheck:function(X){if(d.sheet.max){var Y=B.tableSize(X.table);if(Y.rows>d.sheet.max||Y.cols>d.sheet.max){B.trigger("sheetMaxSize",[X.table,X.i]);F.confirm(B.msg.maxSizeBrowserLimitationOnOpen,function(){X.load()})}else{X.load()}}else{X.load()}},initChildren:function(Z,Y,X){B.controlFactory.sheetUI(Z,Y,X);B.trigger("sheetOpened",[X])},done:function(X){B.sheetSyncSize();B.setActiveSheet(0);B.setDirty(false);B.setBusy(false);while(X.length>0){B.calcVisibleInit(B.i=X.pop())}B.trigger("sheetAllOpened")},lastIndex:P},R;W.ui=V;W.tabContainer=S;V.header=W;V.sheetAdder=Q;V.tabContainer=S;S.header=W;S.ui=V;F.parent.append(W).append(V).append(Q).append(S);B.resizableSheet(F.parent,{minWidth:F.parent.width()*0.1,minHeight:F.parent.height()*0.1,start:function(){B.setBusy(true);B.obj.enclosure().hide();V.sheetAdder.hide();V.tabContainer.hide()},stop:function(){B.obj.enclosure().show();V.sheetAdder.show();V.tabContainer.show();B.setBusy(false);B.sheetSyncSize();B.obj.pane().resizeScroll()}});if(F.loader===null){for(U=0;U<O.length;U++){new l.SpreadsheetUI(U,V,O[U],T);B.sheetCount++}}else{B.insertSheet=function(aa,X,Z,Y){B.sheetCount++;aa=aa||null;Y=Y||m.createElement("table");Z=Z!==undefined?Z:true;X=X||B.sheetCount-1;if(aa!==null){loader.addSpreadsheet(aa)}if(!Y.hasAttribute("title")){Y.setAttribute("title",loader.title(X))}var ab=function(){B.obj.enclosure().hide();B.setBusy(true);var ac=new l.SpreadsheetUI(X,V,Y,T);B.setActiveSheet(-1,ac);B.calcVisibleInit(X);B.setBusy(false);B.sheetSyncSize()};if(Z){ab();return}B.controlFactory.customTab(F.loader.title(X)).mousedown(function(){ab();B.obj.tab().insertBefore(this);d(this).remove();return false})};R=new l.SpreadsheetUI(0,V,O[0],T);B.sheetCount++;if(O.length>1){for(U=1;U<O.length;U++){B.insertSheet(null,U,false,O[U])}B.i=0;R.loaded()}}};if(B.isDirty){F.confirm(B.msg.openSheet,I)}else{I()}},newSheet:function(){F.parent.html(d.sheet.makeTable()).sheet(F)},sheetSyncSize:function(){var X=F.parent,T=X[0],Z=T.clientHeight,U=T.clientWidth,Y=B.obj.tabContainer(),aa=Y[0],I=aa.style,ad=f.scrollBarSize.width,O,ac,W,V,R=B.obj.ui.style,S,ae,Q,ab,P;if(!Z){Z=400;X.height(Z)}else{if(Z<200){Z=200;X.height(Z)}}P=aa.scrollLeft;I.width="";O=aa.clientWidth;ac=(U-(F.colMargin+ad));W=(U-F.colMargin*2)+"px";V=((F.colMargin+ad)+"px");if(O>ac){I.height=V;Y.addClass(B.cl.tabContainerScrollable);Z-=ad}else{I.height=null;Y.removeClass(B.cl.tabContainerScrollable)}I.width=W;aa.scrollLeft=P;Z-=B.obj.header().outerHeight()+F.boxModelCorrection;Z-=aa.clientHeight+F.boxModelCorrection;S=(Z-f.scrollBarSize.height-F.boxModelCorrection)+"px";ae=(U-f.scrollBarSize.width)+"px";Q=(Z+"px");ab=(U+"px");B.obj.panes().each(function(){var ah=this.style,ag=this.actionUI.scrollUI.style,af=this.enclosure.style;ah.height=S;ah.width=ae;af.height=ag.height=Q;af.width=ag.width=ab});R.height=Q;R.width=ab},cellChangeStyle:function(P,Q,I){I=I||B.highlighted(true);if(I.length<1){return false}B.setDirty(this);var O=I.length-1;if(O>=0){B.undo.createCells(I,function(R){do{R[O].td.css(P,Q)}while(O--);return R});return true}return false},cellFind:function(I){function O(Q){var P=B.obj.table().children("tbody").children("tr");if(Q){var R=P.children('td:contains("'+Q+'")');if(R.length<1){R=P.children('td:contains("'+Q.toLowerCase()+'")')}if(R.length<1){R=P.children('td:contains("'+Q.toUpperCase()+'")')}R=R.eq(0);if(R.length>0){B.cellEdit(R)}else{F.alert(B.msg.cellNoFind)}}}if(!I){F.prompt(B.msg.cellFind,O)}else{O(I)}},cellSetActiveBar:function(V,P,Q){var aa=B.sheetSize(),S=w.min(P,Q),X=w.max(P,Q),I={},W={},Z=function(ab){switch(F.cellSelectModel){case l.openOfficeSelectModel:this.row=(ab?I.row:W.row);this.col=(ab?I.col:W.col);this.td=B.getTd(-1,this.row,this.col);if(this.td!==B.cellLast.td){B.cellEdit(this.td,false,true)}break;default:this.row=(ab?W.row:I.row);this.col=(ab?W.col:I.col);this.td=B.getTd(-1,this.row,this.col);if(this.td!==B.cellLast.td){B.cellEdit(this.td,false,true)}break}},R=[],T=B.obj.pane().actionUI.scrolledArea,U=B.obj.table(),O,Y;switch(V){case"top":I.row=T.row;I.col=S;W.row=T.row;W.col=X;B.highlighter.start.row=1;B.highlighter.start.col=S;B.highlighter.end.row=aa.rows;B.highlighter.end.col=X;O=X;do{R.push(B.col(U[0],O))}while(O-->S);break;case"left":I.row=S;I.col=T.col;W.row=X;W.col=T.col;B.highlighter.start.row=S;B.highlighter.start.col=1;B.highlighter.end.row=X;B.highlighter.end.col=aa.cols;Y=X;do{R.push(B.getTd(-1,Y,1).parentNode)}while(Y-->S);break;case"corner":I.row=1;I.col=1;W.col=aa.cols;W.row=aa.rows;R.push(U[0]);break}new Z(P>Q);B.highlighter.set(R)},getTdRange:function(Q,V,T,U){B.cellLast.isEdit=true;var O=function(X){if(X.first.col>X.last.col||X.first.row>X.last.row){return{first:h.parseCellName(X.last.col,X.last.row),last:h.parseCellName(X.first.col,X.first.row)}}else{return{first:h.parseCellName(X.first.col,X.first.row),last:h.parseCellName(X.last.col,X.last.row)}}},S=function(aa){var X=O(aa),Z=V+"";Z=(Z.match(/=/)?Z:"="+Z);if(T||Z.charAt(Z.length-1)!="("){Z=Z+(T?T:"")+"("}var ab,Y="";if(X.first!=X.last){ab=X.first+":"+X.last}else{ab=X.first}if(Z.charAt(Z.length-1)=="("){Y=")"}return Z+ab+Y},I="",P,R,W;if(Q){P={first:B.getTdLocation([Q.target])};R=B.obj.table().mousemove(function(X){P.last=B.getTdLocation([X.target]);I=S(P);if(!U){B.obj.formula().val(I);B.obj.inPlaceEdit().val(I)}});N.one("mouseup",function(){R.unbind("mousemove");return I})}else{W=B.highlighted().not(B.obj.tdActive());if(W.length){P={first:B.getTdLocation(W.first()),last:B.getTdLocation(W.last())};I=S(P);if(!U){B.obj.formula().val(I);B.obj.inPlaceEdit().val(I)}return I}else{return""}}return""},getTd:function(R,T,O){var P=(R>-1?B.obj.tables()[R]:B.obj.table()[0]),I,Q,S;if(!P||!(I=P.tBody)||!(Q=I.children[T])||!(S=Q.children[O])){S=m.createElement("td")}return S},getTdLocation:function(O){var I={col:0,row:0};if(O===E||O===null){return I}if(O.parentNode==E||O.parentNode.rowIndex<0){return I}return{col:parseInt(O.cellIndex),row:parseInt(O.parentNode.rowIndex)}},getBarIndex:{left:function(I){I=I||{};if(!I.parentNode||K(I.parentNode.rowIndex)){return -1}else{return I.parentNode.rowIndex}},top:function(I){I=I||{};if(K(I.cellIndex)){return -1}else{return I.cellIndex}},corner:function(){return 0}},time:{now:new a(),last:new a(),diff:function(){return w.abs(w.ceil(this.last.getTime()-this.now.getTime())/1000).toFixed(5)},set:function(){this.last=this.now;this.now=new a()},get:function(){return this.now.getHours()+":"+this.now.getMinutes()+":"+this.now.getSeconds()}},changed:[],isChanged:function(I){return B.changed[I||B.i]},setChanged:function(I){B.changed[B.i]=I},isDirty:false,setDirty:function(I){B.dirty=I},appendToFormula:function(I){var P=B.obj.formula(),O=P.val();if(O.charAt(0)!="="){O="="+O}P.val(O+I)},undo:{manager:(f.UndoManager?new UndoManager():{undo:A,redo:A,register:A}),cells:[],id:-1,createCells:function(I,O,R){if(R===E){B.undo.id++;R=B.undo.id}var P=(new l.CellRange(I)).clone().cells,Q=(O!==E?(new l.CellRange(O(I)).clone()).cells:P);P.id=R;Q.id=R;B.undo.manager.add({undo:function(){B.undo.removeCells(P,R)},redo:function(){B.undo.createCells(Q,null,R)}});if(R!==B.undo.id){B.undo.draw(Q)}return true},removeCells:function(O,Q){var P=0,I=-1;if(O.id===Q){I=P}if(I!==-1){B.undo.cells.splice(I,1)}B.undo.draw(O)},draw:function(P){var O,S,R,I,Q;for(O=0;O<P.length;O++){R=P[O];Q=B.getTdLocation(R.td);I=B.spreadsheets[R.sheetIndex][Q.row][Q.col];I.value=R.value;I.formula=R.formula;S=I.td=R.td;I.dependencies=R.dependencies;I.needsUpdated=R.needsUpdated;I.calcCount=R.calcCount;I.sheetIndex=R.sheetIndex;I.rowIndex=Q.row;I.columnIndex=Q.col;I.state=R.state;I.jS=R.jS;S.setAttribute("style",R.style);S.setAttribute("class",R.cl);I.setNeedsUpdated();I.updateValue()}}},cols:function(I){I=I||B.obj.table()[0];if(!I){return[]}if(!I.colGroup){return[]}if(!I.colGroup.children){return[]}return I.colGroup.children},tables:function(W,R){W=W||B.obj.tables();var V=[],P=W.length-1,O,Y,U,I,Z,Q,X,S,T;do{Y=(R?m.body.removeChild(W[P]):W[P].cloneNode(true));if((I=Y.children[0])&&(Z=I.children[0])){I.removeChild(Z)}if(U=Y.children[1]){S=U.children;X=S[0];U.removeChild(X);O=S.length-1;do{T=S[O];Q=T.children[0];T.removeChild(Q)}while(O-->0)}V[P]=Y}while(P-->0);return B.sheetDecorateRemove(false,d(V))},col:function(O,I){O=O||B.obj.table()[0];var P=B.cols(O);if(I===E){I=P.length-1}return P[I]},rowTds:function(O,I){O=O||B.obj.table();var P=B.rows(O);if(!P.length){return[]}if(I==E){I=P.length-1}if(!P[I]){return[]}if(!P[I].children){return[]}return P[I].children},rows:function(I){I=I||B.obj.table()[0];if(!I){return[]}if(!I.tBody){return[]}if(!I.tBody.children){return[]}return I.tBody.children},highlighted:function(O){var Q=B.highlighter.last||d([]),R=[],I,P;if(!(I=Q)||!Q.length||!(I=I[0])||!I.tagName){return O?R:d(R)}switch(I.tagName){case"TD":P=Q.length-1;do{R.unshift(O?Q[P].jSCell:Q[P])}while(P-->0);break;case"TR":P=Q.length-1;do{if(Q[P].tds){R=R.concat(O?Q[P].jSCells:Q[P].tds)}}while(P-->0);break;case"COL":Q=Q.filter("col");P=Q.length-1;do{if(Q[P].tds){R=R.concat(O?Q[P].jSCells:Q[P].tds)}}while(P-->0);break;case"TABLE":R=(O?I.jSCells:I.tds);break}return O?R:d(R)},sheetSize:function(P){var O,S,I={},Q=F.minSize||{rows:1,cols:1},R;P=P||B.obj.table()[0];if((I.cols=F.initScrollCols)>0&&(I.rows=F.initScrollRows)>0){}else{O=B.rowTds(P);S=B.getTdLocation(O[O.length-1]);I.cols=S.col;I.rows=S.row}if(F.loader!==null){R=F.loader.size(P.spreadsheetIndex);I.rows=g.max(R.rows,I.rows,Q.rows);I.cols=g.max(R.cols,I.cols,Q.cols)}return I},test:function(){var I=B.highlighted(true);console.log(B.obj.enclosure())},sortVerticalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){B.sortVertical();return true}else{B.sortVerticalSingle(false);return true}},sortVerticalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){B.sortVertical();return false}else{B.sortVerticalSingle(true);return false}},sortVertical:function(W){var U=B.highlighted(true),R=U[0].td.parent().prev(),I=U.length,P=new a(),T=true,X=[],Z=[],S,V=0,Y,O,Q;while(V<I){Y=U[V];Q=Y.td;if(!isNaN(Y.value)){O=(new t(Y.value.valueOf()))}else{T=false;O=(new q(Y.value.valueOf()))}O.loc=B.getTdLocation(Q);O.row=Q.parentNode;O.col=Q;O.cell=Y;X.push(O);V++}if(W){if(T==false){X.sort(function(ab,aa){return aa-ab})}else{X.sort();X.reverse()}}else{if(T==true){X.sort(function(ab,aa){return ab-aa})}else{X.sort()}}B.undo.createCells(U);while(S=X.length){O=X.pop();Z=B.spreadsheets[B.i].splice(O.row.rowIndex,1);Y=O.cell;Y.value=O.valueOf();O.row.parentNode.removeChild(O.row);R.after(O.row);O.row.children[0].innerHTML=R[0].rowIndex+S;B.spreadsheets[B.i].splice(R[0].rowIndex+1,0,Z[0]);B.calcDependencies.call(Y,true)}B.undo.createCells(U)},sortVerticalSingle:function(S){var Q=B.highlighted(true),R=Q.length,P=0,O=[],I;while(P<R){O.push(Q[P].value);P++}if(S){O.sort(function(U,T){return T-U})}else{O.sort(function(U,T){return U-T})}while(Q.length){I=Q.pop();I.value=O[Q.length];I.updateValue()}},sortHorizontalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){B.sortHorizontal();return true}else{B.sortHorizontalSingle(false);return true}},sortHorizontalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){B.sortHorizontal();return false}else{B.sortHorizontalSingle(true);return false}},sortHorizontal:function(W){var U=B.highlighted(true),ac=U[0].td[0],Y=ac.cellIndex,I=ac.table.colGroup,ad=B.sheetSize().rows,O=U.length,Q=new a(),T=true,Z=[],S,V=0,aa,ab,P,X,R;while(V<O){aa=0;ab=U[V];R=ab.td;if(!isNaN(ab.value)){P=new t(ab.value.valueOf())}else{T=false;P=new q(ab.value.valueOf())}P.tds=[];P.loc=B.getTdLocation(R);P.tr=R.parentNode;P.td=R;P.cell=ab;while(aa<=ad){P.tds.push(B.obj.pane().table.children[1].children[aa].children[R.cellIndex]);aa++}Z.push(P);V++}if(W){if(T==false){Z.sort(function(af,ae){return ae-af})}else{Z.sort();Z.reverse()}}else{if(T==true){Z.sort(function(af,ae){return af-ae})}else{Z.sort()}}B.undo.createCells(U);while(Z.length){P=Z.pop();while(P.tds.length>1){R=P.tds.pop();X=R.parentNode;ab=B.spreadsheets[B.i][X.rowIndex].splice(R.cellIndex,1);X.insertBefore(R,X.children[Y]);R.col=I.children[Z.length+R.cellIndex-1];R.barTop=R.col.bar;ab.value=R.jSCell.value;B.spreadsheets[B.i][X.rowIndex].splice(R.cellIndex,0,ab[0]);B.calcDependencies.call(ab,true)}}B.undo.createCells(U)},sortHorizontalSingle:function(S){var Q=B.highlighted(true),R=Q.length,P=0,O=[],I;while(P<R){O.push(Q[P].value);P++}if(S){O.sort(function(U,T){return T-U})}else{O.sort(function(U,T){return U-T})}while(Q.length){I=Q.pop();I.value=O[Q.length];I.updateValue()}},tableSize:function(P){P=P||B.obj.table()[0];var I=P.tBody||{},R=I.children||[],Q=R[R.length-1]||{},O=Q.children||[],S=O[O.length-1]||{};return{cols:S.cellIndex||0,rows:Q.rowIndex||0}},toggleState:function(I){if(F.allowToggleState){var O=I||B.tables();if(F.editable){B.evt.cellEditAbandon();B.trigger("sheetSave",[O])}B.setDirty(false);B.setChanged(true);F.editable=!F.editable;B.kill();F.parent.html(O).sheet(F);F=null}},setCellRef:function(P){function O(R){if(R){B.s.formulaVariables[R]=I.updateValue()}}var Q=B.obj.tdActive(),I=Q.jSCell;if(P){O(P)}else{F.prompt(B.msg.setCellRef,O)}},formulaParser:null,print:function(I,O){I=I||B.i;var Q=f.open(),P;if(Q!==E){P=Q.document;P.write('<html>	<head id="head"></head>	<body>		<div id="entry" class="'+B.cl.parent+'" style="overflow: show;">		</div>	</body></html>');if(O!==true){d(P.getElementById("head")).append(d("style,link").clone())}d(P.getElementById("entry")).append(B.obj.pane().cloneNode(true));P.close();Q.focus();Q.print()}}},v=[],y;B.setBusy(true);F.parent[0].jS=B;if(!f.console){f.console={log:function(){}}}if(f.scrollBarSize===E){f.scrollBarSize=n()}if(f.defaultCharSize===E){f.defaultCharSize=j()}B.cellHandler=new l.CellHandler(B,h,d.sheet.fn);B.theme=new l.Theme(F.theme);B.highlighter=new l.Highlighter(B.theme.tdHighlighted,B.theme.barHighlight,B.theme.tabActive,function(){B.obj.pane().actionUI.redraw()});F.origHtml=F.parent.children().detach();F.parent.addClass(B.cl.parent);F.parent.bind("sheetSwitch",function(P,O,I){B.switchSheet(I)}).bind("sheetRename",function(P,O,I){B.renameSheet(I)});F.width=(F.width?F.width:F.parent.width());F.height=(F.height?F.height:F.parent.height());if(!d.nearest){B.nearest=A}B.resizableCells=B.resizableSheet=B.resizable;if(!d.ui){B.resizable=B.resizableCells=B.resizableSheet=B.draggable=A}else{if(!F.resizableCells){B.resizableCells=A}if(!F.resizableSheet){B.resizableSheet=A}}if(!d.support.boxModel){F.boxModelCorrection=0}if(!F.barMenus){B.controlFactory.barMenuTop=B.controlFactory.barMenuLeft=A}if(!F.freezableCells){B.controlFactory.barHandleFreeze.top=B.controlFactory.barHandleFreeze.left=A}if(F.calcOff){B.calc=A}if(!f.Raphael){h.chart=A}G.resize(function(){if(B&&!B.isBusy()){F.width=F.parent.width();F.height=F.parent.height();B.sheetSyncSize()}});if(d.sheet.fn){d.sheet.fn=d.extend(d.sheet.fn,F.formulaFunctions);if(d.sheet.advancedfn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.advancedfn)}if(d.sheet.financefn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.financefn)}}F.title=F.title||F.parent.attr("title")||"";B.s=F;F.parent.addClass(B.theme.parent);if(F.origHtml.length){B.openSheet(F.origHtml)}else{if(F.loader!==null){while(v.length<F.loader.count){y=m.createElement("table");y.setAttribute("title",F.loader.title(v.length));v.push(y)}B.openSheet(v)}else{B.openSheet([m.createElement("table")])}}B.setBusy(false);return B},makeTable:function(H,x,v){var F=m;H=H||{rows:25,cols:10};x=x||120;v=v||15;var G=m.createElement("table"),w=m.createElement("colgroup"),E=m.createElement("tbody"),B="width:"+x+"px;",z="height:"+v+"px;",D,y,C,A;C=H.cols;do{y=m.createElement("col");y.setAttribute("style",B);w.appendChild(y)}while(C-->1);C=H.rows;do{D=m.createElement("tr");D.setAttribute("style",z);A=H.cols;do{D.appendChild(m.createElement("td"))}while(A-->1);E.appendChild(D)}while(C-->1);G.appendChild(w);G.appendChild(E);return G},killAll:function(){if(d.sheet){var v=d.sheet.instance;if(v){for(var w=0;w<v.length;w++){if(v[w]&&v[w].kill){v[w].kill()}}d.sheet.instance=[]}}},scrollLocker:function(w){var v=d.sheet.instance;v[w].obj.panes().each(function(x){var y;d(y=this.scrollUI).scroll(function(A){var z=v.length-1,B;if(z>-1){do{B=v[z].controls.enclosure[x][0].scrollUI;if(this!==B){B.scrollLeft=y.scrollLeft;B.scrollTop=y.scrollTop}}while(z--)}})})},switchSheetLocker:function(v){d.each(d.sheet.instance,function(){this.s.parent.bind("sheetSwitch",function(y,x,w){d.each(d.sheet.instance,function(){this.setActiveSheet(w)})})})},I:function(){var v=0;if(this.instance){v=(this.instance.length===0?0:this.instance.length-1)}else{this.instance=[]}return v}};var h=d.sheet.engine={calc:function(y,w,z){w=w||[];var B=w.length-1,A,x,v;if(B>0){do{if(B>0&&w[B]){A=w[B];x=A.length-1;if(x>0){do{v=A[x];v.updateValue()}while(x-->1)}}}while(B-->1)}},parseLocation:function(v,w){return{row:parseInt(w),col:h.columnLabelIndex(v)}},parseSheetLocation:function(w){var v=((w+"").replace("SHEET","")*1)-1;return isNaN(v)?-1:v},parseCellName:function(v,w){return h.columnLabelString(v)+(w||"")},alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),columnLabels:{},columnLabelIndex:function(v){return this.columnLabels[v.toUpperCase()]},columnIndexes:[],columnLabelString:function(y){if(!this.columnIndexes.length){var A="",z,x,w,v;z=x=w=-1;for(v=1;v<16385;++v){A="";++w;if(w==26){w=0;++x;if(x==26){x=0;++z}}if(z>=0){A+=this.alphabet[z]}if(x>=0){A+=this.alphabet[x]}if(w>=0){A+=this.alphabet[w]}this.columnIndexes[v]=A;this.columnLabels[A]=v}}return this.columnIndexes[y]||""},regEx:{n:/[\$,\s]/g,cell:/\$?([a-zA-Z]+|[#]REF[!])\$?([0-9]+|[#]REF[!])/gi,range:/\$?([a-zA-Z]+)\$?([0-9]+):\$?([a-zA-Z]+)\$?([0-9]+)/gi,remoteCell:/\$?(SHEET+)\$?([0-9]+)[:!]\$?([a-zA-Z]+)\$?([0-9]+)/gi,remoteCellRange:/\$?(SHEET+)\$?([0-9]+)[:!]\$?([a-zA-Z]+)\$?([0-9]+):\$?([a-zA-Z]+)\$?([0-9]+)/gi,sheet:/SHEET/i,amp:/&/g,gt:/</g,lt:/>/g,nbsp:/&nbsp;/g},chart:function(x){var A=this.jS,D=m.createElement("div"),z=this.td,C,B=m.body;B.appendChild(D);function y(F,G){if(!F){if(G){F=0}else{F=""}}else{if(G){F=c.toNumbers(F)}else{F=c.flatten(F)}}return F}x=d.extend({x:{legend:"",data:[0]},y:{legend:"",data:[0]},title:"",data:[0],legend:""},x);D.className=A.cl.chart;D.onmousedown=function(){d(z).mousedown()};D.onmousemove=function(){d(z).mousemove();return false};A.controls.chart[A.i]=A.obj.chart().add(D);x.data=y(x.data,true);x.x.data=y(x.x.data,true);x.y.data=y(x.y.data,true);x.legend=y(x.legend);x.x.legend=y(x.x.legend);x.y.legend=y(x.y.legend);x.legend=(x.legend?x.legend:x.data);var w,E,v=Raphael(D);if(z.clientHeight>0){w=g.max(z.clientWidth,100);E=g.max(z.clientHeight,50)}if(x.title){v.text(w/2,10,x.title).attr({"font-size":20})}switch(x.type){case"bar":C=v.barchart(w/8,E/8,w*0.8,E*0.8,x.data,x.legend).hover(function(){this.flag=v.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"hbar":C=v.hbarchart(w/8,E/8,w*0.8,E*0.8,x.data,x.legend).hover(function(){this.flag=v.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"line":C=v.linechart(w/8,E/8,w*0.8,E*0.8,x.x.data,x.y.data,{nostroke:false,axis:"0 0 1 1",symbol:"circle",smooth:true}).hoverColumn(function(){this.tags=v.set();if(this.symbols.length){for(var F=0,G=this.y.length;F<G;F++){this.tags.push(v.tag(this.x,this.y[F],this.values[F],160,10).insertBefore(this).attr([{fill:"#fff"},{fill:this.symbols[F].attr("fill")}]))}}},function(){this.tags&&this.tags.remove()});break;case"pie":C=v.piechart(w/2,E/2,(w<E?w:E)/2,x.data,{legend:x.legend}).hover(function(){this.sector.stop();this.sector.scale(1.1,1.1,this.cx,this.cy);if(this.label){this.label[0].stop();this.label[0].attr({r:7.5});this.label[1].attr({"font-weight":800})}},function(){this.sector.animate({transform:"s1 1 "+this.cx+" "+this.cy},500,"bounce");if(this.label){this.label[0].animate({r:5},500,"bounce");this.label[1].attr({"font-weight":400})}});break;case"dot":C=v.dotchart(w/8,E/8,w*0.8,E*0.8,x.x.data,x.y.data,x.data,{symbol:"o",max:10,heat:true,axis:"0 0 1 1",axisxstep:x.x.data.length-1,axisystep:x.y.data.length-1,axisxlabels:(x.x.legend?x.x.legend:x.x.data),axisylabels:(x.y.legend?x.y.legend:x.y.data),axisxtype:" ",axisytype:" "}).hover(function(){this.marker=this.marker||v.tag(this.x,this.y,this.value,0,this.r+2).insertBefore(this);this.marker.show()},function(){this.marker&&this.marker.hide()});break}C.mousedown(function(){d(z).mousedown().mouseup()});B.removeChild(D);return D}};var o=d.sheet.fn={ISNUMBER:function(x){var w;if(!isNaN(x.valueOf())){w=new u(true);w.html="TRUE";return w}w=new u(false);w.html="FALSE";return w},N:function(w){if(w==null){return 0}if(w instanceof a){return w.getTime()}if(typeof(w)=="object"){w=w.toString()}if(typeof(w)=="string"){w=parseFloat(w.replace(h.regEx.n,""))}if(isNaN(w)){return 0}if(typeof(w)=="number"){return w}if(w==true){return 1}return 0},VERSION:function(){return this.jS.version},ABS:function(w){return g.abs(o.N(w))},CEILING:function(w,v){v=v||1;return(parseInt(w/v)*v)+v},EVEN:function(w){w=g.round(w);var x=(w%2==0);if(!x){if(w>0){w++}else{w--}}return w},EXP:function(w){return g.exp(w)},FLOOR:function(x,w){w=w||1;if((x<0&&w>0)||(x>0&&w<0)){var v=new t(0);v.html="#NUM";return v}if(x>=0){return g.floor(x/w)*w}else{return g.ceil(x/w)*w}},INT:function(w){return g.floor(o.N(w))},LN:function(w){return g.log(w)},LOG:function(w,x){x=x||10;return g.log(w)/g.log(x)},LOG10:function(w){return o.LOG(w)},MOD:function(v,z){var w=v%z;if(z<0){w*=-1}return w},ODD:function(w){var y=false;if(w>0){w=g.floor(g.round(w));y=true}else{w=g.ceil(w)}var x=g.abs(w);if((x%2)==0){x++}if(y){return x}else{return -x}},PI:function(){return g.PI},POWER:function(v,w){return g.pow(v,w)},SQRT:function(w){return g.sqrt(w)},RAND:function(){return g.random()},RND:function(){return g.random()},ROUND:function(y,x){var w=g.pow(10,x||0);return g.round(y*w)/w},ROUNDDOWN:function(x,w){var y=(x<0);x=g.abs(x);w=w||0;x=g.floor(x*g.pow(10,w))/g.pow(10,w);return(y?-x:x)},ROUNDUP:function(x,w){var y=(x<0);x=g.abs(x);w=w||0;x=g.ceil(x*g.pow(10,w))/g.pow(10,w);return(y?-x:x)},SUM:function(){var y=0,w=c.toNumbers(arguments),x=w.length-1;if(x<0){return 0}do{y+=w[x]*1}while(x--);return y},TRUNC:function(v,w){w=w||0;v=v+"";if(w==0){return v.split(".").shift()}if(v.match(".")){if(w==1){v=v.substr(0,v.length-1)}else{if(w==-1){v=v.split(".").shift();v=v.substr(0,v.length-1)+"0"}}}return v},AVERAGE:function(w){return o.SUM(arguments)/o.COUNT(arguments)},AVG:function(w){return o.AVERAGE(w)},COUNT:function(){var y=0,w=c.toNumbers(arguments),x=w.length-1;if(x<0){return y}do{if(w[x]!==null){y++}}while(x--);return y},COUNTA:function(){var y=0,w=c.flatten(arguments),x=w.length-1;if(x<0){return y}do{if(w[x]){y++}}while(x--);return y},MAX:function(){var x=c.toNumbers(arguments),w=x[0],y=x.length-1;if(y<0){return 0}do{w=(x[y]>w?x[y]:w)}while(y--);return w},MIN:function(){var w=c.toNumbers(arguments),y=w[0],x=w.length-1;if(x<0){return 0}do{y=(w[x]<y?w[x]:y)}while(x--);return y},ASC:function(w){return w.charCodeAt(0)},CHAR:function(w){return q.fromCharCode(w)},CLEAN:function(w){var x=new b("[cG\x1BcLcJcMcIcK\x07\x1B\f\n\r\t\v]","g");return w.replace(x,"")},CODE:function(w){return o.ASC(w)},CONCATENATE:function(){var x=c.flatten(arguments),w="",v=this;jQuery.each(x,function(y){w+=x[y]});return w},DOLLAR:function(y,x,A){x=x||2;A=A||"$";var w=new t(y),z=o.FIXED(y,x,false);if(y>=0){w.html=A+z}else{w.html="("+A+z.slice(1)+")"}return w},FIXED:function(z,y,x){y=(y===undefined?2:y);var A=g.pow(10,y),w,z=g.round(z*A)/A;w=new q(z.toFixed(y));w.html=Globalize.format(z,"n"+y);if(x){w.html=w.html.replace(Globalize.culture().numberFormat[","],"")}return w},LEFT:function(w,x){x=x||1;return w.substring(0,x)},LEN:function(w){if(!w){return 0}return w.length},LOWER:function(w){return w.toLowerCase()},MID:function(y,z,x){if(!y||!z||!x){var w=new t(0);w.html="ERROR";return w}return y.substring(z-1,x+z-1)},REPLACE:function(w,z,x,y){if(!w||!z||!x||!y){var v=new q("");v.html="ERROR";return v}var v=w.split("");v.splice(z-1,x);v.splice(z-1,0,y);return v.join("")},REPT:function(x,z){var w="";for(var y=0;y<z;y++){w+=x}return w},RIGHT:function(w,x){x=x||1;return w.substring(w.length-x,w.length)},SEARCH:function(y,w,z){z=z||0;if(z){w=w.split("");w.splice(0,z-1);w=w.join("")}var x=w.search(y);if(x<0){var v=new q("");v.html="#VALUE!";return v}return z+(z?0:1)+x},SUBSTITUTE:function(y,v,x,z){z=z||0;v=new b(v,"g");var w=1;y=y.replace(v,function(B,D,E,C){var A=B;if(z){if(w>=z){A=x}}else{A=x}w++;return A});return y},TEXT:function(w,v){return w},UPPER:function(w){return w.toUpperCase()},VALUE:function(x){if(jQuery.isNumeric(x)){return x*=1}else{var w=new q("");w.html="#VALUE!";return w}},NOW:function(){var v=new a();v.html=e.toString(v);return v},TODAY:function(){var w=new a(),v=new t(e.toCentury(w)-1);v.html=e.toString(w,"d");return v},WEEKENDING:function(w){var v=new a();v=new a(v.getFullYear(),v.getMonth(),v.getDate()+5-v.getDay()-((w||0)*7));v.html=e.toString(v,"d");return v},WEEKDAY:function(w,x){w=e.get(w);var v=w.getDay();x=(x?x:1);switch(x){case 3:switch(v){case 0:return 7;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6}break;case 2:switch(v){case 0:return 6;case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5}break;case 1:v++;break}return v},WEEKNUM:function(v){v=e.get(v);return e.week(v)+1},YEAR:function(v){v=e.get(v);return v.getFullYear()},DAYSFROM:function(w,x,v){return g.floor((new a()-new a(w,(x-1),v))/e.dayDiv)},DAYS:function(z,x){var w=e.get(z),v=e.get(x),y=1000*60*60*24;return g.round(g.abs(w.getTime()-v.getTime())/y)},DAY:function(v){v=e.get(v);return v.getDate()},DAYS360:function(A,x,C){A=e.get(A);x=e.get(x);var v=A.getDate(),z=x.getDate(),y=e.isLastDayOfMonth(A),B=e.isLastDayOfMonth(x),w=e.diffMonths(A,x);if(C){v=g.min(v,30);z=g.min(z,30)}else{if(y){v=30}if(B){if(v<30){w++;z=1}else{z=30}}}return(w*30)+(z-v)},DATE:function(y,z,w){var x=new a(y,z-1,w),v=new t(e.toCentury(x));v.html=e.toString(x,"d");return v},DATEVALUE:function(w){w=e.get(w);var v=new t(e.toCentury(w));v.html=e.toString(w,"d");return v},EDATE:function(x,w){x=e.get(x);x.setMonth(x.getMonth()+w);var v=new t(e.toCentury(x));v.html=e.toString(x,"d");return v},EOMONTH:function(x,w){x=e.get(x);x.setMonth(x.getMonth()+w+1);x=new a(x.getFullYear(),x.getMonth(),0);var v=new t(e.toCentury(x));v.html=e.toString(x,"d");return v},HOUR:function(v){v=i.fromMath(v);return v.hour},MINUTE:function(v){return i.fromMath(v).minute},MONTH:function(v){v=e.get(v);return v.getMonth()+1},SECOND:function(v){return i.fromMath(v).second},TIME:function(v,A,w){w=(w?w:0);A=(A?A:0);v=(v?v:0);if(w&&w>60){var x=(((w/60)+"").split(".")[0])*1;w=w-(x*60);A+=x}if(A&&A>60){var z=(((A/60)+"").split(".")[0])*1;A=A-(z*60);v+=z}var y=(v*60*60*1000)+(A*60*1000)+(w*1000);return y/e.dayDiv},TIMEVALUE:function(v){if(!isNaN(v)){return v}if(/([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm)/.test(v)){return i.fromString(v,true)}else{if(/([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?/.test(v)){return i.fromString(v)}}return 0},WORKDAY:function(w,z,y){var A={1:true,2:true,3:true,4:true,5:true},w=e.get(w),z=(z&&!isNaN(z)?z:0),B=0,x=0,v=w,D;if(y){if(!jQuery.isArray(y)){y=[y]}y=c.flatten(y);var C={};jQuery.each(y,function(E){if(y[E]){C[e.toString(e.get(y[E]),"d")]=true}});y=C}else{y={}}while(x<z){v=new a(v.setDate(v.getDate()+1));if(A[v.getDay()]){if(!y[e.toString(v,"d")]){x++}}B++}D=new t(e.toCentury(v));D.html=e.toString(v,"d");return D},YEARFRAC:function(w,A,z){w=e.get(w);A=e.get(A);if(!w||!A){var v=new q("");v.html="#VALUE!";return v}z=(z?z:0);this.html=[];var y=e.diff(w,A,z),x=e.calcAnnualBasis(w,A,z);return y/x},AND:function(){var w=arguments,x,v=this;d.each(w,function(y){if(w[y].valueOf()!==true&&x==undefined){x=o.FALSE()}});if(!x){x=o.TRUE()}return x},FALSE:function(){var v=new u(false);v.html="FALSE";return v},IF:function(x,w,v){if(x.valueOf()){return w}else{return v}},NOT:function(x){var w;if(!x.valueOf()){w=new u(true);w.html="TRUE"}else{w=new u(false);w.html="FALSE"}return w},OR:function(){var y=arguments,w,z=y.length-1,x;if(z>-1){do{x=y[z].valueOf();if(x){w=new u(true);w.html="TRUE";return w}}while(z--)}w=new u(false);w.html="FALSE";return w},TRUE:function(){var v=new u(true);v.html="TRUE";return v},GREATER:function(x,w){var v;if(x>w){v=new u(true);v.html="TRUE"}else{v=new u(false);v.html="FALSE"}return v},LESS:function(x,w){var v;if(x<w){v=new u(true);v.html="TRUE"}else{v=new u(false);v.html="FALSE"}return v},EQUAL:function(x,w){var v;if(x.toString()===w.toString()){v=new u(true);v.html="TRUE"}else{v=new u(false);v.html="FALSE"}return v},GREATER_EQUAL:function(x,w){var v;if(x>=w){v=new u(true);v.html="TRUE"}else{v=new u(false);v.html="FALSE"}return v},LESS_EQUAL:function(x,w){var v;if(x<=w){v=new u(true);v.html="TRUE"}else{v=new u(false);v.html="FALSE"}return v},IMG:function(x){var w=new q("");w.html=d(m.createElement("img")).attr("src",x);return w},TRIM:function(w){if(typeof(w)=="string"){w=d.trim(w)}return w},HYPERLINK:function(x,w){w=w||"LINK";var v=new q(w);v.html=d(m.createElement("a")).attr("href",x).attr("target","_new").text(w);return v},DROPDOWN:function(){var F=this,B=this.jS,y=this.td,E,A,D,x,G,z=0,C;if(y!==null){A=d(y).children().detach()}if(A===undefined||F.needsUpdated||A.length<1){E=c.flatten(arguments);E=c.unique(E);if(this.id!==null){x=this.id+"-dropdown"}else{if(y!==null){x="dropdown"+this.sheetIndex+"_"+this.rowIndex+"_"+this.colIndex+"_"+B.I}}D=m.createElement("select");D.setAttribute("name",x);D.setAttribute("id",x);D.className="jSDropdown";D.cell=this;D.onmouseup=function(){if(this.cell.td!==null){B.cellEdit(this.cell.td)}};D.onchange=function(){F.value=this.value;F.setNeedsUpdated();B.calcDependencies.call(F);B.trigger("sheetCellEdited",[F])};B.controls.inputs[B.i]=B.obj.inputs().add(D);C=(E.length<=50?E.length:50);for(;z<C;z++){if(E[z]){var w=m.createElement("option");w.setAttribute("value",E[z]);w.text=w.innerText=E[z];D.appendChild(w)}}if(!B.s.editable){D.setAttribute("disabled",true)}else{B.s.parent.bind("sheetKill",function(){y.innerText=y.textContent=F.value=D.value})}D.value=F.value||E[0]}if(typeof F.value!=="object"){G=new q(F.value)}else{G=F.value}G.html=D;return G},RADIO:function(){var H=this,C=this.jS,z=this.td,G,B,D,w,y,x,I;if(z!==null){B=d(z).children().detach()}if(B===undefined||B.length<1||H.needsUpdated){G=c.flatten(arguments);G=c.unique(G);D=[];if(this.id!==null){x=this.id+"-radio"}else{if(z!==null){x="radio"+this.sheetIndex+"_"+this.rowIndex+"_"+this.colIndex+"_"+C.I}}B=m.createElement("span");B.className="jSRadio";B.onmousedown=function(){if(this.cell.td!==null){C.cellEdit(this.cell.td)}};B.cell=H;C.controls.inputs[C.i]=C.obj.inputs().add(B);for(var A=0;A<(G.length<=25?G.length:25);A++){if(G[A]){var F=m.createElement("input"),E=m.createElement("span");F.setAttribute("type","radio");F.setAttribute("name",x);F.className=x;F.value=G[A];F.onchange=function(){H.value=jQuery(this).val();C.setCellNeedsUpdated(H);C.calcDependencies.call(H);C.trigger("sheetCellEdited",[H])};D.push(F);if(G[A]==H.value){F.setAttribute("checked","true")}E.textContent=E.innerText=G[A];B.appendChild(F);B.input=F;E.onclick=function(){d(this).prev().click()};B.appendChild(E);B.appendChild(m.createElement("br"))}}w=d(D);if(!C.s.editable){H.value=w.filter(":checked").val();w.attr("disabled",true)}else{C.s.parent.bind("sheetKill",function(){H.value=w.filter(":checked").val();z.textContent=z.innerText=H.value})}}if(typeof H.value!=="object"){I=new q(H.value)}else{I=H.value}I.html=B;return I},CHECKBOX:function(C){if(d.isArray(C)){C=C[0]}var D=this,z=this.jS,x=this.td,y,B,A,w,E;if(x!==null){y=d(x).children().detach()}if(y===undefined||y.length<1||D.needsUpdated){if(this.id!==null){w=this.id+"-checkbox"}else{if(x!==null){w="checkbox"+this.sheet+"_"+this.rowIndex+"_"+this.colIndex+"_"+z.I}}A=m.createElement("input");A.setAttribute("type","checkbox");A.setAttribute("name",w);A.setAttribute("id",w);A.className=w;A.value=C;A.onchange=function(){if(d(this).is(":checked")){D.value=C}else{D.value=""}z.setCellNeedsUpdated(D);z.calcDependencies.call(D);z.trigger("sheetCellEdited",[D])};if(!z.s.editable){A.setAttribute("disabled","true")}else{z.s.parent.bind("sheetKill",function(){D.value=(D.value=="true"||d(A).is(":checked")?C:"");if(D.td!==null){D.td.innerText=D.td.textContent=D.cell.value}})}y=m.createElement("span");y.className="jSCheckbox";y.appendChild(A);B=m.createElement("span");B.textContent=B.innerText=C;y.appendChild(B);y.appendChild(m.createElement("br"));y.onmousedown=function(){if(this.cell.td!==null){z.cellEdit(x)}};y.cell=D;z.controls.inputs[z.i]=z.obj.inputs().add(y);if(C==D.value||D.value==="true"){A.checked=true}}if(D.value==="true"||d(A).is(":checked")){E=new q(C)}else{E=new q("")}E.html=y;return E},BARCHART:function(w,x,y){var v=new q("");v.html=h.chart.call(this,{type:"bar",data:w,legend:x,title:y});return v},HBARCHART:function(w,x,y){var v=new q("");v.html=h.chart.call(this,{type:"hbar",data:w,legend:x,title:y});return v},LINECHART:function(x,w){var v=new q("");v.html=h.chart.call(this,{type:"line",x:{data:x},y:{data:w},title:""});return v},PIECHART:function(w,x,y){var v=new q("");v.html=h.chart.call(this,{type:"pie",data:w,legend:x,title:y});return v},DOTCHART:function(B,z,w,y,x,A){var v=new q("");v.html=h.chart.call(this,{type:"dot",data:(w?w:B),x:{data:B,legend:y},y:{data:(z?z:B),legend:(x?x:y)},title:A});return v},CELLREF:function(w){return(this.jS.spreadsheets[w]?this.jS.spreadsheets[w]:"Cell Reference Not Found")},CALCTIME:function(y,w){y=y||"";w=w||"";var v=this,x=this.jS;this.jS.s.parent.one("sheetCalculation",function(){x.time.last=x.calcLast;v.td.text(y+x.time.diff()+w)});return""},HLOOKUP:function(B,y,x,D){if(B===undefined){return null}var z=this.jS,C,v,E="",w=0,A=y.length;x=x||1;D=D!==undefined?D:true;if(B!==undefined||((isNaN(B)&&B!="#REF!")||B.length===0)){for(;w<A;w++){if(y[w].toString()==B){C=y[w];break}}}else{c.getClosestNum(B,y,function(G,F){if(D){C=G}else{if(G==B){C=G}}})}if(C!==undefined){v=C.cell;v=z.getCell(v.sheetIndex,x,v.columnIndex);if(v!==null){E=v.updateValue()}else{E=""}}else{E=new q();E.html="#N/A"}return E},VLOOKUP:function(B,y,x,D){if(B===undefined){return null}var z=this.jS,C,v,E,w=0,A=y.length;D=D!==undefined?D:true;if((isNaN(B)&&B!="#REF!")||B.length===0){for(;w<A;w++){if(y[w].toString()==B){C=y[w];break}}}else{c.getClosestNum(B,y,function(G,F){if(D){C=G}else{if(G==B){C=G}}})}if(C!==undefined){v=C.cell;v=z.getCell(v.sheetIndex,v.rowIndex,x);if(v!==null){E=v.updateValue()}else{E=""}}else{E=new q();E.html="#N/A"}return E},THISROWCELL:function(v){var w=this.jS;if(isNaN(v)){v=h.columnLabelIndex(v)}return w.getCell(this.sheetIndex,this.rowIndex,v).updateValue()},THISCOLCELL:function(w){var v=this.jS;return v.getCell(this.sheetIndex,w,this.colIndex).updateValue()}};var s={BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,ALT:18,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,C:67,F:70,V:86,X:88,Y:89,Z:90,UNKNOWN:229};var c=f.arrHelpers={math:g,toNumbers:function(v){v=this.flatten(v);var w=v.length-1;if(w<0){return[]}do{if(v[w]){v[w]=d.trim(v[w]);if(isNaN(v[w])){v[w]=0}else{v[w]=v[w]*1}}else{v[w]=0}}while(w--);return v},unique:function(v){var z={},x,w=v.length,y=[];for(x=0;x<w;x+=1){z[v[x]]=v[x]}for(x in z){y.push(z[x])}return y},flatten:function(w){var z=[],y,x=0,v=w.length;for(;x<v;x++){y=w[x];if(y instanceof Array){z=z.concat(this.flatten(y))}else{z=z.concat(y)}}return z},insertAt:function(v,x,w){d(x).each(function(){if(w>-1&&w<=v.length){v.splice(w,0,this)}});return v},closest:function(A,w,x,v){x=x||0;v=v||A.length-1;var z,y;while(true){z=((x+v)>>1);y=A[z];if((z===v||z===x)&&y!==w){return y}if(y>w){v=z}else{if(y<w){x=z}else{return y}}}},getClosestNum:function(x,v,z){var y=0,w,C,B,A;if(v.length){C=v[0];w=y;for(y;y<v.length;y++){B=g.abs(x-C);A=g.abs(x-v[y]);if(A<B){w=y;C=v[y]}B=null;A=null}if(z){return z(C,w)}return C}return false},levenshtein:(function(){var v=[];return function(F,E){if(F===E){return 0}else{var C=F.length,A=E.length;if(C&&A){var x=0,w=0,D,B,z,y,G=v;while(x<C){G[x]=++x}while(w<A){y=E.charCodeAt(w);D=w;++w;B=w;for(x=0;x<C;++x){z=D+(F.charCodeAt(x)===y?0:1);D=G[x];B=B<D?(B<z?B+1:z):(D<z?D+1:z);G[x]=B}}return B}else{return C+A}}}})(),lSearch:function(w,A){var x=0,y,v=w.length,z=-1,B;for(;x<v;x++){y=w[x];B=new t(this.levenshtein(y,A));B.item=y;if(B<z){z=B}}return(B!==undefined?B.item:null)}};var e={dayDiv:86400000,math:g,toCentury:function(v,w){w=w||86400000;return this.math.round(this.math.abs((new a(1900,0,-1))-v)/w)},get:function(w,x){x=x||86400000;if(w.getMonth){return w}else{if(isNaN(w)){return new a(Globalize.parseDate(w))}else{w*=x;var v=(new a(1900,0,-1))*1;w+=v;w=new a(w);return w}}},week:function(v,x){x=x||86400000;var w=new a(v.getFullYear(),0,1);return this.math.ceil((((v-w)/x)+w.getDay()+1)/7)},toString:function(v,w){if(!w){return Globalize.format(v)}return Globalize.format(v,Globalize.culture().calendar.patterns[w])},diff:function(z,w,y,x){x=x||86400000;switch(y){case 0:return this.days360Nasd(z,w,0,true);case 1:case 2:case 3:var v=this.math.abs(w-z)/x;return v;case 4:return this.days360Euro(z,w)}return 0},diffMonths:function(x,w){var v;v=(w.getFullYear()-x.getFullYear())*12;v-=x.getMonth()+1;v+=w.getMonth()+1;return v},days360:function(x,A,y,w,v,z){return((A-x)*360)+((w-y)*30)+(z-v)},days360Nasd:function(w,z,v,x){var y=w.getDate(),D=w.getMonth(),C=w.getFullYear(),B=z.getDate(),A=z.getMonth(),E=z.getFullYear();if((A==2&&this.isEndOfMonth(B,A,E))&&((D==2&&this.isEndOfMonth(y,D,C))||v==3)){B=30}if(B==31&&(y>=30||v==3)){B=30}if(y==31){y=30}if(x&&D==2&&this.isEndOfMonth(y,D,C)){y=30}return this.days360(C,E,D,A,y,B)},days360Euro:function(C,x){var v=C.getDate(),z=C.getMonth(),y=C.getFullYear(),A=x.getDate(),w=x.getMonth(),B=x.getFullYear();if(v==31){v=30}if(A==31){A=30}return this.days360(y,B,z,w,v,A)},isEndOfMonth:function(v,x,w){return v==(new a(w,x+1,0,23,59,59)).getDate()},isLeapYear:function(v){return new a(v,1,29).getMonth()==1},calcAnnualBasis:function(v,x,B){switch(B){case 0:case 2:case 4:return 360;case 3:return 365;case 1:var w=v.getDate(),D=v.getMonth(),A=v.getFullYear(),y=x.getDate(),z=x.getMonth(),E=x.getFullYear(),F=0;if(A==E){if(this.isLeapYear(A)){F=366}else{F=365}}else{if(((E-1)==A)&&((D>z)||((D==z)&&w>=y))){if(this.isLeapYear(A)){if(D<2||(D==2&&w<=29)){F=366}else{F=365}}else{if(this.isLeapYear(E)){if(z>2||(z==2&&y==29)){F=366}else{F=365}}else{F=365}}}else{for(var C=A;C<=E;C++){if(this.isLeapYear(C)){F+=366}else{F+=365}}F=F/(E-A+1)}}return F}return 0},lastDayOfMonth:function(v){v.setDate(0);return v.getDate()},isLastDayOfMonth:function(v){return(v.getDate()==this.lastDayOfMonth(v))}};var i=f.times={math:g,fromMath:function(x){var v={},w=this;v.hour=((x*24)+"").split(".")[0]*1;v.minute=function(y){y=w.math.round(y*24*100)/100;y=(y+"").split(".");var z=0;if(y[1]){if(y[1].length<2){y[1]+="0"}z=y[1]*0.6}return w.math.round(z)}(x);v.second=function(B){B=w.math.round(B*24*10000)/10000;B=(B+"").split(".");var z=0;if(B[1]){for(var A=0;A<4;A++){if(!B[1].charAt(A)){B[1]+="0"}}var y=((B[1]*0.006)+"").split(".");if(y[1]){if(y[1]&&y[1].length>2){y[1]=y[1].substr(0,2)}return w.math.round(y[1]*0.6)}}return z}(x);return v},fromString:function(x,B){var y=new a(),C=x,v,A,z,w,D;if(B){D=C.substr(-2).toLowerCase();C=C.replace(/(am|pm)/i,"")}C=C.split(":");A=C[0]*1;z=C[1]*1;w=(C[2]?C[2]:0)*1;if(B&&D=="pm"){A+=12}return o.TIME(A,z,w)}};d.extend(g,{log10:function(v){return g.log(v)/2.302585092994046},signum:function(v){return(v/g.abs(v))||v},log1p:function(v){var w=0,z=50;if(v<=-1){return"-INF"}if(v<0||v>1){return g.log(1+v)}for(var y=1;y<z;y++){if((y%2)===0){w-=g.pow(v,y)/y}else{w+=g.pow(v,y)/y}}return w}});var n=function(){var B=m,E=d(m.createElement("p")).css({width:"100%",height:"100%"}),D=d(m.createElement("div")).css({position:"absolute",width:"100px",height:"100px",top:"0",left:"0",visibility:"hidden",overflow:"hidden"}).append(E);d(m.body).append(D);var y=E.width(),A=E.height();D.css("overflow","scroll");var v=E.width(),z=E.height();if(y==v&&D[0].clientWidth){v=D[0].clientWidth}if(A==z&&D[0].clientHeight){z=D[0].clientHeight}D.detach();var C=y-v,x=A-z;return{width:C||15,height:x||15}};var j=function(){var v="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",x=d(m.createElement("span")).html(v).appendTo("body"),w={width:x.width()/v.length,height:x.height()};x.remove();return w};var p=function(v,C,z,w,B){w=w||"#"+g.floor(g.random()*16777215).toString(16);if(z){var A=d([]);A=A.add(p(z.left,z.top,null,w,"top-left"));A=A.add(p(z.right,z.top,null,w,"top-right"));A=A.add(p(z.left,z.bottom,null,w,"bottom-left"));A=A.add(p(z.right,z.bottom,null,w,"bottom-right"));return A}return d('<div style="width: 10px; height: 10px; position: absolute;"></div>').css("top",(C-5)+"px").css("left",(v+5)+"px").css("background-color",w).click(function(){console.log(B||"none")}).appendTo("body")};d.printSource=function(x){var v=win.open();v.document.write("<html><body><xmp>"+x+"\n</xmp></body></html>");v.document.close()};if(!Object.getPrototypeOf){Object.getPrototypeOf=function(v){return v||{}}}if(!Array.prototype.indexOf){d.sheet.max=60;Array.prototype.indexOf=function(x,y){for(var w=(y||0),v=this.length;w<v;w++){if(this[w]===x){return w}}return -1}}return l})(jQuery,document,window,Date,String,Number,Boolean,Math,RegExp,Error);var parser=(function(){var T=function(X,W,Y,V){for(Y=Y||{},V=X.length;V--;Y[X[V]]=W){}return Y},n=[1,5],m=[1,6],l=[1,8],j=[1,9],i=[1,10],h=[1,13],f=[1,11],e=[1,12],d=[1,14],c=[1,15],S=[1,20],R=[1,18],Q=[1,21],P=[1,22],O=[1,17],N=[1,24],M=[1,25],L=[1,26],K=[1,27],J=[1,28],I=[1,29],H=[1,30],G=[1,31],F=[1,32],E=[1,33],D=[4,13,14,15,17,18,19,20,21,22,23,24,36,37],C=[1,36],A=[1,37],z=[1,38],y=[4,13,14,15,17,18,19,20,21,22,23,24,36,37,39],x=[4,13,14,15,17,18,19,20,21,22,23,24,36,37,40],w=[4,13,14,15,17,18,19,20,21,22,23,24,30,36,37],v=[4,14,15,17,18,19,20,21,36,37],u=[1,73],t=[4,14,17,18,19,20,36,37],s=[4,14,15,17,18,19,20,21,22,23,36,37],b=[17,36,37];var B={trace:function r(){},yy:{},symbols_:{error:2,expressions:3,EOF:4,expression:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,ESCAPED_STRING:11,LETTERS:12,"&":13,"=":14,"+":15,"(":16,")":17,"<":18,">":19,NOT:20,"-":21,"*":22,"/":23,"^":24,E:25,FUNCTION:26,expseq:27,cellRange:28,cell:29,":":30,SHEET:31,"!":32,NUMBER:33,"$":34,REF:35,";":36,",":37,VARIABLE:38,DECIMAL:39,"%":40,"$accept":0,"$end":1},terminals_:{2:"error",4:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"ESCAPED_STRING",12:"LETTERS",13:"&",14:"=",15:"+",16:"(",17:")",18:"<",19:">",20:"NOT",21:"-",22:"*",23:"/",24:"^",25:"E",26:"FUNCTION",30:":",31:"SHEET",32:"!",33:"NUMBER",34:"$",35:"REF",36:";",37:",",38:"VARIABLE",39:"DECIMAL",40:"%"},productions_:[0,[3,1],[3,2],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,3],[5,3],[5,3],[5,3],[5,4],[5,4],[5,4],[5,3],[5,3],[5,3],[5,3],[5,3],[5,3],[5,3],[5,2],[5,2],[5,1],[5,3],[5,4],[5,1],[28,1],[28,3],[28,3],[28,5],[29,2],[29,3],[29,3],[29,4],[29,1],[29,2],[29,2],[29,2],[29,3],[29,3],[29,3],[29,3],[29,3],[29,3],[29,4],[29,4],[29,4],[27,1],[27,2],[27,2],[27,3],[27,3],[6,1],[6,3],[9,1],[9,3],[9,2]],performAction:function q(X,aa,o,ab,ac,ad,V){var W=ad.length-1;switch(ac){case 1:return null;break;case 2:return ad[W-1];break;case 3:this.$=ab.handler.variable.apply(ab.obj,ad[W]);break;case 4:this.$=ab.handler.time(ad[W],true);break;case 5:this.$=ab.handler.time(ad[W]);break;case 6:this.$=ab.handler.number(ad[W]);break;case 7:this.$=ad[W].substring(1,ad[W].length-1);break;case 8:this.$=ad[W].substring(2,ad[W].length-2);break;case 9:case 58:this.$=ad[W];break;case 10:this.$=ad[W-2].toString()+ad[W].toString();break;case 11:this.$=ab.handler.callFunction(ab.obj,"EQUAL",[ad[W-2],ad[W]]);break;case 12:this.$=ab.handler.performMath("+",ad[W-2],ad[W]);break;case 13:this.$=ab.handler.number(ad[W-1]);break;case 14:this.$=ab.handler.callFunction(ab.obj,"LESS_EQUAL",[ad[W-3],ad[W]]);break;case 15:this.$=ab.handler.callFunction(ab.obj,"GREATER_EQUAL",[ad[W-3],ad[W]]);break;case 16:this.$=(ad[W-3])!=(ad[W]);if(isNaN(this.$)){this.$=0}break;case 17:this.$=ad[W-2]!=ad[W];break;case 18:this.$=ab.handler.callFunction(ab.obj,"GREATER",[ad[W-2],ad[W]]);break;case 19:this.$=ab.handler.callFunction(ab.obj,"LESS",[ad[W-2],ad[W]]);break;case 20:this.$=ab.handler.performMath("-",ad[W-2],ad[W]);break;case 21:this.$=ab.handler.performMath("*",ad[W-2],ad[W]);break;case 22:this.$=ab.handler.performMath("/",ad[W-2],ad[W]);break;case 23:var Z=ab.handler.number(ad[W-2]),Y=ab.handler.number(ad[W]);this.$=ab.handler.performMath("^",ad[W-2],ad[W]);break;case 24:var Z=ab.handler.numberInverted(ad[W]);this.$=Z;if(isNaN(this.$)){this.$=0}break;case 25:var Z=ab.handler.number(ad[W]);this.$=Z;if(isNaN(this.$)){this.$=0}break;case 26:break;case 27:this.$=ab.handler.callFunction(ab.obj,ad[W-2]);break;case 28:this.$=ab.handler.callFunction(ab.obj,ad[W-3],ad[W-1]);break;case 30:this.$=ab.handler.cellValue(ab.obj,ad[W]);break;case 31:this.$=ab.handler.cellRangeValue(ab.obj,ad[W-2],ad[W]);break;case 32:this.$=ab.handler.remoteCellValue(ab.obj,ad[W-2],ad[W]);break;case 33:this.$=ab.handler.remoteCellRangeValue(ab.obj,ad[W-4],ad[W-2],ad[W]);break;case 34:this.$={colString:ad[W-1],rowString:ad[W]};break;case 35:this.$={colString:ad[W-1],rowString:ad[W]};break;case 36:case 37:this.$={colString:ad[W-2],rowString:ad[W]};break;case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:return"#REF!";break;case 51:this.$=[ad[W]];break;case 54:ad[W-2].push(ad[W]);this.$=ad[W-2];break;case 55:ad[W-2].push(ad[W]);this.$=ad[W-2];break;case 56:this.$=[ad[W]];break;case 57:this.$=($.isArray(ad[W-2])?ad[W-2]:[ad[W-2]]);this.$.push(ad[W]);break;case 59:this.$=(ad[W-2]+"."+ad[W])*1;break;case 60:this.$=ad[W-1]*0.01;break}},table:[{3:1,4:[1,2],5:3,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{1:[3]},{1:[2,1]},{4:[1,23],13:N,14:M,15:L,18:K,19:J,20:I,21:H,22:G,23:F,24:E},T(D,[2,3],{39:[1,34]}),T(D,[2,4]),T(D,[2,5]),T(D,[2,6],{40:[1,35]}),T(D,[2,7]),T(D,[2,8]),T(D,[2,9],{33:C,34:A,35:z}),{5:39,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:40,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:41,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},T(D,[2,26]),{16:[1,42]},T(D,[2,29]),T(y,[2,56]),T(x,[2,58],{39:[1,43]}),T(D,[2,30],{30:[1,44]}),{32:[1,45]},{12:[1,46],35:[1,47]},T(w,[2,38],{33:[1,48],34:[1,50],35:[1,49]}),{1:[2,2]},{5:51,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:52,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:53,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:56,6:4,7:n,8:m,9:7,10:l,11:j,12:i,14:[1,54],15:h,16:f,19:[1,55],21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:58,6:4,7:n,8:m,9:7,10:l,11:j,12:i,14:[1,57],15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:59,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:60,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:61,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:62,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:63,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{38:[1,64]},T(x,[2,60]),T(w,[2,34]),{33:[1,65],35:[1,66]},T(w,[2,40]),{13:N,14:M,15:L,17:[1,67],18:K,19:J,20:I,21:H,22:G,23:F,24:E},T(v,[2,24],{13:N,22:G,23:F,24:E}),T(v,[2,25],{13:N,22:G,23:F,24:E}),{5:70,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,17:[1,68],21:e,25:d,26:c,27:69,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{33:[1,71]},{12:u,29:72,34:Q,35:P},{12:u,29:74,34:Q,35:P},{33:[1,75],34:[1,76],35:[1,77]},{33:[1,78],34:[1,80],35:[1,79]},T(w,[2,39]),T(w,[2,41]),{33:[1,81],35:[1,82]},T([4,17,36,37],[2,10],{13:N,14:M,15:L,18:K,19:J,20:I,21:H,22:G,23:F,24:E}),T([4,14,17,36,37],[2,11],{13:N,15:L,18:K,19:J,20:I,21:H,22:G,23:F,24:E}),T(v,[2,12],{13:N,22:G,23:F,24:E}),{5:83,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},{5:84,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},T(t,[2,19],{13:N,15:L,21:H,22:G,23:F,24:E}),{5:85,6:4,7:n,8:m,9:7,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:S,33:R,34:Q,35:P,38:O},T(t,[2,18],{13:N,15:L,21:H,22:G,23:F,24:E}),T([4,14,17,20,36,37],[2,17],{13:N,15:L,18:K,19:J,21:H,22:G,23:F,24:E}),T(v,[2,20],{13:N,22:G,23:F,24:E}),T(s,[2,21],{13:N,24:E}),T(s,[2,22],{13:N,24:E}),T([4,14,15,17,18,19,20,21,22,23,24,36,37],[2,23],{13:N}),T(y,[2,57]),T(w,[2,36]),T(w,[2,46]),T(D,[2,13]),T(D,[2,27]),{17:[1,86],36:[1,87],37:[1,88]},T(b,[2,51],{13:N,14:M,15:L,18:K,19:J,20:I,21:H,22:G,23:F,24:E}),T(x,[2,59]),T(D,[2,31]),{33:C,34:A,35:z},T(D,[2,32],{30:[1,89]}),T(w,[2,35]),{33:[1,90]},T(w,[2,43]),T(w,[2,42]),T(w,[2,44]),{33:[1,91],35:[1,92]},T(w,[2,45]),T(w,[2,47]),T(t,[2,14],{13:N,15:L,21:H,22:G,23:F,24:E}),T(t,[2,16],{13:N,15:L,21:H,22:G,23:F,24:E}),T(t,[2,15],{13:N,15:L,21:H,22:G,23:F,24:E}),T(D,[2,28]),T(b,[2,52],{6:4,9:7,28:16,29:19,5:93,7:n,8:m,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,31:S,33:R,34:Q,35:P,38:O}),T(b,[2,53],{6:4,9:7,28:16,29:19,5:94,7:n,8:m,10:l,11:j,12:i,15:h,16:f,21:e,25:d,26:c,31:S,33:R,34:Q,35:P,38:O}),{12:u,29:95,34:Q,35:P},T(w,[2,37]),T(w,[2,48]),T(w,[2,50]),T(b,[2,54],{13:N,14:M,15:L,18:K,19:J,20:I,21:H,22:G,23:F,24:E}),T(b,[2,55],{13:N,14:M,15:L,18:K,19:J,20:I,21:H,22:G,23:F,24:E}),T(D,[2,33])],defaultActions:{2:[2,1],23:[2,2]},parseError:function g(V,o){if(o.recoverable){this.trace(V)}else{throw new Error(V)}},parse:function p(ag){var ao=this,ad=[0],an=[],az=[null],ai=[],aB=this.table,W="",ah=0,ax=0,Y=0,af=2,am=1;var Z=ai.slice.call(arguments,1);var o=Object.create(this.lexer);var aA={yy:{}};for(var aw in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,aw)){aA.yy[aw]=this.yy[aw]}}o.setInput(ag,aA.yy);aA.yy.lexer=o;aA.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var X=o.yylloc;ai.push(X);var aa=o.options&&o.options.ranges;if(typeof aA.yy.parseError==="function"){this.parseError=aA.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function al(aE){ad.length=ad.length-2*aE;az.length=az.length-aE;ai.length=ai.length-aE}_token_stack:function ak(){var aE;aE=o.lex()||am;if(typeof aE!=="number"){aE=ao.symbols_[aE]||aE}return aE}var av,aq,ac,au,aD,aj,at={},ap,ay,V,ae;while(true){ac=ad[ad.length-1];if(this.defaultActions[ac]){au=this.defaultActions[ac]}else{if(av===null||typeof av=="undefined"){av=ak()}au=aB[ac]&&aB[ac][av]}_handle_error:if(typeof au==="undefined"||!au.length||!au[0]){var ab;var ar="";function aC(aF){var aE=ad.length-1;var aG=0;for(;;){if((af.toString()) in aB[aF]){return aG}if(aF===0||aE<2){return false}aE-=2;aF=ad[aE];++aG}}if(!Y){ab=aC(ac);ae=[];for(ap in aB[ac]){if(this.terminals_[ap]&&ap>af){ae.push("'"+this.terminals_[ap]+"'")}}if(o.showPosition){ar="Parse error on line "+(ah+1)+":\n"+o.showPosition()+"\nExpecting "+ae.join(", ")+", got '"+(this.terminals_[av]||av)+"'"}else{ar="Parse error on line "+(ah+1)+": Unexpected "+(av==am?"end of input":("'"+(this.terminals_[av]||av)+"'"))}return this.parseError(ar,{text:o.match,token:this.terminals_[av]||av,line:o.yylineno,loc:X,expected:ae,recoverable:(ab!==false)})}else{if(aq!==am){ab=aC(ac)}}if(Y==3){if(av===am||aq===am){throw new Error(ar||"Parsing halted while starting to recover from another error.")}ax=o.yyleng;W=o.yytext;ah=o.yylineno;X=o.yylloc;av=ak()}if(ab===false){throw new Error(ar||"Parsing halted. No suitable error recovery rule available.")}al(ab);aq=(av==af?null:av);av=af;ac=ad[ad.length-1];au=aB[ac]&&aB[ac][af];Y=3}if(au[0] instanceof Array&&au.length>1){throw new Error("Parse Error: multiple actions possible at state: "+ac+", token: "+av)}switch(au[0]){case 1:ad.push(av);az.push(o.yytext);ai.push(o.yylloc);ad.push(au[1]);av=null;if(!aq){ax=o.yyleng;W=o.yytext;ah=o.yylineno;X=o.yylloc;if(Y>0){Y--}}else{av=aq;aq=null}break;case 2:ay=this.productions_[au[1]][1];at.$=az[az.length-ay];at._$={first_line:ai[ai.length-(ay||1)].first_line,last_line:ai[ai.length-1].last_line,first_column:ai[ai.length-(ay||1)].first_column,last_column:ai[ai.length-1].last_column};if(aa){at._$.range=[ai[ai.length-(ay||1)].range[0],ai[ai.length-1].range[1]]}aj=this.performAction.apply(at,[W,ax,ah,aA.yy,au[1],az,ai].concat(Z));if(typeof aj!=="undefined"){return aj}if(ay){ad=ad.slice(0,-1*ay*2);az=az.slice(0,-1*ay);ai=ai.slice(0,-1*ay)}ad.push(this.productions_[au[1]][0]);az.push(at.$);ai.push(at._$);V=aB[ad[ad.length-2]][ad[ad.length-1]];ad.push(V);break;case 3:return true}}return true}};if(typeof(window)!=="undefined"){window.Formula=function(W){var X=function(){};X.prototype=B.lexer;var V=function(){this.lexer=new X();this.yy={parseError:function(aa,Z){this.done=true;var Y=new String();Y.html="<pre>"+aa+"</pre>";Y.hash=Z;return Y},lexerError:function(aa,Z){this.done=true;var Y=new String();Y.html="<pre>"+aa+"</pre>";Y.hash=Z;return Y}}};V.prototype=B;var o=new V;o.setObj=function(Y){o.yy.obj=Y};o.yy.handler=W;return o}}var U=(function(){var W=({EOF:1,parseError:function X(af,ae){if(this.yy.parser){this.yy.parser.parseError(af,ae)}else{throw new Error(af)}},setInput:function(ae,af){this.yy=af||this.yy||{};this._input=new a.InputReader(ae);this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var af=this._input.ch();this.yytext+=af;this.yyleng++;this.offset++;this.match+=af;var ae=af.match(/(?:\r\n?|\n).*/g);if(ae){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}return af},unput:function(ag){var ae=ag.length;var af=ag.split(/(?:\r\n?|\n)/g);this._input.unCh(ae,ag);this.yytext=this.yytext.substr(0,this.yytext.length-ae);this.offset-=ae;var ai=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);if(af.length-1){this.yylineno-=af.length-1}var ah=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:af?(af.length===ai.length?this.yylloc.first_column:0)+ai[ai.length-af.length].length-af[0].length:this.yylloc.first_column-ae};if(this.options.ranges){this.yylloc.range=[ah[0],ah[0]+this.yyleng-ae]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(ae){this.unput(this.match.slice(ae))},pastInput:function(){var ae=this._input.toString();var af=ae.substr(0,ae.length-this.match.length);return(af.length>20?"...":"")+af.substr(-20).replace(/\n/g,"")},upcomingInput:function(){if(!this.done){var ae=this.match;if(ae.length<20){ae+=this._input.toString().substr(0,20-ae.length)}return(ae.substr(0,20)+(ae.length>20?"...":"")).replace(/\n/g,"")}return""},showPosition:function(){var ae=this.pastInput();var af=new Array(ae.length+1).join("-");return ae+this.upcomingInput()+"\n"+af+"^"},test_match:function(ai,ag){var aj,ae,ah,af;if(this.options.backtrack_lexer){ah={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,yyleng:this.yyleng,offset:this.offset,_more:this._more,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){ah.yylloc.range=this.yylloc.range.slice(0)}}ae=ai.match(/(?:\r\n?|\n).*/g);if(ae){this.yylineno+=ae.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:ae!==null?ae[ae.length-1].length-ae[ae.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+ai.length};this.yytext+=ai;this.match+=ai;this.matches=ai;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input.addMatch(ai);aj=this.performAction.call(this,this.yy,this,ag,this.conditionStack[this.conditionStack.length-1]);if(this.done&&!this._input.done){this.done=false}if(aj){return aj}else{if(this._backtrack){for(af in ah){if(ah.hasOwnProperty(af)){this[af]=ah[af]}}return null}}return null},next:function(){if(this.done){return this.EOF}if(this._input.done){this.done=true}var ai,ag,ae,af;if(!this._more){this.yytext="";this.match=""}var aj=this._currentRules();for(var ah=0;ah<aj.length;ah++){ae=this._input.match(this.rules[aj[ah]]);if(ae!==null&&(ag===undefined||ae[0].length>ag.length)){ag=ae[0];af=ah;if(this.options.backtrack_lexer){ai=this.test_match(ae[0],aj[ah]);if(ai!==null){return ai}else{if(this._backtrack){ag=undefined;continue}else{return null}}}else{if(!this.options.flex){break}}}}if(ag!==undefined){ai=this.test_match(ag,aj[af]);if(ai!==null){return ai}return null}if(this._input.done){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var ae=this.next();if(ae!==null){return ae}else{return this.lex()}},begin:function V(ae){this.conditionStack.push(ae)},popState:function Y(){var ae=this.conditionStack.length-1;if(ae>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function ad(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function ab(ae){ae=this.conditionStack.length-1-Math.abs(ae||0);if(ae>=0){return this.conditionStack[ae]}else{return"INITIAL"}},pushState:function aa(ae){this.begin(ae)},stateStackSize:function Z(){return this.conditionStack.length},options:{},performAction:function ac(ai,af,ah,ae){var ag=ae;switch(ah){case 0:break;case 1:return 26;break;case 2:return 7;break;case 3:return 8;break;case 4:if(ai.obj.typeName=="Sheet.Cell"){return 31}return 38;break;case 5:af.yytext=af.yytext.substring(1,af.yytext.length-1);if(ai.obj.typeName=="Sheet.Cell"){return 31}return 38;break;case 6:return 10;break;case 7:return 10;break;case 8:return 11;break;case 9:return 11;break;case 10:return 12;break;case 11:return 38;break;case 12:return 38;break;case 13:return 33;break;case 14:return 34;break;case 15:return 13;break;case 16:return" ";break;case 17:return 39;break;case 18:return 30;break;case 19:return 36;break;case 20:return 37;break;case 21:return 22;break;case 22:return 23;break;case 23:return 21;break;case 24:return 15;break;case 25:return 24;break;case 26:return 16;break;case 27:return 17;break;case 28:return 19;break;case 29:return 18;break;case 30:return 20;break;case 31:return"PI";break;case 32:return 25;break;case 33:return'"';break;case 34:return"'";break;case 35:return'"';break;case 36:return"'";break;case 37:return"!";break;case 38:return 14;break;case 39:return 40;break;case 40:return 35;break;case 41:return"#";break;case 42:return 4;break}},rules:[/^(?:\s+)/,/^(?:([A-Za-z]{1,})([A-Za-z_0-9]+)?(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:(([A-Za-z0-9]+))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])|(["](\\["]|[^"])*["]))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])))/,/^(?:((["](\\["]|[^"])*["])))/,/^(?:(([\\]['].+?[\\]['])))/,/^(?:(([\\]["].+?[\\]["])))/,/^(?:[A-Z]+(?=[0-9$]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\$)/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:PI\b)/,/^(?:E\b)/,/^(?:")/,/^(?:')/,/^(?:\\")/,/^(?:\\')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:#REF!)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:true}}});return W})();B.lexer=U;function a(){this.yy={}}a.prototype=B;a.InputReader=(function(W,V,Z){var Y=RegExp.prototype.sticky!==undefined,ah,ae,af,aa;function ai(aj){this.done=false;this.input=aj;this.length=aj.length;this.matches=[];this.position=0}if(Y){ai.prototype={addMatch:function ag(aj){this.matches.push(aj);this.position+=aj.length;this.done=(this.position>=this.length)},ch:function o(){var aj=this.input[this.position];this.addMatch(aj);return aj},unCh:function ad(aj){this.position-=aj;this.position=W.max(0,this.position);this.done=(this.position>=this.length)},substring:function ac(ak,aj){ak=(ak!=0?this.position+ak:this.position);aj=(aj!=0?ak+aj:this.length);return this.input.substring(ak,aj)},match:function ab(ak){var aj;ak.lastIndex=this.position;if((aj=ak.exec(this.input))!==null){return aj}return null},toString:function X(){return this.matches.join("")}};ah=Z.rules;af=ah.length;aa=0;for(;aa<af;aa++){ae=ah[aa];ah[aa]=new RegExp(ae.source.substring(1),"y")}}else{ai.prototype={addMatch:function ag(aj){this.input=this.input.slice(aj.length);this.matches.push(aj);this.position+=aj.length;this.done=(this.position>=this.length)},ch:function o(){var aj=this.input[0];this.addMatch(aj);return aj},unCh:function ad(ak,aj){this.position-=ak;this.position=W.max(0,this.position);this.input=aj+this.input;this.done=(this.position>=this.length)},substring:function ac(ak,aj){ak=(ak!=0?this.position+ak:this.position);aj=(aj!=0?ak+aj:this.length);return this.input.substring(ak,aj)},match:function ab(al){var ak,aj=this.input;if((ak=aj.match(al))!==null){return ak}return null},toString:function X(){return this.matches.join("")}}}return ai})(Math,B,U);B.Parser=a;return new a})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}}var parser=(function(){var p=function(x,w,y,u){for(y=y||{},u=x.length;u--;y[x[u]]=w){}return y},m=[1,10],j=[1,11],i=[1,12],h=[1,13],g=[5,7,8,9,10],f=[1,19],c=[1,20],a=[5,7,8,9,10,12,13],t=[1,21],s=[5,7,8,9,10,12,13,14,16];var l={trace:function q(){},yy:{},symbols_:{error:2,grid:3,rows:4,EOF:5,row:6,END_OF_LINE:7,END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN:8,END_OF_LINE_WITH_NO_COLUMNS:9,END_OF_LINE_WITH_EMPTY_COLUMN:10,string:11,COLUMN_EMPTY:12,COLUMN_STRING:13,CHAR:14,QUOTE_ON:15,QUOTE_OFF:16,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",7:"END_OF_LINE",8:"END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN",9:"END_OF_LINE_WITH_NO_COLUMNS",10:"END_OF_LINE_WITH_EMPTY_COLUMN",12:"COLUMN_EMPTY",13:"COLUMN_STRING",14:"CHAR",15:"QUOTE_ON",16:"QUOTE_OFF"},productions_:[0,[3,2],[3,1],[4,1],[4,1],[4,1],[4,1],[4,1],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[6,1],[6,1],[6,2],[6,3],[6,1],[6,2],[6,3],[11,1],[11,2],[11,3]],performAction:function e(o,w,x,A,z,v,y){var u=v.length-1;switch(z){case 1:return v[u-1];break;case 2:return[[""]];break;case 3:this.$=[v[u]];break;case 4:this.$=[];break;case 5:this.$=[""];break;case 6:this.$=[""];break;case 7:this.$=[""];break;case 8:this.$=v[u-1];break;case 9:v[u-1].push([""]);this.$=v[u-1];break;case 10:v[u-1].push([""]);this.$=v[u-1];break;case 11:v[u-1][v[u-1].length-1].push("");this.$=v[u-1];break;case 12:v[u-2].push(v[u]);this.$=v[u-2];break;case 13:v[u].unshift("");v[u-2].push(v[u]);this.$=v[u-2];break;case 14:v[u-2].push([""]);v[u-2].push(v[u]);this.$=v[u-2];break;case 15:v[u-2][v[u-2].length-1].push("");v[u-2].push(v[u]);this.$=v[u-2];break;case 16:this.$=[v[u].join("")];break;case 17:this.$=[""];break;case 18:v[u-1].push("");this.$=v[u-1];break;case 19:v[u-2].push("");v[u-2].push(v[u].join(""));this.$=v[u-2];break;case 20:break;case 21:break;case 22:v[u-2].push(v[u].join(""));this.$=v[u-2];break;case 23:this.$=[v[u]];break;case 24:v[u-1].push(v[u]);this.$=v[u-1];break;case 25:this.$=v[u-1];break}},table:[{3:1,4:2,5:[1,3],6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:m,13:j,14:i,15:h},{1:[3]},{5:[1,14],7:[1,15],8:[1,16],9:[1,17],10:[1,18]},{1:[2,2]},p(g,[2,3],{12:f,13:c}),p(g,[2,4]),p(g,[2,5]),p(g,[2,6]),p(g,[2,7]),p(a,[2,16],{14:t}),p(a,[2,17]),p(a,[2,20]),p(s,[2,23]),{11:22,14:i,15:h},{1:[2,1]},p(g,[2,8],{11:9,6:23,12:m,13:j,14:i,15:h}),p(g,[2,9],{11:9,6:24,12:m,13:j,14:i,15:h}),p(g,[2,10],{11:9,6:25,12:m,13:j,14:i,15:h}),p(g,[2,11],{11:9,6:26,12:m,13:j,14:i,15:h}),p(a,[2,18],{11:27,14:i,15:h}),p(a,[2,21],{11:28,14:i,15:h}),p(s,[2,24]),{14:t,16:[1,29]},p(g,[2,12],{12:f,13:c}),p(g,[2,13],{12:f,13:c}),p(g,[2,14],{12:f,13:c}),p(g,[2,15],{12:f,13:c}),p(a,[2,19],{14:t}),p(a,[2,22],{14:t}),p(s,[2,25])],defaultActions:{3:[2,2],14:[2,1]},parseError:function r(u,o){if(o.recoverable){this.trace(u)}else{throw new Error(u)}},parse:function n(E){var M=this,B=[0],L=[],W=[null],G=[],Y=this.table,v="",F=0,U=0,x=0,D=2,K=1;var y=G.slice.call(arguments,1);var o=Object.create(this.lexer);var X={yy:{}};for(var T in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,T)){X.yy[T]=this.yy[T]}}o.setInput(E,X.yy);X.yy.lexer=o;X.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var w=o.yylloc;G.push(w);var z=o.options&&o.options.ranges;if(typeof X.yy.parseError==="function"){this.parseError=X.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function J(aa){B.length=B.length-2*aa;W.length=W.length-aa;G.length=G.length-aa}_token_stack:function I(){var aa;aa=o.lex()||K;if(typeof aa!=="number"){aa=M.symbols_[aa]||aa}return aa}var S,O,A,R,Z,H,Q={},N,V,u,C;while(true){A=B[B.length-1];if(this.defaultActions[A]){R=this.defaultActions[A]}else{if(S===null||typeof S=="undefined"){S=I()}R=Y[A]&&Y[A][S]}if(typeof R==="undefined"||!R.length||!R[0]){var P="";C=[];for(N in Y[A]){if(this.terminals_[N]&&N>D){C.push("'"+this.terminals_[N]+"'")}}if(o.showPosition){P="Parse error on line "+(F+1)+":\n"+o.showPosition()+"\nExpecting "+C.join(", ")+", got '"+(this.terminals_[S]||S)+"'"}else{P="Parse error on line "+(F+1)+": Unexpected "+(S==K?"end of input":"'"+(this.terminals_[S]||S)+"'")}this.parseError(P,{text:o.match,token:this.terminals_[S]||S,line:o.yylineno,loc:w,expected:C})}if(R[0] instanceof Array&&R.length>1){throw new Error("Parse Error: multiple actions possible at state: "+A+", token: "+S)}switch(R[0]){case 1:B.push(S);W.push(o.yytext);G.push(o.yylloc);B.push(R[1]);S=null;if(!O){U=o.yyleng;v=o.yytext;F=o.yylineno;w=o.yylloc;if(x>0){x--}}else{S=O;O=null}break;case 2:V=this.productions_[R[1]][1];Q.$=W[W.length-V];Q._$={first_line:G[G.length-(V||1)].first_line,last_line:G[G.length-1].last_line,first_column:G[G.length-(V||1)].first_column,last_column:G[G.length-1].last_column};if(z){Q._$.range=[G[G.length-(V||1)].range[0],G[G.length-1].range[1]]}H=this.performAction.apply(Q,[v,U,F,X.yy,R[1],W,G].concat(y));if(typeof H!=="undefined"){return H}if(V){B=B.slice(0,-1*V*2);W=W.slice(0,-1*V);G=G.slice(0,-1*V)}B.push(this.productions_[R[1]][0]);W.push(Q.$);G.push(Q._$);u=Y[B[B.length-2]][B[B.length-1]];B.push(u);break;case 3:return true}}return true}};if(typeof GLOBAL!=="undefined"){GLOBAL.window=GLOBAL}if(typeof window.TSV==="undefined"){var n=l.parse;l.parse=function(o){var u=this.lexer.setInput;this.lexer.setInput=function(v){u.call(this,v);this.begin("BOF");return this};this.parse=n;return n.call(this,o)};window.TSV=function(u){var w=function(){};w.prototype=l.lexer;var v=function(){this.lexer=new w();this.yy={}};v.prototype=l;var o=new v;o.setObj=function(x){o.yy.obj=x};o.yy.handler=u;return o}}var b=(function(){var v=({EOF:1,parseError:function w(E,D){if(this.yy.parser){this.yy.parser.parseError(E,D)}else{throw new Error(E)}},setInput:function(D,E){this.yy=E||this.yy||{};this._input=D;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var E=this._input[0];this.yytext+=E;this.yyleng++;this.offset++;this.match+=E;this.matched+=E;var D=E.match(/(?:\r\n?|\n).*/g);if(D){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return E},unput:function(F){var D=F.length;var E=F.split(/(?:\r\n?|\n)/g);this._input=F+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-D);this.offset-=D;var H=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(E.length-1){this.yylineno-=E.length-1}var G=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:E?(E.length===H.length?this.yylloc.first_column:0)+H[H.length-E.length].length-E[0].length:this.yylloc.first_column-D};if(this.options.ranges){this.yylloc.range=[G[0],G[0]+this.yyleng-D]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(D){this.unput(this.match.slice(D))},pastInput:function(){var D=this.matched.substr(0,this.matched.length-this.match.length);return(D.length>20?"...":"")+D.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var D=this.match;if(D.length<20){D+=this._input.substr(0,20-D.length)}return(D.substr(0,20)+(D.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var D=this.pastInput();var E=new Array(D.length+1).join("-");return D+this.upcomingInput()+"\n"+E+"^"},test_match:function(H,F){var I,D,G;if(this.options.backtrack_lexer){G={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){G.yylloc.range=this.yylloc.range.slice(0)}}D=H[0].match(/(?:\r\n?|\n).*/g);if(D){this.yylineno+=D.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:D?D[D.length-1].length-D[D.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+H[0].length};this.yytext+=H[0];this.match+=H[0];this.matches=H;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(H[0].length);this.matched+=H[0];I=this.performAction.call(this,this.yy,this,F,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(I){return I}else{if(this._backtrack){for(var E in G){this[E]=G[E]}return false}}return false},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var H,F,D,E;if(!this._more){this.yytext="";this.match=""}var I=this._currentRules();for(var G=0;G<I.length;G++){D=this._input.match(this.rules[I[G]]);if(D&&(!F||D[0].length>F[0].length)){F=D;E=G;if(this.options.backtrack_lexer){H=this.test_match(D,I[G]);if(H!==false){return H}else{if(this._backtrack){F=false;continue}else{return false}}}else{if(!this.options.flex){break}}}}if(F){H=this.test_match(F,I[E]);if(H!==false){return H}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var D=this.next();if(D){return D}else{return this.lex()}},begin:function u(D){this.conditionStack.push(D)},popState:function x(){var D=this.conditionStack.length-1;if(D>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function C(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function A(D){D=this.conditionStack.length-1-Math.abs(D||0);if(D>=0){return this.conditionStack[D]}else{return"INITIAL"}},pushState:function z(D){this.begin(D)},stateStackSize:function y(){return this.conditionStack.length},options:{},performAction:function B(H,E,G,D){var F=D;switch(G){case 0:return 14;break;case 1:this.popState();return 16;break;case 2:if(E.yytext==this.quoteChar){this.popState();this.begin("STRING");return 16}else{return 14}break;case 3:this.popState();this.begin("STRING");return 14;break;case 4:this.popState();this.quoteChar=E.yytext.substring(0);this.begin("QUOTE");return 15;break;case 5:this.quoteChar=E.yytext;this.popState();this.begin("QUOTE");return 15;break;case 6:this.begin("PRE_QUOTE");return 13;break;case 7:this.begin("PRE_QUOTE");return 7;break;case 8:return 14;break;case 9:this.popState();return 8;break;case 10:this.popState();return 9;break;case 11:this.popState();return 7;break;case 12:this.popState();return 13;break;case 13:return 14;break;case 14:this.popState();break;case 15:return"BUFFIN";break;case 16:return 9;break;case 17:return 10;break;case 18:return 12;break;case 19:return 7;break;case 20:this.begin("STRING");return 14;break;case 21:return 5;break}},rules:[/^(?:(\n|\\n))/,/^(?:([\'\"])(?=$))/,/^(?:([\'\"]))/,/^(?:(?=(\t)))/,/^(?:([\'\"]))/,/^(?:([\'\"]))/,/^(?:(\t|\\t)(?=[\'\"]))/,/^(?:(\n|\\n)(?=[\'\"]))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:(\n\t|\\n\\t))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\n|\\n))/,/^(?:(\t|\\t))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:)/,/^(?:(\n\t|\\n\\t)(?=.))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\t\n))/,/^(?:(\t))/,/^(?:(\n))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:$)/],conditions:{BOF:{rules:[4,6,7,14,15,16,17,18,19,20,21],inclusive:true},PRE_QUOTE:{rules:[5,6,7,15,16,17,18,19,20,21],inclusive:true},QUOTE:{rules:[0,1,2,3,6,7,8,15,16,17,18,19,20,21],inclusive:true},STRING:{rules:[6,7,9,10,11,12,13,15,16,17,18,19,20,21],inclusive:true},INITIAL:{rules:[6,7,15,16,17,18,19,20,21],inclusive:true}}});return v})();l.lexer=b;function d(){this.yy={}}d.prototype=l;l.Parser=d;return new d})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}};