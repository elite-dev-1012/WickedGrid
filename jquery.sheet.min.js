var jQuery=window.jQuery||{};var Sheet=(function(d,l,f,a,p,s,t,g,b,q){var k={Loader:{},defaultTheme:0,themeRollerTheme:0,bootstrapTheme:1,customTheme:2,excelSelectModel:0,googleDriveSelectModel:1,openOfficeSelectModel:2,defaultColumnWidth:120,defaultRowHeight:20,calcStack:0,formulaParserUrl:"../parser/formula/formula.js",threadScopeUrl:"../Sheet/threadScope.js",defaultFormulaParser:null,spareFormulaParsers:[],formulaParser:function(v){var u;if(v>-1){u=this.spareFormulaParsers[v];if(u===undefined){u=this.spareFormulaParsers[v]=Formula()}}else{u=k.defaultFormulaParser}u.yy.types=[];return u},parseFormulaSlow:function(w,v){if(k.defaultFormulaParser===null){k.defaultFormulaParser=Formula()}var u=k.formulaParser(k.calcStack);v(u.parse(w))},parseFormula:function(w,v){var u=k.thread();if(u.busy){u.stash.push(function(){u.busy=true;u.parseFormula(w,function(x){u.busy=false;v(x);if(u.stash.length>0){u.stash.shift()()}})})}else{u.busy=true;u.parseFormula(w,function(x){u.busy=false;v(x);if(u.stash.length>0){u.stash.shift()()}})}}};k.Cell=(function(){var v=undefined;function w(u,z,y,x){if(w.cellLoading===null){w.cellLoading=y.msg.cellLoading}if(z!==undefined&&z!==null){this.td=z;z.jSCell=this}else{this.td=null}this.dependencies=[];this.formula="";this.cellType=null;this.value="";this.valueOverride=null;this.calcCount=0;this.sheetIndex=u;this.rowIndex=null;this.columnIndex=null;this.jS=(y!==undefined?y:null);this.state=[];this.needsUpdated=true;this.uneditable=false;this.id=null;this.loader=null;this.loadedFrom=null;this.cellHandler=x;this.waitingCallbacks=[];this.parsedFormula=null;this.defer=null;this.isEdit=false;this.edited=false}w.prototype={clone:function(){var x=new w(this.sheetIndex,this.td,this.jS,this.cellHandler),u;for(u in this){if(u!==undefined&&this.hasOwnProperty(u)){if(this[u]!==null&&this[u].call===undefined){x[u]=this[u]}else{if(this[u]===null){x[u]=this[u]}}}}return x},addDependency:function(u){if(u===undefined||u===null){return}if(u.type!==k.Cell){throw new q("Wrong Type")}if(this.dependencies.indexOf(u)<0&&this!==u){this.dependencies.push(u);if(this.loader!==null){this.loader.addDependency(this,u)}}},updateValue:function(H){if(!this.needsUpdated&&this.value.cell!==v&&this.defer===null){var I=(this.valueOverride!==null?this.valueOverride:this.value);this.displayValue();if(H!==v){H.call(this,I)}if(this.waitingCallbacks.length>0){while(this.waitingCallbacks.length>0){this.waitingCallbacks.pop().call(this,I)}}return}if(this.cellType===null&&this.defer===null&&this.formula.length<1){if(this.value!==undefined&&((this.value+"").length<1||!this.hasOperator.test(this.value))){if(this.td!==null){this.td.innerHTML=this.encode(this.value)}this.value=new p(this.value);this.value.cell=this;this.needsUpdated=false;this.updateDependencies();if(H!==v){H.call(this,this.value)}if(this.waitingCallbacks.length>0){while(this.waitingCallbacks.length>0){this.waitingCallbacks.pop().call(this,this.value)}}return}}var B,G=this,x,E=this.value,C=this.formula,D=this.cellType,y,u=this.defer,F,A=function(J){G.parsedFormula=J;G.resolveFormula(J,function(K){if(K!==v&&K!==null){if(K.cell!==v&&K.cell!==G){K=K.valueOf()}k.calcStack--;if(D!==null&&(y=k.CellTypeHandlers[D])!==v){K=y(G,K)}z.call(G,K)}else{z.call(G,null)}})},z=function(J){if(J===v||J===null){J=new p()}if(J.cell===v){switch(typeof(J)){case"object":break;case"undefined":J=new p();break;case"number":J=new s(J);break;case"boolean":J=new t(J);break;case"string":default:J=new p(J);break}J.cell=G}G.value=J;x=G.displayValue().valueOf();G.state.shift();if(G.loader!==null){G.loader.setCellAttributes(G.loadedFrom,{cache:(typeof x!=="object"?x:null),formula:G.formula,parsedFormula:G.parsedFormula,value:G.value+"",cellType:G.cellType,uneditable:G.uneditable}).setDependencies(G)}G.needsUpdated=false;F=G.valueOverride!==null?G.valueOverride:G.value;if(H!==v){H.call(G,F)}if(G.waitingCallbacks.length>0){while(G.waitingCallbacks.length>0){G.waitingCallbacks.pop().call(G,F)}}G.updateDependencies()};if(this.state.length>0){if(H!==v){this.waitingCallbacks.push(H)}return}if(u!==null){u.updateValue(function(J){J=J.valueOf();switch(typeof(J)){case"object":break;case"undefined":J=new p();break;case"number":J=new s(J);break;case"boolean":J=new t(J);break;case"string":default:J=new p(J);break}J.cell=G;G.value=J;G.updateDependencies();G.needsUpdated=false;G.displayValue();if(H!==v){H.call(G,J)}if(G.waitingCallbacks.length>0){while(G.waitingCallbacks.length>0){G.waitingCallbacks.pop().call(G,J)}}});return}this.oldValue=E;this.state.unshift("updating");this.fnCount=0;this.valueOverride=null;this.calcCount++;if(C.length>0){if(C.charAt(0)==="="){G.formula=C=C.substring(1)}if(G.td!==null){while(G.td.lastChild!==null){G.td.removeChild(G.td.lastChild)}G.td.appendChild(l.createTextNode(w.cellLoading))}k.calcStack++;if(this.parsedFormula!==null){A(this.parsedFormula)}else{this.jS.parseFormula(C,A)}}else{if(E!==v&&E!==null&&D!==null&&(y=k.CellTypeHandlers[D])!==v){E=y(G,E);z(E)}else{switch(typeof E.valueOf()){case"string":B=G.startOperators[E.charAt(0)];if(B!==v){G.valueOverride=B.call(G,E)}else{B=G.endOperators[E.charAt(E.length-1)];if(B!==v){G.valueOverride=B.call(G,E)}}break;case"undefined":E="";break}z(E)}}},updateDependencies:function(){var y,u,x;y=this.dependencies;this.dependencies=[];x=y.length-1;if(x>-1){this.state.unshift("updatingDependencies");do{u=y[x];u.updateValue()}while(x-->0);this.state.shift()}if(this.dependencies.length===0){this.dependencies=y}},displayValue:function(){var x=this.value,A=this.td,z=typeof x,u=x.html,y;if(u===v){if(z==="string"||(x!==null&&z==="object"&&x.toUpperCase!==v)&&x.length>0){u=this.encode(x)}else{u=x}}if(A===v||A===null){return u}switch(typeof u){case"object":if(u===null){while(A.lastChild!==null){A.removeChild(A.lastChild)}}else{if(u.appendChild!==v){if(u.parentNode===null){while(A.lastChild!==null){A.removeChild(A.lastChild)}A.appendChild(u)}return""}}case"string":default:while(A.lastChild!==null){A.removeChild(A.lastChild)}A.appendChild(l.createTextNode(u))}return A.innerHTML},resolveFormula:function(H,F){if(typeof H==="string"){F(H)}var E=this,A=[],y=0,B=H.length,z,G=this.cellHandler,D=[],C=function(J,L){var M=[],I,K=L.length-1;if(K<0){return}do{I=L[K];switch(typeof I){case"number":M[K]=D[I];break;case"string":M[K]=I;break;case"object":if(I instanceof Array){M[K]=x(I);break}default:M[K]=I}}while(K-->0);M.unshift(J);return M},x=function(K){var L=[],J=K.length-1,I;if(J<0){return}do{I=K[J];switch(typeof I){case"number":L[J]=D[I];break;case"string":L[J]=I;break;case"object":if(I.hasOwnProperty("args")){L[J]=I;L[J].a=x(I.a);break}else{if(I instanceof Array){L[J]=x(I);break}}default:L[J]=I}}while(J-->0);return L},u;if(E.jS.s.useStack){u=function(L){var K=w.thawIndex,M=w.thaws,J,I=(typeof M[K]==="undefined");if(I){J=w.thaws[K]=new Thaw([])}else{J=M[K]}w.thawIndex++;if(w.thawIndex>w.thawLimit){w.thawIndex=0}J.add(function(){if(A.length>0){A.shift()()}else{F(E.value=(L!==v?L:null))}})}}else{u=function(I){if(A.length>0){A.shift()()}else{F(E.value=(I!==v?I:null))}}}for(;y<B;y++){z=H[y];switch(z.t){case"m":(function(I,J){A.push(function(){u(D[J]=G[I.m].apply(G,C(E,I.a)))})})(z,y);break;case"l":(function(I,J){A.push(function(){var K=C(E,I.a);K.push(function(L){u(D[J]=L)});G[I.m].apply(G,K)})})(z,y);break;case"v":(function(I,J){A.push(function(){u(D[J]=I.v)})})(z,y);break;case"cell":(function(I,J){A.push(function(){D[J]=I;u()})})(z,y);break;case v:D[y]=z;break;default:D[y]=null;throw new q("Not implemented:"+z.t);break}}u()},recurseDependencies:function(z,B){if(B>w.maxRecursion){this.recurseDependenciesFlat(z);return this}var y=0,A=this.dependencies,x,u=A.length;if(B===undefined){B=0}for(;y<u;y++){x=A[y];z.call(x);x.recurseDependencies(z,B)}return this},recurseDependenciesFlat:function(A){var B=this.dependencies,y=B.length-1,x,u,z=[];if(y<0){return}do{z.push(B[y])}while(y-->0);do{x=z[z.length-1];z.length--;A.call(x);u=x.dependencies;y=u.length-1;if(y>-1){do{z.push(u[y])}while(y-->0)}}while(z.length>0)},getAllDependencies:function(){var u=[];this.recurseDependencies(function(){u.push(this)});return u},setNeedsUpdated:function(u){if(u!==v){this.needsUpdated=u}else{this.needsUpdated=true}this.recurseDependencies(function(){this.needsUpdated=true})},encode:function(u){switch(typeof u){case"object":if(u.getMonth!==v){return globalize.format(u,"d")}return u}if(!u){return u||""}if(!u.replace){return u||""}return u.replace(/&/gi,"&amp;").replace(/>/gi,"&gt;").replace(/</gi,"&lt;").replace(/\t/g,"&nbsp;&nbsp;&nbsp ").replace(/  /g,"&nbsp; ")},addClass:function(u){var A=this.td,y,x,z=this.loadedFrom;if(A!==v){if(A.classList){A.classList.add(u)}else{A.className+=" "+u}}if(z!==v){y=(this.loader.getCellAttribute(z,"class")||"");x=y.split(" ").indexOf(u);if(x<0){y+=" "+u;this.loader.setCellAttribute(z,"class",y)}}return this},removeClass:function(u){var A=this.td,y,x,z=this.loadedFrom;if(A!==v){if(A.classList){A.classList.remove(u)}else{y=(A.className+"").split(" ");x=y.indexOf(u);if(x>-1){y.splice(x,1);A.className=y.join(" ")}}}if(z!==v){y=(this.loader.getCellAttribute(z,"class")||"").split(" ");x=y.indexOf(u);if(x>-1){y.splice(x,1);this.loader.setCellAttribute(z,"class",y.join(" "))}}return this},hasOperator:/(^[$£])|([%]$)/,startOperators:{"$":function(x,u){return this.cellHandler.fn.DOLLAR.call(this,x.substring(1).replace(Globalize.culture().numberFormat[","],""),2,u||"$")},"£":function(u){return this.startOperators["$"].call(this,u,"£")}},endOperators:{"%":function(u){return u.substring(0,this.value.length-1)/100}},type:w,typeName:"Sheet.Cell"};w.thaws=[];w.thawLimit=500;w.thawIndex=0;w.cellLoading=null;w.maxRecursion=10;return w})();k.CellHandler=(function(w){function z(u){return !isNaN(u)}var v=undefined,y=NaN;function x(B,u,A){this.jS=B;this.jSE=u;this.fn=A}x.prototype={variable:function(F,D){if(arguments.length){var C=D[0],A=D[1],E=this.jS.s.formulaVariables,B,u;switch(C.toLowerCase()){case"true":u=new t(true);u.html="TRUE";u.cell=F;return u;case"false":u=new t(false);u.html="FALSE";u.cell=F;return u}if(B=E[C]&&!A){return B}else{if(B&&A){return B[A]}else{return""}}}},time:function(u,B,A){return i.fromString(B,A)},number:function(A,u){if(isNaN(u)||u===null){u=0}switch(typeof u){case"number":return u;case"string":if(z(u)){return u*1}case"object":if(u.getMonth){return e.toCentury(u)}}return u},invertNumber:function(C,B){if(isNaN(B)){B=0}var A=this.number(C,B),u=new s(A.valueOf()*-1);if(A.html){u.html=A.html}return u},performMath:function(u,G,F,E){if(F===v||F===null){F=0}if(E===v||E===null){E=0}var D,C,H=true,A=true,J=[],I,B=function(K){return K};if(F.hasOwnProperty("cell")){F.cell.addDependency(u)}if(E.hasOwnProperty("cell")){E.cell.addDependency(u)}switch(D=(typeof F.valueOf())){case"number":break;case"string":if(z(F)){F*=1}else{H=false}break;case"object":if(F.getMonth){F=e.toCentury(F);B=e.get}else{H=false}break;default:H=false}switch(C=(typeof E.valueOf())){case"number":break;case"string":if(z(E)){E*=1}else{A=false}break;case"object":if(E.getMonth){E=e.toCentury(E)}else{A=false}break;default:A=false}if(!H&&G!=="+"){J.push("not a number: "+F);F=0}if(!A){J.push("not a number: "+E);E=0}if(J.length){}switch(G){case"+":I=F+E;break;case"-":I=F-E;break;case"/":I=F/E;if(I==Infinity||I==y){I=0}break;case"*":I=F*E;break;case"^":I=w.pow(F,E);break}return B(I)},not:function(C,B,A){var u;if(B.valueOf()!=A.valueOf()){u=new t(true);u.html="TRUE";u.cell=C}else{u=new t(false);u.html="FALSE";u.cell=C}return u},concatenate:function(B,A,u){if(A===null){A=""}if(u===null){u=""}return A.toString()+u.toString()},cellValue:function(B,A,F){var D=this.jS,E=h.parseLocation(A.c,A.r),u,C;u=D.getCell(B.sheetIndex,E.row,E.col);if(u!==null){u.addDependency(B);u.updateValue(F)}else{if(F!==v){F.call(B,0)}}return this},cellRangeValue:function(A,C,u,B){return this.remoteCellRangeValue(A,A.sheetIndex,C,u,B)},remoteCellValue:function(u,E,B,G){var A=this.jSE,C=this.jS,D=A.parseLocation(B.c,B.r),H=A.parseSheetLocation(E),F;if(H<0){H=C.getSpreadsheetIndexByTitle(E)}F=C.getCell(H,D.row,D.col);if(F!==null){F.addDependency(u);F.updateValue(G)}else{if(G!==v){G.call(u,0)}}return this},remoteCellRangeValue:function(U,W,E,A,F){var G=(typeof W==="string"?h.parseSheetLocation(W):W),V=h.parseLocation(E.c,E.r),K=h.parseLocation(A.c,A.r),L=(V.row<K.row?V.row:K.row),D=(V.row<K.row?K.row:V.row),T=(V.col<K.col?V.col:K.col),N=T,B=(V.col<K.col?K.col:V.col),S=(B-(T-1))*(D-(L-1)),O=0,I=this.jS,M=[],J,P,u,H,X,R=0,Q,C;if(G<0){G=I.getSpreadsheetIndexByTitle(W)}if(G<0){M=new p("");M.html="#NAME?";F.call(U,M);return this}X=G+"!"+E.c+E.r+":"+A.c+A.r;J=x.cellRangeCache[X];if(J!==v){P=true;Q=J.length;for(R=0;R<Q;R++){if(J[R].needsUpdated){P=false}}if(P){F.call(U,x.cellRangeCache[X]);return this}}C=I.spreadsheets[G];if(C===v){I.spreadsheets[G]=C=[]}M.rowCount=(D-L)+1;M.columnCount=(B-N)+1;for(;L<=D;L++){N=T;H=(C[L]!==v?C[L]:null);for(;N<=B;N++){if(H===null||(u=H[N])===v){u=I.getCell(G,L,N)}else{u.sheetIndex=G;u.rowIndex=L;u.columnIndex=N}if(u!==null){u.addDependency(U);(function(Y){u.updateValue(function(Z){M[Y]=Z;O++;if(O===S){x.cellRangeCache[X]=M;F.call(U,M)}})})(R++)}}}if(R!==S){throw new q("Not all cells were found and added to range")}return this},callFunction:function(C,B,A){B=B.toUpperCase();A=A||[];var D=this.fn[B],u;if(D!==v){C.fnCount++;u=D.apply(C,A)}else{u=new p();u.html="Function "+B+" Not Found"}return u},formulaParser:function(A){var u;if(A>-1){u=this.spareFormulaParsers[A];if(u===v){u=this.spareFormulaParsers[A]=Formula(this)}}else{u=this.jS.formulaParser}return u}};x.cellRangeCache={};return x})(g);k.CellTypeHandlers=(function(){var v=isNaN,u={percent:function(x,z){if(z!==z){return 0}var y=(v(z)?Globalize.parseFloat(z):z*1),w;if(!v(y)){w=new s(y);w.html=Globalize.format(y,"p");return w}return z},date:function(w,y){if(y!==y){return 0}var x=Globalize.parseDate(y);if(x===null){return y}else{w.valueOverride=x;w.html=Globalize.format(x,"d");return y}},time:function(w,y){if(y!==y){return 0}var x=Globalize.parseDate(y);if(x===null){return y}else{x.html=Globalize.format(x,"t");return x}},currency:function(x,z){if(z!==z){return 0}var y=(v(z)?Globalize.parseFloat(z):z*1),w;if(!v(y)){w=new s(y);w.html=Globalize.format(y,"c");return w}return z},number:function(x,z){if(z!==z){return 0}var y,w;if(!u.endOfNumber){y=Globalize.culture().numberFormat["."];u.endOfNumber=new b("(["+(y=="."?".":y)+"])([0-9]*?[1-9]+)?(0)*$")}if(!v(z)){w=new s(z);w.html=Globalize.format(z+"","n10").replace(u.endOfNumber,function(C,B,A){return(A?B:"")+(A||"")});return w}return z}};return u})();k.CellRange=(function(){function u(v){this.cells=v||[]}u.prototype={clone:function(){var z=[],x=this.cells,w=x.length,v,A;for(var y=0;y<w;y++){v=x[y];A=v.clone();z.push(A)}return new u(z)},type:u,typeName:"Sheet.CellRange"};return u})();k.ActionUI=(function(u,x,v,w,z){var y=function(E,D,J,K,H){this.enclosure=D;this.pane=u.createElement("div");D.appendChild(this.pane);this.max=H;this.xIndex=0;this.yIndex=0;this.scrollAxisX={};this.scrollAxisY={};this.hiddenColumns=[];if(!(this.frozenAt=K)){this.frozenAt={row:0,col:0}}this.frozenAt.row=v.max(this.frozenAt.row,0);this.frozenAt.col=v.max(this.frozenAt.col,0);var F=this,I=E.s.loader,A=this.pane,G=this.scrolledArea={row:v.max(this.frozenAt.row,1),col:v.max(this.frozenAt.col,1)},C=this.megaTable=new MegaTable({columns:35,rows:40,element:A,updateCell:function(Q,N,P){if(typeof P.jSCell==="object"&&P.jSCell!==null){P.jSCell.td=null}var M=E.getCell(E.i,Q+1,N+1);if(M===null){return}var L=E.spreadsheets[E.i]||(E.spreadsheets[E.i]=[]),O=L[Q+1]||(L[Q+1]=[]);if(!O[N+1]){O[N+1]=M}M.td=P;P.jSCell=M;I.setupTD(M.loadedFrom,P);M.updateValue()},updateCorner:function(M,L){M.entity="corner";M.col=L;M.className=E.cl.barCorner+" "+E.theme.bar},updateRowHeader:function(L,M){M.entity="left";M.className=E.cl.barLeft+" "+E.theme.bar;M.appendChild(u.createTextNode(L+1));M.parentNode.style.height=M.style.height=I.getHeight(E.i,L+1)+"px"},updateColumnHeader:function(M,N,L){N.th=N;N.col=L;N.entity="top";N.className=E.cl.barTop+" "+E.theme.bar;N.appendChild(u.createTextNode(h.columnLabelString(M+1)));L.style.width=I.getWidth(E.i,M+1)+"px"}}),B=this.infiniscroll=new Infiniscroll(A,{scroll:function(M,L){setTimeout(function(){G.col=M;G.row=L;C.update(L,M)},0)},verticalScrollDensity:5,horizontalScrollDensity:25});new MouseWheel(A,B._out);C.table.className+=" "+E.cl.table+" "+E.theme.table;C.table.setAttribute("cellSpacing","0");C.table.setAttribute("cellPadding","0");A.scroll=B._out;A.actionUI=this;A.table=C.table;A.tBody=C.tBody};y.prototype={putTdInView:function(F){var B=0,A=0,E=0,D,C;this.xIndex=0;this.yIndex=0;while((D=this.directionToSeeTd(F))!==null){C=this.scrolledArea;if(D.left){A--;this.scrollTo("x",0,C.col-1)}else{if(D.right){A++;this.scrollTo("x",0,C.col+1)}}if(D.up){E--;this.scrollTo("y",0,C.row-1)}else{if(D.down){E++;this.scrollTo("y",0,C.row+1)}}B++;if(B<25){break}}},directionToSeeTd:function(B){var A=this.pane,K={top:0,bottom:A.clientHeight,left:0,right:A.clientWidth},G=B.clientWidth,E=B.clientHeight,I={top:B.offsetTop,bottom:B.offsetTop+E,left:B.offsetLeft,right:B.offsetLeft+G},C=B.parentNode,H=this.scrolledArea;if(!B.col){return null}var J=B.barTop.cellIndex<H.col,D=C.rowIndex<H.row,F={up:D,down:I.bottom>K.bottom&&E<=A.clientHeight,left:J,right:I.right>K.right&&G<=A.clientWidth};if(F.up||F.down||F.left||F.right){return F}return null},redraw:function(){var A=this.pane.style;A.opacity=0.9999;setTimeout(function(){A.opacity=1},0)},hide:function(C,B,D){var F="#"+this.table.getAttribute("id"),E=this.pane,A=this;if(this.toggleHideStyleX===null){this.toggleHideStyleX=new k.StyleUpdater(function(){var G=this.nthCss("col",F,A.hiddenColumns,0)+this.nthCss("> td",F+" tr",A.hiddenColumns,0)+this.nthCss("> th",F+" tr",A.hiddenColumns,0);this.setStyle(G)})}E.appendChild(this.toggleHideStyleX.styleElement);this.hiddenColumns=(B!==null?B:[]);if(D!==null&&D.length>0){D.sort();this.toggleHideRowRange(C,D[0],D[D.length-1],true)}if(this.hiddenColumns.length>0){this.hiddenColumns.sort();this.toggleHideStyleX.update()}},toggleHideRow:function(A,B){this.toggleHideRowRange(A,B)},toggleHideRowRange:function(G,L,F,H){if(!L){return}if(!F){F=L}var E=G.spreadsheets,C=E[G.i],K=this.tBody,J=L,M,I,D=(H!==undefined?H:(C[L][1].td.parentNode.parentNode!==null)),A=F+1,B=null;if(D){for(;J<=F&&(M=C[J])!==undefined;J++){I=M[1].td.parentNode;if(I.parentNode!==null){K.removeChild(I)}}}else{while(B===null&&A<C.length){M=C[A++];B=M[1].td.parentNode;if(B.parentNode===null){B=null}}for(;J<=F&&(M=C[J])!==undefined;J++){I=M[1].td.parentNode;if(I.parentNode!==null){K.insertBefore(I,B)}}}},rowShowAll:function(B){var A=B.spreadsheets[B.i],C=A.length-1;this.toggleHideRowRange(B,1,C,false)},toggleHideColumn:function(A){var B;if((B=this.hiddenColumns.indexOf(A))>-1){this.hiddenColumns.splice(B,1)}else{this.hiddenColumns.push(A)}this.hiddenColumns.sort();this.toggleHideStyleX.update()},toggleHideColumnRange:function(H,G){if(!H){return}if(!G){G=H}var F=this.hiddenColumns,D=[],C=F.length,B,E=0,A=null;for(;E<C;E++){B=F[E];if(B>=H&&B<=G){if(A===null){A=true}}else{D.push(B)}}if(A===null){for(E=H;E<=G;E++){D.push(E)}}D.sort();this.hiddenColumns=D;this.toggleHideStyleX.update()},columnShowAll:function(){this.toggleHideStyleX.setStyle("");this.hiddenColumns=[]},remove:function(){},scrollToPixelX:function(B){var D=this.scrollAxisX,A,C,E=(B/this.pixelScrollDensity)>>1,F=c.indexOfNearestLessThan(this.hiddenColumns,E)+1;if(F>0){E+=F}A=D.max;D.value=E;C=E>A?A:E;return D.scrollStyle.update(C)},scrollToPixelY:function(B,D){var C=(B/this.pixelScrollDensity)>>1,A=this.yDetacher;this.yIndex=C;this.scrolledArea.row=v.max(C||1,1);if(D===true){A.attachAboveAfter(C).detachBelowAfter(C+this.maximumVisibleRows+1)}else{A.detachAboveBefore(C).attachBelowBefore(C+this.maximumVisibleRows+1)}return A.aboveChanged||A.belowChanged},scrollToCell:function(A,B){throw new q("Not yet implemented")},toggleHideStyleX:null,toggleHideStyleY:null,pixelScrollDensity:30,maximumVisibleRows:65,maximumVisibleColumns:35};return y})(l,f,g,s,d);k.SpreadsheetUI=(function(){var u=[];function v(x,y,w){w=w||{};this.i=x;this.ui=y;this.isLast=w.lastIndex===x;this.enclosure=null;this.pane=null;this.spreadsheet=null;this.initChildren=w.initChildren||function(){};this.done=w.done||function(){};this.load()}v.prototype={load:function(x,y,w){this.initChildren(this.ui,this.i);this.enclosure=x;this.pane=y;this.spreadsheet=w;u.push(this.i);if(this.isLast){this.loaded()}},loaded:function(){this.done(u,this)}};return v})();k.Theme=(function(u){function v(w){w=w||k.defaultTheme;switch(w){case k.customTheme:this.cl=v.customClasses;break;case k.bootstrapTheme:this.cl=v.bootstrapClasses;break;default:case k.themeRollerTheme:this.cl=v.themeRollerClasses;break}u.extend(this,this.cl)}v.themeRollerClasses={autoFiller:"ui-state-active",bar:"ui-widget-header",barHighlight:"ui-state-active",barHandleFreezeLeft:"ui-state-default",barHandleFreezeTop:"ui-state-default",barMenuTop:"ui-state-default",tdActive:"ui-state-active",tdHighlighted:"ui-state-highlight",control:"ui-widget-header ui-corner-top",controlTextBox:"ui-widget-content",fullScreen:"ui-widget-content ui-corner-all",inPlaceEdit:"ui-state-highlight",menu:"ui-widget-header",menuFixed:"",menuUl:"ui-widget-header",menuLi:"ui-widget-header",menuHover:"ui-state-highlight",pane:"ui-widget-content",parent:"ui-widget-content ui-corner-all",table:"ui-widget-content",tab:"ui-widget-header",tabActive:"ui-state-highlight",barResizer:"ui-state-highlight",barFreezer:"ui-state-highlight",barFreezeIndicator:"ui-state-highlight"};v.bootstrapClasses={autoFiller:"btn-info",bar:"bg-primary",barHighlight:"label-info",barHandleFreezeLeft:"bg-warning",barHandleFreezeTop:"bg-warning",barMenuTop:"bg-warning",tdActive:"active",tdHighlighted:"bg-info",control:"bg-primary",controlTextBox:"form-control",fullScreen:"",inPlaceEdit:"form-control",menu:"panel panel-default",menuFixed:"nav navbar-nav",menuUl:"panel-info",menuLi:"active",menuHover:"bg-primary active",pane:"well",parent:"panel panel-default",table:"table table-bordered table-condensed",tab:"btn-default btn-xs",tabActive:"active",barResizer:"bg-info",barFreezer:"bg-warning",barFreezeIndicator:"bg-warning"};v.customClasses={autoFiller:"",bar:"",barHighlight:"",barHandleFreezeLeft:"",barHandleFreezeTop:"",barMenuTop:"",tdActive:"",tdHighlighted:"",control:"",controlTextBox:"",fullScreen:"",inPlaceEdit:"",menu:"",menuFixed:"",menuUl:"",menuLi:"",menuHover:"",pane:"",parent:"",table:"",tab:"",tabActive:"",barResizer:"",barFreezer:"",barFreezeIndicator:""};return v})(jQuery);k.thread=(function(v){var w=0,x=[];function u(){var z=x[w],y=u.limit;if(z===undefined){z=x[w]=u.create()}else{z=x[w]}w++;if(w>y){w=0}return z}u.limit=10;u.create=function(){var y=v({parseFormula:function(z){formulaParser.yy.types=[];return formulaParser.parse(z)},streamJSONSheet:function(z,A,B){Promise.all([gR(z+A)]).then(function(H){var F=H[0],E=JSON.parse(F),G,C,D=0;if(E.pop!==undefined){E=E[0]}G=E.rows;C=G.length;E.rows=[];B("sheet",JSON.stringify(E));for(;D<C;D++){B("row",JSON.stringify(G[D]))}B()},function(C){B("error",C)})},streamJSONRows:function(A,D,E){var C=0,z=D.length,B=[];if(typeof D==="string"){B.push(gR(A+D))}else{for(;C<z;C++){B.push(gR(A+D[C]))}}Promise.all(B).then(function(K){var H=0,G,M,J,I=K,F=I.length,L;for(;H<F;H++){J=JSON.parse(I[H]);L=J.length;for(G=0;G<L;G++){M=J[G];E("row",JSON.stringify(M))}}E()},function(F){E("error",F)})},streamJSONSheetRows:function(B,A,C,F){var E=0,z=C.length,D=[gR(B+A)];if(typeof C==="string"){D.push(gR(B+C))}else{for(;E<z;E++){D.push(gR(B+C[E]))}}Promise.all(D).then(function(L){F("sheet",L[0]);var I=1,H,N,K,J=L,G=J.length,M;for(;I<G;I++){K=JSON.parse(J[I]);M=K.length;for(H=0;H<M;H++){N=K[H];F("row",JSON.stringify(N))}}F()},function(G){F("error",G)})}},[k.formulaParserUrl,k.threadScopeUrl]);y.stash=[];y.busy=false;return y};u.kill=function(){var z=0,y=x.length;for(;z<y;z++){x[z].terminate()}};return u})(f.operative);k.Highlighter=(function(u,v,w){var x=function(z,B,y,A){this.cssClass=z;this.cssClassBars=B;this.cssClassTabs=y;this.callBack=A||function(){};this.last=w([]);this.lastTop=w([]);this.lastLeft=w([]);this.lastTab=w([]);this.startRowIndex=0;this.startColumnIndex=0;this.endRowIndex=0;this.endColumnIndex=0};x.prototype={set:function(A){if(A.parentNode!==undefined){A=[A]}var y,z=this.last;if(z&&z.length>0){y=z.length-1;do{z[y].isHighlighted=false}while(y-->0)}if(A.length>0){y=A.length-1;do{if(!A[y].isHighlighted){A[y].isHighlighted=true;if(!A[y].className.match(this.cssClass)){A[y].className+=" "+this.cssClass}}}while(y-->0)}this.clear(z);this.last=A;this.callBack();return this},is:function(){return this.last.length>0},clear:function(z){if(this.is()){z=z||this.last;if(z&&z.length){var y=z.length-1;do{if(!z[y].isHighlighted){z[y].className=z[y].className.replace(this.cssClass,"");z[y].isHighlighted=false}}while(y-->0)}}this.last=w([]);return this},setBar:function(y,z){switch(y){case"top":this.lastTop.removeClass(this.cssClassBars);this.lastTop=w(z).addClass(this.cssClassBars);break;case"left":this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=w(z).addClass(this.cssClassBars);break}return this},clearBar:function(){this.lastTop.removeClass(this.cssClassBars);this.lastTop=w([]);this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=w([]);return this},setTab:function(y){this.clearTab();this.lastTab=y.addClass(this.cssClassTabs);return this},clearTab:function(){this.lastTab.removeClass(this.cssClassTabs);return this},setStart:function(y){this.startRowIndex=y.rowIndex+0;this.startColumnIndex=y.columnIndex+0;return this},setEnd:function(y){this.endRowIndex=y.rowIndex+0;this.endColumnIndex=y.columnIndex+0;return this}};return x})(l,f,jQuery);k.ColumnAdder=(function(){function u(){this.qty=-1;this.addedFinishedFn=null;this.createBarFn=null;this.createCellFn=null}u.prototype={setQty:function(x,w){var v=d.sheet.max;if(v){if(v>w.cols&&v<=w.cols+x){this.qty=v-w.cols}else{if(v&&v<=w.cols+x){return false}}}else{this.qty=x}return true},setAddedFinishedFn:function(v){this.addedFinishedFn=v},setCreateBarFn:function(v){this.createBarFn=v},setCreateCellFn:function(v){this.createCellFn=v},createCells:function(A,D,z){var y=(z?0:1),v=D.rows||1,x=A+this.qty,C,w=A,B;for(;w<x;w++){B=this.createBarFn(w+y);for(C=1;C<=v;C++){this.createCellFn(C,w+y,B)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:0,col:this.qty})}}};return u})();k.RowAdder=(function(){function u(){this.qty=-1;this.addedFinishedFn=null;this.createBar=null;this.createCell=null;this.hidden=null}u.prototype={setQty:function(y,w,x){var v=d.sheet.max;if(v){if(v>w.rows&&v<=w.rows+y){this.qty=v-w.rows}else{if(v&&v<=w.rows+y){return false}}}else{this.qty=y}return true},setAddedFinishedFn:function(v){this.addedFinishedFn=v},setCreateBarFn:function(v){this.createBar=v},setCreateCellFn:function(v){this.createCell=v},setHidden:function(v){this.hidden=v||[]},createCells:function(B,E,A){var z=(A?0:1),v=B+this.qty,y=E.cols||1,C,w,D=B,x;for(;D<v;D++){w=this.hidden.indexOf(D+z)>-1;C=this.createBar(D+z,w);for(x=1;x<=y;x++){this.createCell(D+z,x,C,w)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:this.qty,col:0})}}};return u})();(function(y){var x=undefined;function w(z,u){this.parent=z;this.maximumVisible=u;this.detachedAbove=[];this.detachedBelow=[];this.aboveChanged=false;this.belowChanged=false;this.hasInitialDetach=false}function v(D,A){var B=D.parent,z=B.children,C=D.detachedAbove.length,u;if(A<C){return}while((u=(C+(z.length-1)))>A){D.detachedBelow.unshift(B.lastChild);B.removeChild(B.lastChild)}}w.prototype={detachAboveBefore:function(B){var A,C=this.parent,z=C.children,u=this.detachedAbove;this.aboveChanged=false;while(u.length-1<B){A=z[1];if(A===x){break}u.push(A);C.removeChild(A);this.aboveChanged=true}return this},detachBelowAfter:function(A){if(!this.hasInitialDetach){this.hasInitialDetach=true;v(this,A)}var z,C=this.parent,u=this.detachedAbove.length,B=C.children;this.belowChanged=false;while(u+B.length>A){this.detachedBelow.unshift(z=C.lastChild);C.removeChild(z);this.belowChanged=true}return this},attachAboveAfter:function(z){var C=this.parent,D=l.createDocumentFragment(),B,u=this.detachedAbove,A;this.aboveChanged=false;while((A=u.length-1)>=z){B=u.pop();D.insertBefore(B,D.firstChild);this.aboveChanged=true}if(this.aboveChanged){C.insertBefore(D,C.children[1])}return this},attachBelowBefore:function(A){if(!this.hasInitialDetach){this.hasInitialDetach=true;v(this,A)}var C,B=this.parent,u=this.detachedBelow,F=l.createDocumentFragment(),E=F.children,D=this.detachedAbove.length+B.children.length,z;this.belowChanged=false;while((z=D+(E.length-1))<A&&this.detachedBelow.length>0){if(u.length<1){break}C=u.shift();F.appendChild(C);this.belowChanged=true}if(this.belowChanged){B.appendChild(F)}return this},isAboveActive:function(){return this.detachedAbove.length>0},isBelowActive:function(){return this.detachedBelow.length>0}};y.Detacher=w})(k);k.StyleUpdater=(function(u){function v(w){var x=this.styleElement=u.createElement("style");x.styleUpdater=this;this._update=w}v.prototype={setStyle:null,getStyle:null,nthCss:function(w,C,y,A,z){var B=[],x=y.length;z=z||"{display: none;}";do{if(y[x]>A){B.unshift(C+" "+w+":nth-child("+(y[x]+1)+")")}}while(x--);if(B.length){return B.join(",")+z}return""},repeat:function(y,x){var w="";while(x>0){if(x&1){w+=y}x>>=1;y+=y}return w},update:function(){return this._update.apply(this,arguments)}};if(u.createElement("style").styleSheet){v.prototype.setStyle=function(x){var y=this.styleElement,w=y.styleSheet;w.disabled=false;if(!w.disabled){w.cssText=x}};v.prototype.getStyle=function(){var x=this.styleElement,w=x.styleSheet;w.disabled=false;if(!w.disabled){return w.cssText}return""}}else{v.prototype.setStyle=function(w){this.styleElement.innerHTML=w};v.prototype.getStyle=function(){return this.styleElement.innerHTML}}return v})(l);k.Loader.HTML=(function(w,u,v){function x(y){if(y!==undefined){this.tables=y;this.count=y.length}else{this.tables=[];this.count=0}this.cellIds={};this.jS=null;this.handler=null}x.prototype={bindJS:function(y){this.jS=y;return this},bindHandler:function(y){this.handler=y;return this},size:function(C){var A={cols:0,rows:0},z=this.tables,B,D,E,y;if((B=z[C])===undefined){return A}if((D=B.querySelectorAll("tr"))===undefined){return A}if((E=D[0])===undefined){return A}if((y=E.children)===undefined){return A}return{rows:D.length,cols:y.length}},getWidth:function(y,C){var A=this.tables,D=A[y],z,B;z=D.querySelectorAll("col");if(z.length>C){B=z[C-1].style.width.replace("px","")||k.defaultColumnWidth;return B}return k.defaultColumnWidth},getHeight:function(z,E){var A=this.tables,B=A[z],C,D,y;C=B.querySelectorAll("tr");if(C.length>E){D=C[E-1];y=D.style.height.replace("px","")||k.defaultRowHeight;return y}return k.defaultRowHeight},isHidden:function(y){var z=this.tables,A=z[y];return A.style.display==="none"},setHidden:function(y,A){var z=this.tables,B=z[y];if(A){B.style.display="none"}else{B.style.display=""}return this},setupTD:function(y,z){if(y.hasAttribute("class")){z.className=y.className}if(y.hasAttribute("style")){z.setAttribute("style",y.getAttribute("style"))}if(y.hasAttribute("rowspan")){z.setAttribute("rowspan",y.getAttribute("rowspan"))}if(y.hasAttribute("colspan")){z.setAttribute("colspan",y.getAttribute("colspan"))}return this},getCell:function(z,F,B){var A=this.tables,C,D,E,y;if((C=A[z])===undefined){return null}if((D=C.querySelectorAll("tr"))===undefined){return null}if((E=D[F-1])===undefined){return null}if((y=E.children[B-1])===undefined){return null}return y},jitCell:function(K,E,C){var y=this.getCell(K,E,C);if(y===null){return null}if(y.getCell!==undefined){return y.getCell()}var J,z,H,D,F,M,I,L,A,G,B;z=y.getAttribute("id");H=y.innerHTML;D=y.getAttribute("data-formula");F=y.getAttribute("data-celltype");M=y.getAttribute("data-uneditable");I=z!==null;L=H.length>0;A=D!==null;G=F!==null;B=M!==null;J=new k.Cell(K,null,this.jS,this.handler);J.rowIndex=E;J.columnIndex=C;J.loadedFrom=y;J.loader=this;if(I){J.id=z}if(A){J.formula=D}if(G){J.cellType=F}if(B){J.uneditable=M}if(L){J.value=new v(H)}else{J.value=new v()}J.value.cell=J;y.getCell=function(){return J};return J},jitCellById:function(A,J,H){switch(this.cellIds[A]){case undefined:break;case null:return this;default:H(this.cellIds[A].requestCell());break}var G=this,I=this.tables,D=(J<0?I.length-1:J+1),K,F,y,M,L,E,z,C,B;if(J<0){J=0}for(;J<D;J++){K=I[J];M=K.querySelectorAll("tr");if(M.length<1){continue}F=0;y=M.length;for(;F<y;F++){L=M[F];C=L.children;E=0;z=C.length;for(;E<z;E++){B=C[E];if(B===null){continue}if(B.id!==null&&B.id.length>0){this.cellIds[B.id]={cell:B,sheetIndex:J,rowIndex:F+1,columnIndex:E+1,requestCell:function(){return G.jitCell(this.sheetIndex,this.rowIndex,this.columnIndex)}}}}}}if(this.cellIds[A]!==undefined){H(this.cellIds[A].requestCell())}else{this.cellIds[A]=null}return this},title:function(y){var z=this.tables,A;if((A=z[y])===undefined){return""}return A.getAttribute("title")},hiddenRows:function(y){var z=this.tables[y].getAttribute("data-hiddenrows"),A=null;if(z!==null){A=c.toNumbers(z.split(","))}return A},hiddenColumns:function(y){var z=this.tables[y].getAttribute("data-hiddencolumns"),A=null;if(z!==null){A=c.toNumbers(z.split(","))}return A},hasSpreadsheetAtIndex:function(y){return(this.tables[y]!==undefined)},getSpreadsheetIndexByTitle:function(C){var B=this.tables,y=this.count,A=0,z;C=C.toLowerCase();for(;A<y;A++){if(B[A]!==undefined){z=B[A].getAttribute("title");if(z!==undefined&&z!==null&&z.toLowerCase()==C){return A}}}return -1},addSpreadsheet:function(z,y){if(y===undefined){this.tables.push(z)}else{this.tables.splice(y,0,z)}this.count=this.table.length},getCellAttribute:function(y,z){return y.getAttribute(z)},setCellAttribute:function(y,z,A){y.setAttribute(z,A)},setCellAttributes:function(y,z){var A;for(A in z){if(A!==undefined&&z.hasOwnProperty(A)){y.setAttribute(A,z[A])}}return this},setDependencies:function(y){return this},addDependency:function(y,z){return this},cycleCells:function(E,B){var D=this.tables,F,H,y,C,G,A,z;if((F=D[E])===undefined){return}if((A=(H=F.querySelectorAll("tr")).length)<1){return}if(H[0].children.length<1){return}A--;do{G=H[A];y=G.children;z=y.length-1;do{C=y[z];B.call(C,E,A+1,z+1)}while(z-->0)}while(A-->0);return this},cycleCellsAll:function(A){var z=this.tables,y=z.length-1;if(y<0){return}do{this.cycleCells(y,A)}while(y-->0);return this},toTables:function(){return this.tables},fromSheet:function(C){C=(C==undefined?false:C);var O=[],J=this.jS,U=1*J.i,Q,H,D=J.spreadsheets.length-1,L,V,G,R,F,I,B,M,y,K,z,S,N,P,T,E,A;if(D<0){return O}do{T=false;J.i=D;J.evt.cellEditDone();Q=J.obj.pane();V=u.createElement("table");G=u.createElement("tBody");R=u.createElement("colGroup");V.setAttribute("title",J.obj.table().attr("title"));V.setAttribute("data-frozenatrow",Q.action.frozenAt.row);V.setAttribute("data-frozenatcol",Q.action.frozenAt.col);V.appendChild(R);V.appendChild(G);O.unshift(V);H=J.spreadsheets[D];I=H.length-1;do{E=H[I][1].td.parentNode;A=E.style.height;y=u.createElement("tr");y.style.height=(A?A:J.s.colMargin+"px");B=H[I].length-1;do{z=H[I][B];K=u.createElement("td");S=z.td.attributes;if(C||T||S["class"]||z.formula||z.value||S.style){T=true;N=(S["class"]?w.trim((S["class"].value||"").replace(J.cl.uiCellActive,"").replace(J.cl.uiCellHighlighted,"")):"");P=z.td.parentNode;y.insertBefore(K,y.firstChild);if(!y.style.height){y.style.height=(P.style.height?P.style.height:J.s.colMargin+"px")}if(z.formula){K.setAttribute("data-formula",z.formula)}if(z.cellType){K.setAttribute("cellType",z.cellType)}if(z.value){K.setAttribute("value",z.value)}if(z.uneditable){K.setAttribute("uneditable",z.uneditable)}if(z.cache){K.setAttribute("cache",z.cache)}if(z.id){K.setAttribute("id",z.id)}if(S.style&&S.style.value){K.setAttribute("style",S.style.value)}if(N.length){K.className=N}if(S.rowspan){K.rowspan=S.rowspan.value}if(S.colspan){K.colspan=S.colspan.value}if(I*1==1){F=u.createElement("col");F.style.width=w(J.col(null,B)).css("width");R.insertBefore(F,R.firstChild)}}}while(B-->1);if(T){G.insertBefore(y,G.firstChild)}}while(I-->1)}while(D--);J.i=U;return this.json=O},type:x,typeName:"Sheet.Loader.HTML",clearCaching:function(){return this}};x.maxStoredDependencies=100;return x})(jQuery,l,p);k.Loader.JSON=(function(x,u,v){function w(y){if(y!==undefined){this.json=y;this.count=y.length}else{this.json=[];this.count=0}this.cellIds={};this.jS=null;this.handler=null}w.prototype={bindJS:function(y){this.jS=y;return this},bindHandler:function(y){this.handler=y;return this},size:function(B){var A={cols:0,rows:0},z=this.json,D,C,E,y;if((D=z[B])===undefined){return A}if((C=D.rows)===undefined){return A}if((E=C[0])===undefined){return A}if((y=E.columns)===undefined){return A}return{rows:C.length,cols:y.length}},getWidth:function(y,C){var A=this.json,E=A[y]||{},z=E.metadata||{},D=z.widths||[],B=D[C]||k.defaultColumnWidth;return B},getHeight:function(z,E){var A=this.json,C=A[z]||{},B=C.rows||[],D=B[E]||{},y=D.height||k.defaultRowHeight;return y},isHidden:function(y){var A=this.json,B=A[y]||{},z=B.metadata||{};return z.hidden===true},setHidden:function(y,B){var A=this.json,C=A[y]||{},z=C.metadata||{};z.hidden=B;return this},setupTD:function(y,z){if(y["class"]!==undefined){z.className=y["class"]}if(y.style!==undefined){z.setAttribute("style",y.style)}if(y.rowspan!==undefined){z.setAttribute("rowspan",y.rowspan)}if(y.colspan!==undefined){z.setAttribute("colspan",y.colspan)}return this},getCell:function(z,F,B){var A=this.json,D,C,E,y;if((D=A[z])===undefined){return}if((C=D.rows)===undefined){return}if((E=C[F-1])===undefined){return}if((y=E.columns[B-1])===undefined){return}if(y===null){y=E.columns[B-1]={}}return y},jitCell:function(F,I,U){var G=this.getCell(F,I,U);if(G===undefined){return null}if(G.getCell!==undefined){return G.getCell()}var T,S,M,R,O,K,y,A,P,W,N,J,E,V,C,B,D,L,Q,z,H;M=G.id;O=G.value;K=G.cache;y=G.formula;A=G.parsedFormula;P=G.cellType;W=G.uneditable;J=G.dependencies;V=(M!==undefined&&M!==null);C=(O!==undefined&&O!==null);B=(K!==undefined&&K!==null&&(K+"").length>0);D=(y!==undefined&&y!==null&&y!=="");L=(A!==undefined&&A!==null);Q=(P!==undefined&&P!==null);z=(W!==undefined&&W!==null);H=(J!==undefined&&J!==null);T=new k.Cell(F,null,this.jS,this.handler);T.rowIndex=I;T.columnIndex=U;T.loadedFrom=G;T.loader=this;if(V){T.id=M}if(D){T.formula=y}if(L){T.parsedFormula=A}if(Q){T.cellType=P}if(z){T.uneditable=W}if(C){T.value=new v(O)}else{T.value=new v()}if(B){T.value.html=K;T.needsUpdated=false}else{T.needsUpdated=(D||Q||T.hasOperator.test(O))}if(H){R=J.length;for(S=0;S<R;S++){E=J[S];N=this.jitCell(E.s,E.r,E.c);if(N!==null){T.dependencies.push(N)}else{T.dependencies=[];G.dependencies=[];T.setNeedsUpdated(true);T.value=new v()}}}T.value.cell=T;G.getCell=function(){return T};return T},jitCellById:function(A,J,I){switch(this.cellIds[A]){case undefined:break;case null:return this;default:I(this.cellIds[A].requestCell());break}var H=this,K=this.json,D=(J<0?K.length-1:J+1),F,G,y,M,L,E,z,C,B;if(J<0){J=0}for(;J<D;J++){F=K[J];M=F.rows;if(M.length<1){continue}G=0;y=M.length;for(;G<y;G++){L=M[G];C=L.columns;E=0;z=C.length;for(;E<z;E++){B=C[E];if(B===null){continue}if(typeof B.id==="string"){this.cellIds[B.id]={cell:B,sheetIndex:J,rowIndex:G+1,columnIndex:E+1,requestCell:function(){return H.jitCell(this.sheetIndex,this.rowIndex,this.columnIndex)}}}}}}if(this.cellIds[A]!==undefined){I(this.cellIds[A].requestCell())}else{this.cellIds[A]=null}return this},title:function(y){var z=this.json,A;if((A=z[y])===undefined){return""}return A.title||""},hiddenRows:function(B){var D=this.json[B].metadata||{},A=D.hiddenRows||[],z=A.length,y=[],C=0;for(;C<z;C++){y.push(A[C])}return y},hiddenColumns:function(A){var C=this.json[A].metadata||{},D=C.hiddenColumns||[],z=D.length,y=[],B=0;for(;B<z;B++){y.push(D[B])}return y},hasSpreadsheetAtIndex:function(y){return(this.json[y]!==undefined)},getSpreadsheetIndexByTitle:function(C){var A=this.json,y=this.count,z=0,B;C=C.toLowerCase();for(;z<y;z++){if(A[z]!==undefined){B=A[z].title;if(B!==undefined&&B!==null&&B.toLowerCase()==C){return z}}}return -1},addSpreadsheet:function(z,y){if(y===undefined){this.json.push(z)}else{this.json.splice(y,0,z)}this.count=this.json.length},getCellAttribute:function(y,z){return y[z]},setCellAttribute:function(y,z,A){y[z]=A},setCellAttributes:function(y,z){var A;for(A in z){if(A!==undefined&&z.hasOwnProperty(A)){y[A]=z[A]}}return this},setDependencies:function(z){if(z.dependencies.length>w.maxStoredDependencies){delete z.loadedFrom.dependencies;return this}var C=0,E=z.loadedFrom,D=z.dependencies,B,y=D.length,A=E.dependencies=[];for(;C<y;C++){B=D[C];A.push({s:B.sheetIndex,r:B.rowIndex,c:B.columnIndex})}return this},addDependency:function(y,z){var A=y.loadedFrom;if(A.dependencies===undefined){A.dependencies=[]}A.dependencies.push({s:z.sheetIndex,r:z.rowIndex,c:z.columnIndex});return this},cycleCells:function(E,D){var F=this.json,B,H,z,y,G,C,A;if((B=F[E])===undefined){return}if((C=(H=B.rows).length)<1){return}if(H[0].columns.length<1){return}C--;do{G=H[C];z=G.columns;A=z.length-1;do{y=z[A];D.call(y,E,C+1,A+1)}while(A-->0)}while(C-->0);return this},cycleCellsAll:function(A){var z=this.json,y=z.length-1;if(y<0){return}do{this.cycleCells(y,A)}while(y-->0);return this},toTables:function(){var S=this.json,R=this.count,H=x([]),D,J,E,A,B,L,K,N,y,U,G,M,T,I,C,z,F,Q=0,P,O;for(;Q<R;Q++){D=S[Q];T=x(u.createElement("table"));if(D.title){T.attr("title",D.title||"")}H=H.add(T);J=D.rows;for(P=0;P<J.length;P++){E=J[P];if(M=(E.height+"").replace("px","")){z=x(u.createElement("tr")).attr("height",M).css("height",M+"px").appendTo(T)}A=E.columns;for(O=0;O<A.length;O++){B=A[O];F=x(u.createElement("td")).appendTo(z);if(B["class"]){F.attr("class",B["class"]||"")}if(B.style){F.attr("style",B.style||"")}if(B.formula){F.attr("data-formula",(B.formula?"="+B.formula:""))}if(B.cellType){F.attr("data-celltype",B.cellType||"")}if(B.value){F.html(B.value||"")}if(B.uneditable){F.html(B.uneditable||"")}if(B.rowspan){F.attr("rowspan",B.rowspan||"")}if(B.colspan){F.attr("colspan",B.colspan||"")}if(B.id){F.attr("id",B.id||"")}if(B.cache){F.html(B.cache)}}}if(L=D.metadata){if(K=L.widths){I=x(u.createElement("colgroup")).prependTo(T);for(O=0;O<K.length;O++){N=(K[O]+"").replace("px","");C=x(u.createElement("col")).attr("width",N).css("width",N+"px").appendTo(I)}}if(y=L.frozenAt){if(y.row){T.attr("data-frozenatrow",y.row)}if(y.col){T.attr("data-frozenatcol",y.col)}}if(U=L.hiddenRows){T.attr("data-hiddenrows",U.join(","))}if(G=L.hiddenColumns){T.attr("data-hiddencolumns",G.join(","))}}}return H},fromSheet:function(C){C=(C==undefined?false:C);var K=[],H=this.jS,Q=1*H.i,M,D=H.spreadsheets.length-1,R,F,G,B,I,P,A,y,N,J,L,O,E,z;if(D<0){return K}do{O=false;H.i=D;H.evt.cellEditDone();M=H.obj.pane();R={title:(H.obj.table().attr("title")||""),rows:[],metadata:{widths:[],frozenAt:{row:M.actionUI.frozenAt.row,col:M.actionUI.frozenAt.col}}};K.unshift(R);F=H.spreadsheets[D];G=F.length-1;do{E=F[G][1].td.parentNode;z=E.style.height;P={columns:[],height:(z?z.replace("px",""):H.s.colMargin)};B=F[G].length-1;do{y=F[G][B];A={};N=y.td.attributes;if(C||O||N["class"]||y.formula||y.value||N.style){O=true;J=(N["class"]?x.trim((N["class"].value||"").replace(H.cl.uiCellActive,"").replace(H.cl.uiCellHighlighted,"")):"");L=y.td.parentNode;P.columns.unshift(A);if(!P.height){P.height=(L.style.height?L.style.height.replace("px",""):H.s.colMargin)}if(y.formula){A.formula=y.formula}if(y.cellType){A.cellType=y.cellType}if(y.value){A.value=y.value}if(y.uneditable){A.uneditable=y.uneditable}if(y.cache){A.cache=y.cache}if(y.id){A.id=y.id}if(N.style&&N.style.value){A.style=N.style.value}if(J.length){A["class"]=J}if(N.rowspan){A.rowspan=N.rowspan.value}if(N.colspan){A.colspan=N.colspan.value}if(G*1==1){R.metadata.widths.unshift(x(H.col(null,B)).css("width").replace("px",""))}}}while(B-->1);if(O){R.rows.unshift(P)}}while(G-->1)}while(D--);H.i=Q;return this.json=K},type:w,typeName:"Sheet.JSONLoader",clearCaching:function(){var H=this.json,A,I,J,B,C,G=0,F,E,D=H.length,y,z;for(;G<D;G++){A=H[G];J=A.rows;y=J.length;for(F=0;F<y;F++){I=J[F];C=I.columns;z=C.length;for(E=0;E<z;E++){B=C[E];if(B===null){continue}delete B.cache;delete B.dependencies;delete B.parsedFormula}}}return this},download:function(F){F=F||500;var L=f.open(),E,K,M=this.json,C=0,J=M.length-1,z;if(L!==undefined){E=L.document;E.write('<html>	<head id="head"></head>	<body>		<div id="entry">		</div>	</body></html>');K=x(E.getElementById("entry"));while(C<=J){z=M[C];if(z.rows.length>F){var I={title:z.title,metadata:z.metadata,rows:[]},D=[],H=0,O,N=z.rows,G=N.length,B=1,y=0,A=function(Q,P){K.append(u.createElement("br"));K.append(x(u.createElement("a")).attr("download",z.title+"-part"+P+".json").attr("href",URL.createObjectURL(new Blob([JSON.stringify(Q)],{type:"application/json"}))).text(z.title+" - part "+P))};A(I,B);while(H<G){if(y===F){y=0;B++;A(D,B);D=[]}D.push(N[H]);y++;H++}if(D.length>0){B++;A(D,B)}}else{K.append(u.createElement("br")).append(x(u.createElement("a")).attr("download",z.title+".json").attr("href",URL.createObjectURL(new Blob([JSON.stringify(z)],{type:"application/json"}))).text(z.title))}C++}E.close();L.focus()}}};w.maxStoredDependencies=100;return w})(jQuery,l,p);k.Loader.XML=(function(v,u){function w(x){if(x!==undefined){this.xml=v.parseXML(x);this.spreadsheets=this.xml.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet");this.count=this.xml.length}else{this.xml=null;this.spreadsheets=null;this.count=0}}w.prototype={size:function(z){var x=this.xml[z],A=x.rows,B=A[0],y=B.columns;return{rows:A.length,cols:y.length}},setWidth:function(F,C,A){var B=this.spreadsheets,E=B[F],D=E.getElementsByTagName("metadata")[0]||{},y=D.getElementsByTagName("width")||[],z=y[C],x=(z.textContent||z.text);A.style.width=x+"px"},setRowHeight:function(y,E,C){var A=this.spreadsheets,z,B,D,x;if((z=A[y])===undefined){return}if((B=z.getElementsByTagName("rows")[0].getElementsByTagName("row"))===undefined){return}if((D=B[E])===undefined){return}if((x=D.attributes.height.nodeValue)===undefined){return}C.style.height=x+"px"},setupCell:function(F,A,z,x,B){var y=this.spreadsheets,E,G,C,D;if((E=y[F])===undefined){return false}if((G=E.getElementsByTagName("rows")[0].getElementsByTagName("row")[A-1])===undefined){return false}if((C=G.getElementsByTagName("columns")[0].getElementsByTagName("column")[z-1])===undefined){return false}x.cellType=C.attributes.cellType.nodeValue||"";if((D=C.jitCell)!==undefined){x.html=D.html;x.state=D.state;x.cellType=D.cellType;x.value=D.value;x.uneditable=D.uneditable;x.sheet=D.sheet;x.dependencies=D.dependencies}if(C.attributes.formula){x.formula=C.attributes.formula.nodeValue||"";B.setAttribute("data-formula",C.attributes.formula.nodeValue||"")}else{B.innerHTML=x.value=C.attributes.value.nodeValue||""}B.className=C.attributes["class"].nodeValue||"";B.setAttribute("style",C.attributes.style.nodeValue||"");if(C.attributes.rowspan){B.setAttribute("rowspan",C.attributes.rowspan.nodeValue||"")}if(C.attributes.colspan){B.setAttribute("colspan",C.attributes.colspan.nodeValue||"")}return true},getCell:function(x,z,y){return null},jitCell:function(y,D,B){var A=this.spreadsheets,z,C,x;if((z=A[y])===undefined){return false}if((C=z.getElementsByTagName("rows")[0].getElementsByTagName("row")[D-1])===undefined){return false}if((x=C.getElementsByTagName("columns")[0].getElementsByTagName("column")[B-1])===undefined){return false}return{td:{cellIndex:B,parentNode:{rowIndex:D},html:function(){}},html:[],state:[],cellType:x.attributes.cellType.nodeValue||"",formula:x.attributes.formula.nodeValue||"",value:x.attributes.value.nodeValue||"",type:"cell",sheet:y,id:null}},title:function(y){var z=this.spreadsheets,x;if((x=z[y])===undefined){return""}return(x.attributes.title?x.attributes.title.nodeValue:"")},getSpreadsheetIndexByTitle:function(x){},addSpreadsheet:function(x,y){if(y===undefined){this.spreadsheets.append.push(jsonSpreadsheet)}else{this.json.splice(y,0,jsonSpreadsheet)}this.count=this.json.length},setCellAttribute:function(x,y,z){},toTables:function(){var E=this.xml,I=v([]),C=E.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet"),F,M,G,A,D,V,P,ab,O,L,N,S,Q;for(var Y=0;Y<C.length;Y++){F=C[Y];var aa=v(u.createElement("table")).attr("title",(F.attributes.title?F.attributes.title.nodeValue:"")),K=v(u.createElement("colgroup")).appendTo(aa),y=v(u.createElement("tbody")).appendTo(aa);I=I.add(aa);M=F.getElementsByTagName("rows")[0].getElementsByTagName("row");P=F.getElementsByTagName("metadata")[0];for(var W=0;W<M.length;W++){G=M[W];var z=v(u.createElement("tr")).appendTo(y);if(Q=G.attributes.height){Q=(Q.nodeValue||"").replace("px","");z.css("height",Q).attr("height",Q+"px")}A=G.getElementsByTagName("columns")[0].getElementsByTagName("column");for(var U=0;U<A.length;U++){D=A[U];var H=v(u.createElement("td")).appendTo(z),x=D.getElementsByTagName("formula")[0],X=D.getElementsByTagName("cellType")[0],T=D.getElementsByTagName("value")[0],Z=D.getElementsByTagName("style")[0],J=D.getElementsByTagName("class")[0],ac=D.getElementsByTagName("rowspan")[0],B=D.getElementsByTagName("colspan")[0],R=D.getElementsByTagName("id")[0];if(x){H.attr("data-formula","="+(x.textContent||x.text))}if(X){H.attr("data-celltype",X.textContent||X.text)}if(T){H.html(T.textContent||T.text)}if(Z){H.attr("style",Z.textContent||Z.text)}if(J){H.attr("class",J.textContent||J.text)}if(ac){H.attr("rowspan",ac.textContent||ac.text)}if(B){H.attr("colspan",B.textContent||B.text)}if(R){H.attr("id",R.textContent||R.text)}}}N=P.getElementsByTagName("width");for(var W=0;W<N.length;W++){S=(N[W].textContent||N[W].text).replace("px","");v(u.createElement("col")).attr("width",S).css("width",S+"px").appendTo(K)}ab=P.getElementsByTagName("frozenAt")[0];if(ab){L=ab.getElementsByTagName("col")[0];O=ab.getElementsByTagName("row")[0];if(L){aa.attr("data-frozenatcol",(L.textContent||L.text)*1)}if(O){aa.attr("data-frozenatrow",(O.textContent||O.text)*1)}}}return I},fromSheet:function(J,D,E){D=(D==undefined?false:D);var M="",T=1*J.i,F=J.spreadsheets.length-1,y,H,I,C,K,R,S,A,z,P,L,N,x,Q,O,G,B;if(F<0){return M}do{Q=false;J.i=F;J.evt.cellEditDone();x=v.extend({},J.obj.pane().actionUI.frozenAt);O=[];H=J.spreadsheets[F];I=H.length-1;R="";do{A="";C=H[I].length-1;do{S="";z=H[I][C];P=z.td[0].attributes;L=(P["class"]?v.trim((P["class"].value||"").replace(J.cl.uiCellActive,"").replace(J.cl.uiCellHighlighted,"")):"");if(D||Q||L||z.formula||z.value||P.style){Q=true;S+="<column>";if(z.formula){S+="<formula>"+z.formula+"</formula>"}if(z.cellType){S+="<cellType>"+z.cellType+"</cellType>"}if(z.value){S+="<value>"+z.value+"</value>"}if(P.style){S+="<style>"+P.style.value+"</style>"}if(L){S+="<class>"+L+"</class>"}if(P.rowspan){S+="<rowspan>"+P.rowspan.value+"</rowspan>"}if(P.colspan){S+="<colspan>"+P.colspan.value+"</colspan>"}if(P.id){S+="<id>"+P.id.value+"</id>"}S+="</column>";A=S+A;if(I*1==1){O[C]="<width>"+v(J.col(null,C)).css("width").replace("px","")+"</width>"}}}while(C-->1);if(A){G=H[I][1].td[0].parentNode;B=G.style.height;R='<row height="'+(B?B.replace("px",""):J.s.colMargin)+'"><columns>'+A+"</columns></row>"+R}}while(I-->1);y='<spreadsheet title="'+(J.obj.table().attr("title")||"")+'"><rows>'+R+"</rows><metadata>"+(x.row||x.col?"<frozenAt>"+(x.row?"<row>"+x.row+"</row>":"")+(x.col?"<col>"+x.col+"</col>":"")+"</frozenAt>":"")+"<widths>"+O.join("")+"</widths></metadata></spreadsheet>";M=y+M}while(F--);J.i=T;M='<?xml version="1.0" encoding="UTF-8"?><spreadsheets xmlns="http://www.w3.org/1999/xhtml">'+M+"</spreadsheets>";if(E!==true){this.xml=v.parseXML(M)}return M},type:w,typeName:"Sheet.XMLLoader"};return w})(jQuery,l);d.fn.extend({sheet:function(v){var w=isNaN,u=d.sheet.events;d(this).each(function(){var A=d(this),C=d.extend(true,{},d.sheet.defaults,v||{}),B=this.jS;C.useStack=(f.thaw===undefined?false:C.useStack);C.useMultiThreads=(f.operative===undefined?false:C.useMultiThreads);if(B){var y=A.children().detach();B.kill();A.html(y);for(var z in u){if(u.hasOwnProperty(z)){A.unbind(u[z])}}}C.parent=A;if((this.className||"").match(/\bnot-editable\b/i)!=null){C.editable=false}for(var x in u){if(u.hasOwnProperty(x)){A.bind(u[x],C[u[x]])}}A.children().each(function(E){var F=this.getAttribute("data-frozenatrow")*1,D=this.getAttribute("data-frozenatcol")*1;if(!C.frozenAt[E]){C.frozenAt[E]={row:0,col:0}}if(F){C.frozenAt[B.i].row=F}if(D){C.frozenAt[B.i].col=D}});if(!d.sheet.instance.length){d.sheet.instance=[]}this.jS=B=d.sheet.createInstance(C,d.sheet.instance.length);d.sheet.instance.push(B)});return this},disableSelectionSpecial:function(){this.each(function(){this.onselectstart=function(){return false};this.unselectable="on";this.style["-moz-user-select"]="none"});return this},getSheet:function(){var u=this[0],v=(u.jS||{});return v},getCellValue:function(v,A,w,z){var x=this[0],y=(x.jS||{}),u;if(y.getCell){u=y.getCell(v,A,w);if(u!==null){u.updateValue(z)}}return this},setCellValue:function(y,x,z,C,B){var w=this[0],u=(w.jS||{}),A;C=(C||0);if(u.getCell&&(A=u.getCell(C,x,z))){try{if((y+"").charAt(0)=="="){A.valueOverride=A.value="";A.formula=y.substring(1)}else{A.value=y;A.valueOverride=A.formula=""}A.updateValue(B)}catch(v){}}return this},setCellFormula:function(w,y,z,C,B){var x=this[0],u=(x.jS||{}),A;C=(C||0);if(u.getCell){try{A=u.getCell(C,y,z);if(A!==null){A.formula=w;A.valueOverride=A.value="";A.updateValue(B)}}catch(v){}}return this},isSheetFullScreen:function(){var u=this[0],v=(u.jS||{});if(v.obj){return v.obj.fullScreen().is(":visible")}return false},serializeCellInputs:function(v){var w=this[0],x=(w.jS||{}),u=x.obj.tables().find(":input");if(v){return u.serializeArray()}else{return u.serialize()}},viewSource:function(u){var v="";d(this).each(function(){if(u){v+=d(this).toPrettySource()}else{v+=d(this).toCompactSource()}});d.printSource(v);return v},toCompactSource:function(){var y=this[0];var v="";if(y.nodeType==1){v+="<"+y.tagName.toLowerCase();var A=y.attributes.length;for(var x=0;x<A;x++){var w=y.attributes[x].name,z=y.getAttribute(w);if(z){if(w=="contentEditable"&&z=="inherit"){continue}if(typeof(z)=="string"){v+=" "+w+'="'+z.replace(/"/g,"'")+'"'}else{if(w=="style"&&z.cssText){v+=' style="'+z.cssText+'"'}}}}if(y.tagName=="COL"){v+="/>"}else{v+=">";var u="";d(y.childNodes).each(function(){u+=d(this).toCompactSource()});v+=u;v+="</"+y.tagName.toLowerCase()+">"}}else{if(y.nodeType==3){v+=y.data.replace(/^\s*(.*)\s*$/g,"$1")}}return v},toPrettySource:function(z){var y=this[0],B,x;z=z||"";var v="";if(y.nodeType==1){v+="\n"+z+"<"+y.tagName.toLowerCase();B=y.attributes.length;for(x=0;x<B;x++){var w=y.attributes[x].name,A=y.getAttribute(w);if(A){if(w=="contentEditable"&&A=="inherit"){continue}if(typeof(A)=="string"){v+=" "+w+'="'+d.trim(A.replace(/"/g,"'"))+'"'}else{if(w=="style"&&A.cssText){v+=' style="'+d.trim(A.cssText)+'"'}}}}if(y.childNodes.length<=0){if(y.tagName=="COL"){v+="/>"}else{v+="></"+y.tagName.toLowerCase()+">"}}else{v+=">";var u="";B=y.childNodes.length;for(x=0;x<B;x++){u+=d(y.childNodes[x]).toPrettySource(z+"  ")}v+=u;if(u.indexOf("\n")>=0){v+="\n"+z}v+="</"+y.tagName.toLowerCase()+">"}}else{if(y.nodeType==3){v+=y.data.replace(/^\s*(.*)\s*$/g,"$1")}}return v}});d.sheet={defaults:{editable:true,editableNames:true,barMenus:true,freezableCells:true,allowToggleState:true,menuLeft:null,menuRight:null,newColumnWidth:120,title:null,calcOff:false,lockFormulas:false,parent:null,colMargin:20,boxModelCorrection:2,formulaFunctions:{},formulaVariables:{},cellSelectModel:k.excelSelectModel,autoAddCells:true,resizableCells:true,resizableSheet:true,autoFiller:true,minSize:{rows:1,cols:1},error:function(u){return u.error},endOfNumber:false,frozenAt:[],contextmenuTop:{"Insert column after":function(u){u.controlFactory.addColumn(u.colLast);return false},"Insert column before":function(u){u.controlFactory.addColumn(u.colLast,true);return false},"Add column to end":function(u){u.controlFactory.addColumn();return false},"Delete this column":function(u){u.deleteColumn();return false},"Hide column":function(u){u.toggleHideColumn();return false},"Show all columns":function(u){u.columnShowAll()},"Toggle freeze columns to here":function(w){var u=w.getTdLocation(w.obj.tdActive()).col,v=w.obj.pane().actionUI;v.frozenAt.col=(v.frozenAt.col==u?0:u)}},contextmenuLeft:{"Insert row after":function(u){u.controlFactory.addRow(u.rowLast);return false},"Insert row before":function(u){u.controlFactory.addRow(u.rowLast,true);return false},"Add row to end":function(u){u.controlFactory.addRow();return false},"Delete this row":function(u){u.deleteRow();return false},"Hide row":function(u){u.toggleHideRow(u);return false},"Show all rows":function(u){u.rowShowAll()},"Toggle freeze rows to here":function(v){var w=v.getTdLocation(v.obj.tdActive()).row,u=v.obj.pane().actionUI;u.frozenAt.row=(u.frozenAt.row==w?0:w)}},contextmenuCell:{"Insert row after":function(u){u.controlFactory.addRow(u.rowLast);return false},"Insert row before":function(u){u.controlFactory.addRow(u.rowLast,true);return false},"Add row to end":function(u){u.controlFactory.addRow();return false},"Delete this row":function(u){u.deleteRow();return false},line2:"line","Insert column after":function(u){u.controlFactory.addColumn(u.colLast);return false},"Insert column before":function(u){u.controlFactory.addColumn(u.colLast,true);return false},"Add column to end":function(u){u.controlFactory.addColumn();return false},"Delete this column":function(u){u.deleteColumn();return false},line3:"line","Add spreadsheet":function(u){u.addSheet()},"Delete spreadsheet":function(u){u.deleteSheet()}},hiddenRows:[],hiddenColumns:[],alert:function(u){alert(u)},prompt:function(v,w,u){w(prompt(v,u))},confirm:function(w,u,v){if(confirm(w)){u()}else{if(v){v()}}},initCalcRows:50,initCalcCols:15,initScrollRows:0,initScrollCols:0,loader:null,useStack:true,useMultiThreads:true},instance:[],dependencies:{coreCss:{css:"jquery.sheet.css"},jQueryUI:{script:"jquery-ui/jquery-ui.min.js",thirdParty:true},jQueryUIThemeRoller:{css:"jquery-ui/themes/smoothness/jquery-ui.min.css",thirdParty:true},globalize:{script:"globalize/lib/globalize.js",thirdParty:true},nearest:{script:"jquery-nearest/src/jquery.nearest.min.js",thirdParty:true},mousewheel:{script:"MouseWheel/MouseWheel.js",thirdParty:true},operative:{script:"operative/dist/operative.js",thirdParty:true}},optional:{advancedFn:{script:"plugins/jquery.sheet.advancedfn.js"},financeFn:{script:"plugins/jquery.sheet.financefn.js"},colorPicker:{css:"really-simple-color-picker/colorPicker.css",script:"really-simple-color-picker/jquery.colorPicker.min.js",thirdParty:true},elastic:{script:"jquery-elastic/jquery.elastic.source.js",thirdParty:true},globalizeCultures:{script:"globalize/lib/cultures/globalize.cultures.js",thirdParty:true},raphael:{script:"raphael/raphael.js",thirdParty:true},gRaphael:{script:"graphael/g.raphael.js",thirdParty:true},gRaphaelBar:{script:"graphael/g.bar.js",thirdParty:true},gRaphaelDot:{script:"graphael/g.dot.js",thirdParty:true},gRaphaelLine:{script:"graphael/g.line.js",thirdParty:true},gRaphaelPie:{script:"graphael/g.pie.js",thirdParty:true},thaw:{script:"thaw.js/thaw.js",thirdParty:true},undoManager:{script:"Javascript-Undo-Manager/js/undomanager.js",thirdParty:true},zeroClipboard:{script:"zeroclipboard/dist/ZeroClipboard.min.js",thirdParty:true}},events:["sheetAddRow","sheetAddColumn","sheetSwitch","sheetRename","sheetTabSortStart","sheetTabSortUpdate","sheetCellEdit","sheetCellEdited","sheetCalculation","sheetAdd","sheetDelete","sheetDeleteRow","sheetDeleteColumn","sheetOpen","sheetAllOpened","sheetSave","sheetFullScreen","sheetFormulaKeydown"],preLoad:function(x,w){x=x||"";w=d.extend({skip:["globalizeCultures"],thirdPartyDirectory:"bower_components/"},w);var v=d("script:first"),u=function(){var y;if(this.script!==undefined){y=l.createElement("script");y.src=x+(this.thirdParty?w.thirdPartyDirectory:"")+this.script;v.after(y)}if(this.css!==undefined){y=l.createElement("link");y.rel="stylesheet";y.type="text/css";y.href=x+(this.thirdParty?w.thirdPartyDirectory:"")+this.css;v.after(y)}};d.each(this.dependencies,u);d.each(this.optional,u)},createInstance:function(K,E){var v=d(f),x=d(l),C=l.body,z=d(C),F=function(){},J=undefined,D=g,w=isNaN,H=NaN,A=(d.sheet.defaults.useStack&&f.thaw!==J?f.thaw:function(I,M){M=M||{};var N=0,u=I.length,O,P=M.each||function(){},L=M.done||function(){};if(I[0].call!==J){for(;N<u;N++){O=I[N];O()}}else{for(;N<u;N++){O=I[N];P.apply(O)}L()}}),B={version:"4.x",i:0,I:E,sheetCount:0,spreadsheets:[],controls:{autoFiller:[],bar:{helper:[],corner:[],x:{controls:[],handleFreeze:[],menu:[],menuParent:[],parent:[],th:[],ths:function(){var I=[],M=0,L=this.th[B.i],u=L.length;for(;M<u;M++){I.push(L[M])}return I}},y:{controls:[],handleFreeze:[],menu:[],parent:[],th:[],ths:function(){var I=[],M=0,L=this.th[B.i],u=L.length;for(;M<u;M++){I.push(L[M])}return I}}},barMenuLeft:[],barMenuTop:[],barLeft:[],barTop:[],barTopParent:[],chart:[],tdMenu:[],cellsEdited:[],enclosures:[],formula:null,fullScreen:null,header:null,inPlaceEdit:[],inputs:[],label:null,menuLeft:[],menuRight:[],menus:[],pane:[],panes:null,scrolls:null,sheetAdder:null,tab:[],tabContainer:null,tabs:null,title:null,toggleHide:{x:[],y:[]},ui:null},obj:{autoFiller:function(){return B.controls.autoFiller[B.i]||d([])},barCorner:function(){return B.controls.bar.corner[B.i]||d([])},barHelper:function(){return B.controls.bar.helper[B.i]||(B.controls.bar.helper[B.i]=d([]))},barLeft:function(u){return(B.controls.bar.y.th[B.i]&&B.controls.bar.y.th[B.i][u]?B.controls.bar.y.th[B.i][u]:[])},barLeftControls:function(){return B.controls.bar.y.controls[B.i]||d([])},barLefts:function(){return B.controls.bar.y.ths()},barHandleFreezeLeft:function(){return B.controls.bar.y.handleFreeze[B.i]||d([])},barMenuLeft:function(){return B.controls.bar.y.menu[B.i]||d([])},barTop:function(u){return(B.controls.bar.x.th[B.i]&&B.controls.bar.x.th[B.i][u]?B.controls.bar.x.th[B.i][u]:[])},barTopControls:function(){return B.controls.bar.x.controls[B.i]||d([])},barTops:function(){return B.controls.bar.x.ths()},barTopParent:function(){return B.controls.bar.x.parent[B.i]||d([])},barHandleFreezeTop:function(){return B.controls.bar.x.handleFreeze[B.i]||d([])},barMenuParentTop:function(){return B.controls.bar.x.menuParent[B.i]||d([])},barMenuTop:function(){return B.controls.bar.x.menu[B.i]||d([])},tdActive:function(){return B.cellLast!==null?B.cellLast.td:null},cellActive:function(){return B.cellLast},tdMenu:function(){return B.controls.tdMenu[B.i]||d([])},cellsEdited:function(){return(B.controls.cellsEdited!==J?B.controls.cellsEdited:B.controls.cellsEdited=[])},chart:function(){return B.controls.chart[B.i]||d([])},enclosure:function(){return B.controls.enclosures[B.i]||[]},enclosures:function(){return B.controls.enclosures||[]},formula:function(){return B.controls.formula||d([])},fullScreen:function(){return B.controls.fullScreen||d([])},header:function(){return B.controls.header||d([])},highlighted:function(){return B.highlighter.last||d([])},menuRight:function(){return B.controls.menuRight[B.i]||d([])},inPlaceEdit:function(){return B.controls.inPlaceEdit[B.i]||d([])},inputs:function(){return B.controls.inputs[B.i]||d([])},label:function(){return B.controls.label||d([])},menus:function(){return B.controls.menus[B.i]||d([])},menuLeft:function(){return B.controls.menuLeft[B.i]||d([])},pane:function(){return B.controls.pane[B.i]||{}},panes:function(){return B.controls.panes||d([])},parent:function(){return K.parent},scrolls:function(){return B.controls.scrolls||d([])},sheetAdder:function(){return B.controls.sheetAdder||d([])},tab:function(){return B.controls.tab[B.i]||d([])},tabs:function(){return B.controls.tabs||d([])},tabContainer:function(){return B.controls.tabContainer||d([])},title:function(){return B.controls.title||d([])}},id:"jS_"+E+"_",cl:{autoFiller:"jSAutoFiller",autoFillerHandle:"jSAutoFillerHandle",autoFillerCover:"jSAutoFillerCover",barCorner:"jSBarCorner",barController:"jSBarController",barControllerChild:"jSBarControllerChild",barHelper:"jSBarHelper",barLeft:"jSBarLeft",barHandleFreezeLeft:"jSBarHandleFreezeLeft",barTop:"jSBarTop",barTopMenuButton:"jSBarTopMenuButton",barHandleFreezeTop:"jSBarHandleFreezeTop",barTopParent:"jSBarTopParent",chart:"jSChart",formula:"jSFormula",formulaParent:"jSFormulaParent",header:"jSHeader",fullScreen:"jSFullScreen",inPlaceEdit:"jSInPlaceEdit",menu:"jSMenu",menuFixed:"jSMenuFixed",parent:"jSParent",scroll:"jSScroll",sheetAdder:"jSSheetAdder",table:"jS",label:"jSLoc",pane:"jSEditPane",tab:"jSTab",tabContainer:"jSTabContainer",tabContainerScrollable:"jSTabContainerScrollable",tdMenu:"jSTdMenu",title:"jSTitle",enclosure:"jSEnclosure",ui:"jSUI"},msg:{addRowMulti:"How many rows would you like to add?",addColumnMulti:"How many columns would you like to add?",cellFind:"What are you looking for in this spreadsheet?",cellNoFind:"No results found.",dragToFreezeCol:"Drag to freeze column",dragToFreezeRow:"Drag to freeze row",addSheet:"Add a spreadsheet",openSheet:"Are you sure you want to open a different sheet?  All unsaved changes will be lost.",toggleHideRow:"No row selected.",toggleHideColumn:"No column selected.",loopDetected:"Loop Detected",newSheetTitle:"What would you like the sheet's title to be?",notFoundColumn:"Column not found",notFoundRow:"Row not found",notFoundSheet:"Sheet not found",setCellRef:"Enter the name you would like to reference the cell by.",sheetTitleDefault:"Spreadsheet {index}",cellLoading:"Loading..."},kill:function(){if(!B){return false}d(l).unbind("keydown");this.obj.fullScreen().remove();(this.obj.inPlaceEdit().destroy||F)();K.parent.trigger("sheetKill").removeClass(B.theme.parent).html("");delete K.parent[0].jS;this.obj.menus().remove();var u=d.sheet.events.length;for(var I=0;I<u;I++){K.parent.unbind(d.sheet.events[I])}d.sheet.instance.splice(E,1);return true},trigger:function(u,I){I=I||[];return K.parent.triggerHandler(u,[B].concat(I))},spreadsheetsToArray:function(u){if(u||B.spreadsheets.length==0){B.cycleCellsAll(function(L,M,I){B.createCell(L,M,I)})}return B.spreadsheets},spreadsheetToArray:function(I,u){u=(u?u:B.i);if(!B.spreadsheets[u]){B.cycleCells(function(M,N,L){B.createCell(M,N,L)})}return B.spreadsheets[u]},createCell:function(O,R,T,Y){throw new q("Being refactored");var L,P,S,W,aa,V,M,N,I,Q,ac,ab,u,X,Z,ad,U;if((L=B.spreadsheets[O])===J){L=B.spreadsheets[O]=[]}if((P=L[R])===J){P=L[R]=[]}if((aa=B.controls.tables[O])===J){return null}if((N=aa.tBody)===J){return null}if((I=N.children[R])===J){return null}if((Q=I.children[T])===J){return null}S=P[T]=Q.jSCell=new k.Cell(O,Q,B,B.cellHandler);S.sheetIndex=O;S.rowIndex=R;S.columnIndex=T;u=Q.getAttribute("data-formula");X=Q.getAttribute("data-celltype");ad=Q.getAttribute("data-uneditable");U=Q.getAttribute("id");if(u!==null){S.formula=u}if(X!==null){S.cellType=X;Z=true}if(ad!==null){S.uneditable=ad}if(U!==null){S.id=U}W=Q.textContent||Q.innerText;switch(typeof(W)){case"object":break;case"undefined":W=new p();break;case"number":S.value=new s(W);break;case"boolean":S.value=new t(W);break;case"string":default:S.value=new p(W);break}S.value.cell=S;S.calcCount=Y||0;S.needsUpdated=S.formula.length>0||Z;if(S.formula.length>0&&S.formula.charAt(0)=="="){S.formula=S.formula.substring(1)}V=aa.colGroup;if((M=V.children[T])===J){M=l.createElement("col");M.setAttribute("style","width:"+B.s.newColumnWidth+"px;");V.appendChild(M)}if((ab=B.controls.bar.y.th[O])===J){ab=B.controls.bar.y.th[O]=[]}if(ab[R]===J){ab[R]=I.children[0]}if((ac=B.controls.bar.x.th[O])===J){ac=B.controls.bar.x.th[O]=[]}if(ac[T]!==J){ac[T]=N.children[0].children[T]}return S},getCell:function(L,O,M){var I,N,u;if((I=B.spreadsheets[L])===J||(N=I[O])===J||(u=N[M])===J){if(K.loader!==null){u=K.loader.jitCell(L,O,M)}else{u=B.createCell(L,O,M)}}if(u===J||u===null){return null}u.sheetIndex=L;u.rowIndex=O;u.columnIndex=M;return u},getCellById:function(N,L,O){var I=K.loader,u,M;if(I!==null){if(typeof L==="function"){M=-1;O=L}else{M=L;if(typeof M==="string"){M=I.getSpreadsheetIndexByTitle(M)}}if(B.isBusy()){B.whenNotBusy(function(){I.jitCellById(N,M,O)})}else{I.jitCellById(N,M,O)}}else{throw new q("Not yet implemented")}return this},getCells:function(u,R,S){var L=0,O=u.length,I=O-1,P,U,Q,T=[],N=0,M;if(typeof R==="function"){M=-1;S=R}else{M=R;if(typeof M==="string"){M=loader.getSpreadsheetIndexByTitle(M)}}B.whenNotBusy(function(){for(;L<O;L++){P=u[L];if(typeof P==="string"){(function(V){B.getCellById(P,M,function(W){T[V]=W;N++;if(N===O){S.apply(B,T)}})})(L)}else{U=P;Q=B.getCell(U.sheet,U.rowIndex,U.columnIndex);if(Q!==null){T[L]=Q;N++;if(N===O){S.apply(B,T)}}}}});return this},updateCells:function(L,u,M){var I;if(typeof u==="function"){I=-1;M=u}else{I=u;if(typeof I==="string"){I=loader.getSpreadsheetIndexByTitle(I)}}B.getCells(L,I,function(){var P=arguments,N=P.length,R=N-1,O=[],Q=0;for(;Q<N;Q++){(function(S){P[S].updateValue(function(T){R--;O[S]=T;if(R<0){M.apply(B,O)}})})(Q)}});return this},nav:false,setNav:function(L){var u=d.sheet.instance;for(var I=0;I<u.length;I++){(u[I]||{}).nav=false}B.nav=L},controlFactory:{addRowMulti:function(M,P,L,u,O){var I=(O?"row-init":"row");function N(Q){if(Q){if(!w(Q)){B.controlFactory.addCells(M,L,parseInt(Q),I,u);B.trigger("sheetAddRow",[M,L,Q])}}}if(!P){K.prompt(B.msg.addRowMulti,N)}else{N(P)}},addColumnMulti:function(M,P,L,u,O){var I=(O?"col-init":"col");function N(Q){if(Q){if(!w(Q)){B.controlFactory.addCells(M,L,parseInt(Q),I,u);B.trigger("sheetAddColumn",[M,L,Q])}}}if(!P){K.prompt(B.msg.addColumnMulti,N)}else{N(P)}},rowAdder:new k.RowAdder(),columnAdder:new k.ColumnAdder(),addCells:function(ai,ao,X,O,aa){if(X<1){return false}B.autoFillerHide();B.setDirty(true);B.setChanged(true);B.obj.barHelper().remove();var P,ag=B.obj.pane(),am=ag.table,V=ag.actionUI,S=am.tBody,aj=am.colGroup,Z=false,af=B.obj.cellActive(),U=B.spreadsheets[B.i]||(B.spreadsheets[B.i]=[]),ah,T,ad=B.cl.barLeft+" "+B.theme.bar,an=B.cl.barTop+" "+B.theme.bar,W,Y=(K.loader!==null?K.loader:null),M=(Y!==null?function(aq,ap){return Y.getWidth(aq,ap)}:function(){return K.newColumnWidth}),ac=(Y!==null?function(ap,aq){return Y.getHeight(ap,aq)}:function(){return K.colMargin}),R=function(aq,au,ar,ap){var at=l.createElement("td");return new k.Cell(B.i,at,B,B.cellHandler)},ae=(Y!==null?Y.setupCell:R),N=B.controls.bar.x.th[B.i]||(B.controls.bar.x.th[B.i]=[]),L=B.controls.bar.y.th[B.i]||(B.controls.bar.y.th[B.i]=[]),ab=ag.size(),al=am.size(),u=l.createDocumentFragment(),I,Q=V.yDetacher,ak=false;X=X||1;O=O||"col";switch(O){case"row-init":case"row":I=V.maximumVisibleRows;if(ai===J||ai===null){ai=U.length-1;Z=true}if(O==="row-init"&&((ai===0&&U.length===0)||ai===U.length-1)){Z=true}if(ai>ab.rows){ai=ab.rows;Z=true}P=ai;if(P>al.rows){P=al.rows}else{if(ai===0){ao=false}}if(Z){ak=Q.isBelowActive();if(ak){ai+=Q.detachedBelow.length-1}}W={row:ai,col:0};ah=this.rowAdder;ah.setQty(X,al);ah.setCreateBarFn(function(aw,ar){var ap=l.createElement("tr"),au=l.createElement("th");if(al.cols===0){var at=S.children[0],aq=l.createElement("col"),av=l.createElement("th");aq.style.width=M(B.i,1)+"px";av.entity="top";av.type="bar";av.innerHTML=av.label=h.columnLabelString(1);av.className=an;N[1]=av;at.appendChild(av);aj.appendChild(aq)}au.className=ad;au.entity="left";au.type="bar";au.style.height=ac(B.i,aw)+"px";au.innerHTML=au.label=aw;ap.appendChild(au);if(!ar){if(ak){Q.detachedBelow.push(ap)}else{if(S.children.length+u.children.length<V.maximumVisibleRows){u.appendChild(ap);if(u.children.length===I){ak=true}}else{Q.detachedBelow.push(ap)}}}if(U.length===0){L[aw]=au;U[aw]=[]}else{if(aw>=U.length){L[aw]=au;U[aw]=[]}else{L.splice(aw,0,au);U.splice(aw,0,[])}}return ap});ah.setCreateCellFn(function(aw,au,aq,ar){var ap=ae.call(Y,B.i,aw,au,B),av,at=U[aw];if(ap===null){ap=R(B.i,aw,au,B)}av=ap.td;av.jSCell=ap;if(at===J){console.log(B)}if(at.length===0){at[au]=ap}else{at.splice(au,0,ap)}if(!ar){ap.updateValue()}aq.insertBefore(av,aq.children[au])});ah.setHidden(K.hiddenRows[B.i]);ah.setAddedFinishedFn(function(ap){if(ai===0&&Z){S.appendChild(u)}else{S.insertBefore(u,ao?S.children[P]:S.children[P].nextSibling)}if(!Z){B.refreshRowLabels(ai)}T=ap});break;case"col":case"col-init":if(ai===J||ai===null){ai=al.cols;Z=true}if(O==="col-init"&&((ai===0&&U[1].length===0)||ai===U[1].length-1)){Z=true}if(ai>ab.cols){ai=ab.cols;Z=true}P=ai;if(P>al.cols){P=al.cols}else{if(ai===0){ao=false}}W={row:0,col:ai};ah=this.columnAdder;ah.setQty(X,al);ah.setCreateBarFn(function(au){var ar=S.children[0],at=l.createElement("col"),av=l.createElement("th"),aq,ap=S.children[1];at.style.width=M(B.i,au)+"px";av.entity="top";av.type="bar";av.innerHTML=av.label=h.columnLabelString(au);av.className=an;if(ap===J){aq=l.createElement("th");aq.setAttribute("class",ad);aq.entity="left";aq.type="bar";ap=l.createElement("tr");ap.style.height=ac(B.i,au)+"px";ap.appendChild(aq);S.appendChild(ap);aq.innerHTML=ap.rowIndex;L[1]=aq}aj.insertBefore(at,aj.children[au]);ar.insertBefore(av,ar.children[au]);if(N.length===0){N[au]=av}else{N.splice(au,0,av)}return{bar:av,col:at,barParent:ar,firstRowParent:ap}});ah.setCreateCellFn(function(aw,au,ar){var aq=ae.call(Y,B.i,aw,au,B),av,ap,at=U[aw];if(aq===null){aq=R(B.i,aw,au,B)}av=aq.td;if(at===J){U[aw]=at=[];ap=S.children[aw]}else{if(aw===1&&ar.firstRowParent){ap=ar.firstRowParent}else{ap=at[1].td.parentNode}}if(at.length===0){at[au]=aq}else{at.splice(au,0,aq)}aq.updateValue();ap.insertBefore(av,ap.children[au])});ah.setAddedFinishedFn(function(ap){if(!Z){B.refreshColumnLabels(ai)}T=ap});break}ah.createCells(ai,al,ao);if(!aa&&Z!=true){B.offsetFormulas(W,T,ao)}if(ag.inPlaceEdit){ag.inPlaceEdit.goToTd()}if(af){B.colLast=af.columnIndex;B.rowLast=af.rowIndex}return true},addRow:function(I,u){B.controlFactory.addCells(I,u,1,"row");B.trigger("sheetAddRow",[I,u,1])},addColumn:function(I,u){B.controlFactory.addCells(I,u,1,"col");B.trigger("sheetAddColumn",[I,u,1])},barHandleFreeze:{top:function(P,N){if(B.isBusy()){return false}var I=N.actionUI,U=N.tBody,V=I.frozenAt,S=I.scrolledArea;if(!(S.col<=(V.col+1))){return false}B.obj.barHelper().remove();var T,R=U.children[0].children[V.col+1],u=N.getBoundingClientRect(),O=u.top+l.body.scrollTop,L=u.left+l.body.scrollLeft,Q=l.createElement("div"),M=N.freezeHandleTop=d(Q).appendTo(N).addClass(B.theme.barHandleFreezeTop+" "+B.cl.barHelper+" "+B.cl.barHandleFreezeTop).height(R.clientHeight-1).css("left",(R.offsetLeft-Q.clientWidth)+"px").attr("title",B.msg.dragToFreezeCol);B.controls.bar.helper[B.i]=B.obj.barHelper().add(Q);B.controls.bar.x.handleFreeze[B.i]=M;B.draggable(M,{axis:"x",start:function(){B.setBusy(true);T=d(l.createElement("div")).appendTo(N).css("position","absolute").addClass(B.theme.barFreezeIndicator+" "+B.cl.barHelper).height(R.clientHeight-1).fadeTo(0,0.33)},drag:function(){var W=B.nearest(M,R.parentNode.children).prev();if(W.length&&W.position){T.width(W.position().left+W.width())}},stop:function(Y,W){T.remove();B.setBusy(false);B.setDirty(true);var X=B.nearest(M,R.parentNode.children);B.obj.barHelper().remove();S.col=I.frozenAt.col=B.getTdLocation(X[0]).col-1;B.autoFillerHide()},containment:[L,O,L+N.clientWidth-f.scrollBarSize.width,O]});return true},left:function(P,N){if(B.isBusy()){return false}var I=N.actionUI,W=N.table,U=N.tBody,V=I.frozenAt,S=I.scrolledArea;if(!(S.row<=(V.row+1))){return false}B.obj.barHelper().remove();var R=U.children[V.row+1].children[0],u=N.getBoundingClientRect(),O=u.top+l.body.scrollTop,L=u.left+l.body.scrollLeft,Q=l.createElement("div"),M=N.freezeHandleLeft=d(Q).appendTo(N).addClass(B.theme.barHandleFreezeLeft+" "+B.cl.barHelper+" "+B.cl.barHandleFreezeLeft).width(R.clientWidth).css("top",(R.offsetTop-Q.clientHeight+1)+"px").attr("title",B.msg.dragToFreezeRow),T;B.controls.bar.helper[B.i]=B.obj.barHelper().add(Q);B.controls.bar.y.handleFreeze[B.i]=M;B.draggable(M,{axis:"y",start:function(){B.setBusy(true);T=d(l.createElement("div")).appendTo(N).css("position","absolute").addClass(B.theme.barFreezeIndicator+" "+B.cl.barHelper).width(Q.clientWidth).fadeTo(0,0.33)},drag:function(){var X=B.nearest(M,R.parentNode.parentNode.children).prev();if(X.length&&X.position){T.height(X.position().top+X.height())}},stop:function(Z,X){T.remove();B.setBusy(false);B.setDirty(true);var Y=B.nearest(M,R.parentNode.parentNode.children);B.obj.barHelper().remove();S.row=I.frozenAt.row=D.max(B.getTdLocation(Y.children(0)[0]).row-1,0);B.autoFillerHide()},containment:[L,O,L,O+N.clientHeight-f.scrollBarSize.height]});return true},corner:function(){}},menu:function(L,u){var O,I=d([]),N=B.theme.menuHover;switch(L){case"top":O=d(l.createElement("div")).addClass(B.theme.menu+" "+B.cl.tdMenu);B.controls.bar.x.menu[B.i]=O;break;case"left":O=d(l.createElement("div")).addClass(B.theme.menu+" "+B.cl.tdMenu);B.controls.bar.y.menu[B.i]=O;break;case"cell":O=d(l.createElement("div")).addClass(B.theme.menu+" "+B.cl.tdMenu);B.controls.tdMenu[B.i]=O;break}B.controls.menus[B.i]=B.obj.menus().add(O);O.mouseleave(function(){O.hide()}).bind("contextmenu",function(){return false}).appendTo(z).hide().disableSelectionSpecial();for(var M in u){if(u[M]){if(d.isFunction(u[M])){I.pushStack(d(l.createElement("div")).text(M).data("msg",M).click(function(){u[d(this).data("msg")].call(this,B);O.hide();return false}).appendTo(O).hover(function(){I.removeClass(N);d(this).addClass(N)},function(){d(this).removeClass(N)}))}else{if(u[M]=="line"){d(l.createElement("hr")).appendTo(O)}}}}return O},barMenu:{top:function(L,u,I){if(B.isBusy()){return false}var N=B.obj.barMenuTop().hide();if(!N.length){N=B.controlFactory.menu("top",K.contextmenuTop)}B.obj.menus().hide();if(!I){N.css("left",(L.pageX-5)+"px").css("top",(L.pageY-5)+"px").show();return N}var M=B.obj.barMenuParentTop().hide();if(!M.length){M=d(l.createElement("div")).addClass(B.theme.barMenuTop+" "+B.cl.barHelper+" "+B.cl.barTopMenuButton).append(d(l.createElement("span")).addClass("ui-icon ui-icon-triangle-1-s")).mousedown(function(O){M.parent().mousedown().mouseup();var P=M.offset();N.css("left",(O.pageX-5)+"px").css("top",(O.pageY-5)+"px").show()}).blur(function(){if(N){N.hide()}});M.get(0).destroy=function(){M.remove();B.controls.bar.x.menuParent[B.i]=null};B.controls.bar.x.menuParent[B.i]=M}M.prependTo(I).show()},left:function(I,u){if(B.isBusy()){return false}B.obj.barMenuLeft().hide();if(u){B.obj.barHandleFreezeLeft().remove()}var L;L=B.obj.barMenuLeft();if(!L.length){L=B.controlFactory.menu("left",K.contextmenuLeft)}B.obj.menus().hide();L.css("left",(I.pageX-5)+"px").css("top",(I.pageY-5)+"px").show();return true},corner:function(){}},tdMenu:function(u){if(B.isBusy()){return false}B.obj.tdMenu().hide();var I=B.obj.tdMenu();if(!I.length){I=B.controlFactory.menu("cell",K.contextmenuCell)}B.obj.menus().hide();I.css("left",(u.pageX-5)+"px").css("top",(u.pageY-5)+"px").show();return true},header:function(){B.obj.header().remove();B.obj.sheetAdder().remove();B.obj.tabContainer().remove();var R=l.createElement("div"),L=l.createElement("table"),O=l.createElement("tr"),U,M,V=l.createElement("td"),W,N,I,S,u;R.appendChild(L);L.appendChild(O);R.className=B.cl.header+" "+B.theme.control;B.controls.header=d(R);if(K.title){if(d.isFunction(K.title)){K.title=B.title(B,E)}V.className=B.cl.title;B.controls.title=d(V).html(K.title)}else{d(V).hide()}O.appendChild(V);function T(Y){if(d.isFunction(Y)){Y=d(Y.call(B))}else{Y=d(Y)}if(Y.is("ul")){Y.find("ul").hide().addClass(B.theme.menuUl);Y.find("li").addClass(B.theme.menuLi).hover(function(){d(this).find("ul:first").hide().show()},function(){d(this).find("ul:first").hide()})}return Y}if(B.isSheetEditable()){if(K.menuLeft){N=l.createElement("td");N.className=B.cl.menu+" "+B.cl.menuFixed+" "+B.theme.menuFixed;O.insertBefore(N,V);B.controls.menuLeft[B.i]=d(N).append(T(K.menuLeft)).children().addClass(B.theme.menuFixed);B.controls.menuLeft[B.i].find("img").load(function(){B.sheetSyncSize()})}if(K.menuRight){I=l.createElement("td");I.className=B.cl.menu+" "+B.cl.menuFixed;O.appendChild(I);B.controls.menuRight[B.i]=d(I).append(T(K.menuRight)).children().addClass(B.theme.menuFixed);B.controls.menuRight[B.i].find("img").load(function(){B.sheetSyncSize()})}W=l.createElement("td");W.className=B.cl.label+" "+B.theme.control;B.controls.label=d(W);S=l.createElement("textarea");S.className=B.cl.formula+" "+B.theme.controlTextBox;S.onkeydown=B.evt.formula.keydown;S.onkeyup=function(){B.obj.inPlaceEdit().value=this.value};S.onchange=function(){B.obj.inPlaceEdit().value=this.value};S.onpaste=B.evt.pasteOverCells;S.onfocus=function(){B.setNav(false)};S.onfocusout=function(){B.setNav(true)};S.onblur=function(){B.setNav(true)};B.controls.formula=d(S);var Q=l.createElement("span");Q.appendChild(S);U=l.createElement("table");M=l.createElement("tr");U.appendChild(M);R.appendChild(U);u=l.createElement("td");u.className=B.cl.formulaParent;u.appendChild(Q);M.appendChild(W);M.appendChild(u);M.appendChild(l.createElement("td"));B.resizableSheet(d(Q),{minHeight:B.controls.formula.height(),maxHeight:78,handles:"s",resize:function(Z,Y){B.controls.formula.height(Y.size.height)},stop:function(){B.sheetSyncSize()}});var X=d.sheet.instance;for(var P=0;P<X.length;P++){(X||{}).nav=false}B.setNav(true);d(l).keydown(B.evt.document.keydown)}return R},ui:function(){var u=l.createElement("div");u.setAttribute("class",B.cl.ui);B.obj.ui=u;return u},sheetAdder:function(){var u=l.createElement("span");if(B.isSheetEditable()){u.setAttribute("class",B.cl.sheetAdder+" "+B.cl.tab+" "+B.theme.tab);u.setAttribute("title",B.msg.addSheet);u.innerHTML="+";u.onmousedown=function(){B.addSheet();return false};u.i=-1}return B.controls.sheetAdder=d(u)},tabContainer:function(){var u=l.createElement("span"),I;u.setAttribute("class",B.cl.tabContainer);u.onmousedown=function(M){M=M||f.event;var L=(M.target||M.srcElement).i;if(L>=0){B.trigger("sheetSwitch",[L])}return false};u.ondblclick=function(M){M=M||f.event;var L=(M.target||M.srcElement).i;if(L>=0){B.trigger("sheetRename",[L])}return false};if(B.isSheetEditable()&&d.fn.sortable){return B.controls.tabContainer=d(u).sortable({placeholder:"ui-state-highlight",axis:"x",forceHelperSize:true,forcePlaceholderSize:true,opacity:0.6,start:function(M,L){I=L.item.index();B.trigger("sheetTabSortStart",[M,L])},update:function(M,L){B.trigger("sheetTabSortUpdate",[M,L,I])}})}return B.controls.tabContainer=d(u)},sheetUI:function(S,N){B.i=N;var O=B.controlFactory.enclosure(),M=B.s,u=M.hiddenRows[N],R=M.hiddenColumns[N],L=O.pane,I=d(L),P=function(W){W=W||f.event;if(B.isBusy()){return false}if(B.isBar(W.target)){var U=W.target.entity,V=B.getBarIndex[U](W.target);if(V<0){return false}if(B.evt.barInteraction.first===B.evt.barInteraction.last){B.controlFactory.barMenu[U](W,V)}}else{B.controlFactory.tdMenu(W)}return false};S.appendChild(O);if(B.isSheetEditable()){B.controlFactory.autoFiller(L)}if(B.isSheetEditable()){var Q=B.obj.formula(),T="";I.mousedown(function(U){B.setNav(true);if(B.isBusy()){return false}if(B.isCell(U.target)){if(U.button==2){P.call(this,U);B.evt.cellOnMouseDown(U);return true}B.evt.cellOnMouseDown(U);return false}if(B.isBar(U.target)){if(U.button==2){P.call(this,U)}T=U.target.entity;B.evt.barInteraction.select(U.target);return false}return true});L.onmouseup=function(){T=""};L.onmouseover=function(Y){Y=Y||f.event;var X=Y.target||Y.srcElement;if(B.isBusy()){return false}if(!B.isBar(X)){return false}var W=X,U=X.entity,V=B.getBarIndex[U](W);if(V<0){return false}if(B.evt.barInteraction.selecting&&W===T){B.evt.barInteraction.last=W;B.cellSetActiveBar(U,B.evt.barInteraction.first,B.evt.barInteraction.last)}else{B.resizeBar[U](W,V,L);if(B.isSheetEditable()){B.controlFactory.barHandleFreeze[U](V,L);if(U=="top"){B.controlFactory.barMenu[U](Y,V,W)}}}return true};L.ondblclick=B.evt.cellOnDblClick;I.bind("contextmenu",P).disableSelectionSpecial().bind("cellEdit",B.evt.cellEdit)}u=M.loader.hiddenRows(N);R=M.loader.hiddenColumns(N);if(M.hiddenRows[N]===J){M.hiddenRows[N]=[]}if(M.hiddenColumns[N]===J){M.hiddenColumns[N]=[]}M.hiddenRows[N]=u;M.hiddenColumns[N]=R;B.controlFactory.tab();B.setChanged(true)},enclosure:function(){var L=l.createElement("div"),I=d(L),u=new k.ActionUI(B,L,B.cl.scroll,B.s.frozenAt[B.i],d.sheet.max),M=u.pane;M.setAttribute("class",B.cl.pane+" "+B.theme.pane);L.setAttribute("class",B.cl.enclosure);L.pane=M;M.enclosure=L;M.$enclosure=I;B.controls.pane[B.i]=M;B.controls.panes=B.obj.panes().add(M);B.controls.enclosures[B.i]=L;return L},tab:function(){var u=l.createElement("span"),I=B.controls.tab[B.i]=d(u).appendTo(B.obj.tabContainer());u.setAttribute("class",B.cl.tab+" "+B.theme.tab);B.sheetTab(true,function(L){u.innerHTML=L});u.i=B.i;B.controls.tabs=B.obj.tabs().add(I);return u},customTab:function(L){var u=l.createElement("span"),I=d(u).appendTo(B.obj.tabContainer());u.setAttribute("class",B.cl.tab+" "+B.theme.tab);u.innerHTML=L;return I},inPlaceEdit:function(P,I){P=P||B.obj.cellActive().td||null;if(P===null){P=B.rowTds(null,1)[1];B.cellEdit(P)}if(P===null){return}(B.obj.inPlaceEdit().destroy||F)();var O=B.obj.formula(),L=O.val(),u,N,M=B.obj.pane();if(!P.isHighlighted){return}u=l.createElement("textarea");N=d(u);M.inPlaceEdit=u;u.i=B.i;u.className=B.cl.inPlaceEdit+" "+B.theme.inPlaceEdit;u.td=P;u.table=P.parentNode.parentNode.parentNode;u.goToTd=function(){this.offset=d(P).position();if(!this.offset.left&&!this.offset.right){d(u).hide()}else{this.setAttribute("style","left:"+(this.offset.left-1)+"px;top:"+(this.offset.top-1)+"px;width:"+this.td.clientWidth+"px;height:"+this.td.clientHeight+"px;min-width:"+this.td.clientWidth+"px;min-height:"+this.td.clientHeight+"px;")}};u.goToTd();u.onkeydown=B.evt.inPlaceEdit.keydown;u.onchange=u.onkeyup=function(){O[0].value=u.value};u.onfocus=function(){B.setNav(false)};u.onblur=u.onfocusout=function(){B.setNav(true)};u.onpaste=B.evt.pasteOverCells;u.destroy=function(){M.inPlaceEdit=null;B.cellLast.isEdit=(u.value!=L);u.parentNode.removeChild(u);B.controls.inPlaceEdit[u.i]=false};M.appendChild(u);u.onfocus();B.controls.inPlaceEdit[B.i]=u;N.focus().val("").val(O[0].value);if(I){N.select()}if(d.fn.elastic){d(u).elastic()}},autoFiller:function(M){if(!K.autoFiller){return false}var I=l.createElement("div"),u=l.createElement("div"),L=l.createElement("div");I.i=B.i;I.className=B.cl.autoFiller+" "+B.theme.autoFiller;u.className=B.cl.autoFillerHandle;L.className=B.cl.autoFillerCover;I.onmousedown=function(){var O=B.obj.tdActive();if(O){var N=B.getTdLocation(O);B.cellSetActive(O,N,true,B.autoFillerNotGroup,function(){var Q=B.highlighted(),P=B.getTdLocation(Q.last());B.fillUpOrDown(P.row<N.row||P.col<N.col);B.autoFillerGoToTd(O);B.autoFillerNotGroup=false})}return false};M.autoFiller=B.controls.autoFiller[B.i]=I;M.appendChild(I);return true}},autoFillerNotGroup:true,tsv:new TSV(),updateCellsAfterPasteToFormula:function(T){var R=0,Q=B.obj.formula(),S=B.cellLast;T=T||Q.val();var I=Q.val(),L=I;if((S.rowIndex==0&&S.columnIndex==0)||I.length===0){return false}var P=B.tsv.parse(I);if(!d.isArray(P)){Q.val(P);B.fillUpOrDown(false,P);return true}var O=0,N,M,u,V,U;for(;O<P.length;O++){S.isEdit=true;M=P[O];for(N=0;N<M.length;N++){R++;if(!(u=B.spreadsheets[B.i])||!(V=u[O+S.rowIndex])||!(U=V[N+S.columnIndex])){continue}if(U){(function(W,X){K.parent.one("sheetPreCalculation",function(){if((X+"").charAt(0)=="="){W.formula=X.substring(1);W.value=""}else{W.formula="";W.value=X}})})(U,M[N]);B.resolveCell(U);if(O==0&&N==0){L=M[N]}}}}if(I!=L){Q.val(L)}B.fillUpOrDown(false,L);B.evt.cellEditDone(true);return true},evt:{inPlaceEdit:{enter:function(u){if(u.shiftKey){return true}return B.evt.cellSetActiveFromKeyCode(u,true)},tab:function(u){if(u.shiftKey){return true}return B.evt.cellSetActiveFromKeyCode(u,true)},keydown:function(u){u=u||f.event;B.trigger("sheetFormulaKeydown",[true]);switch(u.keyCode){case r.ENTER:return B.evt.inPlaceEdit.enter(u);break;case r.TAB:return B.evt.inPlaceEdit.tab(u);break;case r.ESCAPE:B.evt.cellEditAbandon();return false;break}}},formula:{keydown:function(u){u=u||f.event;if(B.readOnly[B.i]){return false}if(B.cellLast===null){return false}if(B.cellLast.rowIndex<0||B.cellLast.columnIndex<0){return false}B.trigger("sheetFormulaKeydown",[false]);switch(u.keyCode){case r.C:if(u.ctrlKey){return B.evt.document.copy(u)}case r.X:if(u.ctrlKey){return B.evt.document.cut(u)}case r.Y:if(u.ctrlKey){B.evt.document.redo(u);return false}break;case r.Z:if(u.ctrlKey){B.evt.document.undo(u);return false}break;case r.ESCAPE:B.evt.cellEditAbandon();return true;break;case r.ENTER:B.evt.cellSetActiveFromKeyCode(u,true);return false;break;case r.UNKNOWN:return false}B.cellLast.isEdit=true},If:function(I,u){if(I){d(B.obj.tdActive()).dblclick();return true}return false}},document:{enter:function(u){if(!B.cellLast.isEdit&&!u.ctrlKey){d(B.obj.tdActive()).dblclick()}return false},tab:function(u){B.evt.cellSetActiveFromKeyCode(u)},findCell:function(u){if(u.ctrlKey){B.cellFind();return false}return true},redo:function(u){if(u.ctrlKey&&!B.cellLast.isEdit){B.undo.manager.redo();return false}return true},undo:function(u){if(u.ctrlKey&&!B.cellLast.isEdit){B.undo.manager.undo();return false}return true},copy:function(N,I){var M=B.highlighted(true),O=B.obj.formula(),L=O.val(),u=B.toTsv(M,I);O.val(u).focus().select();x.one("keyup",function(){if(I){O.val("")}else{O.val(L)}});return true},cut:function(u){return this.copy(u,true)},pageUpDown:function(u){var M=B.sheetSize(),Q=B.obj.pane(),L=Q.clientHeight,N=0,O=0,P,I;if(u){for(I=B.cellLast.rowIndex;I>0&&N<L;I--){P=B.getTd(-1,I,1);if(P!==null&&!P.getAttribute("data-hidden")&&d(P).is(":hidden")){d(P).show()}N+=P.parentNode.clientHeight}}else{for(I=B.cellLast.rowIndex;I<M.rows&&N<L;I++){P=B.getTd(-1,I,1);if(P===null){continue}N+=P.parentNode.clientHeight}}B.cellEdit(P);return false},keydown:function(u){u=u||f.event;if(B.readOnly[B.i]){return false}if(B.cellLast===null){return}if(B.cellLast.rowIndex<0||B.cellLast.columnIndex<0){return false}var I=B.cellLast.td;if(B.nav){switch(u.keyCode){case r.DELETE:B.toTsv(null,true);B.obj.formula().val("");B.cellLast.isEdit=true;break;case r.TAB:B.evt.document.tab(u);break;case r.ENTER:B.evt.cellSetActiveFromKeyCode(u);break;case r.LEFT:case r.UP:case r.RIGHT:case r.DOWN:(u.shiftKey?B.evt.cellSetHighlightFromKeyCode(u):B.evt.cellSetActiveFromKeyCode(u));break;case r.PAGE_UP:B.evt.document.pageUpDown(true);break;case r.PAGE_DOWN:B.evt.document.pageUpDown();break;case r.HOME:case r.END:B.evt.cellSetActiveFromKeyCode(u);break;case r.V:if(u.ctrlKey){return B.evt.formula.If(!B.evt.pasteOverCells(u),u)}else{d(I).trigger("cellEdit");return true}break;case r.Y:if(u.ctrlKey){B.evt.document.redo(u);return false}else{d(I).trigger("cellEdit");return true}break;case r.Z:if(u.ctrlKey){B.evt.document.undo(u);return false}else{d(I).trigger("cellEdit");return true}break;case r.ESCAPE:B.evt.cellEditAbandon();break;case r.F:if(u.ctrlKey){return B.evt.formula.If(B.evt.document.findCell(u),u)}else{d(I).trigger("cellEdit");return true}break;case r.CAPS_LOCK:case r.SHIFT:case r.ALT:break;case r.CONTROL:B.obj.formula().focus().select();return true;break;default:if(B.obj.inPlaceEdit().td!==I){d(I).trigger("cellEdit")}return true;break}return false}}},pasteOverCells:function(I){I=I||f.event;if(I.ctrlKey||I.type=="paste"){var u=function(){B.updateCellsAfterPasteToFormula()};var L=x.one("keyup",function(){u();u=function(){};L.mouseup()}).one("mouseup",function(){u();u=function(){};L.keyup()});B.setDirty(true);B.setChanged(true);return true}return false},cellEditDone:function(u){var I=B.obj.inPlaceEdit(),L=d(I).is(":focus"),T=B.cellLast,S;(I.destroy||F)();if(T!==null&&(T.isEdit||u)){S=B.getCell(T.sheetIndex,T.rowIndex,T.columnIndex);var O=(L?d(I):B.obj.formula()),M=S.td;if(B.isFormulaEditable(M)){if(M!==null&&S.rowIndex>0&&S.columnIndex>0){var R=O.val(),N=0,Q=K.loader,P;if(!S.edited){S.edited=true;B.obj.cellsEdited().push(S)}K.parent.one("sheetPreCalculation",function(){S.parsedFormula=null;if(R.charAt(0)=="="){S.formula=R=R.substring(1)}else{S.value=R;S.formula="";if((P=S.loadedFrom)!==null){Q.setCellAttributes(P,{cache:J,formula:"",value:R,parsedFormula:null})}}S.setNeedsUpdated()});B.resolveCell(S);S.isEdit=false;B.trigger("sheetCellEdited",[S])}}}},cellEditAbandon:function(u){(B.obj.inPlaceEdit().destroy||F)();B.highlighter.clearBar().clear();if(!u){B.calc()}B.cellLast=null;B.rowLast=0;B.colLast=0;B.highlighter.startRowIndex=0;B.highlighter.startColumnIndex=0;B.highlighter.endRowIndex=0;B.highlighter.endColumnIndex=0;B.labelUpdate("");B.obj.formula().val("").blur();B.autoFillerHide();return false},cellSetHighlightFromKeyCode:function(N){var L=B.orderedGrid(B.highlighter),I=B.sheetSize(),M=B.cellActive,u=B.highlighter;if(M===null){return false}switch(N.keyCode){case r.UP:if(L.startRowIndex<M.rowIndex){L.startRowIndex--;L.startRowIndex=L.startRowIndex>0?L.startRowIndex:1;break}L.endRowIndex--;L.endRowIndex=L.endRowIndex>0?L.endRowIndex:1;break;case r.DOWN:if(L.startRowIndex===L.endRowIndex){L.startRowIndex++;L.startRowIndex=L.startRowIndex<I.rows?L.startRowIndex:I.rows;break}if(L.startRowIndex<cell.rowIndex){L.startRowIndex++;L.startRowIndex=L.startRowIndex>0?L.startRowIndex:1;break}L.endRowIndex++;L.endRowIndex=L.endRowIndex<I.rows?L.endRowIndex:I.rows;break;case r.LEFT:if(L.startColumnIndex<cell.columnIndex){L.startColumnIndex--;L.startColumnIndex=L.startColumnIndex>0?L.startColumnIndex:1;break}L.endColumnIndex--;L.endColumnIndex=L.endColumnIndex>0?L.endColumnIndex:1;break;case r.RIGHT:if(L.startColumnIndex<cell.columnIndex){L.startColumnIndex++;L.startColumnIndex=L.startColumnIndex<I.cols?L.startColumnIndex:I.cols;break}L.endColumnIndex++;L.endColumnIndex=L.endColumnIndex<I.cols?L.endColumnIndex:I.cols;break}u.startRowIndex=L.startRowIndex;u.startColumnIndex=L.startColumnIndex;u.endRowIndex=L.endRowIndex;u.endColumnIndex=L.endColumnIndex;B.cycleCellArea(function(O){u.set(O.td)},L);return false},cellSetActiveFromKeyCode:function(P,M){if(B.cellLast===null){return false}var Q=B.cellLast,O={rowIndex:Q.rowIndex,columnIndex:Q.columnIndex},I,S,R,N=false,L,u=false;switch(P.keyCode){case r.UP:O.rowIndex--;break;case r.DOWN:O.rowIndex++;break;case r.LEFT:O.columnIndex--;break;case r.RIGHT:O.columnIndex++;break;case r.ENTER:O=B.evt.incrementAndStayInGrid(B.orderedGrid(B.highlighter),O,true,P.shiftKey);N=true;L=B.highlighted();if(L.length>1){u=true}else{if(!M){O.rowIndex+=(P.shiftKey?-1:1)}if(K.autoAddCells&&O.rowIndex>B.sheetSize(P.target.table).rows){B.controlFactory.addRow()}}break;case r.TAB:O=B.evt.incrementAndStayInGrid(B.orderedGrid(B.highlighter),O,false,P.shiftKey);N=true;L=B.highlighted();if(L.length>1){u=true}else{if(!M){O.columnIndex+=(P.shiftKey?-1:1)}if(K.autoAddCells&&O.columnIndex>B.sheetSize(P.target.table).cols){B.controlFactory.addColumn()}}break;case r.HOME:O.columnIndex=1;break;case r.END:O.columnIndex=B.obj.tdActive().parentNode.children.length-2;break}O.columnIndex=O.columnIndex||1;O.rowIndex=O.rowIndex||1;if(!Q.isEdit||N){if((I=B.spreadsheets[B.i])===J){return false}if((S=I[O.rowIndex])===J){return false}if((R=S[O.columnIndex])===J){return false}if(R!==null){B.cellEdit(R.td,null,u);return false}}return true},incrementAndStayInGrid:function(I,M,L,u){if(L){if(u){M.rowIndex--;if(M.rowIndex<I.startRowIndex){M.rowIndex=I.endRowIndex;M.columnIndex--}if(M.columnIndex<I.startColumnIndex){M.columnIndex=I.endColumnIndex}}else{M.rowIndex++;if(M.rowIndex>I.endRowIndex){M.rowIndex=I.startRowIndex;M.columnIndex++}if(M.columnIndex>I.endColumnIndex){M.columnIndex=I.startColumnIndex}}}else{if(u){M.columnIndex--;if(M.columnIndex<I.startColumnIndex){M.columnIndex=I.endColumnIndex;M.rowIndex--}if(M.rowIndex<I.startRowIndex){M.rowIndex=I.endRowIndex}}else{M.columnIndex++;if(M.columnIndex>I.endColumnIndex){M.columnIndex=I.startColumnIndex;M.rowIndex++}if(M.rowIndex>I.endRowIndex){M.rowIndex=I.startRowIndex}}}return M},cellOnMouseDown:function(u){B.obj.formula().blur();if(u.shiftKey){B.getTdRange(u,B.obj.formula().val())}else{B.cellEdit(u.target,true)}},cellOnDblClick:function(u){if(B.isBusy()){return false}B.controlFactory.inPlaceEdit();return true},cellEdit:function(u){if(B.isBusy()){return false}B.controlFactory.inPlaceEdit(null,true);return true},barInteraction:{first:0,last:0,selecting:false,select:function(L){if(!L){return}if(!L.type==="bar"){return}var u=L.entity,I=B.getBarIndex[u](L);if(I<0){return false}B[u+"Last"]=I;B.evt.barInteraction.last=B.evt.barInteraction.first=B[u+"Last"]=L;B.cellSetActiveBar(u,B.evt.barInteraction.first,B.evt.barInteraction.last);B.evt.barInteraction.selecting=true;x.one("mouseup",function(){B.evt.barInteraction.selecting=false});return false}}},refreshColumnLabels:function(O){O=O||0;var I=B.obj.barMenuParentTop();if((I)&&(I.length)){var N=I.get(0);if(d.isFunction(N.destroy)){N.destroy()}}var u=B.controls.bar.x.th[B.i],M;if(!u){return}for(var L=g.max(O,0);L<u.length;L++){if(L>0){M=u[L];M.innerHTML=M.label=h.columnLabelString(M.cellIndex)}}},refreshRowLabels:function(N,u){N=N||0;var I=B.controls.bar.y.th[B.i],M;if(!I){return}u=u||I.length;for(var L=N;L<u;L++){if(L>0&&(M=I[L])!==J){M.innerHTML=M.label=M.parentNode.rowIndex}}},isCell:function(u){if(u&&u.jSCell!==J){return true}return false},isBar:function(u){if(u.tagName=="TH"){return true}return false},readOnly:[],isSheetEditable:function(u){u=u||B.i;return(K.editable==true&&!B.readOnly[u])},isFormulaEditable:function(u){if(K.lockFormulas){if(u.data("formula")!==J){return false}}return true},toggleFullScreen:function(){if(!B){return}B.evt.cellEditDone();var L=B.obj.fullScreen(),O=B.obj.pane();if(L.is(":visible")){v.unbind("jSResize");z.removeClass("bodyNoScroll");K.parent=L[0].origParent;K.parent.prepend(L.children());L.remove();B.sheetSyncSize();if(O.inPlaceEdit){O.inPlaceEdit.goToTd()}B.trigger("sheetFullScreen",[false])}else{z.addClass("bodyNoScroll");var M=d(K.parent),L=l.createElement("div"),I=d._data(K.parent[0],"events");L.className=B.cl.fullScreen+" "+B.theme.fullScreen+" "+B.cl.parent;L.origParent=M;K.parent=B.controls.fullScreen=d(L).append(M.children()).appendTo(z);v.bind("resize",function(){v.trigger("jSResize")}).bind("jSResize",function(){this.w=v.width();this.h=v.height();K.parent.width(this.w).height(this.h);B.sheetSyncSize();if(O.inPlaceEdit){O.inPlaceEdit.goToTd()}}).trigger("jSResize");M.trigger("sheetFullScreen",[true]);for(var N in I){for(var u=0;u<I[N].length;u++){K.parent.bind(N,I[N][u].handler)}}}},renameSheet:function(u){if(w(u)){return false}if(u>-1){B.sheetTab()}return true},switchSheet:function(u){if(w(u)){return false}if(u==-1){B.addSheet()}else{if(u!=B.i){B.setActiveSheet(u);if(K.loader===null){B.calc(u)}}}return true},toggleHideRow:function(u){u=u||B.rowLast;if(!u){return}var I=B.obj.pane().actionUI;I.toggleHideRow(B,u);B.autoFillerGoToTd()},toggleHideRowRange:function(L,I){var u=B.obj.pane().actionUI;u.toggleHideRowRange(B,L,I);B.autoFillerGoToTd()},toggleHideColumn:function(u){u=u||B.colLast;if(!u){return}var I=B.obj.pane().actionUI;I.toggleHideColumn(u);B.autoFillerGoToTd()},toggleHideColumnRange:function(L,I){var u=B.obj.pane().actionUI;u.toggleHideColumnRange(L,I);B.autoFillerGoToTd()},rowShowAll:function(){B.obj.pane().actionUI.rowShowAll()},columnShowAll:function(){B.obj.pane().actionUI.columnShowAll()},merge:function(P){P=P||B.highlighted();if(!P.length){return}var N=[],u=P[0],M=P[P.length-1],U=B.getTdLocation(u),I=B.getTdLocation(M),W={},S={},R=0,T=0,O=P.length-1,V,X,L,Q;if(U.row){B.setDirty(true);B.setChanged(true);if(U.row<I.row){W.row=U.row;S.row=I.row;L=u}else{W.row=I.row;S.row=U.row;L=M}if(L.hasAttribute("rowSpan")||L.hasAttribute("colSpan")){return false}if(U.col<I.col){W.col=U.col;S.col=I.col}else{W.col=I.col;S.col=U.col}T=(S.row-W.row)+1;R=(S.col-W.col)+1;Q=B.getTdLocation(L);do{X=P[O];V=X.jSCell;if(V.formula||V.value){N.unshift(V.formula?"("+V.formula.substring(1)+")":V.value)}K.parent.one("sheetPreCalculation",function(){if(X.cellIndex!=Q.col||X.parentNode.rowIndex!=Q.row){V.formula="";V.value="";V.defer=L.jSCell;X.innerHTML="";X.style.visibility="collapse"}});B.resolveCell(V)}while(O--);L.jSCell.value=d.trim(N.join(" "));L.jSCell.formula=d.trim(L.jSCell.formula?N.join(" "):"");L.setAttribute("rowSpan",T);L.setAttribute("colSpan",R);L.style.display="";L.style.visibility="";L.style.position="";L.style.height=L.clientHeight+"px";L.style.width=L.clientWidth+"px";L.style.position="absolute";B.resolveCell(L.jSCell);B.evt.cellEditDone();B.autoFillerGoToTd(L);B.cellSetActive(L,Q)}return true},unmerge:function(I){I=I||B.highlighted();if(!I){return}var O=B.getTdLocation(I),P=new a(),R=D.max(I.getAttribute("rowSpan")*1,1)-1,u=D.max(I.getAttribute("colSpan")*1,1)-1,N=R+O.row,L,Q,M=[];if(R==0&&u==0){return false}do{L=O.col+u;do{Q=B.getTd(-1,N,L);if(Q===null){continue}Q.style.display="";Q.style.visibility="";Q.removeAttribute("colSpan");Q.removeAttribute("rowSpan");Q.jSCell.defer=null;B.resolveCell(Q.jSCell,P);M.push(Q)}while(L-->O.col)}while(N-->O.row);B.evt.cellEditDone();B.autoFillerGoToTd(I);B.cellSetActive(I,O);B.highlighter.set(M);return true},fillUpOrDown:function(Q,R,T){B.evt.cellEditDone();T=T||B.highlighted(true);if(T.length<1){return false}var N=B.obj.tdActive();if(T.length<1){return false}var O=B.getTdLocation(T[0].td),U=B.getTdLocation(T[T.length-1].td),u=B.getTdLocation(N),L={row:0,col:0},I=R||N.jSCell.value,S=false,M=T.length-1,P=function(){};R=R||N.jSCell.value;if(M>=0){if(R.charAt&&R.charAt(0)=="="){if(M>=0){do{if(!Q){L.row=u.row-U.row;L.col=u.col-U.col}else{L.row=u.row-O.row;L.col=u.col-O.col}I=B.reparseFormula(R,L);K.parent.one("sheetPreCalculation",function(){T[M].formula=I;T[M].value=""});B.resolveCell(T[M])}while(M--);return true}}else{if((S=!w(I))||I.length>0){if(S&&I!=""){I*=1;if(Q){I-=T.length-1}P=function(){I++}}}do{K.parent.one("sheetPreCalculation",function(){T[M].formula="";T[M].value=I+""});B.resolveCell(T[M]);P()}while(M--);return true}}return false},toTsv:function(T,M,R){T=T||B.highlighted(true);if(T.type){T=[T]}R=R||function(W,V){if(M){K.parent.one("sheetPreCalculation",function(){V.formula="";V.value=""});B.resolveCell(V)}};var P=[],S,O,I={},L=T.length-1,U,u;if(L>=0){S=B.getTdLocation(T[0].td);O=B.getTdLocation(T[T.length-1].td);I.row=D.min(S.row,O.row);I.col=D.min(S.col,O.col);do{var N=B.getTdLocation(T[L].td),Q=(T[L].formula?"="+T[L].formula:T[L].value);U=D.abs(N.row-I.row);u=D.abs(N.col-I.col);if(!P[U]){P[U]=[]}if((Q+="").match(/\n/)){Q='"'+Q+'"'}P[U][u]=(Q||"");R.call(T[L].td,N,T[L])}while(L-->0);L=P.length-1;do{P[L]=P[L].join("\t")}while(L-->0);return P.join("\n")}return""},offsetFormulas:function(P,O,L,N){var I=B.sheetSize(),M={first:{row:1,col:1},last:{row:I.rows,col:I.cols}},u=[];B.cycleCells(function(){var Q=this;if(this.formula&&typeof this.formula=="string"&&B.isFormulaEditable(this.td)){this.formula=B.reparseFormula(this.formula,O,P,L,N)}u.push(function(){B.resolveCell(Q,true)})},M.first,M.last);while(u.length){u.pop()()}B.evt.cellEditDone()},cellRegex:/(\$?[a-zA-Z]+|[#]REF[!])(\$?[0-9]+|[#]REF[!])/gi,reparseFormula:function(N,M,L,u,I){return N.replace(this.cellRegex,function(P,Q,U,V){if(Q=="SHEET"){return P}M=M||{loc:0,row:0};var O={row:U*1,col:h.columnLabelIndex(Q)},T,S,R={row:U,col:Q,use:false};if(L){if(I){if(u){if(O.col&&O.col==L.col-1){R.col="#REF!";R.use=true}if(O.row&&O.row==L.row-1){R.row="#REF!";R.use=true}if(O.col>=L.col){T=true}if(O.row>=L.row){S=true}}else{if(L.col&&O.col==L.col){R.col="#REF!";R.use=true}if(L.row&&O.row==L.row){R.row="#REF!";R.use=true}if(L.col&&O.col>L.col){T=true}if(L.row&&O.row>L.row){S=true}}if(R.use){return R.col+R.row}if(T){O.col+=M.col;return B.makeFormula(O)}if(S){O.row+=M.row;return B.makeFormula(O)}}else{if(u){if(L.col&&O.col>=L.col){T=true}if(L.row&&O.row>=L.row){S=true}}else{if(L.col&&O.col>L.col){T=true}if(L.row&&O.row>L.row){S=true}}if(T){O.col+=M.col;return B.makeFormula(O)}if(S){O.row+=M.row;return B.makeFormula(O)}}}else{return B.makeFormula(O,M)}return P})},makeFormula:function(I,u){u=d.extend({row:0,col:0},u);I.col+=u.col;I.row+=u.row;if(I.col<0){I.col=0}if(I.row<0){I.row=0}return h.parseCellName(I.col,I.row)},cycleCells:function(N,Q,L,I){I=I||B.i;Q=Q||{rowIndex:1,col:1};if(!L){var S=B.sheetSize();L={row:S.rows,col:S.cols}}var u=B.spreadsheets[I],M,P,R,O;for(P=Q.col;P<=L.col;P++){for(M=Q.row;M<=L.row;M++){if((R=u[M])===J){continue}if((O=R[P])===J){continue}O.rowIndex=M;O.columnIndex=P;N.call(O,I,M,P)}}},cycleCellsAll:function(M){var N=B.i,L,I,u;for(L=0;L<=B.sheetCount;L++){B.i=L;I=B.sheetSize();u={row:I.rows,col:I.cols};B.cycleCells(M,{row:0,col:0},u,L)}B.i=N},cycleCellArea:function(P,u){var O,N,R,Q,M=B.i,L={cell:[],td:[]},I=B.spreadsheets[M];for(O=u.startRowIndex;O<=u.endRowIndex;O++){if((R=I[O])===J){continue}for(N=u.startColumnIndex;N<=u.endColumnIndex;N++){if((Q=R[N])===J){continue}L.cell.push(Q);L.td.push(Q.td)}}if(P){P(L)}},theme:null,highlighter:null,resizable:function(I,u){if(!I.data("resizable")){I.resizable(u)}},busy:[],setBusy:function(u){if(u){B.busy.push(u)}else{B.busy.pop()}if(B.busy.length<1&&B.whenNotBusyStack.length>0){B.whenNotBusyStack.shift()()}},isBusy:function(){return(B.busy.length>0)},whenNotBusyStack:[],whenNotBusy:function(u){if(B.isBusy()){B.whenNotBusyStack.push(u)}else{u()}},draggable:function(I,u){if(!I.data("jSdraggable")){I.data("jSdraggable",true).draggable(u)}},nearest:function(I,u){return d(I).nearest(u)},resizeBar:{top:function(L,u,O){B.obj.barTopControls().remove();var I=l.createElement("div"),N=d(I).addClass(B.cl.barController+" "+B.theme.barResizer).width(L.clientWidth).prependTo(L),M;B.controls.bar.x.controls[B.i]=B.obj.barTopControls().add(N);B.resizableCells(N,{handles:"e",start:function(Q,P){B.autoFillerHide();B.setBusy(true);if(O.freezeHandleTop){O.freezeHandleTop.remove()}},resize:function(Q,P){L.col.style.width=P.size.width+"px";if(O.inPlaceEdit){O.inPlaceEdit.goToTd()}},stop:function(Q,P){B.setBusy(false);if(O.inPlaceEdit){O.inPlaceEdit.goToTd()}B.followMe();B.setDirty(true)},minWidth:32});M=I.children[0];M.style.height=L.clientHeight+"px";M.style.position="absolute"},left:function(S,N,M){B.obj.barLeftControls().remove();var u=S.getBoundingClientRect(),O=u.top+l.body.scrollTop,P=u.left+l.body.scrollLeft,T=l.createElement("div"),R=d(T).addClass(B.cl.barController+" "+B.theme.barResizer).prependTo(S).offset({top:O,left:P}),U=S.parentNode,L=l.createElement("div"),I=d(L).addClass(B.cl.barControllerChild).height(S.clientHeight).prependTo(R),Q;B.controls.bar.y.controls[B.i]=B.obj.barLeftControls().add(R);B.resizableCells(I,{handles:"s",start:function(){B.autoFillerHide();B.setBusy(true);if(M.freezeHandleLeft){M.freezeHandleLeft.remove()}},resize:function(W,V){T.style.height=S.style.height=U.style.height=V.size.height+"px";if(M.inPlaceEdit){M.inPlaceEdit.goToTd()}},stop:function(W,V){B.setBusy(false);if(M.inPlaceEdit){M.inPlaceEdit.goToTd()}B.followMe();B.setDirty(true)},minHeight:15});Q=L.children[0];Q.style.width=S.offsetWidth+"px";Q.style.position="absolute"},corner:function(){}},labelUpdate:function(u){if(u instanceof k.Cell){var I=h.parseCellName(u.columnIndex,u.rowIndex);B.obj.label().text(I)}else{B.obj.label().text(u)}},cellEdit:function(N,M,L){B.autoFillerNotGroup=true;B.evt.cellEditDone();if(N===null){return}var u=N.jSCell,I;if(u===J||u===null){return}if(u.uneditable){return}B.trigger("sheetCellEdit",[u]);if(B.cellLast!==null&&N!==B.cellLast.td){B.followMe(N)}else{B.autoFillerGoToTd(N)}B.labelUpdate(u);if(u.formula.length>0){I="="+u.formula}else{I=u.value}B.obj.formula().val(I).blur();B.cellSetActive(u,M,false,null,L)},cellSetActive:function(T,I,U,O,L){var N=T.td;B.cellLast=T;B.rowLast=T.rowIndex;B.colLast=T.columnIndex;if(!L){B.highlighter.set(T.td).setStart(T).setEnd(T)}B.highlighter.setBar("left",N.parentNode.children[0]).setBar("top",N.parentNode.parentNode.children[0].children[N.cellIndex]);var Q,V;switch(K.cellSelectModel){case k.excelSelectModel:case k.googleDriveSelectModel:Q=function(){};V=function(){};break;case k.openOfficeSelectModel:Q=function(W){if(B.isCell(W)){B.cellEdit(W)}};V=function(){};break}if(I){var M=B.obj.pane(),S=B.highlighter,u={startRowIndex:T.rowIndex,startColumnIndex:T.columnIndex,endRowIndex:0,endColumnIndex:0},P=T.rowIndex,R=T.columnIndex;M.onmousemove=function(ae){ae=ae||f.event;var af=ae.target||ae.srcElement;if(B.isBusy()){return false}if(af.jSCell===J){return false}var W=af.jSCell,ag=true;u.endColumnIndex=W.columnIndex;u.endRowIndex=W.rowIndex;if(U){ag=(T.columnIndex===W.columnIndex||T.rowIndex===W.rowIndex)}if((R!==W.columnIndex||P!==W.rowIndex)&&ag){Q(af);B.cycleCellArea(function(ah){S.set(ah.td)},B.orderedGrid(u))}B.followMe(af);var Z=ae.clientY,aa=ae.clientX,ab=M.$enclosure.offset(),ac=W.rowIndex,Y=W.columnIndex,X=false,ad;if(w(ac)||w(Y)){return false}if(Z>ab.top){X=true;ac--}if(aa>ab.left){X=true;Y--}if(X){if(ac<1||Y<1){return false}ad=B.spreadsheets[B.i][ac][Y];B.followMe(ad.td,true)}R=W.columnIndex;P=W.rowIndex;return true};l.onmouseup=function(){M.onmousemove=null;M.onmousemove=null;M.onmouseup=null;l.onmouseup=null;if(O){O()}}}},colLast:0,rowLast:0,cellLast:null,orderedGrid:function(u){var I={startRowIndex:(u.startRowIndex<u.endRowIndex?u.startRowIndex:u.endRowIndex),startColumnIndex:(u.startColumnIndex<u.endColumnIndex?u.startColumnIndex:u.endColumnIndex),endRowIndex:(u.endRowIndex>u.startRowIndex?u.endRowIndex:u.startRowIndex),endColumnIndex:(u.endColumnIndex>u.startColumnIndex?u.endColumnIndex:u.startColumnIndex)};return I},cellStyleToggle:function(P,O,M){M=M||B.highlighted();if(M.length<1){return false}B.setDirty(true);var Q,N,L=M.length-1,u=B.obj.cellsEdited(),I;if(L>=0){I=M[0].className.match(P);do{Q=M[L];N=d(Q);if(O){N.removeClass(O)}if(I){N.removeClass(P)}else{N.addClass(P)}if(!Q.jSCell.edited){Q.jSCell.edited=true;u.push(Q.jSCell)}}while(L--);return true}return false},cellTypeToggle:function(N,L){L=L||B.highlighted(true);if(L.length<1){return}var M=L.length-1,I=L[M].cellType==N,u;if(M>=0){do{u=L[M];if(I){u.cellType=null}else{u.cellType=N}u.updateValue()}while(M--)}},fontReSize:function(O,N){N=N||B.highlighted();if(N.length<1){return false}var I=0;switch(O){case"up":I=1;break;case"down":I=-1;break}var Q,P,M=N.length-1,L,u=B.obj.cellsEdited();if(M>=0){do{Q=N[M];P=d(Q);L=(P.css("font-size")+"").replace("px","")*1;P.css("font-size",((L||10)+I)+"px");if(!Q.jSCell.edited){Q.jSCell.edited=true;u.push(Q.jSCell)}}while(M--);return true}return false},cellHandler:null,calc:function(L,N){L=(L===J?B.i:L);if(B.readOnly[L]||B.isChanged(L)===false&&!N){return false}var I=K.loader,u;if(I!==null){I.cycleCells(L,function(O,Q,P){u=I.jitCell(O,Q,P);u.updateValue()})}else{var M=B.spreadsheetToArray(null,L);h.calc(L,M);B.trigger("sheetCalculation",[{which:"spreadsheet",sheet:M,index:L}])}B.setChanged(false);return true},calcAll:function(L){var I=0,u;if(K.loader!==null){u=K.loader.count;for(;I<u;I++){B.calc(I,L)}}else{u=B.spreadsheets.length;for(;I<u;I++){B.calc(I,L)}}},resolveCell:function(u,I){var L=!u.needsUpdated;if(!I){B.undo.createCells([u],function(M){B.trigger("sheetPreCalculation",[{which:"cell",cell:u}]);B.setDirty(true);B.setChanged(true);u.updateValue(function(){B.trigger("sheetCalculation",[{which:"cell",cell:u}]);if(L){u.updateDependencies()}});return M})}else{B.trigger("sheetPreCalculation",[{which:"cell",cell:u}]);B.setDirty(true);B.setChanged(true);u.updateValue(function(){B.trigger("sheetCalculation",[{which:"cell",cell:u}]);if(L){u.updateDependencies()}})}},addSheet:function(u){u=u||{rows:25,cols:10};B.evt.cellEditAbandon();B.setDirty(true);B.controlFactory.sheetUI(B.obj.ui,d.sheet.makeTable(u),B.sheetCount);B.setActiveSheet(B.sheetCount);B.sheetCount++;B.sheetSyncSize();var I=B.obj.pane();if(I.inPlaceEdit){I.inPlaceEdit.goToTd()}B.trigger("sheetAdd",[B.i])},insertSheet:null,deleteSheet:function(I){var N=I||B.i,M=B.controls.enclosure,u;M.splice(N,1);B.obj.barHelper().remove();d(B.obj.enclosure()).remove();B.obj.menus().remove();B.obj.tabContainer().children().eq(B.i).remove();B.spreadsheets.splice(N,1);B.controls.autoFiller.splice(N,1);B.controls.bar.helper.splice(N,1);B.controls.bar.corner.splice(N,1);B.controls.bar.x.controls.splice(N,1);B.controls.bar.x.handleFreeze.splice(N,1);B.controls.bar.x.controls.splice(N,1);B.controls.bar.x.menu.splice(N,1);if(B.controls.bar.x.menuParent&&B.controls.bar.x.menuParent[N]){B.controls.bar.x.menuParent.splice(N,1)}B.controls.bar.x.parent.splice(N,1);B.controls.bar.x.th.splice(N,1);B.controls.bar.y.controls.splice(N,1);B.controls.bar.y.handleFreeze.splice(N,1);B.controls.bar.y.controls.splice(N,1);B.controls.bar.y.menu.splice(N,1);if(B.controls.bar.y.menuParent&&B.controls.bar.y.menuParent[N]){B.controls.bar.y.menuParent.splice(N,1)}B.controls.bar.y.parent.splice(N,1);B.controls.bar.y.th.splice(N,1);B.controls.barMenuLeft.splice(N,1);B.controls.barMenuTop.splice(N,1);B.controls.barLeft.splice(N,1);B.controls.barTop.splice(N,1);B.controls.barTopParent.splice(N,1);B.controls.chart.splice(N,1);B.controls.tdMenu.splice(N,1);B.controls.enclosure.splice(N,1);B.controls.fullScreen=null;B.controls.inPlaceEdit.splice(N,1);B.controls.menus.splice(N,1);B.controls.menuLeft.splice(N,1);B.controls.menuRight.splice(N,1);B.controls.pane.splice(N,1);B.controls.tables.splice(N,1);B.controls.table.splice(N,1);for(u=N+1;u<B.controls.tab.length;++u){var L=B.controls.tab[u].get(0);L.i--}B.controls.tab.splice(N,1);B.controls.toggleHide.x.splice(N,1);B.controls.toggleHide.y.splice(N,1);B.readOnly.splice(N,1);B.i=0;B.sheetCount--;B.sheetCount=D.max(B.sheetCount,0);if(B.sheetCount==0){B.addSheet()}B.setActiveSheet(B.i);B.setDirty(true);B.setChanged(true);B.trigger("sheetDelete",[N])},deleteRow:function(Q,O){var N,u,M,S,U=B.sheetSize(),T,I=B.obj.pane(),R=I.table.tBody,L,P=B.highlighter;if(Q){u=M=Q}else{u=(P.startRowIndex<P.endRowIndex?P.startRowIndex:P.endRowIndex);M=(P.endRowIndex>P.startRowIndex?P.endRowIndex:P.startRowIndex)}S=(M-u)+1;if(u<1||U.cols<2||S>=U.rows){return}N=M;do{L=B.getTd(-1,N,1);if(L===null){continue}T=L.parentNode;R.removeChild(T)}while(u<N--);B.controls.bar.y.th[B.i].splice(u,S);B.spreadsheets[B.i].splice(u,S);B.refreshRowLabels(u);B.setChanged(true);B.offsetFormulas({row:u,col:0},{row:-S,col:0},false,true);B.setDirty(true);B.evt.cellEditAbandon();if(I.inPlaceEdit){I.inPlaceEdit.goToTd()}B.trigger("sheetDeleteRow",N)},deleteColumn:function(P){var O,u,N,S,U=B.sheetSize(),T,M,L=B.obj.pane(),Q=B.highlighter;if(P){u=N=P}else{u=(Q.startColumnIndex<Q.endColumnIndex?Q.startColumnIndex:Q.endColumnIndex);N=(Q.endColumnIndex>Q.startColumnIndex?Q.endColumnIndex:Q.startColumnIndex)}S=(N-u)+1;if(u<1||U.cols<2||S>=U.cols){return}O=N;B.obj.barHelper().remove();do{var R=B.obj.table(),I=B.col(R[0],O);d(B.obj.barTop(O)).remove();d(I).remove()}while(u<O--);B.controls.bar.x.th[B.i].splice(u,S);M=B.spreadsheets[B.i].length-S;do{T=B.spreadsheets[B.i][M].splice(u,S);while(T.length>0){d(T.pop().td).remove()}}while(M-->1);B.refreshColumnLabels(u);B.setChanged(true);B.offsetFormulas({row:0,col:u},{row:0,col:-S},false,true);B.setDirty(true);B.evt.cellEditAbandon();if(L.inPlaceEdit){L.inPlaceEdit.goToTd()}B.trigger("sheetDeleteColumn",O)},sheetTab:function(I,L){var u="";if(I){u=K.loader.title(B.i)||B.msg.sheetTitleDefault.replace(/[{]index[}]/gi,B.i+1);if(L){L(u)}return u}else{if(B.isSheetEditable()&&K.editableNames){K.prompt(B.msg.newSheetTitle,function(M){if(!M){u=K.loader.title(B.i);M=(u?u:B.msg.sheetTitleDefault.replace(/[{]index[}]/gi,B.i+1))}else{B.setDirty(true);B.obj.table().attr("title",M);B.obj.tab().html(M);u=M}if(L){L(d(l.createElement("div")).text(u).html())}},B.sheetTab(true));return null}}},followMe:function(M,u){M=M||B.obj.tdActive();if(M===null){return}var L=B.obj.pane(),I=L.actionUI;B.setBusy(true);B.setBusy(false);if(!u){B.autoFillerGoToTd(M)}},autoFillerGoToTd:function(M,I,u){if(!K.autoFiller){return}if(M===J&&B.cellLast!==null){M=B.cellLast.td}if(M&&M.type=="cell"){I=I||M.clientHeight;u=u||M.clientWidth;if(!M.offsetHeight||!M.offsetWidth||!M.clientHeight||!M.clientWidth){B.autoFillerHide();return}var L=d(M).position();B.autoFillerShow(((L.top+(I||M.clientHeight)-3)+"px"),((L.left+(u||M.clientWidth)-3)+"px"))}},autoFillerHide:function(){if(!K.autoFiller){return}var I=B.obj.autoFiller(),u=I.parentNode;if(u!==null){u.removeChild(I)}},autoFillerShow:function(N,M){if(!K.autoFiller){return}var L=B.obj.autoFiller(),I=B.obj.pane(),u=L.style;u.top=N;u.left=M;I.insertBefore(L,I.firstChild)},setActiveSheet:function(M,I){if(I!==J){M=I.i}else{M=M||0}if(B.cellLast!==null&&(B.cellLast.rowIndex>0||B.cellLast.columnIndex>0)){B.evt.cellEditDone();B.obj.formula().val("")}var O=B.obj.ui,P=B.obj.panes(),L=0,Q=P.length,R,u,N;B.autoFillerHide();for(;L<Q;L++){if(M!=L){u=P[L];R=u.scroll;if(u!==J&&u.parentNode.parentNode!==null){u._scrollLeft=u._scrollLeft||R.scrollLeft;u._scrollTop=u._scrollTop||R.scrollTop;O.removeChild(u.parentNode)}}}B.i=M;O.appendChild(N=B.obj.enclosure());B.highlighter.setTab(B.obj.tab());u=N.pane;if(u.inPlaceEdit){u.inPlaceEdit.goToTd()}u.scroll.scrollLeft=u._scrollLeft||u.scroll.scrollLeft;u.scroll.scrollTop=u._scrollTop||u.scroll.scrollTop;u._scrollLeft=u._scrollTop=null},getSpreadsheetIndexByTitle:function(O){if(K.loader!==null){var N=K.loader.getSpreadsheetIndexByTitle(O);return N}var L=B.obj.tables(),u=L.length,M,I=0;for(;I<u;I++){M=L[I];if(M.getAttribute("title")==O){return M.spreadsheetIndex}}return null},getSpreadsheetTitleByIndex:function(u){if(K.loader!==null){return K.loader.json[u].title}var I=B.obj.tables(),L;if(I[u]){L=I[u].getAttribute("title");return L}return null},openSheet:function(u){var L=u.count,M=L-1,I=function(){B.setBusy(true);B.s.loader=u;var T=B.controlFactory.header(),S=B.controlFactory.ui(),N=B.controlFactory.sheetAdder(),P=B.controlFactory.tabContainer(),R,Q={initChildren:function(V,U){B.controlFactory.sheetUI(V,U);B.trigger("sheetOpened",[U])},done:function(U){B.sheetSyncSize();B.setActiveSheet(0);B.setDirty(false);B.setBusy(false);B.trigger("sheetAllOpened")},lastIndex:M},O;T.ui=S;T.tabContainer=P;S.header=T;S.sheetAdder=N;S.tabContainer=P;P.header=T;P.ui=S;K.parent.append(T).append(S).append(N).append(P);B.resizableSheet(K.parent,{minWidth:K.parent.width()*0.1,minHeight:K.parent.height()*0.1,start:function(){B.setBusy(true);B.obj.ui.removeChild(B.obj.enclosure());S.sheetAdder.hide();S.tabContainer.hide()},stop:function(){B.obj.ui.appendChild(B.obj.enclosure());S.sheetAdder.show();S.tabContainer.show();B.setBusy(false);B.sheetSyncSize();var U=B.obj.pane();if(U.inPlaceEdit){U.inPlaceEdit.goToTd()}}});B.insertSheet=function(X,U,W){B.sheetCount++;X=X||null;W=W!==J?W:true;U=U||B.sheetCount-1;if(X!==null){K.loader.addSpreadsheet(X)}var Y=function(){B.obj.ui.removeChild(B.obj.enclosure());B.setBusy(true);var Z=new k.SpreadsheetUI(U,S,Q);B.setActiveSheet(-1,Z);B.setBusy(false);B.sheetSyncSize()},V;if(W){Y();return}V=B.controlFactory.customTab(u.title(U)).mousedown(function(){Y();B.obj.tab().insertBefore(this);d(this).remove();return false});if(K.loader.isHidden(U)){V.hide()}};O=new k.SpreadsheetUI(0,S,Q);B.sheetCount++;if(L>0){for(R=1;R<L;R++){B.insertSheet(null,R,false)}B.i=0;O.loaded()}};if(B.isDirty){K.confirm(B.msg.openSheet,I)}else{I()}},newSheet:function(){K.parent.html(d.sheet.makeTable()).sheet(K)},sheetSyncSize:function(){var T=K.parent,P=T[0],V=P.clientHeight,Q=P.clientWidth,U=B.obj.tabContainer(),W=U[0],u=W.style,Z=f.scrollBarSize.width,I,Y,S,R,N=B.obj.ui.style,O,aa,M,X,L;if(!V){V=400;T.height(V)}else{if(V<200){V=200;T.height(V)}}L=W.scrollLeft;u.width="";I=W.clientWidth;Y=(Q-(K.colMargin+Z));S=(Q-K.colMargin*2)+"px";R=((K.colMargin+Z)+"px");if(I>Y){u.height=R;U.addClass(B.cl.tabContainerScrollable);V-=Z}else{u.height=null;U.removeClass(B.cl.tabContainerScrollable)}u.width=S;W.scrollLeft=L;V-=B.obj.header().outerHeight()+K.boxModelCorrection;V-=W.clientHeight+K.boxModelCorrection;O=(V-f.scrollBarSize.height-K.boxModelCorrection)+"px";aa=(Q-f.scrollBarSize.width)+"px";M=(V+"px");X=(Q+"px");B.obj.panes().each(function(){var ad=this.style,ac=this.scroll.style,ab=this.enclosure.style;ad.height=O;ad.width=aa;ab.height=ac.height=M;ab.width=ac.width=X});N.height=M;N.width=X},showSheets:function(){B.obj.tabContainer().children().each(function(u){d(this).show();if(K.loader!==null){K.loader.setHidden(u,false)}})},showSheet:function(u){B.obj.tabContainer().children().eq(u).show();if(K.loader!==null){K.loader.setHidden(u,false)}},hideSheet:function(u){B.obj.tabContainer().children().eq(u).hide();if(K.loader!==null){K.loader.setHidden(u,true)}},cellChangeStyle:function(L,M,u){u=u||B.highlighted(true);if(u.length<1){return false}B.setDirty(this);var I=u.length-1;if(I>=0){B.undo.createCells(u,function(N){do{N[I].td.css(L,M)}while(I--);return N});return true}return false},cellFind:function(u){function I(M){var L=B.obj.table().children("tbody").children("tr");if(M){var N=L.children('td:contains("'+M+'")');if(N.length<1){N=L.children('td:contains("'+M.toLowerCase()+'")')}if(N.length<1){N=L.children('td:contains("'+M.toUpperCase()+'")')}N=N.eq(0);if(N.length>0){B.cellEdit(N)}else{K.alert(B.msg.cellNoFind)}}}if(!u){K.prompt(B.msg.cellFind,I)}else{I(u)}},cellSetActiveBar:function(R,I,M){var Y=K.loader.size(),V,O,u={},T={},U,X=function(Z){switch(K.cellSelectModel){case k.openOfficeSelectModel:this.row=Z.startRowIndex;this.col=Z.startColumnIndex;this.td=B.getTd(-1,this.row,this.col);if(this.td!==null&&(B.cellLast!==null&&this.td!==B.cellLast.td)){B.cellEdit(this.td,false,true)}break;default:this.row=Z.endRowIndex;this.col=Z.endColumnIndex;this.td=B.getTd(-1,this.row,this.col);if(this.td!==null&&(B.cellLast!==null&&this.td!==B.cellLast.td)){B.cellEdit(this.td,false,true)}break}},N=[],Q=B.obj.pane().actionUI.scrolledArea,P,W,L,S=B.highlighter;switch(R){case"top":u.row=Q.row;T.row=Q.row;if(I.th.rowIndex<M.th.rowIndex){S.startColumnIndex=P=V=u.col=I.th.cellIndex;S.endColumnIndex=O=T.col=M.th.cellIndex}else{U=true;S.startColumnIndex=P=V=u.col=M.th.cellIndex;S.endColumnIndex=O=T.col=I.th.cellIndex}S.startRowIndex=1;S.endRowIndex=Y.rows;N.push(I.col);for(;P<O;P++){N.push(N[N.length-1].nextSibling)}break;case"left":u.row=first;u.col=Q.col;T.row=last;T.col=Q.col;S.startRowIndex=first;S.startColumnIndex=1;S.endRowIndex=last;S.endColumnIndex=Y.cols;W=last;do{L=B.getTd(-1,W,1);if(L===null){continue}N.push(L.parentNode)}while(W-->first);break;case"corner":u.row=1;u.col=1;T.col=Y.cols;T.row=Y.rows;N.push(sheet[0]);break}new X(S);B.highlighter.set(N)},getTdRange:function(M,R,P,Q){B.cellLast.isEdit=true;var I=function(T){if(T.first.col>T.last.col||T.first.row>T.last.row){return{first:h.parseCellName(T.last.col,T.last.row),last:h.parseCellName(T.first.col,T.first.row)}}else{return{first:h.parseCellName(T.first.col,T.first.row),last:h.parseCellName(T.last.col,T.last.row)}}},O=function(W){var T=I(W),V=R+"";V=(V.match(/=/)?V:"="+V);if(P||V.charAt(V.length-1)!="("){V=V+(P?P:"")+"("}var X,U="";if(T.first!=T.last){X=T.first+":"+T.last}else{X=T.first}if(V.charAt(V.length-1)=="("){U=")"}return V+X+U},u="",L,N,S;if(M){L={first:B.getTdLocation([M.target])};N=B.obj.table().mousemove(function(T){L.last=B.getTdLocation([T.target]);u=O(L);if(!Q){B.obj.formula().val(u);B.obj.inPlaceEdit().val(u)}});x.one("mouseup",function(){N.unbind("mousemove");return u})}else{S=B.highlighted().not(B.obj.tdActive());if(S.length){L={first:B.getTdLocation(S.first()),last:B.getTdLocation(S.last())};u=O(L);if(!Q){B.obj.formula().val(u);B.obj.inPlaceEdit().val(u)}return u}else{return""}}return""},getTd:function(L,I,M){if(L<0){L=B.i}var u=K.loader.jitCell(L,I,M);if(u===null){return u}return u.td||null},getTdLocation:function(M){var u={col:0,row:0},I=0,L=B.obj.pane();if(M===J||M===null){return u}if(M.parentNode===J||(M.parentNode.rowIndex+I)<0){return u}return{col:M.cellIndex,row:M.parentNode.rowIndex+I}},getBarIndex:{left:function(u){u=u||{};if(!u.parentNode||w(u.parentNode.rowIndex)){return -1}else{return u.parentNode.rowIndex}},top:function(u){u=u||{};if(w(u.cellIndex)){return -1}else{return u.cellIndex}},corner:function(){return 0}},time:{now:new a(),last:new a(),diff:function(){return D.abs(D.ceil(this.last.getTime()-this.now.getTime())/1000).toFixed(5)},set:function(){this.last=this.now;this.now=new a()},get:function(){return this.now.getHours()+":"+this.now.getMinutes()+":"+this.now.getSeconds()}},changed:[],isChanged:function(u){return B.changed[u||B.i]},setChanged:function(u){B.changed[B.i]=u},isDirty:false,setDirty:function(u){B.dirty=u},appendToFormula:function(u){var L=B.obj.formula(),I=L.val();if(I.charAt(0)!="="){I="="+I}L.val(I+u)},undo:{manager:(f.UndoManager?new UndoManager():{undo:F,redo:F,register:F}),cells:[],id:-1,createCells:function(u,I,N){if(N===J){B.undo.id++;N=B.undo.id}var L=(new k.CellRange(u)).clone().cells,M=(I!==J?(new k.CellRange(I(u)).clone()).cells:L);L.id=N;M.id=N;B.undo.manager.add({undo:function(){B.undo.removeCells(L,N)},redo:function(){B.undo.createCells(M,null,N)}});if(N!==B.undo.id){B.undo.draw(M)}return true},removeCells:function(I,M){var L=0,u=-1;if(I.id===M){u=L}if(u!==-1){B.undo.cells.splice(u,1)}B.undo.draw(I)},draw:function(L){var I,O,N,u,M;for(I=0;I<L.length;I++){N=L[I];M=B.getTdLocation(N.td);u=B.spreadsheets[N.sheetIndex][M.row][M.col];u.value=N.value;u.formula=N.formula;O=u.td=N.td;u.dependencies=N.dependencies;u.needsUpdated=N.needsUpdated;u.calcCount=N.calcCount;u.sheetIndex=N.sheetIndex;u.rowIndex=M.row;u.columnIndex=M.col;u.state=N.state;u.jS=N.jS;O.setAttribute("style",N.style);O.setAttribute("class",N.cl);u.setNeedsUpdated();u.updateValue()}}},cols:function(u){u=u||B.obj.table()[0];if(!u){return[]}if(!u.colGroup){return[]}if(!u.colGroup.children){return[]}return u.colGroup.children},tables:function(S,N){S=S||B.obj.tables();var R=[],L=S.length-1,I,U,Q,u,V,M,T,O,P;do{U=(N?l.body.removeChild(S[L]):S[L].cloneNode(true));if((u=U.children[0])&&(V=u.children[0])){u.removeChild(V)}if(Q=U.children[1]){O=Q.children;T=O[0];Q.removeChild(T);I=O.length-1;do{P=O[I];M=P.children[0];P.removeChild(M)}while(I-->0)}R[L]=U}while(L-->0);return B.sheetDecorateRemove(false,d(R))},col:function(I,u){I=I||B.obj.table()[0];var L=B.cols(I);if(u===J){u=L.length-1}return L[u]},rowTds:function(I,u){I=I||B.obj.table();var L=B.rows(I);if(!L.length){return[]}if(u==J){u=L.length-1}if(!L[u]){return[]}if(!L[u].children){return[]}return L[u].children},rows:function(u){u=u||B.obj.table()[0];if(u===J){return[]}if(u.tBody===J){return[]}if(u.tBody.children===J){return[]}return u.tBody.children},highlighted:function(I){var M=B.highlighter.last||d([]),N=[],u,L;if(!(u=M)||!M.length||!(u=u[0])||!u.tagName){return I?N:d(N)}switch(u.tagName){case"TD":L=M.length-1;do{N.unshift(I?M[L].jSCell:M[L])}while(L-->0);break;case"TR":L=M.length-1;do{if(M[L].tds){N=N.concat(I?M[L].jSCells:M[L].tds)}}while(L-->0);break;case"COL":M=M.filter("col");L=M.length-1;do{if(M[L].tds){N=N.concat(I?M[L].jSCells:M[L].tds)}}while(L-->0);break;case"TABLE":N=(I?u.jSCells:u.tds);break}return I?N:d(N)},sheetSize:function(L){L=L||B.obj.table()[0];var I,O,u={},M=K.minSize||{rows:1,cols:1},N;if(K.loader!==null){N=K.loader.size(L.spreadsheetIndex);u.rows=g.max(N.rows,M.rows);u.cols=g.max(N.cols,M.cols)}else{if((u.cols=K.initScrollCols)>0&&(u.rows=K.initScrollRows)>0){}else{I=B.rowTds(L);O=B.getTdLocation(I[I.length-1]);u.cols=O.col;u.rows=O.row}}return u},sortVerticalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){B.sortVertical();return true}else{B.sortVerticalSingle(false);return true}},sortVerticalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){B.sortVertical();return false}else{B.sortVerticalSingle(true);return false}},sortVertical:function(S){var Q=B.highlighted(true),N=Q[0].td.parent().prev(),u=Q.length,L=new a(),P=true,T=[],V=[],O,R=0,U,I,M;while(R<u){U=Q[R];M=U.td;if(!isNaN(U.value)){I=(new s(U.value.valueOf()))}else{P=false;I=(new p(U.value.valueOf()))}I.loc=B.getTdLocation(M);I.row=M.parentNode;I.col=M;I.cell=U;T.push(I);R++}if(S){if(P==false){T.sort(function(X,W){return W-X})}else{T.sort();T.reverse()}}else{if(P==true){T.sort(function(X,W){return X-W})}else{T.sort()}}B.undo.createCells(Q);while(O=T.length){I=T.pop();V=B.spreadsheets[B.i].splice(I.row.rowIndex,1);U=I.cell;U.value=I.valueOf();I.row.parentNode.removeChild(I.row);N.after(I.row);I.row.children[0].innerHTML=N[0].rowIndex+O;B.spreadsheets[B.i].splice(N[0].rowIndex+1,0,V[0]);B.track.call(U,true)}B.undo.createCells(Q)},sortVerticalSingle:function(O){var M=B.highlighted(true),N=M.length,L=0,I=[],u;while(L<N){I.push(M[L].value);L++}if(O){I.sort(function(Q,P){return P-Q})}else{I.sort(function(Q,P){return Q-P})}while(M.length){u=M.pop();u.value=I[M.length];u.updateValue()}},sortHorizontalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){B.sortHorizontal();return true}else{B.sortHorizontalSingle(false);return true}},sortHorizontalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){B.sortHorizontal();return false}else{B.sortHorizontalSingle(true);return false}},sortHorizontal:function(N){var V=B.highlighted(true),W=B.obj.pane(),Z=W.table,M=V[0].td,L=M.jSCell,u=L.cellIndex,X=Z.colGroup,U=B.sheetSize().rows,O=V.length,T=true,S=[],P,Y=0,R,L,aa,I,Q;while(Y<O){R=0;L=V[Y];Q=L.td;if(!isNaN(L.value)){aa=new s(L.value.valueOf())}else{T=false;aa=new p(L.value.valueOf())}aa.tds=[];aa.loc=B.getTdLocation(Q);aa.tr=Q.parentNode;aa.td=Q;aa.cell=L;while(R<=U){aa.tds.push(B.obj.pane().table.children[1].children[R].children[Q.cellIndex]);R++}S.push(aa);Y++}if(N){if(T==false){S.sort(function(ac,ab){return ab-ac})}else{S.sort();S.reverse()}}else{if(T==true){S.sort(function(ac,ab){return ac-ab})}else{S.sort()}}B.undo.createCells(V);while(S.length){aa=S.pop();while(aa.tds.length>1){Q=aa.tds.pop();I=Q.parentNode;L=B.spreadsheets[B.i][I.rowIndex].splice(Q.cellIndex,1);I.insertBefore(Q,I.children[u]);Q.col=X.children[S.length+Q.cellIndex-1];Q.barTop=Q.col.bar;L.value=Q.jSCell.value;B.spreadsheets[B.i][I.rowIndex].splice(Q.cellIndex,0,L[0]);B.resolveCell(L,true)}}B.undo.createCells(V)},sortHorizontalSingle:function(O){var M=B.highlighted(true),N=M.length,L=0,I=[],u;while(L<N){I.push(M[L].value);L++}if(O){I.sort(function(Q,P){return P-Q})}else{I.sort(function(Q,P){return Q-P})}while(M.length){u=M.pop();u.value=I[M.length];u.updateValue()}},tableSize:function(S,P){var R,L,Q,u,N,I=S.pane,T=0,M=0,O=0;S=S||B.obj.table()[0];if((R=S.tBody)!==J&&(L=R.children)!==J&&(Q=L[L.length-1])!==J&&(u=Q.children)!==J&&(N=u[u.length-1])!==J){if(P===true){T=Q.rowIndex}else{T=Q.rowIndex+O}M=N.cellIndex}else{return{}}return{cols:M,rows:T}},toggleState:function(u){if(K.allowToggleState){var I=u||B.tables();if(K.editable){B.evt.cellEditAbandon();B.trigger("sheetSave",[I])}B.setDirty(false);B.setChanged(true);K.editable=!K.editable;B.kill();K.parent.html(I).sheet(K);K=null}},setCellRef:function(L){function I(N){if(N){B.s.formulaVariables[N]=u.updateValue()}}var M=B.obj.tdActive(),u=M.jSCell;if(L){I(L)}else{K.prompt(B.msg.setCellRef,I)}},parseFormula:null,print:function(u,I){u=u||B.i;var M=f.open(),L;if(M!==J){L=M.document;L.write('<html>	<head id="head"></head>	<body>		<div id="entry" class="'+B.cl.parent+'" style="overflow: show;">		</div>	</body></html>');if(I!==true){d(L.getElementById("head")).append(d("style,link").clone())}d(L.getElementById("entry")).append(B.obj.pane().cloneNode(true));L.close();M.focus();M.print()}}},y=[],G;B.setBusy(true);K.parent[0].jS=B;if(!f.console){f.console={log:function(){}}}if(f.scrollBarSize===J){f.scrollBarSize=m()}B.cellHandler=new k.CellHandler(B,h,d.sheet.fn);B.theme=new k.Theme(K.theme);B.highlighter=new k.Highlighter(B.theme.tdHighlighted,B.theme.barHighlight,B.theme.tabActive,function(){});K.origHtml=K.parent.children().detach();K.parent.addClass(B.cl.parent);K.parent.bind("sheetSwitch",function(L,I,u){B.switchSheet(u)}).bind("sheetRename",function(L,I,u){B.renameSheet(u)});K.width=(K.width?K.width:K.parent.width());K.height=(K.height?K.height:K.parent.height());if(!d.nearest){B.nearest=F}B.resizableCells=B.resizableSheet=B.resizable;if(!d.ui){B.resizable=B.resizableCells=B.resizableSheet=B.draggable=F}else{if(!K.resizableCells){B.resizableCells=F}if(!K.resizableSheet){B.resizableSheet=F}}if(!d.support.boxModel){K.boxModelCorrection=0}if(!K.barMenus){B.controlFactory.barMenuTop=B.controlFactory.barMenuLeft=F}if(!K.freezableCells){B.controlFactory.barHandleFreeze.top=B.controlFactory.barHandleFreeze.left=F}if(K.calcOff){B.calc=F}if(!f.Raphael){h.chart=F}v.resize(function(){if(B&&!B.isBusy()){K.width=K.parent.width();K.height=K.parent.height();B.sheetSyncSize()}}).unload(function(){k.thread.kill()});if(d.sheet.fn){d.sheet.fn=d.extend(d.sheet.fn,K.formulaFunctions);if(d.sheet.advancedfn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.advancedfn)}if(d.sheet.financefn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.financefn)}}K.title=K.title||K.parent.attr("title")||"";B.s=K;B.parseFormula=(K.useMultiThreads?k.parseFormula:k.parseFormulaSlow);K.parent.addClass(B.theme.parent);if(K.loader===null){K.loader=(new k.Loader.HTML(K.origHtml))}K.loader.bindJS(B).bindHandler(B.cellHandler);B.openSheet(K.loader);B.setBusy(false);return B},makeTable:function(G,w,u){var E=l;G=G||{rows:25,cols:10};w=w||120;u=u||15;var F=l.createElement("table"),v=l.createElement("colgroup"),D=l.createElement("tbody"),A="width:"+w+"px;",y="height:"+u+"px;",C,x,B,z;B=G.cols;do{x=l.createElement("col");x.setAttribute("style",A);v.appendChild(x)}while(B-->1);B=G.rows;do{C=l.createElement("tr");C.setAttribute("style",y);z=G.cols;do{C.appendChild(l.createElement("td"))}while(z-->1);D.appendChild(C)}while(B-->1);F.appendChild(v);F.appendChild(D);return F},killAll:function(){if(d.sheet){var u=d.sheet.instance;if(u){for(var v=0;v<u.length;v++){if(u[v]&&u[v].kill){u[v].kill()}}d.sheet.instance=[]}}},scrollLocker:function(v){var u=d.sheet.instance;u[v].obj.panes().each(function(w){var x;d(x=this.scrollUI).scroll(function(z){var y=u.length-1,A;if(y>-1){do{A=u[y].controls.enclosures[w].scrollUI;if(this!==A){A.scrollLeft=x.scrollLeft;A.scrollTop=x.scrollTop}}while(y--)}})})},switchSheetLocker:function(u){d.each(d.sheet.instance,function(){this.s.parent.bind("sheetSwitch",function(x,w,v){d.each(d.sheet.instance,function(){this.setActiveSheet(v)})})})},I:function(){var u=0;if(this.instance){u=(this.instance.length===0?0:this.instance.length-1)}else{this.instance=[]}return u}};var h=d.sheet.engine={calc:function(x,v){v=v||[];var z=v.length-1,y,w,u;if(z>0){do{if(z>0&&v[z]){y=v[z];w=y.length-1;if(w>0){do{u=y[w];u.updateValue()}while(w-->1)}}}while(z-->1)}},parseLocation:function(u,v){return{row:parseInt(v),col:h.columnLabelIndex(u)}},parseSheetLocation:function(v){var u=((v+"").replace(/SHEET/i,"")*1)-1;return isNaN(u)?-1:u},parseCellName:function(u,v){return h.columnLabelString(u)+(v||"")},alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),columnLabels:{},columnLabelIndex:function(u){return this.columnLabels[u.toUpperCase()]},columnIndexes:[],columnLabelString:function(x){if(!this.columnIndexes.length){var z="",y,w,v,u;y=w=v=-1;for(u=1;u<16385;++u){z="";++v;if(v==26){v=0;++w;if(w==26){w=0;++y}}if(y>=0){z+=this.alphabet[y]}if(w>=0){z+=this.alphabet[w]}if(v>=0){z+=this.alphabet[v]}this.columnIndexes[u]=z;this.columnLabels[z]=u}}return this.columnIndexes[x]||""},chart:function(w){var z=this.jS,D=z.s.loader,C=l.createElement("div"),y=this.td,B,A=l.body;A.appendChild(C);function x(F,G){if(!F){if(G){F=0}else{F=""}}else{if(G){F=c.toNumbers(F)}else{F=c.flatten(F)}}return F}w=d.extend({x:{legend:"",data:[0]},y:{legend:"",data:[0]},title:"",data:[0],legend:""},w);C.className=z.cl.chart;C.onmousedown=function(){d(y).mousedown()};C.onmousemove=function(){d(y).mousemove();return false};z.controls.chart[z.i]=z.obj.chart().add(C);w.data=x(w.data,true);w.x.data=x(w.x.data,true);w.y.data=x(w.y.data,true);w.legend=x(w.legend);w.x.legend=x(w.x.legend);w.y.legend=x(w.y.legend);w.legend=(w.legend?w.legend:w.data);var v=D.getWidth(this.sheetIndex,this.columnIndex),E=D.getHeight(this.sheetIndex,this.rowIndex),u=Raphael(C);if(w.title){u.text(v/2,10,w.title).attr({"font-size":20})}switch(w.type){case"bar":B=u.barchart(v/8,E/8,v*0.8,E*0.8,w.data,w.legend).hover(function(){this.flag=u.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"hbar":B=u.hbarchart(v/8,E/8,v*0.8,E*0.8,w.data,w.legend).hover(function(){this.flag=u.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"line":B=u.linechart(v/8,E/8,v*0.8,E*0.8,w.x.data,w.y.data,{nostroke:false,axis:"0 0 1 1",symbol:"circle",smooth:true}).hoverColumn(function(){this.tags=u.set();if(this.symbols.length){for(var F=0,G=this.y.length;F<G;F++){this.tags.push(u.tag(this.x,this.y[F],this.values[F],160,10).insertBefore(this).attr([{fill:"#fff"},{fill:this.symbols[F].attr("fill")}]))}}},function(){this.tags&&this.tags.remove()});break;case"pie":B=u.piechart(v/2,E/2,(v<E?v:E)/2,w.data,{legend:w.legend}).hover(function(){this.sector.stop();this.sector.scale(1.1,1.1,this.cx,this.cy);if(this.label){this.label[0].stop();this.label[0].attr({r:7.5});this.label[1].attr({"font-weight":800})}},function(){this.sector.animate({transform:"s1 1 "+this.cx+" "+this.cy},500,"bounce");if(this.label){this.label[0].animate({r:5},500,"bounce");this.label[1].attr({"font-weight":400})}});break;case"dot":B=u.dotchart(v/8,E/8,v*0.8,E*0.8,w.x.data,w.y.data,w.data,{symbol:"o",max:10,heat:true,axis:"0 0 1 1",axisxstep:w.x.data.length-1,axisystep:w.y.data.length-1,axisxlabels:(w.x.legend?w.x.legend:w.x.data),axisylabels:(w.y.legend?w.y.legend:w.y.data),axisxtype:" ",axisytype:" "}).hover(function(){this.marker=this.marker||u.tag(this.x,this.y,this.value,0,this.r+2).insertBefore(this);this.marker.show()},function(){this.marker&&this.marker.hide()});break}B.mousedown(function(){d(y).mousedown().mouseup()});A.removeChild(C);return C}};var n=d.sheet.fn={ISNUMBER:function(w){var u;if(!isNaN(w.valueOf())){u=new t(true);u.html="TRUE";return u}u=new t(false);u.html="FALSE";return u},N:function(u){if(u==null){return 0}if(u instanceof a){return u.getTime()}if(typeof(u)=="object"){u=u.toString()}if(typeof(u)=="string"){u=parseFloat(u.replace(/[\$,\s]/g,""))}if(isNaN(u)){return 0}if(typeof(u)=="number"){return u}if(u==true){return 1}return 0},VERSION:function(){return this.jS.version},ABS:function(u){return g.abs(n.N(u))},CEILING:function(v,u){u=u||1;return(parseInt(v/u)*u)+u},EVEN:function(u){u=g.round(u);var w=(u%2==0);if(!w){if(u>0){u++}else{u--}}return u},EXP:function(u){return g.exp(u)},FLOOR:function(w,v){v=v||1;if((w<0&&v>0)||(w>0&&v<0)){var u=new s(0);u.html="#NUM";return u}if(w>=0){return g.floor(w/v)*v}else{return g.ceil(w/v)*v}},INT:function(u){return g.floor(n.N(u))},LN:function(u){return g.log(u)},LOG:function(u,w){w=w||10;return g.log(u)/g.log(w)},LOG10:function(u){return n.LOG(u)},MOD:function(u,w){var v=u%w;if(w<0){v*=-1}return v},ODD:function(u){var x=false;if(u>0){u=g.floor(g.round(u));x=true}else{u=g.ceil(u)}var w=g.abs(u);if((w%2)==0){w++}if(x){return w}else{return -w}},PI:function(){return g.PI},POWER:function(u,v){return g.pow(u,v)},SQRT:function(u){return g.sqrt(u)},RAND:function(){return g.random()},RND:function(){return g.random()},ROUND:function(x,w){var u=g.pow(10,w||0);return g.round(x*u)/u},ROUNDDOWN:function(w,u){var x=(w<0);w=g.abs(w);u=u||0;w=g.floor(w*g.pow(10,u))/g.pow(10,u);return(x?-w:w)},ROUNDUP:function(w,u){var x=(w<0);w=g.abs(w);u=u||0;w=g.ceil(w*g.pow(10,u))/g.pow(10,u);return(x?-w:w)},SUM:function(){var z=0,x=c.flatten(arguments),w,y=0,u=x.length,A=isNaN;for(;y<u;y++){w=x[y];if(w===null||w===undefined){continue}w=w.valueOf();if(!A(w)){switch(typeof w){case"string":z+=(w*1);break;default:z+=w}}}return z},TRUNC:function(u,v){v=v||0;u=u+"";if(v==0){return u.split(".").shift()}if(u.match(".")){if(v==1){u=u.substr(0,u.length-1)}else{if(v==-1){u=u.split(".").shift();u=u.substr(0,u.length-1)+"0"}}}return u},AVERAGE:function(){return n.SUM.apply(this,arguments)/n.COUNT.apply(this,arguments)},AVG:function(){return n.AVERAGE.apply(this,arguments)},COUNT:function(){var x=0,u=c.toNumbers(arguments),w=u.length-1;if(w<0){return x}do{if(u[w]!==null){x++}}while(w--);return x},COUNTA:function(){var x=0,u=c.flatten(arguments),w=u.length-1;if(w<0){return x}do{if(u[w]){x++}}while(w--);return x},MAX:function(){var w=c.toNumbers(arguments),u=w[0],x=w.length-1;if(x<0){return 0}do{u=(w[x]>u?w[x]:u)}while(x--);return u},MIN:function(){var u=c.toNumbers(arguments),x=u[0],w=u.length-1;if(w<0){return 0}do{x=(u[w]<x?u[w]:x)}while(w--);return x},ASC:function(u){return u.charCodeAt(0)},CHAR:function(u){return p.fromCharCode(u)},CLEAN:function(u){var w=new b("[cG\x1BcLcJcMcIcK\x07\x1B\f\n\r\t\v]","g");return u.replace(w,"")},CODE:function(u){return n.ASC(u)},CONCATENATE:function(){var w=c.flatten(arguments),v="",u=this;jQuery.each(w,function(x){v+=w[x]});return v},DOLLAR:function(x,w,z){w=w||2;z=z||"$";var u=new s(x),y=n.FIXED(x,w,false);if(x>=0){u.html=z+y}else{u.html="("+z+y.slice(1)+")"}return u},FIXED:function(y,x,w){x=(x===undefined?2:x);var z=g.pow(10,x),u,y=g.round(y*z)/z;u=new p(y.toFixed(x));u.html=Globalize.format(y,"n"+x);if(w){u.html=u.html.replace(Globalize.culture().numberFormat[","],"")}return u},LEFT:function(u,w){u=u.valueOf().toString();w=w||1;return u.substring(0,w)},LEN:function(u){if(!u){return 0}return u.length},LOWER:function(u){return u.toLowerCase()},MID:function(x,y,w){if(!x||!y||!w){var u=new s(0);u.html="ERROR";return u}return x.substring(y-1,w+y-1)},REPLACE:function(v,y,w,x){if(!v||!y||!w||!x){var u=new p("");u.html="ERROR";return u}var u=v.split("");u.splice(y-1,w);u.splice(y-1,0,x);return u.join("")},REPT:function(w,y){var u="";for(var x=0;x<y;x++){u+=w}return u},RIGHT:function(u,w){w=w||1;return u.substring(u.length-w,u.length)},SEARCH:function(x,v,y){y=y||0;if(y){v=v.split("");v.splice(0,y-1);v=v.join("")}var w=v.search(x);if(w<0){var u=new p("");u.html="#VALUE!";return u}return y+(y?0:1)+w},SUBSTITUTE:function(x,u,w,y){y=y||0;u=new b(u,"g");var v=1;x=x.replace(u,function(A,C,D,B){var z=A;if(y){if(v>=y){z=w}}else{z=w}v++;return z});return x},TEXT:function(v,u){return v},UPPER:function(u){return u.toUpperCase()},VALUE:function(w){if(jQuery.isNumeric(w)){return w*=1}else{var u=new p("");u.html="#VALUE!";return u}},NOW:function(){var u=new a();u.html=e.toString(u);return u},TODAY:function(){var v=new a(),u=new s(e.toCentury(v)-1);u.html=e.toString(v,"d");return u},WEEKENDING:function(v){var u=new a();u=new a(u.getFullYear(),u.getMonth(),u.getDate()+5-u.getDay()-((v||0)*7));u.html=e.toString(u,"d");return u},WEEKDAY:function(v,w){v=e.get(v);var u=v.getDay();w=(w?w:1);switch(w){case 3:switch(u){case 0:return 7;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6}break;case 2:switch(u){case 0:return 6;case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5}break;case 1:u++;break}return u},WEEKNUM:function(u){u=e.get(u);return e.week(u)+1},YEAR:function(u){u=e.get(u);return u.getFullYear()},DAYSFROM:function(v,w,u){return g.floor((new a()-new a(v,(w-1),u))/e.dayDiv)},DAYS:function(y,w){var v=e.get(y),u=e.get(w),x=1000*60*60*24;return g.round(g.abs(v.getTime()-u.getTime())/x)},DAY:function(u){u=e.get(u);return u.getDate()},DAYS360:function(z,w,B){z=e.get(z);w=e.get(w);var u=z.getDate(),y=w.getDate(),x=e.isLastDayOfMonth(z),A=e.isLastDayOfMonth(w),v=e.diffMonths(z,w);if(B){u=g.min(u,30);y=g.min(y,30)}else{if(x){u=30}if(A){if(u<30){v++;y=1}else{y=30}}}return(v*30)+(y-u)},DATE:function(x,y,v){var w=new a(x,y-1,v),u=new s(e.toCentury(w));u.html=e.toString(w,"d");return u},DATEVALUE:function(v){v=e.get(v);var u=new s(e.toCentury(v));u.html=e.toString(v,"d");return u},EDATE:function(w,v){w=e.get(w);w.setMonth(w.getMonth()+v);var u=new s(e.toCentury(w));u.html=e.toString(w,"d");return u},EOMONTH:function(w,v){w=e.get(w);w.setMonth(w.getMonth()+v+1);w=new a(w.getFullYear(),w.getMonth(),0);var u=new s(e.toCentury(w));u.html=e.toString(w,"d");return u},HOUR:function(u){u=i.fromMath(u);return u.hour},MINUTE:function(u){return i.fromMath(u).minute},MONTH:function(u){u=e.get(u);return u.getMonth()+1},SECOND:function(u){return i.fromMath(u).second},TIME:function(u,z,v){v=(v?v:0);z=(z?z:0);u=(u?u:0);if(v&&v>60){var w=(((v/60)+"").split(".")[0])*1;v=v-(w*60);z+=w}if(z&&z>60){var y=(((z/60)+"").split(".")[0])*1;z=z-(y*60);u+=y}var x=(u*60*60*1000)+(z*60*1000)+(v*1000);return x/e.dayDiv},TIMEVALUE:function(u){if(!isNaN(u)){return u}if(/([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm)/.test(u)){return i.fromString(u,true)}else{if(/([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?/.test(u)){return i.fromString(u)}}return 0},WORKDAY:function(v,y,x){var z={1:true,2:true,3:true,4:true,5:true},v=e.get(v),y=(y&&!isNaN(y)?y:0),A=0,w=0,u=v,C;if(x){if(!jQuery.isArray(x)){x=[x]}x=c.flatten(x);var B={};jQuery.each(x,function(D){if(x[D]){B[e.toString(e.get(x[D]),"d")]=true}});x=B}else{x={}}while(w<y){u=new a(u.setDate(u.getDate()+1));if(z[u.getDay()]){if(!x[e.toString(u,"d")]){w++}}A++}C=new s(e.toCentury(u));C.html=e.toString(u,"d");return C},YEARFRAC:function(v,z,y){v=e.get(v);z=e.get(z);if(!v||!z){var u=new p("");u.html="#VALUE!";return u}y=(y?y:0);this.html=[];var x=e.diff(v,z,y),w=e.calcAnnualBasis(v,z,y);return x/w},AND:function(){var v,w=0,u=arguments.length;for(;w<u;w++){v=arguments[w];if(v===undefined||(v.valueOf!==undefined&&v.valueOf()!=true)||v!=true){return n.FALSE()}}return n.TRUE()},FALSE:function(){var u=new t(false);u.html="FALSE";return u},IF:function(y,w,v){var u=y.valueOf(),x;switch(typeof u){case"boolean":if(u===true){return w}else{return v}break;case"number":if(u!==0){return w}else{return v}break;case"string":x=u.toUpperCase();if(x==="TRUE"){return w}else{if(x==="FALSE"){return v}else{if(x.replace(/ /g,"").length>0){return w}}}break}if(u){return w}return w},NOT:function(w){var u;if(!w.valueOf()){u=new t(true);u.html="TRUE"}else{u=new t(false);u.html="FALSE"}return u},OR:function(){var x=arguments,u,y=x.length-1,w;if(y>-1){do{w=x[y].valueOf();if(w){u=new t(true);u.html="TRUE";return u}}while(y--)}u=new t(false);u.html="FALSE";return u},TRUE:function(){var u=new t(true);u.html="TRUE";return u},GREATER:function(w,v){var u;if(w>v){u=new t(true);u.html="TRUE"}else{u=new t(false);u.html="FALSE"}return u},LESS:function(w,v){var u;if(w<v){u=new t(true);u.html="TRUE"}else{u=new t(false);u.html="FALSE"}return u},EQUAL:function(x,w){var u,y,v;if(x===undefined||x===null){x=""}if(w===undefined||w===null){w=""}y=x+"";v=w+"";if(y==v){u=new t(true);u.html="TRUE"}else{u=new t(false);u.html="FALSE"}return u},GREATER_EQUAL:function(w,v){var u;if(w>=v){u=new t(true);u.html="TRUE"}else{u=new t(false);u.html="FALSE"}return u},LESS_EQUAL:function(w,v){var u;if(w<=v){u=new t(true);u.html="TRUE"}else{u=new t(false);u.html="FALSE"}return u},IMG:function(w){var u=new p("");u.html=d(l.createElement("img")).attr("src",w);return u},TRIM:function(u){if(typeof(u)=="string"){u=d.trim(u)}return u},HYPERLINK:function(v,w){w=w||"LINK";var u=new p(w.valueOf()),x=l.createElement("a");x.setAttribute("href",v);x.setAttribute("target","_new");x.innerText=x.textContent=w;u.html=x;return u},DROPDOWN:function(){var F=this,A=this.jS,x=this.td,D,E,z,C,w,G,y=0,B;if(x!==null){d(x).children().detach();z=F.value.html}if(z===undefined||F.needsUpdated||z.length<1){E=c.flatten(arguments);E=c.unique(E);if(this.id!==null){w=this.id+"-dropdown"}else{if(x!==null){w="dropdown"+this.sheetIndex+"_"+this.rowIndex+"_"+this.columnIndex+"_"+A.I}}C=l.createElement("select");C.setAttribute("name",w);C.setAttribute("id",w);C.className="jSDropdown";C.cell=this;C.onmouseup=function(){if(this.cell.td!==null){A.cellEdit(this.cell.td)}};C.onchange=function(){D=new p(this.value);D.html=C;D.cell=F;F.value=D;F.setNeedsUpdated(false);A.resolveCell(F);A.trigger("sheetCellEdited",[F])};B=(E.length<=50?E.length:50);for(;y<B;y++){if(E[y]){var u=l.createElement("option");u.setAttribute("value",E[y]);u.text=u.innerText=E[y];C.appendChild(u)}}if(!A.s.editable){C.setAttribute("disabled",true)}else{A.s.parent.bind("sheetKill",function(){x.innerText=x.textContent=F.value.valueOf()})}C.value=F.value||E[0]}if(typeof F.value!=="object"){G=new p(F.value)}else{G=F.value}G.html=C;return G},RADIO:function(){var F=this,A=this.jS,x=this.td,E,D,z,w,u,G;if(x!==null){z=F.value.html;d(x).children().detach()}if(z===undefined||z.length<1||F.needsUpdated){E=c.flatten(arguments);E=c.unique(E);if(this.id!==null){u=this.id+"-radio"}else{if(x!==null){u="radio"+this.sheetIndex+"_"+this.rowIndex+"_"+this.columnIndex+"_"+A.I}}z=l.createElement("span");z.className="jSRadio";z.onmousedown=function(){if(this.cell.td!==null){A.cellEdit(F.td)}};z.cell=F;for(var y=0;y<(E.length<=25?E.length:25);y++){if(E[y]){var C=l.createElement("input"),B=l.createElement("span");C.setAttribute("type","radio");C.setAttribute("name",u);C.className=u;C.value=E[y];if(!A.s.editable){C.setAttribute("disabled","disabled")}C.onchange=function(){D=new p(this.value);D.html=z;D.cell=F;F.value=D;F.setNeedsUpdated(false);A.resolveCell(F);A.trigger("sheetCellEdited",[F])};if(E[y].valueOf()===F.value.valueOf()){C.checked=true}B.textContent=B.innerText=E[y];z.appendChild(C);B.input=C;B.onmousedown=function(){d(this.input).click()};z.appendChild(B);z.appendChild(l.createElement("br"))}}A.s.parent.bind("sheetKill",function(){x.textContent=x.innerText=F.value.valueOf()})}if(typeof F.value!=="object"){G=new p(F.value)}else{G=F.value}G.html=z;return G},CHECKBOX:function(C){if(d.isArray(C)){C=C[0]}var D=this,y=this.jS,w=this.td,x,A,z,u,B,E;if(w!==null){x=D.value.html;d(w).children().detach()}if(x===undefined||x.length<1||D.needsUpdated){if(this.id!==null){u=this.id+"-checkbox"}else{if(w!==null){u="checkbox"+this.sheetIndex+"_"+this.rowIndex+"_"+this.columnIndex+"_"+y.I}}z=l.createElement("input");z.setAttribute("type","checkbox");z.setAttribute("name",u);z.setAttribute("id",u);z.className=u;z.value=C;z.onchange=function(){if(this.checked){B=new p(C)}else{B=new p("")}B.html=x;B.cell=D;D.value=B;D.setNeedsUpdated(false);y.resolveCell(D);y.trigger("sheetCellEdited",[D])};if(!y.s.editable){z.setAttribute("disabled","true")}else{y.s.parent.bind("sheetKill",function(){D.value=(D.value=="true"||z.checked?C:"");if(D.td!==null){D.td.innerText=D.td.textContent=D.value.valueOf()}})}x=l.createElement("span");x.className="jSCheckbox";x.appendChild(z);A=l.createElement("span");A.textContent=A.innerText=C;x.appendChild(A);x.appendChild(l.createElement("br"));x.onmousedown=function(){if(this.cell.td!==null){y.cellEdit(this.cell.td)}};x.cell=D;switch(D.value.valueOf()){case C.valueOf():case"true":z.checked=true}}if(D.value==="true"||z.checked){E=new p(C)}else{E=new p("")}E.html=x;return E},BARCHART:function(v,w,x){var u=new p("");u.html=h.chart.call(this,{type:"bar",data:v,legend:w,title:x});return u},HBARCHART:function(v,w,x){var u=new p("");u.html=h.chart.call(this,{type:"hbar",data:v,legend:w,title:x});return u},LINECHART:function(w,v){var u=new p("");u.html=h.chart.call(this,{type:"line",x:{data:w},y:{data:v},title:""});return u},PIECHART:function(v,w,x){var u=new p("");u.html=h.chart.call(this,{type:"pie",data:v,legend:w,title:x});return u},DOTCHART:function(A,y,v,x,w,z){var u=new p("");u.html=h.chart.call(this,{type:"dot",data:(v?v:A),x:{data:A,legend:x},y:{data:(y?y:A),legend:(w?w:x)},title:z});return u},CELLREF:function(u){return(this.jS.spreadsheets[u]?this.jS.spreadsheets[u]:"Cell Reference Not Found")},CALCTIME:function(x,v){x=x||"";v=v||"";var u=this,w=this.jS;this.jS.s.parent.one("sheetCalculation",function(){w.time.last=w.calcLast;u.td.text(x+w.time.diff()+v)});return""},HLOOKUP:function(A,x,w,C){if(A===undefined){return null}var y=this.jS,B,u,D="",v=0,z=x.length;w=w||1;C=C!==undefined?C:true;if(A!==undefined||((isNaN(A)&&A!="#REF!")||A.length===0)){for(;v<z;v++){if(x[v].toString()==A){B=x[v];break}}}else{c.getClosestNum(A,x,function(F,E){if(C){B=F}else{if(F==A){B=F}}})}if(B!==undefined){u=B.cell;u=y.getCell(u.sheetIndex,w,u.columnIndex);if(u!==null){D=u.updateValue()}else{D=""}}else{D=new p();D.html="#N/A"}return D},VLOOKUP:function(A,x,w,C){if(A===undefined){return null}var y=this.jS,B,u,D,v=0,z=x.length;C=C!==undefined?C:true;if((isNaN(A)&&A!="#REF!")||A.length===0){for(;v<z;v++){if(x[v].toString()==A){B=x[v];break}}}else{c.getClosestNum(A,x,function(F,E){if(C){B=F}else{if(F==A){B=F}}})}if(B!==undefined){u=B.cell;u=y.getCell(u.sheetIndex,u.rowIndex,w);if(u!==null){D=u.value}else{D=""}}else{D=new p();D.html="#N/A"}return D},TRANSPOSE:function(G){var L=0,B=this.jS,A=this.sheetIndex,E=G[0],w=E.cell,x=G[G.length-1],I=x.cell,u=w.rowIndex,z=w.columnIndex,D,M,v,y=[],F,C=[],H,K=G.length,J,N=false;for(;L<K;L++){H=G[L];v=H.cell;D=this.rowIndex+(v.columnIndex-z);M=this.columnIndex+(v.rowIndex-u);F=B.getCell(this.sheetIndex,D,M);if(F!==null&&F!==this){if(F.value!=""){N=true}C.push(F);y.push(v)}}if(N){J=new p("");J.html="#REF!";return J}L=0;K=C.length;for(;L<K;L++){F=C[L];if(F!==this){v=y[L];F.setNeedsUpdated();F.defer=v;F.updateValue();F.addDependency(this)}}return E.valueOf()},THISROWCELL:function(u){var v=this.jS;if(isNaN(u)){u=h.columnLabelIndex(u)}return v.getCell(this.sheetIndex,this.rowIndex,u).updateValue()},THISCOLCELL:function(v){var u=this.jS;return u.getCell(this.sheetIndex,v,this.columnIndex).updateValue()}};var r={BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,ALT:18,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,C:67,F:70,V:86,X:88,Y:89,Z:90,UNKNOWN:229};var c=f.arrHelpers={math:g,toNumbers:function(u){u=this.flatten(u);var v=u.length-1;if(v<0){return[]}do{if(u[v]){u[v]=d.trim(u[v]);if(isNaN(u[v])){u[v]=0}else{u[v]=u[v]*1}}else{u[v]=0}}while(v--);return u},unique:function(u){var y={},w,v=u.length,x=[];for(w=0;w<v;w+=1){y[u[w]]=u[w]}for(w in y){x.push(y[w])}return x},flatten:function(v){var y=[],x,w=0,u=v.length;for(;w<u;w++){x=v[w];if(x instanceof Array){y=y.concat(this.flatten(x))}else{y=y.concat(x)}}return y},insertAt:function(u,w,v){d(w).each(function(){if(v>-1&&v<=u.length){u.splice(v,0,this)}});return u},indexOfNearestLessThan:function(A,z){if(A.length===0){return -1}var x=A.length-1,u=0,v,w,y=-1;if(A[x]<z){return x}while(u<=x){v=(u+x)>>1;w=A[v];if(w>z){x=v-1}else{if(w<z){y=v;u=v+1}else{y=u;break}}}return y},ofSet:function(D,x){if(D.length===0){return null}var v=D.length-1,A=v,w=D[v],B=D[0],E=0,F,G,C=-1,z,y=-1,u=-1;if(D[v]<x||D[0]>x){return null}else{while(E<=v){F=(E+v)>>1;G=D[F];if(G>x){C=F;v=F-1}else{if(G<x){E=F+1}else{C=v;break}}}}if(C>-1){z=C;while(z<=A){if(D[z]+1===D[z+1]){z++}else{y=D[z];break}}if(y===-1){y=w}z=C;while(z>=0){if(D[z]-1===D[z-1]){z--}else{u=D[z];break}}if(u===-1){u=B}}return{start:u,end:y}},closest:function(z,v,w,u){w=w||0;u=u||z.length-1;var y,x;while(true){y=((w+u)>>1);x=z[y];if((y===u||y===w)&&x!==v){return x}if(x>v){u=y}else{if(x<v){w=y}else{return x}}}},getClosestNum:function(w,u,y){var x=0,v,B,A,z;if(u.length){B=u[0];v=x;for(x;x<u.length;x++){A=g.abs(w-B);z=g.abs(w-u[x]);if(z<A){v=x;B=u[x]}A=null;z=null}if(y){return y(B,v)}return B}return false},levenshtein:(function(){var u=[];return function(E,D){if(E===D){return 0}else{var B=E.length,z=D.length;if(B&&z){var w=0,v=0,C,A,y,x,F=u;while(w<B){F[w]=++w}while(v<z){x=D.charCodeAt(v);C=v;++v;A=v;for(w=0;w<B;++w){y=C+(E.charCodeAt(w)===x?0:1);C=F[w];A=A<C?(A<y?A+1:y):(C<y?C+1:y);F[w]=A}}return A}else{return B+z}}}})(),lSearch:function(v,z){var w=0,x,u=v.length,y=-1,A;for(;w<u;w++){x=v[w];A=new s(this.levenshtein(x,z));A.item=x;if(A<y){y=A}}return(A!==undefined?A.item:null)}};var e={dayDiv:86400000,math:g,toCentury:function(u,v){v=v||86400000;return this.math.round(this.math.abs((new a(1900,0,-1))-u)/v)},get:function(v,w){w=w||86400000;if(v.getMonth){return v}else{if(isNaN(v)){return new a(Globalize.parseDate(v))}else{v*=w;var u=(new a(1900,0,-1))*1;v+=u;v=new a(v);return v}}},week:function(u,w){w=w||86400000;var v=new a(u.getFullYear(),0,1);return this.math.ceil((((u-v)/w)+v.getDay()+1)/7)},toString:function(u,v){if(!v){return Globalize.format(u)}return Globalize.format(u,Globalize.culture().calendar.patterns[v])},diff:function(y,v,x,w){w=w||86400000;switch(x){case 0:return this.days360Nasd(y,v,0,true);case 1:case 2:case 3:var u=this.math.abs(v-y)/w;return u;case 4:return this.days360Euro(y,v)}return 0},diffMonths:function(w,v){var u;u=(v.getFullYear()-w.getFullYear())*12;u-=w.getMonth()+1;u+=v.getMonth()+1;return u},days360:function(w,z,x,v,u,y){return((z-w)*360)+((v-x)*30)+(y-u)},days360Nasd:function(v,y,u,w){var x=v.getDate(),C=v.getMonth(),B=v.getFullYear(),A=y.getDate(),z=y.getMonth(),D=y.getFullYear();if((z==2&&this.isEndOfMonth(A,z,D))&&((C==2&&this.isEndOfMonth(x,C,B))||u==3)){A=30}if(A==31&&(x>=30||u==3)){A=30}if(x==31){x=30}if(w&&C==2&&this.isEndOfMonth(x,C,B)){x=30}return this.days360(B,D,C,z,x,A)},days360Euro:function(B,w){var u=B.getDate(),y=B.getMonth(),x=B.getFullYear(),z=w.getDate(),v=w.getMonth(),A=w.getFullYear();if(u==31){u=30}if(z==31){z=30}return this.days360(x,A,y,v,u,z)},isEndOfMonth:function(u,w,v){return u==(new a(v,w+1,0,23,59,59)).getDate()},isLeapYear:function(u){return new a(u,1,29).getMonth()==1},calcAnnualBasis:function(u,w,A){switch(A){case 0:case 2:case 4:return 360;case 3:return 365;case 1:var v=u.getDate(),C=u.getMonth(),z=u.getFullYear(),x=w.getDate(),y=w.getMonth(),D=w.getFullYear(),E=0;if(z==D){if(this.isLeapYear(z)){E=366}else{E=365}}else{if(((D-1)==z)&&((C>y)||((C==y)&&v>=x))){if(this.isLeapYear(z)){if(C<2||(C==2&&v<=29)){E=366}else{E=365}}else{if(this.isLeapYear(D)){if(y>2||(y==2&&x==29)){E=366}else{E=365}}else{E=365}}}else{for(var B=z;B<=D;B++){if(this.isLeapYear(B)){E+=366}else{E+=365}}E=E/(D-z+1)}}return E}return 0},lastDayOfMonth:function(u){u.setDate(0);return u.getDate()},isLastDayOfMonth:function(u){return(u.getDate()==this.lastDayOfMonth(u))}};var i=f.times={math:g,fromMath:function(w){var u={},v=this;u.hour=((w*24)+"").split(".")[0]*1;u.minute=function(x){x=v.math.round(x*24*100)/100;x=(x+"").split(".");var y=0;if(x[1]){if(x[1].length<2){x[1]+="0"}y=x[1]*0.6}return v.math.round(y)}(w);u.second=function(A){A=v.math.round(A*24*10000)/10000;A=(A+"").split(".");var y=0;if(A[1]){for(var z=0;z<4;z++){if(!A[1].charAt(z)){A[1]+="0"}}var x=((A[1]*0.006)+"").split(".");if(x[1]){if(x[1]&&x[1].length>2){x[1]=x[1].substr(0,2)}return v.math.round(x[1]*0.6)}}return y}(w);return u},fromString:function(w,A){var x=new a(),B=w,u,z,y,v,C;if(A){C=B.substr(-2).toLowerCase();B=B.replace(/(am|pm)/i,"")}B=B.split(":");z=B[0]*1;y=B[1]*1;v=(B[2]?B[2]:0)*1;if(A&&C=="pm"){z+=12}return n.TIME(z,y,v)}};d.extend(g,{log10:function(u){return g.log(u)/2.302585092994046},signum:function(u){return(u/g.abs(u))||u},log1p:function(u){var v=0,y=50;if(u<=-1){return"-INF"}if(u<0||u>1){return g.log(1+u)}for(var w=1;w<y;w++){if((w%2)===0){v-=g.pow(u,w)/w}else{v+=g.pow(u,w)/w}}return v}});var m=function(){var A=l,D=d(l.createElement("p")).css({width:"100%",height:"100%"}),C=d(l.createElement("div")).css({position:"absolute",width:"100px",height:"100px",top:"0",left:"0",visibility:"hidden",overflow:"hidden"}).append(D);d(l.body).append(C);var x=D.width(),z=D.height();C.css("overflow","scroll");var u=D.width(),y=D.height();if(x==u&&C[0].clientWidth){u=C[0].clientWidth}if(z==y&&C[0].clientHeight){y=C[0].clientHeight}C.detach();var B=x-u,v=z-y;return{width:B||15,height:v||15}};var j=function(){var u="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",w=d(l.createElement("span")).html(u).appendTo("body"),v={width:w.width()/u.length,height:w.height()};w.remove();return v};var o=function(u,B,w,v,A){v=v||"#"+g.floor(g.random()*16777215).toString(16);if(w){var z=d([]);z=z.add(o(w.left,w.top,null,v,"top-left"));z=z.add(o(w.right,w.top,null,v,"top-right"));z=z.add(o(w.left,w.bottom,null,v,"bottom-left"));z=z.add(o(w.right,w.bottom,null,v,"bottom-right"));return z}return d('<div style="width: 10px; height: 10px; position: absolute;"></div>').css("top",(B-5)+"px").css("left",(u+5)+"px").css("background-color",v).click(function(){console.log(A||"none")}).appendTo("body")};d.printSource=function(v){var u=win.open();u.document.write("<html><body><xmp>"+v+"\n</xmp></body></html>");u.document.close()};if(!Object.getPrototypeOf){Object.getPrototypeOf=function(u){return u||{}}}if(!Array.prototype.indexOf){d.sheet.max=60;Array.prototype.indexOf=function(w,x){for(var v=(x||0),u=this.length;v<u;v++){if(this[v]===w){return v}}return -1}}return k})(jQuery,document,window,Date,String,Number,Boolean,Math,RegExp,Error);var parser=(function(){var S=function(W,V,X,U){for(X=X||{},U=W.length;U--;X[W[U]]=V){}return X},m=[1,5],l=[1,6],k=[1,8],j=[1,9],i=[1,10],h=[1,13],f=[1,11],d=[1,12],c=[1,14],b=[1,15],R=[1,20],Q=[1,18],P=[1,21],O=[1,22],N=[1,17],M=[1,24],L=[1,25],K=[1,26],J=[1,27],I=[1,28],H=[1,29],G=[1,30],F=[1,31],E=[1,32],D=[4,13,14,15,17,18,19,20,21,22,23,35,36],C=[1,35],B=[1,36],z=[1,37],y=[4,13,14,15,17,18,19,20,21,22,23,35,36,38],x=[4,13,14,15,17,18,19,20,21,22,23,35,36,39],w=[4,13,14,15,17,18,19,20,21,22,23,29,35,36],v=[4,14,15,17,18,19,20,35,36],u=[1,71],t=[4,14,17,18,19,35,36],s=[4,14,15,17,18,19,20,21,22,35,36],r=[17,35,36];var A={trace:function q(){},yy:{},symbols_:{error:2,expressions:3,EOF:4,expression:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,ESCAPED_STRING:11,LETTERS:12,"&":13,"=":14,"+":15,"(":16,")":17,"<":18,">":19,"-":20,"*":21,"/":22,"^":23,E:24,FUNCTION:25,expseq:26,cellRange:27,cell:28,":":29,SHEET:30,"!":31,NUMBER:32,"$":33,REF:34,";":35,",":36,VARIABLE:37,DECIMAL:38,"%":39,"$accept":0,"$end":1},terminals_:{2:"error",4:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"ESCAPED_STRING",12:"LETTERS",13:"&",14:"=",15:"+",16:"(",17:")",18:"<",19:">",20:"-",21:"*",22:"/",23:"^",24:"E",25:"FUNCTION",29:":",30:"SHEET",31:"!",32:"NUMBER",33:"$",34:"REF",35:";",36:",",37:"VARIABLE",38:"DECIMAL",39:"%"},productions_:[0,[3,1],[3,2],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,3],[5,3],[5,3],[5,3],[5,4],[5,4],[5,4],[5,3],[5,3],[5,3],[5,3],[5,3],[5,3],[5,2],[5,2],[5,1],[5,3],[5,4],[5,1],[27,1],[27,3],[27,3],[27,5],[28,2],[28,3],[28,3],[28,4],[28,1],[28,2],[28,2],[28,2],[28,3],[28,3],[28,3],[28,3],[28,3],[28,3],[28,4],[28,4],[28,4],[26,1],[26,2],[26,2],[26,3],[26,3],[6,1],[6,3],[9,1],[9,3],[9,2]],performAction:function p(W,Y,o,Z,ab,ac,U){var V=ac.length-1;switch(ab){case 1:return null;break;case 2:var X=Z.types;Z.types=[];return X;break;case 3:var aa={t:"m",m:"variable",a:[ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 4:var aa={t:"m",m:"time",a:[ac[V],true]};this.$=Z.types.length;Z.types.push(aa);break;case 5:var aa={t:"m",m:"time",a:[ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 6:var aa={t:"m",m:"number",a:[ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 7:var aa={t:"v",v:Z.escape(ac[V].substring(1,ac[V].length-1))};this.$=Z.types.length;Z.types.push(aa);break;case 8:var aa={t:"v",v:Z.escape(ac[V].substring(2,ac[V].length-2))};this.$=Z.types.length;Z.types.push(aa);break;case 9:var aa={t:"v",v:ac[V]};Z.types.push(aa);break;case 10:var aa={t:"m",m:"concatenate",a:[ac[V-2],ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 11:var aa={t:"m",m:"callFunction",a:["EQUAL",[ac[V-2],ac[V]]]};this.$=Z.types.length;Z.types.push(aa);break;case 12:var aa={t:"m",m:"performMath",a:["+",ac[V-2],ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 13:this.$=ac[V-1];break;case 14:var aa={t:"m",m:"callFunction",a:["LESS_EQUAL",[ac[V-3],ac[V]]]};this.$=Z.types.length;Z.types.push(aa);break;case 15:var aa={t:"m",m:"callFunction",a:["GREATER_EQUAL",[ac[V-3],ac[V]]]};this.$=Z.types.length;Z.types.push(aa);break;case 16:var aa={t:"m",m:"not",a:[ac[V-3],ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 17:var aa={t:"m",m:"callFunction",a:["GREATER",[ac[V-2],ac[V]]]};this.$=Z.types.length;Z.types.push(aa);break;case 18:var aa={t:"m",m:"callFunction",a:["LESS",[ac[V-2],ac[V]]]};this.$=Z.types.length;Z.types.push(aa);break;case 19:var aa={t:"m",m:"performMath",a:["-",ac[V-2],ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 20:var aa={t:"m",m:"performMath",a:["*",ac[V-2],ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 21:var aa={t:"m",m:"performMath",a:["/",ac[V-2],ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 22:var aa={t:"m",m:"performMath",a:["^",ac[V-2],ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 23:var aa={t:"m",m:"invertNumber",a:[ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 24:var aa={t:"m",m:"number",a:[ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 25:break;case 26:var aa={t:"m",m:"callFunction",a:[ac[V-2]]};this.$=Z.types.length;Z.types.push(aa);break;case 27:var aa={t:"m",m:"callFunction",a:[ac[V-3],ac[V-1]]};this.$=Z.types.length;Z.types.push(aa);break;case 29:var aa={t:"l",m:"cellValue",a:[ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 30:var aa={t:"l",m:"cellRangeValue",a:[ac[V-2],ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 31:var aa={t:"l",m:"remoteCellValue",a:[ac[V-2],ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 32:var aa={t:"l",m:"remoteCellRangeValue",a:[ac[V-4],ac[V-2],ac[V]]};this.$=Z.types.length;Z.types.push(aa);break;case 33:var aa={t:"cell",c:ac[V-1],r:ac[V]};this.$=Z.types.length;Z.types.push(aa);break;case 34:var aa={t:"cell",c:ac[V-1],r:ac[V]};this.$=Z.types.length;Z.types.push(aa);break;case 35:case 36:var aa={t:"cell",c:ac[V-2],r:ac[V]};this.$=Z.types.length;Z.types.push(aa);break;case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:return"#REF!";break;case 50:this.$=[ac[V]];break;case 53:ac[V-2].push(ac[V]);this.$=ac[V-2];break;case 54:ac[V-2].push(ac[V]);this.$=ac[V-2];break;case 55:this.$=[ac[V]];break;case 56:this.$=(ac[V-2] instanceof Array?ac[V-2]:[ac[V-2]]);this.$.push(ac[V]);break;case 57:this.$=ac[V];break;case 58:this.$=ac[V-2]+"."+ac[V];break;case 59:this.$=(ac[V-1]*0.01)+"";break}},table:[{3:1,4:[1,2],5:3,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{1:[3]},{1:[2,1]},{4:[1,23],13:M,14:L,15:K,18:J,19:I,20:H,21:G,22:F,23:E},S(D,[2,3],{38:[1,33]}),S(D,[2,4]),S(D,[2,5]),S(D,[2,6],{39:[1,34]}),S(D,[2,7]),S(D,[2,8]),S(D,[2,9],{32:C,33:B,34:z}),{5:38,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:39,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:40,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},S(D,[2,25]),{16:[1,41]},S(D,[2,28]),S(y,[2,55]),S(x,[2,57],{38:[1,42]}),S(D,[2,29],{29:[1,43]}),{31:[1,44]},{12:[1,45],34:[1,46]},S(w,[2,37],{32:[1,47],33:[1,49],34:[1,48]}),{1:[2,2]},{5:50,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:51,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:52,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:55,6:4,7:m,8:l,9:7,10:k,11:j,12:i,14:[1,53],15:h,16:f,19:[1,54],20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:57,6:4,7:m,8:l,9:7,10:k,11:j,12:i,14:[1,56],15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:58,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:59,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:60,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:61,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{37:[1,62]},S(x,[2,59]),S(w,[2,33]),{32:[1,63],34:[1,64]},S(w,[2,39]),{13:M,14:L,15:K,17:[1,65],18:J,19:I,20:H,21:G,22:F,23:E},S(v,[2,23],{13:M,21:G,22:F,23:E}),S(v,[2,24],{13:M,21:G,22:F,23:E}),{5:68,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,17:[1,66],20:d,24:c,25:b,26:67,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{32:[1,69]},{12:u,28:70,33:P,34:O},{12:u,28:72,33:P,34:O},{32:[1,73],33:[1,74],34:[1,75]},{32:[1,76],33:[1,78],34:[1,77]},S(w,[2,38]),S(w,[2,40]),{32:[1,79],34:[1,80]},S([4,17,35,36],[2,10],{13:M,14:L,15:K,18:J,19:I,20:H,21:G,22:F,23:E}),S([4,14,17,35,36],[2,11],{13:M,15:K,18:J,19:I,20:H,21:G,22:F,23:E}),S(v,[2,12],{13:M,21:G,22:F,23:E}),{5:81,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},{5:82,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},S(t,[2,18],{13:M,15:K,20:H,21:G,22:F,23:E}),{5:83,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:R,32:Q,33:P,34:O,37:N},S(t,[2,17],{13:M,15:K,20:H,21:G,22:F,23:E}),S(v,[2,19],{13:M,21:G,22:F,23:E}),S(s,[2,20],{13:M,23:E}),S(s,[2,21],{13:M,23:E}),S([4,14,15,17,18,19,20,21,22,23,35,36],[2,22],{13:M}),S(y,[2,56]),S(w,[2,35]),S(w,[2,45]),S(D,[2,13]),S(D,[2,26]),{17:[1,84],35:[1,85],36:[1,86]},S(r,[2,50],{13:M,14:L,15:K,18:J,19:I,20:H,21:G,22:F,23:E}),S(x,[2,58]),S(D,[2,30]),{32:C,33:B,34:z},S(D,[2,31],{29:[1,87]}),S(w,[2,34]),{32:[1,88]},S(w,[2,42]),S(w,[2,41]),S(w,[2,43]),{32:[1,89],34:[1,90]},S(w,[2,44]),S(w,[2,46]),S(t,[2,14],{13:M,15:K,20:H,21:G,22:F,23:E}),S(t,[2,16],{13:M,15:K,20:H,21:G,22:F,23:E}),S(t,[2,15],{13:M,15:K,20:H,21:G,22:F,23:E}),S(D,[2,27]),S(r,[2,51],{6:4,9:7,27:16,28:19,5:91,7:m,8:l,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,30:R,32:Q,33:P,34:O,37:N}),S(r,[2,52],{6:4,9:7,27:16,28:19,5:92,7:m,8:l,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,30:R,32:Q,33:P,34:O,37:N}),{12:u,28:93,33:P,34:O},S(w,[2,36]),S(w,[2,47]),S(w,[2,49]),S(r,[2,53],{13:M,14:L,15:K,18:J,19:I,20:H,21:G,22:F,23:E}),S(r,[2,54],{13:M,14:L,15:K,18:J,19:I,20:H,21:G,22:F,23:E}),S(D,[2,32])],defaultActions:{2:[2,1],23:[2,2]},parseError:function g(U,o){if(o.recoverable){this.trace(U)}else{throw new Error(U)}},parse:function n(af){var an=this,ac=[0],am=[],ay=[null],ah=[],aA=this.table,V="",ag=0,aw=0,X=0,ae=2,al=1;var Y=ah.slice.call(arguments,1);var o=Object.create(this.lexer);var az={yy:{}};for(var av in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,av)){az.yy[av]=this.yy[av]}}o.setInput(af,az.yy);az.yy.lexer=o;az.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var W=o.yylloc;ah.push(W);var Z=o.options&&o.options.ranges;if(typeof az.yy.parseError==="function"){this.parseError=az.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function ak(aD){ac.length=ac.length-2*aD;ay.length=ay.length-aD;ah.length=ah.length-aD}_token_stack:function aj(){var aD;aD=o.lex()||al;if(typeof aD!=="number"){aD=an.symbols_[aD]||aD}return aD}var au,ap,ab,at,aC,ai,ar={},ao,ax,U,ad;while(true){ab=ac[ac.length-1];if(this.defaultActions[ab]){at=this.defaultActions[ab]}else{if(au===null||typeof au=="undefined"){au=aj()}at=aA[ab]&&aA[ab][au]}_handle_error:if(typeof at==="undefined"||!at.length||!at[0]){var aa;var aq="";function aB(aE){var aD=ac.length-1;var aF=0;for(;;){if((ae.toString()) in aA[aE]){return aF}if(aE===0||aD<2){return false}aD-=2;aE=ac[aD];++aF}}if(!X){aa=aB(ab);ad=[];for(ao in aA[ab]){if(this.terminals_[ao]&&ao>ae){ad.push("'"+this.terminals_[ao]+"'")}}if(o.showPosition){aq="Parse error on line "+(ag+1)+":\n"+o.showPosition()+"\nExpecting "+ad.join(", ")+", got '"+(this.terminals_[au]||au)+"'"}else{aq="Parse error on line "+(ag+1)+": Unexpected "+(au==al?"end of input":("'"+(this.terminals_[au]||au)+"'"))}return this.parseError(aq,{text:o.match,token:this.terminals_[au]||au,line:o.yylineno,loc:W,expected:ad,recoverable:(aa!==false)})}else{if(ap!==al){aa=aB(ab)}}if(X==3){if(au===al||ap===al){throw new Error(aq||"Parsing halted while starting to recover from another error.")}aw=o.yyleng;V=o.yytext;ag=o.yylineno;W=o.yylloc;au=aj()}if(aa===false){throw new Error(aq||"Parsing halted. No suitable error recovery rule available.")}ak(aa);ap=(au==ae?null:au);au=ae;ab=ac[ac.length-1];at=aA[ab]&&aA[ab][ae];X=3}if(at[0] instanceof Array&&at.length>1){throw new Error("Parse Error: multiple actions possible at state: "+ab+", token: "+au)}switch(at[0]){case 1:ac.push(au);ay.push(o.yytext);ah.push(o.yylloc);ac.push(at[1]);au=null;if(!ap){aw=o.yyleng;V=o.yytext;ag=o.yylineno;W=o.yylloc;if(X>0){X--}}else{au=ap;ap=null}break;case 2:ax=this.productions_[at[1]][1];ar.$=ay[ay.length-ax];ar._$={first_line:ah[ah.length-(ax||1)].first_line,last_line:ah[ah.length-1].last_line,first_column:ah[ah.length-(ax||1)].first_column,last_column:ah[ah.length-1].last_column};if(Z){ar._$.range=[ah[ah.length-(ax||1)].range[0],ah[ah.length-1].range[1]]}ai=this.performAction.apply(ar,[V,aw,ag,az.yy,at[1],ay,ah].concat(Y));if(typeof ai!=="undefined"){return ai}if(ax){ac=ac.slice(0,-1*ax*2);ay=ay.slice(0,-1*ax);ah=ah.slice(0,-1*ax)}ac.push(this.productions_[at[1]][0]);ay.push(ar.$);ah.push(ar._$);U=aA[ac[ac.length-2]][ac[ac.length-1]];ac.push(U);break;case 3:return true}}return true}};var e=function(){var V=function(){};V.prototype=A.lexer;var U=function(){this.lexer=new V();this.yy={types:[],escape:function(W){return W.replace(/&/gi,"&amp;").replace(/>/gi,"&gt;").replace(/</gi,"&lt;").replace(/\n/g,"\n<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp ").replace(/  /g,"&nbsp; ")},parseError:function(Y,X){this.done=true;var W=new String();W.html="<pre>"+Y+"</pre>";W.hash=X;return W}}};U.prototype=A;var o=new U();return o};if(typeof(window)!=="undefined"){window.Formula=e}else{A.Formula=e}var T=(function(){var V=({EOF:1,parseError:function W(ae,ad){if(this.yy.parser){this.yy.parser.parseError(ae,ad)}else{throw new Error(ae)}},setInput:function(ad,ae){this.yy=ae||this.yy||{};this._input=new a.InputReader(ad);this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var ae=this._input.ch();this.yytext+=ae;this.yyleng++;this.offset++;this.match+=ae;var ad=ae.match(/(?:\r\n?|\n).*/g);if(ad){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}return ae},unput:function(af){var ad=af.length;var ae=af.split(/(?:\r\n?|\n)/g);this._input.unCh(ad,af);this.yytext=this.yytext.substr(0,this.yytext.length-ad);this.offset-=ad;var ah=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);if(ae.length-1){this.yylineno-=ae.length-1}var ag=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:ae?(ae.length===ah.length?this.yylloc.first_column:0)+ah[ah.length-ae.length].length-ae[0].length:this.yylloc.first_column-ad};if(this.options.ranges){this.yylloc.range=[ag[0],ag[0]+this.yyleng-ad]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(ad){this.unput(this.match.slice(ad))},pastInput:function(){var ad=this._input.toString();var ae=ad.substr(0,ad.length-this.match.length);return(ae.length>20?"...":"")+ae.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var ad=this._input.input.substr(this._input.position,this._input.input.length-1);return(ad.substr(0,20)+(ad.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var ad=this.pastInput();var ae=new Array(ad.length+1).join("-");return ad+this.upcomingInput()+"\n"+ae+"^"},test_match:function(ah,af){var ai,ad,ag,ae;if(this.options.backtrack_lexer){ag={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,yyleng:this.yyleng,offset:this.offset,_more:this._more,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){ag.yylloc.range=this.yylloc.range.slice(0)}}ad=ah.match(/(?:\r\n?|\n).*/g);if(ad){this.yylineno+=ad.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:ad!==null?ad[ad.length-1].length-ad[ad.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+ah.length};this.yytext+=ah;this.match+=ah;this.matches=ah;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input.addMatch(ah);ai=this.performAction.call(this,this.yy,this,af,this.conditionStack[this.conditionStack.length-1]);if(this.done&&!this._input.done){this.done=false}if(ai){return ai}else{if(this._backtrack){for(ae in ag){if(ag.hasOwnProperty(ae)){this[ae]=ag[ae]}}return null}}return null},next:function(){if(this.done){return this.EOF}if(this._input.done){this.done=true}var ah,af,ad,ae;if(!this._more){this.yytext="";this.match=""}var ai=this._currentRules();for(var ag=0;ag<ai.length;ag++){ad=this._input.match(this.rules[ai[ag]]);if(ad!==null&&(af===undefined||ad[0].length>af.length)){af=ad[0];ae=ag;if(this.options.backtrack_lexer){ah=this.test_match(ad[0],ai[ag]);if(ah!==null){return ah}else{if(this._backtrack){af=undefined;continue}else{return null}}}else{if(!this.options.flex){break}}}}if(af!==undefined){ah=this.test_match(af,ai[ae]);if(ah!==null){return ah}return null}if(this._input.done){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var ad=this.next();if(ad!==null){return ad}else{return this.lex()}},begin:function U(ad){this.conditionStack.push(ad)},popState:function X(){var ad=this.conditionStack.length-1;if(ad>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function ac(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function aa(ad){ad=this.conditionStack.length-1-Math.abs(ad||0);if(ad>=0){return this.conditionStack[ad]}else{return"INITIAL"}},pushState:function Z(ad){this.begin(ad)},stateStackSize:function Y(){return this.conditionStack.length},options:{},performAction:function ab(ah,ae,ag,ad){var af=ad;switch(ag){case 0:break;case 1:return 25;break;case 2:return 7;break;case 3:return 8;break;case 4:return 30;break;case 5:ae.yytext=ae.yytext.substring(1,ae.yytext.length-1);return 30;break;case 6:return 10;break;case 7:return 10;break;case 8:return 11;break;case 9:return 11;break;case 10:return 12;break;case 11:return 37;break;case 12:return 37;break;case 13:return 32;break;case 14:return 33;break;case 15:return 13;break;case 16:return" ";break;case 17:return 38;break;case 18:return 29;break;case 19:return 35;break;case 20:return 36;break;case 21:return 21;break;case 22:return 22;break;case 23:return 20;break;case 24:return 15;break;case 25:return 23;break;case 26:return 16;break;case 27:return 17;break;case 28:return 19;break;case 29:return 18;break;case 30:return"PI";break;case 31:return 24;break;case 32:return'"';break;case 33:return"'";break;case 34:return'"';break;case 35:return"'";break;case 36:return"!";break;case 37:return 14;break;case 38:return 39;break;case 39:return 34;break;case 40:return"#";break;case 41:return 4;break}},rules:[/^(?:\s+)/,/^(?:([A-Za-z]{1,})([A-Za-z_0-9]+)?(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:(([A-Za-z0-9]+))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])|(["](\\["]|[^"])*["]))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])))/,/^(?:((["](\\["]|[^"])*["])))/,/^(?:(([\\]['].+?[\\]['])))/,/^(?:(([\\]["].+?[\\]["])))/,/^(?:[A-Z]+(?=[0-9$]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\$)/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:PI\b)/,/^(?:E\b)/,/^(?:")/,/^(?:')/,/^(?:\\")/,/^(?:\\')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:#REF!)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41],inclusive:true}}});return V})();A.lexer=T;function a(){this.yy={}}a.prototype=A;a.InputReader=(function(V,U,Y){var X=RegExp.prototype.sticky!==undefined,ag,ad,ae,Z;function ah(ai){this.done=false;this.input=ai;this.length=ai.length;this.matches=[];this.position=0}if(X){ah.prototype={addMatch:function af(ai){this.matches.push(ai);this.position+=ai.length;this.done=(this.position>=this.length)},ch:function o(){var ai=this.input[this.position];this.addMatch(ai);return ai},unCh:function ac(ai){this.position-=ai;this.position=V.max(0,this.position);this.done=(this.position>=this.length)},substring:function ab(aj,ai){aj=(aj!=0?this.position+aj:this.position);ai=(ai!=0?aj+ai:this.length);return this.input.substring(aj,ai)},match:function aa(aj){var ai;aj.lastIndex=this.position;if((ai=aj.exec(this.input))!==null){return ai}return null},toString:function W(){return this.matches.join("")}};ag=Y.rules;ae=ag.length;Z=0;for(;Z<ae;Z++){ad=ag[Z];ag[Z]=new RegExp(ad.source.substring(1),"y")}}else{ah.prototype={addMatch:function af(ai){this.input=this.input.slice(ai.length);this.matches.push(ai);this.position+=ai.length;this.done=(this.position>=this.length)},ch:function o(){var ai=this.input[0];this.addMatch(ai);return ai},unCh:function ac(aj,ai){this.position-=aj;this.position=V.max(0,this.position);this.input=ai+this.input;this.done=(this.position>=this.length)},substring:function ab(aj,ai){aj=(aj!=0?this.position+aj:this.position);ai=(ai!=0?aj+ai:this.length);return this.input.substring(aj,ai)},match:function aa(ak){var aj,ai=this.input;if((aj=ai.match(ak))!==null){return aj}return null},toString:function W(){return this.matches.join("")}}}return ah})(Math,A,T);A.Parser=a;return new a})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}}var parser=(function(){var n=function(w,u,x,t){for(x=x||{},t=w.length;t--;x[w[t]]=u){}return x},l=[1,10],j=[1,11],i=[1,12],h=[1,13],g=[5,7,8,9,10],f=[1,19],c=[1,20],a=[5,7,8,9,10,12,13],s=[1,21],r=[5,7,8,9,10,12,13,14,16];var k={trace:function p(){},yy:{},symbols_:{error:2,grid:3,rows:4,EOF:5,row:6,END_OF_LINE:7,END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN:8,END_OF_LINE_WITH_NO_COLUMNS:9,END_OF_LINE_WITH_EMPTY_COLUMN:10,string:11,COLUMN_EMPTY:12,COLUMN_STRING:13,CHAR:14,QUOTE_ON:15,QUOTE_OFF:16,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",7:"END_OF_LINE",8:"END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN",9:"END_OF_LINE_WITH_NO_COLUMNS",10:"END_OF_LINE_WITH_EMPTY_COLUMN",12:"COLUMN_EMPTY",13:"COLUMN_STRING",14:"CHAR",15:"QUOTE_ON",16:"QUOTE_OFF"},productions_:[0,[3,2],[3,1],[4,1],[4,1],[4,1],[4,1],[4,1],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[6,1],[6,1],[6,2],[6,3],[6,1],[6,2],[6,3],[11,1],[11,2],[11,3]],performAction:function e(o,v,w,z,y,u,x){var t=u.length-1;switch(y){case 1:return u[t-1];break;case 2:return[[""]];break;case 3:this.$=[u[t]];break;case 4:this.$=[];break;case 5:this.$=[""];break;case 6:this.$=[""];break;case 7:this.$=[""];break;case 8:this.$=u[t-1];break;case 9:u[t-1].push([""]);this.$=u[t-1];break;case 10:u[t-1].push([""]);this.$=u[t-1];break;case 11:u[t-1][u[t-1].length-1].push("");this.$=u[t-1];break;case 12:u[t-2].push(u[t]);this.$=u[t-2];break;case 13:u[t].unshift("");u[t-2].push(u[t]);this.$=u[t-2];break;case 14:u[t-2].push([""]);u[t-2].push(u[t]);this.$=u[t-2];break;case 15:u[t-2][u[t-2].length-1].push("");u[t-2].push(u[t]);this.$=u[t-2];break;case 16:this.$=[u[t].join("")];break;case 17:this.$=[""];break;case 18:u[t-1].push("");this.$=u[t-1];break;case 19:u[t-2].push("");u[t-2].push(u[t].join(""));this.$=u[t-2];break;case 20:break;case 21:break;case 22:u[t-2].push(u[t].join(""));this.$=u[t-2];break;case 23:this.$=[u[t]];break;case 24:u[t-1].push(u[t]);this.$=u[t-1];break;case 25:this.$=u[t-1];break}},table:[{3:1,4:2,5:[1,3],6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:l,13:j,14:i,15:h},{1:[3]},{5:[1,14],7:[1,15],8:[1,16],9:[1,17],10:[1,18]},{1:[2,2]},n(g,[2,3],{12:f,13:c}),n(g,[2,4]),n(g,[2,5]),n(g,[2,6]),n(g,[2,7]),n(a,[2,16],{14:s}),n(a,[2,17]),n(a,[2,20]),n(r,[2,23]),{11:22,14:i,15:h},{1:[2,1]},n(g,[2,8],{11:9,6:23,12:l,13:j,14:i,15:h}),n(g,[2,9],{11:9,6:24,12:l,13:j,14:i,15:h}),n(g,[2,10],{11:9,6:25,12:l,13:j,14:i,15:h}),n(g,[2,11],{11:9,6:26,12:l,13:j,14:i,15:h}),n(a,[2,18],{11:27,14:i,15:h}),n(a,[2,21],{11:28,14:i,15:h}),n(r,[2,24]),{14:s,16:[1,29]},n(g,[2,12],{12:f,13:c}),n(g,[2,13],{12:f,13:c}),n(g,[2,14],{12:f,13:c}),n(g,[2,15],{12:f,13:c}),n(a,[2,19],{14:s}),n(a,[2,22],{14:s}),n(r,[2,25])],defaultActions:{3:[2,2],14:[2,1]},parseError:function q(t,o){if(o.recoverable){this.trace(t)}else{throw new Error(t)}},parse:function m(D){var L=this,A=[0],K=[],V=[null],F=[],X=this.table,u="",E=0,T=0,w=0,C=2,J=1;var x=F.slice.call(arguments,1);var o=Object.create(this.lexer);var W={yy:{}};for(var S in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,S)){W.yy[S]=this.yy[S]}}o.setInput(D,W.yy);W.yy.lexer=o;W.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var v=o.yylloc;F.push(v);var y=o.options&&o.options.ranges;if(typeof W.yy.parseError==="function"){this.parseError=W.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function I(Z){A.length=A.length-2*Z;V.length=V.length-Z;F.length=F.length-Z}_token_stack:function H(){var Z;Z=o.lex()||J;if(typeof Z!=="number"){Z=L.symbols_[Z]||Z}return Z}var R,N,z,Q,Y,G,P={},M,U,t,B;while(true){z=A[A.length-1];if(this.defaultActions[z]){Q=this.defaultActions[z]}else{if(R===null||typeof R=="undefined"){R=H()}Q=X[z]&&X[z][R]}if(typeof Q==="undefined"||!Q.length||!Q[0]){var O="";B=[];for(M in X[z]){if(this.terminals_[M]&&M>C){B.push("'"+this.terminals_[M]+"'")}}if(o.showPosition){O="Parse error on line "+(E+1)+":\n"+o.showPosition()+"\nExpecting "+B.join(", ")+", got '"+(this.terminals_[R]||R)+"'"}else{O="Parse error on line "+(E+1)+": Unexpected "+(R==J?"end of input":"'"+(this.terminals_[R]||R)+"'")}this.parseError(O,{text:o.match,token:this.terminals_[R]||R,line:o.yylineno,loc:v,expected:B})}if(Q[0] instanceof Array&&Q.length>1){throw new Error("Parse Error: multiple actions possible at state: "+z+", token: "+R)}switch(Q[0]){case 1:A.push(R);V.push(o.yytext);F.push(o.yylloc);A.push(Q[1]);R=null;if(!N){T=o.yyleng;u=o.yytext;E=o.yylineno;v=o.yylloc;if(w>0){w--}}else{R=N;N=null}break;case 2:U=this.productions_[Q[1]][1];P.$=V[V.length-U];P._$={first_line:F[F.length-(U||1)].first_line,last_line:F[F.length-1].last_line,first_column:F[F.length-(U||1)].first_column,last_column:F[F.length-1].last_column};if(y){P._$.range=[F[F.length-(U||1)].range[0],F[F.length-1].range[1]]}G=this.performAction.apply(P,[u,T,E,W.yy,Q[1],V,F].concat(x));if(typeof G!=="undefined"){return G}if(U){A=A.slice(0,-1*U*2);V=V.slice(0,-1*U);F=F.slice(0,-1*U)}A.push(this.productions_[Q[1]][0]);V.push(P.$);F.push(P._$);t=X[A[A.length-2]][A[A.length-1]];A.push(t);break;case 3:return true}}return true}};if(typeof GLOBAL!=="undefined"){GLOBAL.window=GLOBAL}if(typeof window.TSV==="undefined"){var m=k.parse;k.parse=function(o){var t=this.lexer.setInput;this.lexer.setInput=function(u){t.call(this,u);this.begin("BOF");return this};this.parse=m;return m.call(this,o)};window.TSV=function(t){var v=function(){};v.prototype=k.lexer;var u=function(){this.lexer=new v();this.yy={}};u.prototype=k;var o=new u;o.setObj=function(w){o.yy.obj=w};o.yy.handler=t;return o}}var b=(function(){var u=({EOF:1,parseError:function v(D,C){if(this.yy.parser){this.yy.parser.parseError(D,C)}else{throw new Error(D)}},setInput:function(C,D){this.yy=D||this.yy||{};this._input=C;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var D=this._input[0];this.yytext+=D;this.yyleng++;this.offset++;this.match+=D;this.matched+=D;var C=D.match(/(?:\r\n?|\n).*/g);if(C){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return D},unput:function(E){var C=E.length;var D=E.split(/(?:\r\n?|\n)/g);this._input=E+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-C);this.offset-=C;var G=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(D.length-1){this.yylineno-=D.length-1}var F=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:D?(D.length===G.length?this.yylloc.first_column:0)+G[G.length-D.length].length-D[0].length:this.yylloc.first_column-C};if(this.options.ranges){this.yylloc.range=[F[0],F[0]+this.yyleng-C]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(C){this.unput(this.match.slice(C))},pastInput:function(){var C=this.matched.substr(0,this.matched.length-this.match.length);return(C.length>20?"...":"")+C.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var C=this.match;if(C.length<20){C+=this._input.substr(0,20-C.length)}return(C.substr(0,20)+(C.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var C=this.pastInput();var D=new Array(C.length+1).join("-");return C+this.upcomingInput()+"\n"+D+"^"},test_match:function(G,E){var H,C,F;if(this.options.backtrack_lexer){F={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){F.yylloc.range=this.yylloc.range.slice(0)}}C=G[0].match(/(?:\r\n?|\n).*/g);if(C){this.yylineno+=C.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:C?C[C.length-1].length-C[C.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+G[0].length};this.yytext+=G[0];this.match+=G[0];this.matches=G;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(G[0].length);this.matched+=G[0];H=this.performAction.call(this,this.yy,this,E,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(H){return H}else{if(this._backtrack){for(var D in F){this[D]=F[D]}return false}}return false},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var G,E,C,D;if(!this._more){this.yytext="";this.match=""}var H=this._currentRules();for(var F=0;F<H.length;F++){C=this._input.match(this.rules[H[F]]);if(C&&(!E||C[0].length>E[0].length)){E=C;D=F;if(this.options.backtrack_lexer){G=this.test_match(C,H[F]);if(G!==false){return G}else{if(this._backtrack){E=false;continue}else{return false}}}else{if(!this.options.flex){break}}}}if(E){G=this.test_match(E,H[D]);if(G!==false){return G}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var C=this.next();if(C){return C}else{return this.lex()}},begin:function t(C){this.conditionStack.push(C)},popState:function w(){var C=this.conditionStack.length-1;if(C>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function B(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function z(C){C=this.conditionStack.length-1-Math.abs(C||0);if(C>=0){return this.conditionStack[C]}else{return"INITIAL"}},pushState:function y(C){this.begin(C)},stateStackSize:function x(){return this.conditionStack.length},options:{},performAction:function A(G,D,F,C){var E=C;switch(F){case 0:return 14;break;case 1:this.popState();return 16;break;case 2:if(D.yytext==this.quoteChar){this.popState();this.begin("STRING");return 16}else{return 14}break;case 3:this.popState();this.begin("STRING");return 14;break;case 4:this.popState();this.quoteChar=D.yytext.substring(0);this.begin("QUOTE");return 15;break;case 5:this.quoteChar=D.yytext;this.popState();this.begin("QUOTE");return 15;break;case 6:this.begin("PRE_QUOTE");return 13;break;case 7:this.begin("PRE_QUOTE");return 7;break;case 8:return 14;break;case 9:this.popState();return 8;break;case 10:this.popState();return 9;break;case 11:this.popState();return 7;break;case 12:this.popState();return 13;break;case 13:return 14;break;case 14:this.popState();break;case 15:return"BUFFIN";break;case 16:return 9;break;case 17:return 10;break;case 18:return 12;break;case 19:return 7;break;case 20:this.begin("STRING");return 14;break;case 21:return 5;break}},rules:[/^(?:(\n|\\n))/,/^(?:([\'\"])(?=$))/,/^(?:([\'\"]))/,/^(?:(?=(\t)))/,/^(?:([\'\"]))/,/^(?:([\'\"]))/,/^(?:(\t|\\t)(?=[\'\"]))/,/^(?:(\n|\\n)(?=[\'\"]))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:(\n\t|\\n\\t))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\n|\\n))/,/^(?:(\t|\\t))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:)/,/^(?:(\n\t|\\n\\t)(?=.))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\t\n))/,/^(?:(\t))/,/^(?:(\n))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:$)/],conditions:{BOF:{rules:[4,6,7,14,15,16,17,18,19,20,21],inclusive:true},PRE_QUOTE:{rules:[5,6,7,15,16,17,18,19,20,21],inclusive:true},QUOTE:{rules:[0,1,2,3,6,7,8,15,16,17,18,19,20,21],inclusive:true},STRING:{rules:[6,7,9,10,11,12,13,15,16,17,18,19,20,21],inclusive:true},INITIAL:{rules:[6,7,15,16,17,18,19,20,21],inclusive:true}}});return u})();k.lexer=b;function d(){this.yy={}}d.prototype=k;k.Parser=d;return new d})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}};