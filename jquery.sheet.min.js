var jQuery=window.jQuery||{};var Sheet=(function(d,l,f,a,q,u,v,g,b,r){var k={defaultTheme:0,themeRollerTheme:0,bootstrapTheme:1,customTheme:2,excelSelectModel:0,googleDriveSelectModel:1,openOfficeSelectModel:2,defaultColumnWidth:120,defaultRowHeight:20};k.Cell=(function(){var w=undefined;function x(y,B,A,z){this.td=(B!==undefined?B:null);this.dependencies=[];this.formula="";this.cellType=null;this.value="";this.calcCount=0;this.sheetIndex=y;this.rowIndex=null;this.columnIndex=null;this.jS=(A!==undefined?A:null);this.state=[];this.needsUpdated=true;this.uneditable=false;this.id=null;this.loader=null;this.loadedFrom=null;this.cellHandler=z}x.prototype={addDependency:function(y){if(y===undefined||y===null){return}if(y.type!==k.Cell){throw new Exception("Wrong Type")}if(this.dependencies.indexOf(y)<0){this.dependencies.push(y)}},updateValue:function(){var B,G,E,C,y,D="",H,F=k.calcStack,z=this.cellHandler.formulaParser(F);switch(this.state[0]){case"updating":H=new q();H.cell=this;H.html="#VAL!";return H;case"updatingDependencies":return(this.valueOverride!=w?this.valueOverride:this.value)}if(this.defer!==w){if(this.value.length>0){D=new q("");D.cell=this;this.td.innerHTML="#REF!";return D}H=this.defer.updateValue().valueOf();switch(typeof(H)){case"number":H=new u(H);break;case"boolean":H=new v(H);break;case"string":H=new q(H);break}H.cell=this;this.updateDependencies();return H}if(this.needsUpdated){this.oldValue=this.value;this.state.unshift("updating");this.fnCount=0;delete this.valueOverride;this.calcCount++;if(this.formula.length>0){if(this.formula.charAt(0)==="="){this.formula=this.formula.substring(1)}k.calcStack++;z.setObj(this);try{this.value=z.parse(this.formula)}catch(A){this.value=A.toString()}this.needsUpdated=false;k.calcStack--;if(this.value!==w&&this.value!==null&&this.cellType!==null&&k.CellTypeHandlers[this.cellType]!==w){this.value=k.CellTypeHandlers[this.cellType].call(this,this.value)}}else{if(this.value!==w&&this.value!==null&&this.cellType!==null&&k.CellTypeHandlers[this.cellType]!==w){this.value=s.cellTypeHandlers[this.cellType].call(this,this.value)}else{switch(typeof this.value){case"string":C=this.cellStartingHandlers[this.value.charAt(0)];if(C!==w){this.valueOverride=C.call(this,this.value)}else{C=this.cellEndHandlers[this.value.charAt(this.value.length-1)];if(C!==w){this.valueOverride=C.call(this,this.value)}}break;case"undefined":this.value="";break}}}y=this.displayValue();if(this.loader!==null){this.loader.setCellAttributes(this.loadedFrom,{cache:y,formula:this.formula,value:this.value+"",cellType:this.cellType,uneditable:this.uneditable})}this.needsUpdated=false;this.state.shift()}if(this.value===w||this.value===null){this.value=new q()}if(this.value.cell===w){switch(typeof(this.value)){case"number":this.value=new u(this.value);break;case"boolean":this.value=new v(this.value);break;case"string":this.value=new q(this.value);break}this.value.cell=this}return(this.valueOverride!==w?this.valueOverride:this.value)},updateDependencies:function(){var A,y,z;A=this.dependencies;this.dependencies=[];z=A.length-1;if(z>-1){this.state.unshift("updatingDependencies");do{y=A[z];y.updateValue();y.updateDependencies()}while(z-->0);this.state.shift()}if(this.dependencies.length===0){this.dependencies=A}},displayValue:function(){var A=this.value,C=this.td,y,B=typeof A,z=A.html;if(B==="string"||(A!==null&&B==="object"&&A.toUpperCase!==w)&&A.length>0){y=this.encode(A)}if(C===null){return A}if(z===w){if(y!==w){z=y}else{z=A}}switch(typeof z){case"object":if(z===null){C.innerHTML=""}else{if(z.appendChild!==w){if(z.parentNode!==null){C.innerHTML=A.valueOf();return""}C.innerHTML="";C.appendChild(z);break}}case"string":default:C.innerHTML=z}return C.innerHTML},recurseDependencies:function(B){var A=0,C=this.dependencies,z,y=C.length;for(;A<y;A++){z=C[A];B.call(z);z.recurseDependencies(B)}},getAllDependencies:function(){var y=[];this.recurseDependencies(function(){y.push(this)});return y},setNeedsUpdated:function(){this.needsUpdated=true;this.recurseDependencies(function(){this.needsUpdated=true})},encode:function(y){switch(typeof y){case"object":if(y.getMonth!==w){return globalize.format(y,"d")}return y}if(!y){return y||""}if(!y.replace){return y||""}return y.replace(/&/gi,"&amp;").replace(/>/gi,"&gt;").replace(/</gi,"&lt;").replace(/\n/g,"\n<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp ").replace(/  /g,"&nbsp; ")},cellStartingHandlers:{"$":function(z,y){return this.cellHandler.fn.DOLLAR.call(this,z.substring(1).replace(globalize.culture().numberFormat[","],""),2,y||"$")},"£":function(y){return this.cellStartingHandlers["$"].call(this,y,"£")}},cellEndHandlers:{"%":function(y){return y.substring(0,this.value.length-1)/100}},type:x,typeName:"Sheet.Cell"};return x})();k.CellHandler=(function(x){function A(B){return !isNaN(B)}var w=undefined,y=NaN;function z(D,B,C){this.jS=D;this.jSE=B;this.fn=C}z.prototype={variable:function(F){if(arguments.length){var E=arguments[0],C=arguments[1],G=this.jS.s.formulaVariables,D,B;switch(E.toLowerCase()){case"true":B=new v(true);B.html="TRUE";return B;case"false":B=new v(false);B.html="FALSE";return B}if(D=G[E]&&!C){return D}else{if(D&&C){return D[C]}else{return""}}}},time:function(C,B){return i.fromString(C,B)},number:function(B){switch(typeof B){case"number":return B;case"string":if(A(B)){return B*1}case"object":if(B.getMonth){return e.toCentury(B)}}return B},numberInverted:function(D){var C=this.number(D),B=new u(C.valueOf()*-1);if(C.html){B.html=C.html}return B},performMath:function(H,G,F){if(G===w||G===null){G=0}if(F===w||F===null){F=0}var E,D,I=true,B=true,K=[],J,C=function(L){return L};switch(E=(typeof G.valueOf())){case"number":break;case"string":if(A(G)){G*=1}else{I=false}break;case"object":if(G.getMonth){G=e.toCentury(G);C=e.get}else{I=false}break;default:I=false}switch(D=(typeof F.valueOf())){case"number":break;case"string":if(A(F)){F*=1}else{B=false}break;case"object":if(F.getMonth){F=e.toCentury(F)}else{B=false}break;default:B=false}if(!I&&H!=="+"){K.push("not a number: "+G);G=0}if(!B){K.push("not a number: "+F);F=0}if(K.length){}switch(H){case"+":J=G+F;break;case"-":J=G-F;break;case"/":J=G/F;if(J==Infinity||J==y){J=0}break;case"*":J=G*F;break;case"^":J=x.pow(G,F);break}return C(J)},cellValue:function(D,C){var E=this.jS,F=h.parseLocation(C.colString,C.rowString),B;B=E.getCell(D.sheetIndex,F.row,F.col);if(B!==null){B.addDependency(D);return B.updateValue()}else{return""}},cellRangeValue:function(D,E,G){var O=D.sheetIndex,F=h.parseLocation(E.colString,E.rowString),I=h.parseLocation(G.colString,G.rowString),K=x.max(F.row,I.row),L=x.min(F.row,I.row),C=x.max(F.col,I.col),B=x.min(F.col,I.col),H=this.jS,J=H.spreadsheets[O],Q=[],N,M,P;if(J===w){H.spreadsheets[O]=J={}}if(K>=L||C>=B){Q.rowCount=(L-K)+1;Q.columnCount=(B-C)+1;do{N=C;P=(J[K]!==w?J[K]:null);do{if(P===null||(M=P[N])===w){M=H.getCell(O,K,N)}else{M.sheetIndex=O;M.rowIndex=K;M.columnIndex=N}if(M!==null){D.addDependency(M);Q.unshift(M.updateValue())}}while(N-->B)}while(K-->L);return Q}return Q},fixedCellValue:function(B,C){return this.cellValue(B,C)},fixedCellRangeValue:function(C,D,B){return this.cellRangeValue(C,D,B)},remoteCellValue:function(G,F,D){var E=this.jSE,H=this.jS,I=E.parseLocation(D.colString,D.rowString),C=E.parseSheetLocation(F),B;if(C<0){C=H.getSpreadsheetIndexByTitle(F)}B=H.getCell(C,I.row,I.col);if(B!==null){B.addDependency(G);return B.updateValue()}else{return""}},remoteCellRangeValue:function(B,J,C,F){var H=this.jS,D=this.jSE,E=D.parseLocation(C.colString,C.rowString),I=D.parseLocation(F.colString,F.rowString),O=D.parseSheetLocation(J),N,M=I.col,K,G=I.row,P=[],L;if(O<0){O=H.getSpreadsheetIndexByTitle(J)}P.rowCount=(G-E.row)+1;P.columnCount=(M-E.col)+1;for(N=E.col;N<=M;N++){for(K=E.row;K<=G;K++){L=H.getCell(O,K,N);if(L!==null){P.push(L.updateValue());L.addDependency(B)}}}return P},callFunction:function(E,D,C){D=D.toUpperCase();C=C||[];var F=this.fn[D],B;if(F!==w){E.fnCount++;B=F.apply(E,C)}else{B=new q();B.html="Function "+D+" Not Found"}return B},spareFormulaParsers:{},formulaParser:function(C){var B;if(C>-1){B=this.spareFormulaParsers[C];if(B===w){B=this.spareFormulaParsers[C]=Formula(this)}}else{B=this.jS.formulaParser}return B}};return z})(g);k.CellTypeHandlers={percent:function(y){var x=(n(y)?globalize.parseFloat(y):y*1),w;if(!n(x)){w=new u(x);w.html=globalize.format(x,"p");return w}return y},date:function(x){var w=globalize.parseDate(x);if(w===null){return x}else{w.html=globalize.format(w,"d");return w}},time:function(x){var w=globalize.parseDate(x);if(w===null){return x}else{w.html=globalize.format(w,"t");return w}},currency:function(y){var x=(n(y)?globalize.parseFloat(y):y*1),w;if(!n(x)){w=new u(x);w.html=globalize.format(x,"c");return w}return y},number:function(y){var x,w;if(!settings.endOfNumber){x=globalize.culture().numberFormat["."];settings.endOfNumber=new b("(["+(x=="."?".":x)+"])([0-9]*?[1-9]+)?(0)*$")}if(!n(y)){w=new u(y);w.html=globalize.format(y+"","n10").replace(settings.endOfNumber,function(B,A,z){return(z?A:"")+(z||"")});return w}return y}};k.CellRange=(function(){function w(x){this.cells=x||[]}w.prototype={clone:function(){var B=[],z=this.cells,y=z.length,x,C;for(var A=0;A<y;A++){x=z[A];C={value:x.value,formula:x.formula,td:x.td,dependencies:x.dependencies,needsUpdated:x.needsUpdated,calcCount:x.calcCount,sheetIndex:x.sheetIndex,rowIndex:x.rowIndex,columnIndex:x.columnIndex,html:x.html,state:x.state,jS:x.jS,style:x.style,cl:x.cl,id:x.id,cellType:x.cellType,type:x.type,uneditable:x.uneditable};B.push(C)}return new w(B)},type:w,typeName:"Sheet.CellRange"};return w})();k.ActionUI=(function(w,z,x,y,A){var B=function(H,R,I,D,N){this.enclosure=H;this.pane=w.createElement("div");this.table=R;this.max=N;this.xIndex=0;this.yIndex=0;this.scrollAxis={x:{},y:{}};this.scrollSize={};this.hiddenColumns=[];this.hiddenRows=[];if(!(this.frozenAt=D)){this.frozenAt={row:0,col:0}}this.frozenAt.row=x.max(this.frozenAt.row,0);this.frozenAt.col=x.max(this.frozenAt.col,0);this.scrolledArea={start:{row:x.max(this.frozenAt.row,1),col:x.max(this.frozenAt.col,1)},end:{row:x.max(this.frozenAt.row,1),col:x.max(this.frozenAt.col,1)}};var G=this,L=this.pane,K="#"+R.getAttribute("id"),S=this.scrollUI=L.scrollOuter=w.createElement("div"),P=L.scrollInner=w.createElement("div"),F=L.scrollStyleX=this.scrollStyleX=new k.StyleUpdater(function(W,X){W=W||[];if(W.length!==G.xIndex||X){G.xIndex=W.length||G.xIndex;if(X===undefined){var V=G.frozenAt.col;if(this.max===undefined){X=K+" tr > *:nth-child(-n+"+W[0]+") {display: none;}"+K+" col:nth-child(-n+"+W[0]+") {display: none;}"+K+" tr > *:nth-child(-n+"+(G.frozenAt.col+1)+") {display: table-cell;}"+K+" col:nth-child(-n+"+(G.frozenAt.col+1)+") {display: table-column;}"+K+" tr > *:nth-child("+(W[0]+20)+") ~ * {display: none;}"+K+" col:nth-child("+(W[0]+20)+") ~ col {display: none;}"}else{X=this.nthCss("col",K,W,G.frozenAt.col+1)+this.nthCss("*",K+" tr",W,G.frozenAt.col+1)+K+" tr *:nth-child("+(W[0]+20)+") ~ * {display: none;}"}}this.setStyle(X);if(W.length){G.scrolledArea.start.col=x.max(W.pop()||1,1);G.scrolledArea.end.col=x.max(W.shift()||1,1)}return true}return false},N),E=L.scrollStyleY=this.scrollStyleY=new k.StyleUpdater(function(V,W){V=V||[];if(V.length!==G.yIndex||W){G.yIndex=V.length||G.yIndex;if(W===undefined){var X=G.frozenAt.row;if(this.max===undefined){W=K+" tr:nth-child(-n+"+V[0]+") {display: none;}"+K+" tr:nth-child(-n+"+(G.frozenAt.row+1)+") {display: table-row;}"+K+" tr:nth-child("+(V[0]+40)+") ~ tr {display: none;}"}else{W=this.nthCss("tr",K,V,G.frozenAt.row+1)+K+" tr:nth-child("+(V[0]+40)+") ~ * {display: none;}"}}this.setStyle(W);if(V.length){G.scrolledArea.start.row=x.max(V.pop()||1,1);G.scrolledArea.end.row=x.max(V.shift()||1,1)}return true}return false});S.setAttribute("class",I);S.appendChild(P);A(S).disableSelectionSpecial();L.appendChild(F.styleElement);L.appendChild(E.styleElement);var O,T,Q,U,J,M,C=R.tBody.children[0];L.resizeScroll=function(V){if(V){O=F.getStyle();T=E.getStyle()}else{O=(R.clientWidth<=H.clientWidth?"":F.getStyle());T=(R.clientHeight<=H.clientHeight?"":E.getStyle())}F.update(null," ");E.update(null," ");if(C===undefined){C=R.tBody.children[0]}Q=(C.clientWidth||R.clientWidth)+"px";U=R.clientHeight+"px";J=H.clientWidth+"px";M=H.clientHeight+"px";P.style.width=Q;P.style.height=U;S.style.width=J;S.style.height=M;G.scrollStart("x");G.scrollStart("y");F.update(null,O);E.update(null,T);if(L.inPlaceEdit){L.inPlaceEdit.goToTd()}};new MouseWheel(L,S)};B.prototype={putTdInView:function(H){var D=0,C=0,G=0,F,E;this.xIndex=0;this.yIndex=0;while((F=this.directionToSeeTd(H))!==null){E=this.scrolledArea.end;if(F.left){C--;this.scrollTo({axis:"x",value:E.col-1})}else{if(F.right){C++;this.scrollTo({axis:"x",value:E.col+1})}}if(F.up){G--;this.scrollTo({axis:"y",value:E.row-1})}else{if(F.down){G++;this.scrollTo({axis:"y",value:E.row+1})}}D++;if(D<25){break}this.scrollStop()}},directionToSeeTd:function(D){var C=this.pane,M={top:0,bottom:C.clientHeight,left:0,right:C.clientWidth},I=D.clientWidth,G=D.clientHeight,K={top:D.offsetTop,bottom:D.offsetTop+G,left:D.offsetLeft,right:D.offsetLeft+I},E=D.parentNode,J=this.scrolledArea.end;if(!D.col){return null}var L=D.barTop.cellIndex<J.col,F=E.rowIndex<J.row,H={up:F,down:K.bottom>M.bottom&&G<=C.clientHeight,left:L,right:K.right>M.right&&I<=C.clientWidth};if(H.up||H.down||H.left||H.right){return H}return null},redraw:function(){var C=this.pane.style;C.opacity=0.9999;setTimeout(function(){C.opacity=1},0)},hide:function(E,D){var G="#"+this.table.getAttribute("id"),F=this.pane,C=this;if(this.toggleHideStyleX===null){this.toggleHideStyleX=new k.StyleUpdater(function(){var H=this.nthCss("col",G,C.hiddenColumns,0)+this.nthCss("> td",G+" tr",C.hiddenColumns,0)+this.nthCss("> th",G+" tr",C.hiddenColumns,0);this.setStyle(H)});this.toggleHideStyleY=new k.StyleUpdater(function(){var H=this.nthCss("tr",G,C.hiddenRows,0);this.setStyle(H)})}F.appendChild(this.toggleHideStyleX.styleElement);F.appendChild(this.toggleHideStyleY.styleElement);this.hiddenRows=(E!==null?E:[]);this.hiddenColumns=(D!==null?D:[]);this.toggleHideStyleY.update();this.toggleHideStyleX.update()},toggleHideRow:function(C){var D;if((D=this.hiddenRows.indexOf(C))>-1){this.hiddenRows.splice(D,1)}else{this.hiddenRows.push(C)}this.toggleHideStyleY.update()},toggleHideRowRange:function(J,H){if(!J){return}if(!H){H=J}var I=this.hiddenRows,G=[],D=I.length,E,F=0,C=null;for(;F<D;F++){E=I[F];if(E>=J&&E<=H){if(C===null){C=true}}else{G.push(E)}}if(C===null){for(F=J;F<=H;F++){G.push(F)}}this.hiddenRows=G;this.toggleHideStyleY.update()},rowShowAll:function(){this.toggleHideStyleY.setStyle("");this.hiddenRows=[]},toggleHideColumn:function(C){var D;if((D=this.hiddenColumns.indexOf(C))>-1){this.hiddenColumns.splice(D,1)}else{this.hiddenColumns.push(C)}this.toggleHideStyleX.update()},toggleHideColumnRange:function(J,I){if(!J){return}if(!I){I=J}var H=this.hiddenColumns,F=[],E=H.length,D,G=0,C=null;for(;G<E;G++){D=H[G];if(D>=J&&D<=I){if(C===null){C=true}}else{F.push(D)}}if(C===null){for(G=J;G<=I;G++){F.push(G)}}this.hiddenColumns=F;this.toggleHideStyleX.update()},columnShowAll:function(){this.toggleHideStyleX.setStyle("");this.hiddenColumns=[]},remove:function(){},scrollStart:function(H){var I=this.pane,F=I.scrollOuter,G=this.scrollAxis[H],E=this.scrollSize=I.size();G.v=[];G.name=H;switch(H||"x"){case"x":G.value=0;G.max=E.cols;G.min=0;G.size=E.cols;I.scrollStyleX.update();G.scrollStyle=I.scrollStyleX;G.area=F.scrollWidth-F.clientWidth;G.sheetArea=I.table.clientWidth-I.table.corner.clientWidth;G.scrollUpdate=function(){F.scrollLeft=(G.value)*(G.area/G.size)};G.gridSize=100/G.size;break;case"y":G.value=0;G.max=E.rows;G.min=0;G.size=E.rows;I.scrollStyleY.update();G.scrollStyle=I.scrollStyleY;G.area=F.scrollHeight-F.clientHeight;G.sheetArea=I.table.clientHeight-I.table.corner.clientHeight;G.scrollUpdate=function(){F.scrollTop=(G.value)*(G.area/G.size)};G.gridSize=100/G.size;break}var D=G.max;do{var C=new y(G.gridSize*D);C.index=D+1;G.v.unshift(C)}while(D--)},scrollTo:function(F){F=F||{};F.axis=F.axis||"x";F.value=F.value||0;F.pixel=F.pixel||0;var E=this.scrollAxis[F.axis];if(!F.value){F.value=c.closest(E.v,x.abs(F.pixel/E.area)*100,E.min).index}F.max=F.max||E.max;var D=((F.value>F.max?F.max:F.value)-E.min),C=[];if(D>=0){do{C.push(D+E.min)}while(D-->0)}E.value=F.value;if(C.length>0){if(E.scrollStyle){return E.scrollStyle.update(C)}}else{if(E.scrollStyle){return E.scrollStyle.update()}}return false},scrollStop:function(){if(this.scrollAxis.x.scrollUpdate){this.scrollAxis.x.scrollUpdate()}if(this.scrollAxis.y.scrollUpdate){this.scrollAxis.y.scrollUpdate()}},toggleHideStyleX:null,toggleHideStyleY:null};return B})(l,f,g,u,d);k.SpreadsheetUI=(function(){var w=[];function x(z,B,A,y){y=y||{};this.i=z;this.ui=B;this.table=A;this.isLast=y.lastIndex===z;this.enclosure=null;this.pane=null;this.spreadsheet=null;this.sizeCheck=y.sizeCheck||function(){};this.initChildren=y.initChildren||function(){};this.done=y.done||function(){};this.sizeCheck(this)}x.prototype={load:function(){var y=this.table;this.initChildren(this.ui,y,this.i);y.pane.ui=this.ui;this.enclosure=y.enclosure;this.pane=y.pane;this.spreadsheet=y.spreadsheet;w.push(this.i);if(this.isLast){this.loaded()}},loaded:function(){this.done(w,this)}};return x})();k.Theme=(function(w){function x(y){y=y||k.defaultTheme;switch(y){case k.customTheme:this.cl=x.customClasses;break;case k.bootstrapTheme:this.cl=x.bootstrapClasses;break;default:case k.themeRollerTheme:this.cl=x.themeRollerClasses;break}w.extend(this,this.cl)}x.themeRollerClasses={autoFiller:"ui-state-active",bar:"ui-widget-header",barHighlight:"ui-state-active",barHandleFreezeLeft:"ui-state-default",barHandleFreezeTop:"ui-state-default",barMenuTop:"ui-state-default",tdActive:"ui-state-active",tdHighlighted:"ui-state-highlight",control:"ui-widget-header ui-corner-top",controlTextBox:"ui-widget-content",fullScreen:"ui-widget-content ui-corner-all",inPlaceEdit:"ui-state-highlight",menu:"ui-widget-header",menuFixed:"",menuUl:"ui-widget-header",menuLi:"ui-widget-header",menuHover:"ui-state-highlight",pane:"ui-widget-content",parent:"ui-widget-content ui-corner-all",table:"ui-widget-content",tab:"ui-widget-header",tabActive:"ui-state-highlight",barResizer:"ui-state-highlight",barFreezer:"ui-state-highlight",barFreezeIndicator:"ui-state-highlight"};x.bootstrapClasses={autoFiller:"btn-info",bar:"bg-primary",barHighlight:"label-info",barHandleFreezeLeft:"bg-warning",barHandleFreezeTop:"bg-warning",barMenuTop:"bg-warning",tdActive:"active",tdHighlighted:"bg-info",control:"bg-primary",controlTextBox:"form-control",fullScreen:"",inPlaceEdit:"form-control",menu:"panel panel-default",menuFixed:"nav navbar-nav",menuUl:"panel-info",menuLi:"active",menuHover:"bg-primary active",pane:"well",parent:"panel panel-default",table:"table table-bordered table-condensed",tab:"btn-default btn-xs",tabActive:"active",barResizer:"bg-info",barFreezer:"bg-warning",barFreezeIndicator:"bg-warning"};x.customClasses={autoFiller:"",bar:"",barHighlight:"",barHandleFreezeLeft:"",barHandleFreezeTop:"",barMenuTop:"",tdActive:"",tdHighlighted:"",control:"",controlTextBox:"",fullScreen:"",inPlaceEdit:"",menu:"",menuFixed:"",menuUl:"",menuLi:"",menuHover:"",pane:"",parent:"",table:"",tab:"",tabActive:"",barResizer:"",barFreezer:"",barFreezeIndicator:""};return x})(jQuery);k.Highlighter=(function(w,x,y){var z=function(B,D,A,C){this.cssClass=B;this.cssClassBars=D;this.cssClassTabs=A;this.callBack=C||function(){};this.last=y([]);this.lastTop=y([]);this.lastLeft=y([]);this.lastTab=y([]);this.start={row:0,col:0};this.end={row:0,col:0}};z.prototype={set:function(C){if(C.parentNode!==undefined){C=[C]}var A,B=this.last;if(B&&B.length>0){A=B.length-1;do{B[A].isHighlighted=false}while(A-->0)}if(C.length>0){A=C.length-1;do{if(!C[A].isHighlighted){C[A].isHighlighted=true;if(!C[A].className.match(this.cssClass)){C[A].className+=" "+this.cssClass}}}while(A-->0)}this.clear(B);this.last=C;this.callBack();return this},is:function(){return this.last.length>0},clear:function(B){if(this.is()){B=B||this.last;if(B&&B.length){var A=B.length-1;do{if(!B[A].isHighlighted){B[A].className=B[A].className.replace(this.cssClass,"");B[A].isHighlighted=false}}while(A-->0)}}this.last=y([]);return this},setBar:function(A,B){switch(A){case"top":this.lastTop.removeClass(this.cssClassBars);this.lastTop=y(B).addClass(this.cssClassBars);break;case"left":this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=y(B).addClass(this.cssClassBars);break}return this},clearBar:function(){this.lastTop.removeClass(this.cssClassBars);this.lastTop=y([]);this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=y([]);return this},setTab:function(A){this.clearTab();this.lastTab=A.addClass(this.cssClassTabs);return this},clearTab:function(){this.lastTab.removeClass(this.cssClassTabs);return this},setStart:function(A){this.start=A;return this},setEnd:function(A){this.end=A;return this}};return z})(l,f,jQuery);k.ColumnAdder=(function(){function w(){this.qty=-1;this.addedFinishedFn=null;this.createBarFn=null;this.createCellFn=null}w.prototype={setQty:function(z,y){var x=d.sheet.max;if(x){if(x>y.cols&&x<=y.cols+z){this.qty=x-y.cols}else{if(x&&x<=y.cols+z){return false}}}else{this.qty=z}return true},setAddedFinishedFn:function(x){this.addedFinishedFn=x},setCreateBarFn:function(x){this.createBarFn=x},setCreateCellFn:function(x){this.createCellFn=x},createCells:function(C,F,B){var A=(B?0:1),x=F.rows||1,z=C+this.qty,E,y=C,D;for(;y<z;y++){D=this.createBarFn(y+A);for(E=1;E<=x;E++){this.createCellFn(E,y+A,D)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:0,col:this.qty})}}};return w})();k.RowAdder=(function(){function w(){this.qty=-1;this.addedFinishedFn=null;this.createBar=null;this.createCell=null}w.prototype={setQty:function(A,y,z){var x=d.sheet.max;if(x){if(x>y.rows&&x<=y.rows+A){this.qty=x-y.rows}else{if(x&&x<=y.rows+A){return false}}}else{this.qty=A}return true},setAddedFinishedFn:function(x){this.addedFinishedFn=x},setCreateBarFn:function(x){this.createBar=x},setCreateCellFn:function(x){this.createCell=x},createCells:function(C,F,B){var A=(B?0:1),x=C+this.qty,z=F.cols||1,D,E=C,y;for(;E<x;E++){D=this.createBar(E+A);for(y=1;y<=z;y++){this.createCell(E+A,y,D)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:this.qty,col:0})}}};return w})();k.StyleUpdater=(function(w){function x(z,y){var A=this.styleElement=w.createElement("style");A.styleUpdater=this;this._update=z;this.max=y;if(k.StyleUpdater.prototype.nthCss===null){if(y!==undefined){k.StyleUpdater.prototype.nthCss=function(B,I,D,F,E){var G=[],C=D.length,H=this.repeat;E=E||"{display: none;}";do{if(D[C]>F){G.push(I+" "+B+":first-child"+H("+"+B,D[C]-1))}}while(C--);if(G.length){return G.join(",")+E}return""}}else{k.StyleUpdater.prototype.nthCss=function(B,H,D,F,E){var G=[],C=D.length;E=E||"{display: none;}";do{if(D[C]>F){G.unshift(H+" "+B+":nth-child("+(D[C]+1)+")")}}while(C--);if(G.length){return G.join(",")+E}return""}}}}x.prototype={setStyle:null,getStyle:null,nthCss:null,repeat:function(A,z){var y="";while(z>0){if(z&1){y+=A}z>>=1;A+=A}return y},update:function(){return this._update.apply(this,arguments)}};if(w.createElement("style").styleSheet){x.prototype.setStyle=function(z){var A=this.styleElement,y=A.styleSheet;y.disabled=false;if(!y.disabled){y.cssText=z}};x.prototype.getStyle=function(){var z=this.styleElement,y=z.styleSheet;y.disabled=false;if(!y.disabled){return y.cssText}return""}}else{x.prototype.setStyle=function(y){this.styleElement.innerHTML=y};x.prototype.getStyle=function(){return this.styleElement.innerHTML}}return x})(l);k.JSONLoader=(function(y,w,x){function z(A){if(A!==undefined){this.json=A;this.count=A.length}else{this.json=[];this.count=0}}z.prototype={size:function(D){var C={cols:0,rows:0},B=this.json,F,E,G,A;if((F=B[D])===undefined){return C}if((E=F.rows)===undefined){return C}if((G=E[0])===undefined){return C}if((A=G.columns)===undefined){return C}return{rows:E.length,cols:A.length}},getWidth:function(A,E){var C=this.json,G=C[A]||{},B=G.metadata||{},F=B.widths||[],D=F[E]||k.defaultColumnWidth;return D},getHeight:function(B,G){var C=this.json,E=C[B]||{},D=E.rows||[],F=D[G]||{},A=F.height||k.defaultRowHeight;return A},setupCell:function(C,H,E,B){var G=w.createElement("td"),F=this.getCell(C,H,E),A,D;if(F!==null){if(F.getCell!==undefined){A=F.getCell();if(A.formula){G.setAttribute("data-formula",A.formula||"");if(A.hasOwnProperty("value")&&A.value!==null){D=A.value.hasOwnProperty("html")?A.value.html:A.value;switch(typeof D){case"object":if(D.appendChild!==undefined){G.appendChild(D);break}case"string":default:G.innerHTML=D;break}}}else{G.innerHTML=A.value}}else{A=B(G);A.value=F.value;if(F.formula){A.formula=F.formula||"";G.setAttribute("data-formula",F.formula||"")}else{G.innerHTML=F.value}}if(A.loadedFrom===null){A.loadedFrom=F;A.loader=this}if(F["class"]!==undefined){G.className=F["class"]}if(F.style!==undefined){G.setAttribute("style",F.style)}if(F.rowspan!==undefined){G.setAttribute("rowspan",F.rowspan)}if(F.colspan!==undefined){G.setAttribute("colspan",F.colspan)}if(F.uneditable!==undefined){G.setAttribute("data-uneditable",F.uneditable)}if(F.cellType!==undefined){G.setAttribute("data-celltype",F.cellType);A.cellType=F.cellType}if(F.id!==undefined){G.setAttribute("id",F.id);A.id=F.id}}else{A=B(G)}G.jSCell=A;A.td=G;A.sheetIndex=C;A.rowIndex=H;A.columnIndex=E;return A},getCell:function(B,H,D){var C=this.json,F,E,G,A;if((F=C[B])===undefined){return null}if((E=F.rows)===undefined){return null}if((G=E[H-1])===undefined){return null}if((A=G.columns[D-1])===undefined){return null}return A},jitCell:function(O,I,G,F,D){var B=this.getCell(O,I,G);if(B===null){return null}if(B.getCell!==undefined){return B.getCell()}var N,A,L,H,J,Q,M,P,C,K,E;A=B.id;L=B.value;H=B.formula;J=B.cellType;Q=B.uneditable;M=(A!==undefined&&A!==null);P=(L!==undefined&&L!==null);C=(H!==undefined&&H!==null);K=(J!==undefined&&J!==null);E=(Q!==undefined&&Q!==null);N=new k.Cell(O,null,F,D);N.rowIndex=I;N.columnIndex=G;N.loadedFrom=B;N.loader=this;N.needsUpdated=C;if(K){N.cellType=J}if(C){N.formula=H}if(E){N.uneditable=Q}if(M){N.id=A}if(P){N.value=new x(L)}else{N.value=new x()}N.value.cell=N;B.getCell=function(){return N};return N},title:function(A){var B=this.json,C;if((C=B[A])===undefined){return""}return C.title||""},hiddenRows:function(D){var F=this.json[D].metadata||{},C=F.hiddenRows||[],B=C.length,A=[],E=0;for(;E<B;E++){A.push(C[E])}return A},hiddenColumns:function(C){var E=this.json[C].metadata||{},F=E.hiddenColumns||[],B=F.length,A=[],D=0;for(;D<B;D++){A.push(F[D])}return A},hasSpreadsheetAtIndex:function(A){return(this.json[A]!==undefined)},getSpreadsheetIndexByTitle:function(D){var C=this.json,A=this.count,B=0;for(;B<A;B++){if(C[B].title==D){return B}}return -1},addSpreadsheet:function(B,A){if(A===undefined){this.json.push(B)}else{this.json.splice(A,0,B)}this.count=this.json.length},getCellAttribute:function(A,B){return A[B]},setCellAttribute:function(A,B,C){A[B]=C},setCellAttributes:function(A,B){var C;for(C in B){if(B.hasOwnProperty(C)){A[C]=B[C]}}},cycleCells:function(G,F){var H=this.json,D,J,B,A,I,E,C;if((D=H[G])===undefined){return}if((E=(J=D.rows).length)<1){return}if(J[0].columns.length<1){return}E--;do{I=J[E];B=I.columns;C=B.length-1;do{A=B[C];F.call(this.jitCell(G,E,C,A),G,E,C)}while(C-->0)}while(E-->0)},cycleCellsAll:function(C){var B=this.json,A=B.length-1;if(A<0){return}do{this.cycleCells(A,C)}while(A-->0)},toTables:function(){var T=this.json,J=y([]),F,L,G,C,D,N,M,P,A,V,I,O,U,K,E,B,H,S,R,Q;for(S=0;S<T.length;S++){F=T[S];U=y(w.createElement("table"));if(F.title){U.attr("title",F.title||"")}J=J.add(U);L=F.rows;for(R=0;R<L.length;R++){G=L[R];if(O=(G.height+"").replace("px","")){B=y(w.createElement("tr")).attr("height",O).css("height",O+"px").appendTo(U)}C=G.columns;for(Q=0;Q<C.length;Q++){D=C[Q];H=y(w.createElement("td")).appendTo(B);if(D["class"]){H.attr("class",D["class"]||"")}if(D.style){H.attr("style",D.style||"")}if(D.formula){H.attr("data-formula",(D.formula?"="+D.formula:""))}if(D.cellType){H.attr("data-celltype",D.cellType||"")}if(D.value){H.html(D.value||"")}if(D.uneditable){H.html(D.uneditable||"")}if(D.rowspan){H.attr("rowspan",D.rowspan||"")}if(D.colspan){H.attr("colspan",D.colspan||"")}if(D.id){H.attr("id",D.id||"")}if(D.cache){H.html(D.cache)}}}if(N=F.metadata){if(M=N.widths){K=y(w.createElement("colgroup")).prependTo(U);for(Q=0;Q<M.length;Q++){P=(M[Q]+"").replace("px","");E=y(w.createElement("col")).attr("width",P).css("width",P+"px").appendTo(K)}}if(A=N.frozenAt){if(A.row){U.attr("data-frozenatrow",A.row)}if(A.col){U.attr("data-frozenatcol",A.col)}}if(V=N.hiddenRows){U.attr("data-hiddenrows",V.join(","))}if(I=N.hiddenColumns){U.attr("data-hiddencolumns",I.join(","))}}}return J},fromSheet:function(J,E){E=(E==undefined?false:E);var M=[],S=1*J.i,O,F=J.spreadsheets.length-1,T,H,I,D,K,R,C,A,P,L,N,Q,G,B;if(F<0){return M}do{Q=false;J.i=F;J.evt.cellEditDone();O=J.obj.pane();T={title:(J.obj.table().attr("title")||""),rows:[],metadata:{widths:[],frozenAt:{row:O.actionUI.frozenAt.row,col:O.actionUI.frozenAt.col}}};M.unshift(T);H=J.spreadsheets[F];I=H.length-1;do{G=H[I][1].td[0].parentNode;B=G.style.height;R={columns:[],height:(B?B.replace("px",""):J.s.colMargin)};D=H[I].length-1;do{A=H[I][D];C={};P=A.td[0].attributes;if(E||Q||P["class"]||A.formula||A.value||P.style){Q=true;L=(P["class"]?y.trim((P["class"].value||"").replace(J.cl.uiCellActive,"").replace(J.cl.uiCellHighlighted,"")):"");N=A.td[0].parentNode;R.columns.unshift(C);if(!R.height){R.height=(N.style.height?N.style.height.replace("px",""):J.s.colMargin)}if(A.formula){C.formula=A.formula}if(A.cellType){C.cellType=A.cellType}if(A.value){C.value=A.value}if(A.uneditable){C.uneditable=A.uneditable}if(A.cache){C.cache=A.cache}if(A.id){C.id=A.id}if(P.style&&P.style.value){C.style=P.style.value}if(L.length){C["class"]=L}if(P.rowspan){C.rowspan=P.rowspan.value}if(P.colspan){C.colspan=P.colspan.value}if(I*1==1){T.metadata.widths.unshift(y(J.col(null,D)).css("width").replace("px",""))}}}while(D-->1);if(Q){T.rows.unshift(R)}}while(I-->1)}while(F--);J.i=S;return this.json=M},type:z,typeName:"Sheet.JSONLoader"};return z})(jQuery,l,q);k.XMLLoader=(function(x,w){function y(z){if(z!==undefined){this.xml=x.parseXML(z);this.spreadsheets=this.xml.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet");this.count=this.xml.length}else{this.xml=null;this.spreadsheets=null;this.count=0}}y.prototype={size:function(B){var z=this.xml[B],C=z.rows,D=C[0],A=D.columns;return{rows:C.length,cols:A.length}},setWidth:function(H,E,C){var D=this.spreadsheets,G=D[H],F=G.getElementsByTagName("metadata")[0]||{},A=F.getElementsByTagName("width")||[],B=A[E],z=(B.textContent||B.text);C.style.width=z+"px"},setRowHeight:function(A,G,E){var C=this.spreadsheets,B,D,F,z;if((B=C[A])===undefined){return}if((D=B.getElementsByTagName("rows")[0].getElementsByTagName("row"))===undefined){return}if((F=D[G])===undefined){return}if((z=F.attributes.height.nodeValue)===undefined){return}E.style.height=z+"px"},setupCell:function(H,C,B,z,D){var A=this.spreadsheets,G,I,E,F;if((G=A[H])===undefined){return false}if((I=G.getElementsByTagName("rows")[0].getElementsByTagName("row")[C-1])===undefined){return false}if((E=I.getElementsByTagName("columns")[0].getElementsByTagName("column")[B-1])===undefined){return false}z.cellType=E.attributes.cellType.nodeValue||"";if((F=E.jitCell)!==undefined){z.html=F.html;z.state=F.state;z.calcLast=F.calcLast;z.calcDependenciesLast=F.calcDependenciesLast;z.cellType=F.cellType;z.value=F.value;z.uneditable=F.uneditable;z.sheet=F.sheet;z.dependencies=F.dependencies}if(E.attributes.formula){z.formula=E.attributes.formula.nodeValue||"";D.setAttribute("data-formula",E.attributes.formula.nodeValue||"")}else{D.innerHTML=z.value=E.attributes.value.nodeValue||""}D.className=E.attributes["class"].nodeValue||"";D.setAttribute("style",E.attributes.style.nodeValue||"");if(E.attributes.rowspan){D.setAttribute("rowspan",E.attributes.rowspan.nodeValue||"")}if(E.attributes.colspan){D.setAttribute("colspan",E.attributes.colspan.nodeValue||"")}return true},getCell:function(z,B,A){return null},jitCell:function(A,F,D){var C=this.spreadsheets,B,E,z;if((B=C[A])===undefined){return false}if((E=B.getElementsByTagName("rows")[0].getElementsByTagName("row")[F-1])===undefined){return false}if((z=E.getElementsByTagName("columns")[0].getElementsByTagName("column")[D-1])===undefined){return false}return{td:{cellIndex:D,parentNode:{rowIndex:F},html:function(){}},html:[],state:[],calcLast:-1,calcDependenciesLast:-1,cellType:z.attributes.cellType.nodeValue||"",formula:z.attributes.formula.nodeValue||"",value:z.attributes.value.nodeValue||"",type:"cell",sheet:A,id:null}},title:function(A){var B=this.spreadsheets,z;if((z=B[A])===undefined){return""}return(z.attributes.title?z.attributes.title.nodeValue:"")},getSpreadsheetIndexByTitle:function(z){},addSpreadsheet:function(z,A){if(A===undefined){this.spreadsheets.append.push(jsonSpreadsheet)}else{this.json.splice(A,0,jsonSpreadsheet)}this.count=this.json.length},setCellAttribute:function(z,A,B){},toTables:function(){var G=this.xml,K=x([]),E=G.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet"),H,O,I,C,F,X,R,ad,Q,N,P,U,S;for(var aa=0;aa<E.length;aa++){H=E[aa];var ac=x(w.createElement("table")).attr("title",(H.attributes.title?H.attributes.title.nodeValue:"")),M=x(w.createElement("colgroup")).appendTo(ac),A=x(w.createElement("tbody")).appendTo(ac);K=K.add(ac);O=H.getElementsByTagName("rows")[0].getElementsByTagName("row");R=H.getElementsByTagName("metadata")[0];for(var Y=0;Y<O.length;Y++){I=O[Y];var B=x(w.createElement("tr")).appendTo(A);if(S=I.attributes.height){S=(S.nodeValue||"").replace("px","");B.css("height",S).attr("height",S+"px")}C=I.getElementsByTagName("columns")[0].getElementsByTagName("column");for(var W=0;W<C.length;W++){F=C[W];var J=x(w.createElement("td")).appendTo(B),z=F.getElementsByTagName("formula")[0],Z=F.getElementsByTagName("cellType")[0],V=F.getElementsByTagName("value")[0],ab=F.getElementsByTagName("style")[0],L=F.getElementsByTagName("class")[0],ae=F.getElementsByTagName("rowspan")[0],D=F.getElementsByTagName("colspan")[0],T=F.getElementsByTagName("id")[0];if(z){J.attr("data-formula","="+(z.textContent||z.text))}if(Z){J.attr("data-celltype",Z.textContent||Z.text)}if(V){J.html(V.textContent||V.text)}if(ab){J.attr("style",ab.textContent||ab.text)}if(L){J.attr("class",L.textContent||L.text)}if(ae){J.attr("rowspan",ae.textContent||ae.text)}if(D){J.attr("colspan",D.textContent||D.text)}if(T){J.attr("id",T.textContent||T.text)}}}P=R.getElementsByTagName("width");for(var Y=0;Y<P.length;Y++){U=(P[Y].textContent||P[Y].text).replace("px","");x(w.createElement("col")).attr("width",U).css("width",U+"px").appendTo(M)}ad=R.getElementsByTagName("frozenAt")[0];if(ad){N=ad.getElementsByTagName("col")[0];Q=ad.getElementsByTagName("row")[0];if(N){ac.attr("data-frozenatcol",(N.textContent||N.text)*1)}if(Q){ac.attr("data-frozenatrow",(Q.textContent||Q.text)*1)}}}return K},fromSheet:function(L,F,G){F=(F==undefined?false:F);var O="",V=1*L.i,H=L.spreadsheets.length-1,A,J,K,E,M,T,U,C,B,R,N,P,z,S,Q,I,D;if(H<0){return O}do{S=false;L.i=H;L.evt.cellEditDone();z=x.extend({},L.obj.pane().actionUI.frozenAt);Q=[];J=L.spreadsheets[H];K=J.length-1;T="";do{C="";E=J[K].length-1;do{U="";B=J[K][E];R=B.td[0].attributes;N=(R["class"]?x.trim((R["class"].value||"").replace(L.cl.uiCellActive,"").replace(L.cl.uiCellHighlighted,"")):"");if(F||S||N||B.formula||B.value||R.style){S=true;U+="<column>";if(B.formula){U+="<formula>"+B.formula+"</formula>"}if(B.cellType){U+="<cellType>"+B.cellType+"</cellType>"}if(B.value){U+="<value>"+B.value+"</value>"}if(R.style){U+="<style>"+R.style.value+"</style>"}if(N){U+="<class>"+N+"</class>"}if(R.rowspan){U+="<rowspan>"+R.rowspan.value+"</rowspan>"}if(R.colspan){U+="<colspan>"+R.colspan.value+"</colspan>"}if(R.id){U+="<id>"+R.id.value+"</id>"}U+="</column>";C=U+C;if(K*1==1){Q[E]="<width>"+x(L.col(null,E)).css("width").replace("px","")+"</width>"}}}while(E-->1);if(C){I=J[K][1].td[0].parentNode;D=I.style.height;T='<row height="'+(D?D.replace("px",""):L.s.colMargin)+'"><columns>'+C+"</columns></row>"+T}}while(K-->1);A='<spreadsheet title="'+(L.obj.table().attr("title")||"")+'"><rows>'+T+"</rows><metadata>"+(z.row||z.col?"<frozenAt>"+(z.row?"<row>"+z.row+"</row>":"")+(z.col?"<col>"+z.col+"</col>":"")+"</frozenAt>":"")+"<widths>"+Q.join("")+"</widths></metadata></spreadsheet>";O=A+O}while(H--);L.i=V;O='<?xml version="1.0" encoding="UTF-8"?><spreadsheets xmlns="http://www.w3.org/1999/xhtml">'+O+"</spreadsheets>";if(G!==true){this.xml=x.parseXML(O)}return O},type:y,typeName:"Sheet.XMLLoader"};return y})(jQuery,l);d.fn.extend({sheet:function(x){var y=isNaN,w=d.sheet.events;x=x||{};d(this).each(function(){var F=Globalize,C=d(this),E={editable:true,editableNames:true,barMenus:true,freezableCells:true,allowToggleState:true,menuLeft:null,menuRight:null,newColumnWidth:120,title:null,calcOff:false,lockFormulas:false,parent:C,colMargin:20,boxModelCorrection:2,formulaFunctions:{},formulaVariables:{},cellSelectModel:k.excelSelectModel,autoAddCells:true,resizableCells:true,resizableSheet:true,autoFiller:true,minSize:{rows:1,cols:1},error:function(G){return G.error},endOfNumber:false,frozenAt:[],contextmenuTop:{"Insert column after":function(G){G.controlFactory.addColumn(G.colLast);return false},"Insert column before":function(G){G.controlFactory.addColumn(G.colLast,true);return false},"Add column to end":function(G){G.controlFactory.addColumn();return false},"Delete this column":function(G){G.deleteColumn();return false},"Hide column":function(G){G.toggleHideColumn();return false},"Show all columns":function(G){G.columnShowAll()},"Toggle freeze columns to here":function(I){var G=I.getTdLocation(I.obj.tdActive()).col,H=I.obj.pane().actionUI;H.frozenAt.col=(H.frozenAt.col==G?0:G)}},contextmenuLeft:{"Insert row after":function(G){G.controlFactory.addRow(G.rowLast);return false},"Insert row before":function(G){G.controlFactory.addRow(G.rowLast,true);return false},"Add row to end":function(G){G.controlFactory.addRow();return false},"Delete this row":function(G){G.deleteRow();return false},"Hide row":function(G){G.toggleHideRow();return false},"Show all rows":function(G){G.rowShowAll()},"Toggle freeze rows to here":function(H){var I=H.getTdLocation(H.obj.tdActive()).row,G=H.obj.pane().actionUI;G.frozenAt.row=(G.frozenAt.row==I?0:I)}},contextmenuCell:{"Insert row after":function(G){G.controlFactory.addRow(G.rowLast);return false},"Insert row before":function(G){G.controlFactory.addRow(G.rowLast,true);return false},"Add row to end":function(G){G.controlFactory.addRow();return false},"Delete this row":function(G){G.deleteRow();return false},line2:"line","Insert column after":function(G){G.controlFactory.addColumn(G.colLast);return false},"Insert column before":function(G){G.controlFactory.addColumn(G.colLast,true);return false},"Add column to end":function(G){G.controlFactory.addColumn();return false},"Delete this column":function(G){G.deleteColumn();return false},line3:"line","Add spreadsheet":function(G){G.addSheet()},"Delete spreadsheet":function(G){G.deleteSheet()}},hiddenRows:[],hiddenColumns:[],alert:function(G){alert(G)},prompt:function(H,I,G){I(prompt(H,G))},confirm:function(I,G,H){if(confirm(I)){G()}else{if(H){H()}}},initCalcRows:20,initCalcCols:10,initScrollRows:0,initScrollCols:0,loader:null};var D=this.jS;if(D){var A=C.children().detach();D.kill();C.html(A);for(var B in w){if(w.hasOwnProperty(B)){C.unbind(w[B])}}}if((this.className||"").match(/\bnot-editable\b/i)!=null){x.editable=false}for(var z in w){if(w.hasOwnProperty(z)){C.bind(w[z],x[w[z]])}}if(!d.sheet.instance.length){d.sheet.instance=[]}this.jS=D=d.sheet.createInstance(d.extend(E,x),d.sheet.instance.length);d.sheet.instance.push(D)});return this},disableSelectionSpecial:function(){this.each(function(){this.onselectstart=function(){return false};this.unselectable="on";this.style["-moz-user-select"]="none"});return this},getSheet:function(){var w=this[0],x=(w.jS||{});return x},getCellValue:function(x,C,y){var z=this[0],A=(z.jS||{}),w;if(A.getCell){try{w=A.getCell(x,C,y);if(w!==null){return w.updateValue()}}catch(B){}}return null},setCellValue:function(B,D,y,x){var z=this[0],A=(z.jS||{}),w;x=(x||0);if(A.getCell&&(w=A.getCell(x,D,y))){try{if((B+"").charAt(0)=="="){w.valueOverride=w.value="";w.formula=B.substring(1)}else{w.value=B;w.valueOverride=w.formula=""}w.updateValue();w.updateDependencies();return true}catch(C){}}return false},setCellFormula:function(D,C,y,x){var z=this[0],A=(z.jS||{}),w;x=(x||0);if(A.getCell){try{w=A.getCell(x,C,y);if(w!==null){w.formula=D;w.valueOverride=w.value="";w.updateValue();w.updateDependencies()}}catch(B){}}return this},isSheetFullScreen:function(){var w=this[0],x=(w.jS||{});if(x.obj){return x.obj.fullScreen().is(":visible")}return false},serializeCellInputs:function(x){var y=this[0],z=(y.jS||{}),w=z.obj.tables().find(":input");if(x){return w.serializeArray()}else{return w.serialize()}},viewSource:function(w){var x="";d(this).each(function(){if(w){x+=d(this).toPrettySource()}else{x+=d(this).toCompactSource()}});d.printSource(x);return x},toCompactSource:function(){var A=this[0];var x="";if(A.nodeType==1){x+="<"+A.tagName.toLowerCase();var C=A.attributes.length;for(var z=0;z<C;z++){var y=A.attributes[z].name,B=A.getAttribute(y);if(B){if(y=="contentEditable"&&B=="inherit"){continue}if(typeof(B)=="string"){x+=" "+y+'="'+B.replace(/"/g,"'")+'"'}else{if(y=="style"&&B.cssText){x+=' style="'+B.cssText+'"'}}}}if(A.tagName=="COL"){x+="/>"}else{x+=">";var w="";d(A.childNodes).each(function(){w+=d(this).toCompactSource()});x+=w;x+="</"+A.tagName.toLowerCase()+">"}}else{if(A.nodeType==3){x+=A.data.replace(/^\s*(.*)\s*$/g,"$1")}}return x},toPrettySource:function(B){var A=this[0],D,z;B=B||"";var x="";if(A.nodeType==1){x+="\n"+B+"<"+A.tagName.toLowerCase();D=A.attributes.length;for(z=0;z<D;z++){var y=A.attributes[z].name,C=A.getAttribute(y);if(C){if(y=="contentEditable"&&C=="inherit"){continue}if(typeof(C)=="string"){x+=" "+y+'="'+d.trim(C.replace(/"/g,"'"))+'"'}else{if(y=="style"&&C.cssText){x+=' style="'+d.trim(C.cssText)+'"'}}}}if(A.childNodes.length<=0){if(A.tagName=="COL"){x+="/>"}else{x+="></"+A.tagName.toLowerCase()+">"}}else{x+=">";var w="";D=A.childNodes.length;for(z=0;z<D;z++){w+=d(A.childNodes[z]).toPrettySource(B+"  ")}x+=w;if(w.indexOf("\n")>=0){x+="\n"+B}x+="</"+A.tagName.toLowerCase()+">"}}else{if(A.nodeType==3){x+=A.data.replace(/^\s*(.*)\s*$/g,"$1")}}return x}});d.sheet={instance:[],dependencies:{coreCss:{css:"jquery.sheet.css"},jQueryUI:{script:"jquery-ui/jquery-ui.min.js",thirdParty:true},jQueryUIThemeRoller:{css:"jquery-ui/themes/smoothness/jquery-ui.min.css",thirdParty:true},globalize:{script:"globalize/lib/globalize.js",thirdParty:true},nearest:{script:"jquery-nearest/src/jquery.nearest.min.js",thirdParty:true},mousewheel:{script:"MouseWheel/MouseWheel.js",thirdParty:true}},optional:{advancedFn:{script:"plugins/jquery.sheet.advancedfn.js"},financeFn:{script:"plugins/jquery.sheet.financefn.js"},colorPicker:{css:"really-simple-color-picker/colorPicker.css",script:"really-simple-color-picker/jquery.colorPicker.min.js",thirdParty:true},elastic:{script:"jquery-elastic/jquery.elastic.source.js",thirdParty:true},globalizeCultures:{script:"globalize/lib/cultures/globalize.cultures.js",thirdParty:true},raphael:{script:"raphael/raphael-min.js",thirdParty:true},gRaphael:{script:"graphael/g.raphael.js",thirdParty:true},gRaphaelBar:{script:"graphael/g.bar.js",thirdParty:true},gRaphaelDot:{script:"graphael/g.dot.js",thirdParty:true},gRaphaelLine:{script:"graphael/g.line.js",thirdParty:true},gRaphaelPie:{script:"graphael/g.pie.js",thirdParty:true},thaw:{script:"thaw.js/thaw.js",thirdParty:true},undoManager:{script:"Javascript-Undo-Manager/js/undomanager.js",thirdParty:true},zeroClipboard:{script:"zeroclipboard/dist/ZeroClipboard.min.js",thirdParty:true}},events:["sheetAddRow","sheetAddColumn","sheetSwitch","sheetRename","sheetTabSortStart","sheetTabSortUpdate","sheetCellEdit","sheetCellEdited","sheetCalculation","sheetAdd","sheetDelete","sheetDeleteRow","sheetDeleteColumn","sheetOpen","sheetAllOpened","sheetSave","sheetFullScreen","sheetFormulaKeydown"],preLoad:function(z,y){z=z||"";y=d.extend({skip:["globalizeCultures"],thirdPartyDirectory:"bower_components/"},y);var x=function(){if(this.script!==undefined){l.write('<script src="'+z+(this.thirdParty?y.thirdPartyDirectory:"")+this.script+'"><\/script>')}if(this.css!==undefined){l.write('<link rel="stylesheet" type="text/css" href="'+z+(this.thirdParty?y.thirdPartyDirectory:"")+this.css+'"></link>')}};for(var w in y.skip){if(this.dependencies[y.skip[w]]){delete this.dependencies[y.skip[w]]}if(this.optional[y.skip[w]]){delete this.optional[y.skip[w]]}}d.each(this.dependencies,function(){x.call(this)});d.each(this.optional,function(){x.call(this)})},createInstance:function(G,D){var J=this,N=function(Q,I){var P=I.parentNode;if(P.lastchild==I){P.appendChild(Q)}else{P.insertBefore(Q,I.nextSibling)}},H=d(f),O=d(l),E=l.body,M=d(E),B=function(){},F=undefined,x=g,L=isNaN,A=NaN,y=f.thaw,K=f.Formula,C={version:"4.x",i:0,I:D,sheetCount:0,spreadsheets:[],controls:{autoFiller:[],bar:{helper:[],corner:[],x:{controls:[],handleFreeze:[],menu:[],menuParent:[],parent:[],th:[],ths:function(){var I=d([]);for(var P in this.th[C.i]){I.pushStack(this.th[C.i][P])}return I}},y:{controls:[],handleFreeze:[],menu:[],parent:[],th:[],ths:function(){var I=d([]);for(var P in this.th[C.i]){I.pushStack(this.th[C.i][P])}return I}}},barMenuLeft:[],barMenuTop:[],barLeft:[],barTop:[],barTopParent:[],chart:[],tdMenu:[],cellsEdited:[],enclosure:[],enclosures:null,formula:null,fullScreen:null,header:null,inPlaceEdit:[],inputs:[],label:null,menuLeft:[],menuRight:[],menus:[],pane:[],panes:null,scrolls:null,sheetAdder:null,table:[],tables:null,tab:[],tabContainer:null,tabs:null,title:null,toggleHide:{x:[],y:[]},ui:null},obj:{autoFiller:function(){return C.controls.autoFiller[C.i]||d([])},barCorner:function(){return C.controls.bar.corner[C.i]||d([])},barHelper:function(){return C.controls.bar.helper[C.i]||(C.controls.bar.helper[C.i]=d([]))},barLeft:function(I){return(C.controls.bar.y.th[C.i]&&C.controls.bar.y.th[C.i][I]?C.controls.bar.y.th[C.i][I]:d([]))},barLeftControls:function(){return C.controls.bar.y.controls[C.i]||d([])},barLefts:function(){return C.controls.bar.y.ths()},barHandleFreezeLeft:function(){return C.controls.bar.y.handleFreeze[C.i]||d([])},barMenuLeft:function(){return C.controls.bar.y.menu[C.i]||d([])},barTop:function(I){return(C.controls.bar.x.th[C.i]&&C.controls.bar.x.th[C.i][I]?C.controls.bar.x.th[C.i][I]:d([]))},barTopControls:function(){return C.controls.bar.x.controls[C.i]||d([])},barTops:function(){return C.controls.bar.x.ths()},barTopParent:function(){return C.controls.bar.x.parent[C.i]||d([])},barHandleFreezeTop:function(){return C.controls.bar.x.handleFreeze[C.i]||d([])},barMenuParentTop:function(){return C.controls.bar.x.menuParent[C.i]||d([])},barMenuTop:function(){return C.controls.bar.x.menu[C.i]||d([])},tdActive:function(){return C.cellLast.td||null},tdMenu:function(){return C.controls.tdMenu[C.i]||d([])},cellsEdited:function(){return(C.controls.cellsEdited!==F?C.controls.cellsEdited:C.controls.cellsEdited=[])},chart:function(){return C.controls.chart[C.i]||d([])},enclosure:function(){return C.controls.enclosure[C.i]||d([])},enclosures:function(){return C.controls.enclosures||d([])},formula:function(){return C.controls.formula||d([])},fullScreen:function(){return C.controls.fullScreen||d([])},header:function(){return C.controls.header||d([])},highlighted:function(){return C.highlighter.last||d([])},menuRight:function(){return C.controls.menuRight[C.i]||d([])},inPlaceEdit:function(){return C.controls.inPlaceEdit[C.i]||d([])},inputs:function(){return C.controls.inputs[C.i]||d([])},label:function(){return C.controls.label||d([])},menus:function(){return C.controls.menus[C.i]||d([])},menuLeft:function(){return C.controls.menuLeft[C.i]||d([])},pane:function(){return C.controls.pane[C.i]||{}},panes:function(){return C.controls.panes||d([])},parent:function(){return G.parent},scrolls:function(){return C.controls.scrolls||d([])},sheetAdder:function(){return C.controls.sheetAdder||d([])},table:function(){return C.controls.table[C.i]||d([])},tables:function(){return C.controls.tables||d([])},tab:function(){return C.controls.tab[C.i]||d([])},tabs:function(){return C.controls.tabs||d([])},tabContainer:function(){return C.controls.tabContainer||d([])},title:function(){return C.controls.title||d([])}},id:"jS_"+D+"_",cl:{autoFiller:"jSAutoFiller",autoFillerHandle:"jSAutoFillerHandle",autoFillerCover:"jSAutoFillerCover",barCorner:"jSBarCorner",barController:"jSBarController",barControllerChild:"jSBarControllerChild",barHelper:"jSBarHelper",barLeft:"jSBarLeft",barHandleFreezeLeft:"jSBarHandleFreezeLeft",barTop:"jSBarTop",barTopMenuButton:"jSBarTopMenuButton",barHandleFreezeTop:"jSBarHandleFreezeTop",barTopParent:"jSBarTopParent",chart:"jSChart",formula:"jSFormula",formulaParent:"jSFormulaParent",header:"jSHeader",fullScreen:"jSFullScreen",inPlaceEdit:"jSInPlaceEdit",menu:"jSMenu",menuFixed:"jSMenuFixed",parent:"jSParent",scroll:"jSScroll",sheetAdder:"jSSheetAdder",table:"jS",label:"jSLoc",pane:"jSEditPane",tab:"jSTab",tabContainer:"jSTabContainer",tabContainerScrollable:"jSTabContainerScrollable",tdMenu:"jSTdMenu",title:"jSTitle",enclosure:"jSEnclosure",ui:"jSUI"},msg:{addRowMulti:"How many rows would you like to add?",addColumnMulti:"How many columns would you like to add?",cellFind:"What are you looking for in this spreadsheet?",cellNoFind:"No results found.",dragToFreezeCol:"Drag to freeze column",dragToFreezeRow:"Drag to freeze row",addSheet:"Add a spreadsheet",openSheet:"Are you sure you want to open a different sheet?  All unsaved changes will be lost.",toggleHideRow:"No row selected.",toggleHideColumn:"No column selected.",loopDetected:"Loop Detected",newSheetTitle:"What would you like the sheet's title to be?",notFoundColumn:"Column not found",notFoundRow:"Row not found",notFoundSheet:"Sheet not found",setCellRef:"Enter the name you would like to reference the cell by.",sheetTitleDefault:"Spreadsheet {index}",maxRowsBrowserLimitation:"You've reached the maximum amount of rows this browser supports. Try using Chrome, FireFox, or Internet Explorer 9+",maxColsBrowserLimitation:"You've reached the maximum amount of columns this browser supports. Try using Chrome, FireFox, or Internet Explorer 9+",maxSizeBrowserLimitationOnOpen:"The spreadsheet you are loading is larger than the maximum size of cells this browser supports. Try using Chrome, Firefox, or Internet Explorer 9+. You can an proceed, but the spreadsheet may not work as intended."},kill:function(){if(!C){return false}d(l).unbind("keydown");this.obj.fullScreen().remove();(this.obj.inPlaceEdit().destroy||B)();G.parent.trigger("sheetKill").removeClass(C.theme.parent).html("");G.parent[0].jS=F;this.obj.menus().remove();var I=d.sheet.events.length;for(var P=0;P<I;P++){G.parent.unbind(d.sheet.events[P])}d.sheet.instance.splice(D,1);return true},trigger:function(I,P){P=P||[];return G.parent.triggerHandler(I,[C].concat(P))},spreadsheetsToArray:function(I){if(I||C.spreadsheets.length==0){C.cycleCellsAll(function(Q,R,P){C.createCell(Q,R,P)})}return C.spreadsheets},spreadsheetToArray:function(P,I){I=(I?I:C.i);if(!C.spreadsheets[I]){C.cycleCells(function(R,S,Q){C.createCell(R,S,Q)})}return C.spreadsheets[I]},createCell:function(T,W,Y,ac){var Q,U,X,ad,aa,R,S,P,V,af,ae,I,ab,ag,Z;if((Q=C.spreadsheets[T])===F){Q=C.spreadsheets[T]=[]}if((U=Q[W])===F){U=Q[W]=[]}if((ad=C.controls.tables[T])===F||(S=ad.tBody)===F||(P=S.children[W])===F||(V=P.children[Y])===F){return}X=U[Y]=V.jSCell=new k.Cell(T,V,C,C.cellHandler);I=V.getAttribute("data-formula");ab=V.getAttribute("data-celltype");ag=V.getAttribute("data-uneditable");Z=V.getAttribute("id");if(I!==null){X.formula=I}if(ab!==null){X.cellType=ab}if(ag!==null){X.uneditable=ag}if(Z!==null){X.id=Z}X.value=V.textContent||V.innerText;X.calcCount=ac||0;X.needsUpdated=X.formula.length>0;if(X.formula.length>0&&X.formula.charAt(0)=="="){X.formula=X.formula.substring(1)}aa=ad.colGroup;if((R=aa.children[Y])===F){R=l.createElement("col");R.setAttribute("style","width:"+C.s.newColumnWidth+"px;");aa.appendChild(R)}C.shortenCellLookupTime(Y,X,V,R,P,S,ad);if((ae=C.controls.bar.y.th[T])===F){ae=C.controls.bar.y.th[T]=[]}if(ae[W]===F){ae[W]=d(P.children[0])}if((af=C.controls.bar.x.th[T])===F){af=C.controls.bar.x.th[T]=[]}if(af[Y]!==F){af[Y]=d(S.children[0].children[Y])}return X},shortenCellLookupTime:function(Q,T,V,P,U,I,S){var R;if((R=P.jSCells)===F){R=P.jSCells=[]}R.unshift(T);if(P.tds===F){P.tds=[]}P.tds.unshift(V);V.col=P;V.type="cell";V.barLeft=V.barLeft||U.children[0];V.barTop=V.barTop||I.children[0].children[Q];if(U.jSCells===F){U.jSCells=[]}U.jSCells.unshift(T);if(U.tds===F){U.tds=[]}U.tds.unshift(V);if(S.jSCells===F){S.jSCells=[]}S.jSCells.unshift(T);if(!S.tds){S.tds=[]}S.tds.unshift(V);V.table=S},getCell:function(Q,T,R){var P,S,I;if((P=C.spreadsheets[Q])===F||(S=P[T])===F||(I=S[R])===F){if(G.loader!==null){I=G.loader.jitCell(Q,T,R,C,C.cellHandler)}}if(I===F||I===null){return null}I.sheetIndex=Q;I.rowIndex=T;I.columnIndex=R;return I},nav:false,setNav:function(Q){var I=d.sheet.instance;for(var P=0;P<I.length;P++){(I[P]||{}).nav=false}C.nav=Q},controlFactory:{addRowMulti:function(R,U,Q,I,T){var P=(T?"row-init":"row");function S(V){if(V){if(!L(V)){C.controlFactory.addCells(R,Q,parseInt(V),P,I);C.trigger("sheetAddRow",[R,Q,V])}}}if(!U){G.prompt(C.msg.addRowMulti,S)}else{S(U)}},addColumnMulti:function(R,U,Q,I,T){var P=(T?"col-init":"col");function S(V){if(V){if(!L(V)){C.controlFactory.addCells(R,Q,parseInt(V),P,I);C.trigger("sheetAddColumn",[R,Q,V])}}}if(!U){G.prompt(C.msg.addColumnMulti,S)}else{S(U)}},rowAdder:new k.RowAdder(),columnAdder:new k.ColumnAdder(),addCells:function(aj,am,W,S,ab){C.autoFillerHide();C.setDirty(true);C.setChanged(true);C.obj.barHelper().remove();var Z=C.obj.table(),ak=Z[0],T=ak.tBody,ah=ak.colGroup,aa=false,af=C.obj.tdActive(),V=C.spreadsheets[C.i]||(C.spreadsheets[C.i]=[]),ag,U,ad=C.cl.barLeft+" "+C.theme.bar,al=C.cl.barTop+" "+C.theme.bar,X,Y=(G.loader!==null?G.loader:null),Q=(Y!==null?function(ao,an){return Y.getWidth(ao,an)}:function(){return G.newColumnWidth}),ac=(Y!==null?function(an,ao){return Y.getHeight(an,ao)}:function(){return G.colMargin}),ae=(Y!==null?Y.setupCell:null),R=C.controls.bar.x.th[C.i]||(C.controls.bar.x.th[C.i]=[]),P=C.controls.bar.y.th[C.i]||(C.controls.bar.y.th[C.i]=[]),ai=ak.size(),I=l.createDocumentFragment();W=W||1;S=S||"col";switch(S){case"row":ae=null;case"row-init":if(!aj){aj=ai.rows;aa=true}X={row:aj,col:0};ag=this.rowAdder;if(ag.setQty(W,ai)===false){if(!C.isBusy()){G.alert(C.msg.maxRowsBrowserLimitation)}return}ag.setCreateBarFn(function(an){var ao=l.createElement("tr"),ap=l.createElement("th");ap.setAttribute("class",ad);ap.entity="left";ap.type="bar";ap.style.height=ac(C.i,an)+"px";ao.appendChild(ap);I.appendChild(ao);ap.innerHTML=ao.rowIndex;P.splice(an,0,d(ap));V.splice(an,0,[]);return ao});if(ae!==null){ag.setCreateCellFn(function(ar,ap,ao){var an=ae.call(Y,C.i,ar,ap,function(at){return at.jSCell=new k.Cell(C.i,at,C,C.cellHandler)}),au=an.td,aq=V[ar];aq[ap]=an;an.updateValue();an.updateDependencies();ao.insertBefore(au,ao.children[ap]);C.shortenCellLookupTime(ap,an,au,ah.children[ap],ao,T,ak)})}else{ag.setCreateCellFn(function(ap,ao,an){var aq=l.createElement("td");an.insertBefore(aq,an.children[ao]);C.createCell(C.i,ap,ao)})}ag.setAddedFinishedFn(function(an){T.insertBefore(I,T.children[aj].nextSibling);C.refreshRowLabels(aj);U=an});break;case"col":ae=null;case"col-init":if(!aj){aj=ai.cols;aa=true}X={row:0,col:aj};ag=this.columnAdder;if(ag.setQty(W,ai)===false){if(!C.isBusy()){G.alert(C.msg.maxColsBrowserLimitation)}return}ag.setCreateBarFn(function(ap){var aq=T.children[0],ar=l.createElement("col"),au=l.createElement("th"),ao,an=T.children[1];ar.style.width=Q(C.i,ap)+"px";au.entity="top";au.type="bar";au.innerHTML=h.columnLabelString(ap);au.className=al;if(an===undefined){ao=l.createElement("th");ao.setAttribute("class",ad);ao.entity="left";ao.type="bar";an=l.createElement("tr");an.style.height=ac(C.i,ap)+"px";an.appendChild(ao);T.appendChild(an);ao.innerHTML=an.rowIndex;P.splice(0,0,d(ao))}ah.insertBefore(ar,ah.children[ap]);aq.insertBefore(au,aq.children[ap]);R.splice(ap,0,d(au));return{bar:au,col:ar,barParent:aq}});if(ae!==null){ag.setCreateCellFn(function(au,ap,aq){var ao=ae.call(Y,C.i,au,ap,function(at){return at.jSCell=new k.Cell(C.i,at,C,C.cellHandler)}),av=ao.td,an=T.children[au],ar=V[au];if(ar===undefined){V[au]=ar=[]}ar[ap]=ao;ao.updateValue();ao.updateDependencies();an.insertBefore(av,an.children[ap]);C.shortenCellLookupTime(ap,ao,av,aq.col,an,T,ak)})}else{ag.setCreateCellFn(function(au,ap,aq){var av=l.createElement("td"),ao=T.children[au],ar=V[au],an=new k.Cell(C.i,av,C,C.cellHandler);if(ar===undefined){V[au]=ar=[]}ao.insertBefore(av,ao.children[ap]);ar.splice(ap,0,an);C.shortenCellLookupTime(ap,an,av,aq.col,ao,T,ak)})}ag.setAddedFinishedFn(function(an){C.refreshColumnLabels(aj);U=an});break}ag.createCells(aj,ai,am);if(!ab&&aa!=true){C.offsetFormulas(X,U,am)}C.obj.pane().resizeScroll(true);if(af&&af[0]&&af[0].cellIndex&&af[0].parentNode){C.colLast=af[0].cellIndex;C.rowLast=af[0].parentNode.rowIndex}return true},addRow:function(P,I){C.controlFactory.addCells(P,I,1,"row");C.trigger("sheetAddRow",[P,I,1])},addColumn:function(P,I){C.controlFactory.addCells(P,I,1,"col");C.trigger("sheetAddColumn",[P,I,1])},barLeft:function(P){var Q=P.tBody.children,I=Q.length-1;if(I>0){do{Q[I].insertBefore(l.createElement("th"),Q[I].children[0])}while(I-->1)}},barTop:function(X){var P=X.colGroup,W=P.children,S,Q=X.tBody.children[0],U=l.createElement("col"),V=l.createElement("th"),T=l.createElement("tr"),R=0;if(Q===undefined){P.innerHTML=""}else{R=Q.children.length;while(W.length>R){P.removeChild(W[W.length-1])}}U.style.width=U.style.minWidth=G.colMargin+"px";P.insertBefore(U,P.children[0]);T.appendChild(V);T.className=C.cl.barTopParent;X.tBody.insertBefore(T,X.tBody.children[0]);X.barTopParent=T;X.corner=V;V.col=U;C.controls.barTopParent[C.i]=d(T);S=g.min(R,G.initCalcCols);if(S>0){do{var I=l.createElement("th");if(!W[S]){W[S]=l.createElement("col");P.insertBefore(W[S],U.nextSibling)}W[S].bar=I;I.col=W[S];T.insertBefore(I,V.nextSibling)}while(S-->1)}X.barTop=C.controls.barTopParent[C.i].children();return T},barHandleFreeze:{top:function(Q){if(C.isBusy()){return false}var I=C.obj.pane().actionUI,aa=I.frozenAt,W=I.scrolledArea;if(!(W.end.col<=(aa.col+1))){return false}C.obj.barHelper().remove();var ab=Q.table,Z=ab.tBody,R=Z.children[0],T=R.children,V=d(T[aa.col+1]),Y=V.position(),X,S=d(Q).offset(),U=l.createElement("div"),P=Q.freezeHandleTop=d(U).appendTo(Q).addClass(C.theme.barHandleFreezeTop+" "+C.cl.barHelper+" "+C.cl.barHandleFreezeTop).height(V.height()).css("left",(Y.left-U.clientWidth)+"px").attr("title",C.msg.dragToFreezeCol);C.controls.bar.helper[C.i]=C.obj.barHelper().add(U);C.controls.bar.x.handleFreeze[C.i]=P;C.draggable(P,{axis:"x",start:function(){C.setBusy(true);X=d(l.createElement("div")).appendTo(Q).css("position","absolute").addClass(C.theme.barFreezeIndicator+" "+C.cl.barHelper).height(Q.table.corner.clientHeight).fadeTo(0,0.33)},drag:function(){var ac=C.nearest(P,T).prev();if(ac.length&&ac.position){X.width(ac.position().left+ac.width())}},stop:function(ae,ac){X.remove();C.setBusy(false);C.setDirty(true);var ad=C.nearest(P,T);C.obj.barHelper().remove();W.end.col=I.frozenAt.col=C.getTdLocation(ad[0]).col-1;C.autoFillerHide();I.scrollStart("x",C.sheetSize(Q.table))},containment:[S.left,S.top,x.min(S.left+Q.table.clientWidth,S.left+Q.clientWidth-f.scrollBarSize.width),S.top]});return true},left:function(Q){if(C.isBusy()){return false}var Q=C.obj.pane(),I=Q.actionUI,Z=I.frozenAt,V=I.scrolledArea;if(!(V.end.row<=(Z.row+1))){return false}C.obj.barHelper().remove();var aa=Q.table,Y=aa.tBody,U=d(Y.children[Z.row+1].children[0]),X=U.position(),W,R=d(Q).offset(),T=l.createElement("div"),S=Y.children,P=Q.freezeHandleLeft=d(T).appendTo(Q).addClass(C.theme.barHandleFreezeLeft+" "+C.cl.barHelper+" "+C.cl.barHandleFreezeLeft).width(U.width()).css("top",(X.top-T.clientHeight+1)+"px").attr("title",C.msg.dragToFreezeRow);C.controls.bar.helper[C.i]=C.obj.barHelper().add(T);C.controls.bar.y.handleFreeze[C.i]=P;C.draggable(P,{axis:"y",start:function(){C.setBusy(true);W=d(l.createElement("div")).appendTo(Q).css("position","absolute").addClass(C.theme.barFreezeIndicator+" "+C.cl.barHelper).width(T.clientWidth).fadeTo(0,0.33)},drag:function(){var ab=C.nearest(P,S).prev();if(ab.length&&ab.position){W.height(ab.position().top+ab.height())}},stop:function(ad,ab){W.remove();C.setBusy(false);C.setDirty(true);var ac=C.nearest(P,S);C.obj.barHelper().remove();V.end.row=I.frozenAt.row=x.max(C.getTdLocation(ac.children(0)[0]).row-1,0);C.autoFillerHide();Q.actionUI.scrollStart("y",C.sheetSize(Q.table))},containment:[R.left,R.top,R.left,x.min(R.top+Q.table.clientHeight,R.top+Q.clientHeight-f.scrollBarSize.height)]});return true},corner:function(){}},menu:function(Q,I){var T,P=d([]),S=C.theme.menuHover;switch(Q){case"top":T=d(l.createElement("div")).addClass(C.theme.menu+" "+C.cl.tdMenu);C.controls.bar.x.menu[C.i]=T;break;case"left":T=d(l.createElement("div")).addClass(C.theme.menu+" "+C.cl.tdMenu);C.controls.bar.y.menu[C.i]=T;break;case"cell":T=d(l.createElement("div")).addClass(C.theme.menu+" "+C.cl.tdMenu);C.controls.tdMenu[C.i]=T;break}C.controls.menus[C.i]=C.obj.menus().add(T);T.mouseleave(function(){T.hide()}).bind("contextmenu",function(){return false}).appendTo(M).hide().disableSelectionSpecial();for(var R in I){if(I[R]){if(d.isFunction(I[R])){P.pushStack(d(l.createElement("div")).text(R).data("msg",R).click(function(){I[d(this).data("msg")].call(this,C);T.hide();return false}).appendTo(T).hover(function(){P.removeClass(S);d(this).addClass(S)},function(){d(this).removeClass(S)}))}else{if(I[R]=="line"){d(l.createElement("hr")).appendTo(T)}}}}return T},barMenu:{top:function(Q,I,P){if(C.isBusy()){return false}var S=C.obj.barMenuTop().hide();if(!S.length){S=C.controlFactory.menu("top",G.contextmenuTop)}C.obj.menus().hide();if(!P){S.css("left",(Q.pageX-5)+"px").css("top",(Q.pageY-5)+"px").show();return S}var R=C.obj.barMenuParentTop().hide();if(!R.length){R=d(l.createElement("div")).addClass(C.theme.barMenuTop+" "+C.cl.barHelper+" "+C.cl.barTopMenuButton).append(d(l.createElement("span")).addClass("ui-icon ui-icon-triangle-1-s")).mousedown(function(T){R.parent().mousedown().mouseup();var U=R.offset();S.css("left",(T.pageX-5)+"px").css("top",(T.pageY-5)+"px").show()}).blur(function(){if(S){S.hide()}});R.get(0).destroy=function(){R.remove();C.controls.bar.x.menuParent[C.i]=null};C.controls.bar.x.menuParent[C.i]=R}R.prependTo(P).show()},left:function(P,I){if(C.isBusy()){return false}C.obj.barMenuLeft().hide();if(I){C.obj.barHandleFreezeLeft().remove()}var Q;Q=C.obj.barMenuLeft();if(!Q.length){Q=C.controlFactory.menu("left",G.contextmenuLeft)}C.obj.menus().hide();Q.css("left",(P.pageX-5)+"px").css("top",(P.pageY-5)+"px").show();return true},corner:function(){}},tdMenu:function(I){if(C.isBusy()){return false}C.obj.tdMenu().hide();var P=C.obj.tdMenu();if(!P.length){P=C.controlFactory.menu("cell",G.contextmenuCell)}C.obj.menus().hide();P.css("left",(I.pageX-5)+"px").css("top",(I.pageY-5)+"px").show();return true},header:function(){C.obj.header().remove();C.obj.sheetAdder().remove();C.obj.tabContainer().remove();var W=l.createElement("div"),Q=l.createElement("table"),T=l.createElement("tr"),Z,R,aa=l.createElement("td"),ab,S,P,X,I;W.appendChild(Q);Q.appendChild(T);W.className=C.cl.header+" "+C.theme.control;C.controls.header=d(W);if(G.title){if(d.isFunction(G.title)){G.title=C.title(C,D)}aa.className=C.cl.title;C.controls.title=d(aa).html(G.title)}else{d(aa).hide()}T.appendChild(aa);function Y(ad){if(d.isFunction(ad)){ad=d(ad.call(C))}else{ad=d(ad)}if(ad.is("ul")){ad.find("ul").hide().addClass(C.theme.menuUl);ad.find("li").addClass(C.theme.menuLi).hover(function(){d(this).find("ul:first").hide().show()},function(){d(this).find("ul:first").hide()})}return ad}if(C.isSheetEditable()){if(G.menuLeft){S=l.createElement("td");S.className=C.cl.menu+" "+C.cl.menuFixed+" "+C.theme.menuFixed;T.insertBefore(S,aa);C.controls.menuLeft[C.i]=d(S).append(Y(G.menuLeft)).children().addClass(C.theme.menuFixed);C.controls.menuLeft[C.i].find("img").load(function(){C.sheetSyncSize()})}if(G.menuRight){P=l.createElement("td");P.className=C.cl.menu+" "+C.cl.menuFixed;T.appendChild(P);C.controls.menuRight[C.i]=d(P).append(Y(G.menuRight)).children().addClass(C.theme.menuFixed);C.controls.menuRight[C.i].find("img").load(function(){C.sheetSyncSize()})}ab=l.createElement("td");ab.className=C.cl.label+" "+C.theme.control;C.controls.label=d(ab);X=l.createElement("textarea");X.className=C.cl.formula+" "+C.theme.controlTextBox;X.onkeydown=C.evt.formula.keydown;X.onkeyup=function(){C.obj.inPlaceEdit().value=this.value};X.onchange=function(){C.obj.inPlaceEdit().value=this.value};X.onpaste=C.evt.pasteOverCells;X.onfocus=function(){C.setNav(false)};X.onfocusout=function(){C.setNav(true)};X.onblur=function(){C.setNav(true)};C.controls.formula=d(X);var V=l.createElement("span");V.appendChild(X);Z=l.createElement("table");R=l.createElement("tr");Z.appendChild(R);W.appendChild(Z);I=l.createElement("td");I.className=C.cl.formulaParent;I.appendChild(V);R.appendChild(ab);R.appendChild(I);R.appendChild(l.createElement("td"));C.resizableSheet(d(V),{minHeight:C.controls.formula.height(),maxHeight:78,handles:"s",resize:function(ae,ad){C.controls.formula.height(ad.size.height)},stop:function(){C.sheetSyncSize()}});var ac=d.sheet.instance;for(var U=0;U<ac.length;U++){(ac||{}).nav=false}C.setNav(true);d(l).keydown(C.evt.document.keydown)}return W},ui:function(){var I=l.createElement("div");I.setAttribute("class",C.cl.ui);C.obj.ui=I;return I},sheetAdder:function(){var I=l.createElement("span");if(C.isSheetEditable()){I.setAttribute("class",C.cl.sheetAdder+" "+C.cl.tab+" "+C.theme.tab);I.setAttribute("title",C.msg.addSheet);I.innerHTML="+";I.onmousedown=function(){C.addSheet();return false};I.i=-1}return C.controls.sheetAdder=d(I)},tabContainer:function(){var I=l.createElement("span"),P;I.setAttribute("class",C.cl.tabContainer);I.onmousedown=function(R){R=R||f.event;var Q=(R.target||R.srcElement).i;if(Q>=0){C.trigger("sheetSwitch",[Q])}return false};I.ondblclick=function(R){R=R||f.event;var Q=(R.target||R.srcElement).i;if(Q>=0){C.trigger("sheetRename",[Q])}return false};if(C.isSheetEditable()&&d.fn.sortable){return C.controls.tabContainer=d(I).sortable({placeholder:"ui-state-highlight",axis:"x",forceHelperSize:true,forcePlaceholderSize:true,opacity:0.6,start:function(R,Q){P=Q.item.index();C.trigger("sheetTabSortStart",[R,Q])},update:function(R,Q){C.trigger("sheetTabSortUpdate",[R,Q,P])}})}return C.controls.tabContainer=d(I)},sheetUI:function(Y,Z,S){C.i=S;C.tuneTableForSheetUse(Z);C.readOnly[S]=(Z.className||"").match(/\breadonly\b/i)!=null;var U=Z.tBody.children.length>0,T=C.controlFactory.enclosure(Z),R=C.s,P=R.hiddenRows[S],X=R.hiddenColumns[S],Q=T.pane,I=d(Q),V=function(ad){ad=ad||f.event;if(C.isBusy()){return false}if(C.isBar(ad.target)){var ab=ad.target.entity,ac=C.getBarIndex[ab](ad.target);if(ac<0){return false}if(C.evt.barInteraction.first==C.evt.barInteraction.last){C.controlFactory.barMenu[ab](ad,ac)}}else{C.controlFactory.tdMenu(ad)}return false};Y.appendChild(T);C.controlFactory.barTop(Z);C.controlFactory.barLeft(Z);Q.appendChild(Z);if(C.isSheetEditable()){C.controlFactory.autoFiller(Q)}if(C.isSheetEditable()){var W=C.obj.formula(),aa="";I.mousedown(function(ab){C.setNav(true);if(C.isBusy()){return false}if(C.isCell(ab.target)){if(ab.button==2){V.call(this,ab);C.evt.cellOnMouseDown(ab);return true}C.evt.cellOnMouseDown(ab);return false}if(C.isBar(ab.target)){if(ab.button==2){V.call(this,ab)}aa=ab.target.entity;C.evt.barInteraction.select(ab.target);return false}return true});Q.onmouseup=function(){aa=""};Q.onmouseover=function(af){af=af||f.event;var ae=af.target||af.srcElement;if(C.isBusy()){return false}if(!C.isBar(ae)){return false}var ad=d(ae),ab=ae.entity,ac=C.getBarIndex[ab](ae);if(ac<0){return false}if(C.evt.barInteraction.selecting&&ab==aa){C.evt.barInteraction.last=ac;C.cellSetActiveBar(ab,C.evt.barInteraction.first,C.evt.barInteraction.last)}else{C.resizeBar[ab](ad,ac,Q,Z);if(C.isSheetEditable()){C.controlFactory.barHandleFreeze[ab](Q);if(ab=="top"){C.controlFactory.barMenu[ab](af,ac,ad)}}}return true};Q.ondblclick=C.evt.cellOnDblClick;I.bind("contextmenu",V).disableSelectionSpecial().bind("cellEdit",C.evt.cellEdit)}C.createSpreadsheet(Z,S);C.checkMinSize(Z);C.controlFactory.tab();if(R.loader!==null){P=R.loader.hiddenRows(S);X=R.loader.hiddenColumns(S)}else{if(P===F||P.length>0){P=Z.getAttribute("data-hiddenrows");if(P!==null){P=c.toNumbers(P.split(","))}}if(X===F||X.length>0){X=Z.getAttribute("data-hiddencolumns");if(X!==null){X=c.toNumbers(X.split(","))}}}T.actionUI.hide(P,X);C.setChanged(true)},enclosure:function(V){var T=l.createElement("div"),S=d(T),I=new k.ActionUI(T,V,C.cl.scroll,C.s.frozenAt[C.i],d.sheet.max),U=I.scrollUI,P=I.pane,W=V.tBody.children,R=V.colGroup.children,Q=(G.loader!==null);V.size=function(){return C.tableSize(V)};P.size=function(){return C.sheetSize(V)};U.onscroll=function(){this.scrollTop=this.scrollLeft=0;if(Q){U.onscroll=function(){if(!C.isBusy()){var X=this,Z,Y;y([function(){Z=I.scrollTo({axis:"x",pixel:X.scrollLeft})},function(){Y=I.scrollTo({axis:"y",pixel:X.scrollTop})},function(){if(Z&&I.scrollAxis.x.size>=(R.length-1)){C.calcVisibleCol(I)}},function(){if(Y){if(I.scrollAxis.y.size>=(W.length-1)){C.calcVisibleRow(I)}C.updateYBarWidthToCorner(I)}},function(){if(Z&&Y){C.obj.barHelper().remove();C.autoFillerGoToTd();if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}}}])}}}else{U.onscroll=function(){if(!C.isBusy()){var X=this,Z,Y;y([function(){Z=I.scrollTo({axis:"x",pixel:X.scrollLeft})},function(){Y=I.scrollTo({axis:"y",pixel:X.scrollTop})},function(){if(Z){C.calcVisibleCol(I)}},function(){if(Y){C.calcVisibleRow(I);C.updateYBarWidthToCorner(I)}},function(){if(Z&&Y){C.obj.barHelper().remove();C.autoFillerGoToTd();if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}}}])}}}};U.onmousedown=function(){C.obj.barHelper().remove()};T.actionUI=P.actionUI=I;T.scrollUI=P.scrollUI=U;T.appendChild(U);U.scrollTop=0;U.scrollLeft=0;P.setAttribute("class",C.cl.pane+" "+C.theme.pane);T.appendChild(P);T.setAttribute("class",C.cl.enclosure);T.pane=P;T.table=V;P.table=V;P.enclosure=T;P.$enclosure=S;V.pane=P;V.enclosure=T;V.$enclosure=S;C.controls.pane[C.i]=P;C.controls.panes=C.obj.panes().add(P);C.controls.enclosure[C.i]=S;C.controls.enclosures=C.obj.enclosures().add(T);return T},tab:function(){var I=l.createElement("span"),P=C.controls.tab[C.i]=d(I).appendTo(C.obj.tabContainer());I.setAttribute("class",C.cl.tab+" "+C.theme.tab);C.sheetTab(true,function(Q){I.innerHTML=Q});I.i=C.i;C.controls.tabs=C.obj.tabs().add(P);return I},customTab:function(Q){var I=l.createElement("span"),P=d(I).appendTo(C.obj.tabContainer());I.setAttribute("class",C.cl.tab+" "+C.theme.tab);I.innerHTML=Q;return P},inPlaceEdit:function(U,P){U=U||C.obj.tdActive();if(U===null){U=C.rowTds(null,1)[1];C.cellEdit(U)}if(U===null){return}(C.obj.inPlaceEdit().destroy||B)();var T=C.obj.formula(),Q=T.val(),I,S,R=C.obj.pane();if(!U.isHighlighted){return}I=l.createElement("textarea");S=d(I);R.inPlaceEdit=I;I.i=C.i;I.className=C.cl.inPlaceEdit+" "+C.theme.inPlaceEdit;I.td=U;I.goToTd=function(){this.offset=d(U).position();if(!this.offset.left&&!this.offset.right){d(I).hide()}else{this.setAttribute("style","left:"+(this.offset.left-1)+"px;top:"+(this.offset.top-1)+"px;width:"+this.td.clientWidth+"px;height:"+this.td.clientHeight+"px;min-width:"+this.td.clientWidth+"px;min-height:"+this.td.clientHeight+"px;")}};I.goToTd();I.onkeydown=C.evt.inPlaceEdit.keydown;I.onchange=I.onkeyup=function(){T[0].value=I.value};I.onfocus=function(){C.setNav(false)};I.onblur=I.onfocusout=function(){C.setNav(true)};I.onpaste=C.evt.pasteOverCells;I.destroy=function(){R.inPlaceEdit=null;C.cellLast.isEdit=(I.value!=Q);I.parentNode.removeChild(I);C.controls.inPlaceEdit[I.i]=false};R.appendChild(I);I.onfocus();C.controls.inPlaceEdit[C.i]=I;S.focus().val("").val(T[0].value);if(P){S.select()}if(d.fn.elastic){d(I).elastic()}},autoFiller:function(R){if(!G.autoFiller){return false}var P=l.createElement("div"),I=l.createElement("div"),Q=l.createElement("div");P.i=C.i;P.className=C.cl.autoFiller+" "+C.theme.autoFiller;I.className=C.cl.autoFillerHandle;Q.className=C.cl.autoFillerCover;P.onmousedown=function(){var T=C.obj.tdActive();if(T){var S=C.getTdLocation(T);C.cellSetActive(T,S,true,C.autoFillerNotGroup,function(){var V=C.highlighted(),U=C.getTdLocation(V.last());C.fillUpOrDown(U.row<S.row||U.col<S.col);C.autoFillerGoToTd(T);C.autoFillerNotGroup=false})}return false};R.autoFiller=C.controls.autoFiller[C.i]=d(P);R.appendChild(P);return true}},autoFillerNotGroup:true,tsv:new TSV(),updateCellsAfterPasteToFormula:function(X){var W=0,V=C.obj.formula(),Z=new a();X=X||V.val();var U={row:C.cellLast.row,col:C.cellLast.col},P=V.val(),R=P;if(U.row==0&&U.col==0){return false}var aa=C.tsv.parse(P);if(!d.isArray(aa)){V.val(aa);C.fillUpOrDown(false,aa);return true}for(var T=0;T<aa.length;T++){C.cellLast.isEdit=true;var I=aa[T];for(var S=0;S<I.length;S++){W++;var Q=C.getTd(-1,T+U.row,S+U.col);Q.row=U.row;Q.col=U.col;if(Q.length){if(!C.spreadsheets[C.i]||!C.spreadsheets[C.i][T+U.row]||!C.spreadsheets[C.i][T+U.row][S+U.col]){continue}var Y=C.spreadsheets[C.i][T+U.row][S+U.col];if(Y){G.parent.one("sheetPreCalculation",function(){if((I[S]+"").charAt(0)=="="){Y.formula=I[S].substring(1);Y.value="";Q.setAttribute("data-formula",I[S])}else{Y.formula="";Y.value=I[S];Q.removeData("formula")}});C.calcDependencies.call(Y);if(T==0&&S==0){R=I[S]}}}}}if(P!=R){V.val(R)}C.fillUpOrDown(false,R);C.evt.cellEditDone(true);return true},evt:{inPlaceEdit:{enter:function(I){if(I.shiftKey){return true}return C.evt.cellSetActiveFromKeyCode(I,true)},tab:function(I){if(I.shiftKey){return true}return C.evt.cellSetActiveFromKeyCode(I,true)},keydown:function(I){I=I||f.event;C.trigger("sheetFormulaKeydown",[true]);switch(I.keyCode){case t.ENTER:return C.evt.inPlaceEdit.enter(I);break;case t.TAB:return C.evt.inPlaceEdit.tab(I);break;case t.ESCAPE:C.evt.cellEditAbandon();return false;break}}},formula:{keydown:function(I){I=I||f.event;if(C.readOnly[C.i]){return false}if(C.cellLast.row<0||C.cellLast.col<0){return false}C.trigger("sheetFormulaKeydown",[false]);switch(I.keyCode){case t.C:if(I.ctrlKey){return C.evt.document.copy(I)}case t.X:if(I.ctrlKey){return C.evt.document.cut(I)}case t.Y:if(I.ctrlKey){C.evt.document.redo(I);return false}break;case t.Z:if(I.ctrlKey){C.evt.document.undo(I);return false}break;case t.ESCAPE:C.evt.cellEditAbandon();return true;break;case t.ENTER:C.evt.cellSetActiveFromKeyCode(I,true);return false;break;case t.UNKNOWN:return false}C.cellLast.isEdit=true},If:function(P,I){if(P){C.obj.tdActive().dblclick();return true}return false}},document:{enter:function(I){if(!C.cellLast.isEdit&&!I.ctrlKey){C.obj.tdActive().dblclick()}return false},tab:function(I){C.evt.cellSetActiveFromKeyCode(I)},findCell:function(I){if(I.ctrlKey){C.cellFind();return false}return true},redo:function(I){if(I.ctrlKey&&!C.cellLast.isEdit){C.undo.manager.redo();return false}return true},undo:function(I){if(I.ctrlKey&&!C.cellLast.isEdit){C.undo.manager.undo();return false}return true},copy:function(S,P){var R=C.highlighted(true),T=C.obj.formula(),Q=T.val(),I=C.toTsv(R,P);T.val(I).focus().select();O.one("keyup",function(){if(P){T.val("")}else{T.val(Q)}});return true},cut:function(I){return this.copy(I,true)},pageUpDown:function(I){var R=C.sheetSize(),V=C.obj.pane(),Q=V.clientHeight,S=0,T=0,U,P;if(I){for(P=C.cellLast.row;P>0&&S<Q;P--){U=C.getTd(-1,P,1);if(!U.getAttribute("data-hidden")&&U.is(":hidden")){U.show()}S+=U.parent().height()}}else{for(P=C.cellLast.row;P<R.rows&&S<Q;P++){U=C.getTd(-1,P,1);S+=U.parent().height()}}C.cellEdit(U);return false},keydown:function(I){I=I||f.event;if(C.readOnly[C.i]){return false}if(C.cellLast.row<0||C.cellLast.col<0){return false}var P=C.cellLast.td;if(C.nav){switch(I.keyCode){case t.DELETE:C.toTsv(null,true);C.obj.formula().val("");break;case t.TAB:C.evt.document.tab(I);break;case t.ENTER:C.evt.cellSetActiveFromKeyCode(I);break;case t.LEFT:case t.UP:case t.RIGHT:case t.DOWN:(I.shiftKey?C.evt.cellSetHighlightFromKeyCode(I):C.evt.cellSetActiveFromKeyCode(I));break;case t.PAGE_UP:C.evt.document.pageUpDown(true);break;case t.PAGE_DOWN:C.evt.document.pageUpDown();break;case t.HOME:case t.END:C.evt.cellSetActiveFromKeyCode(I);break;case t.V:if(I.ctrlKey){return C.evt.formula.If(!C.evt.pasteOverCells(I),I)}else{d(P).trigger("cellEdit");return true}break;case t.Y:if(I.ctrlKey){C.evt.document.redo(I);return false}else{d(P).trigger("cellEdit");return true}break;case t.Z:if(I.ctrlKey){C.evt.document.undo(I);return false}else{d(P).trigger("cellEdit");return true}break;case t.ESCAPE:C.evt.cellEditAbandon();break;case t.F:if(I.ctrlKey){return C.evt.formula.If(C.evt.document.findCell(I),I)}else{d(P).trigger("cellEdit");return true}break;case t.CAPS_LOCK:case t.SHIFT:case t.ALT:break;case t.CONTROL:C.obj.formula().focus().select();return true;break;default:d(P).trigger("cellEdit");return true;break}return false}}},pasteOverCells:function(P){P=P||f.event;if(P.ctrlKey||P.type=="paste"){var I=function(){C.updateCellsAfterPasteToFormula()};var Q=O.one("keyup",function(){I();I=function(){};Q.mouseup()}).one("mouseup",function(){I();I=function(){};Q.keyup()});C.setDirty(true);C.setChanged(true);return true}return false},cellEditDone:function(R){(C.obj.inPlaceEdit().destroy||B)();if(C.cellLast.isEdit||R){var T=C.obj.formula(),S=C.obj.tdActive();if(C.isFormulaEditable(S)){if(S&&C.cellLast.row>0&&C.cellLast.col>0){var P=T.val(),I=S.jSCell,Q=0;if(!I.edited){I.edited=true;C.obj.cellsEdited().push(I)}G.parent.one("sheetPreCalculation",function(){if(P.charAt(0)=="="){S.setAttribute("data-formula",P);I.formula=P}else{S.removeAttribute("data-formula");I.value=P;I.formula=""}I.setNeedsUpdated()});C.calcDependencies.call(I);C.cellLast.isEdit=false;C.trigger("sheetCellEdited",[I])}}}},cellEditAbandon:function(I){(C.obj.inPlaceEdit().destroy||B)();C.highlighter.clearBar().clear();if(!I){C.calc()}C.cellLast.td=null;C.cellLast.row=0;C.cellLast.col=0;C.rowLast=0;C.colLast=0;C.highlighter.start={row:0,col:0};C.highlighter.end={row:0,col:0};C.labelUpdate("",true);C.obj.formula().val("").blur();C.autoFillerHide();return false},cellSetHighlightFromKeyCode:function(S){var R=C.highlightedLastOrdered(),Q=C.sheetSize(),V=C.obj.tdActive(),T=C.getTdLocation(V),U=R.start,I=R.end,P=C.highlighter;switch(S.keyCode){case t.UP:if(U.row<T.row){U.row--;U.row=x.max(U.row,1);break}I.row--;I.row=x.max(I.row,1);break;case t.DOWN:if(U.row===U.end){U.row++;U.row=x.min(U.row,Q.rows);break}if(U.row<T.row){U.row++;U.row=x.max(U.row,1);break}I.row++;I.row=x.min(I.row,Q.rows);break;case t.LEFT:if(U.col<T.col){U.col--;U.col=x.max(U.col,1);break}I.col--;I.col=x.max(I.col,1);break;case t.RIGHT:if(U.col<T.col){U.col++;U.col=x.min(U.col,Q.cols);break}I.col++;I.col=x.min(I.col,Q.cols);break}C.highlighter.start=U;C.highlighter.end=I;C.cycleCellArea(function(W){P.set(W.td)},U,I);return false},cellSetActiveFromKeyCode:function(S,I){var T={row:C.cellLast.row,col:C.cellLast.col},R=false,Q,P=false;switch(S.keyCode){case t.UP:T.row--;break;case t.DOWN:T.row++;break;case t.LEFT:T.col--;break;case t.RIGHT:T.col++;break;case t.ENTER:T=C.evt.incrementAndStayInGrid(C.highlightedLastOrdered(),T,"row","col",S.shiftKey);R=true;Q=C.highlighted();if(Q.length>1){P=true}else{if(!I){T.row+=(S.shiftKey?-1:1)}if(G.autoAddCells&&T.row>C.sheetSize().rows){C.controlFactory.addRow()}}break;case t.TAB:T=C.evt.incrementAndStayInGrid(C.highlightedLastOrdered(),T,"col","row",S.shiftKey);R=true;Q=C.highlighted();if(Q.length>1){P=true}else{if(!I){T.col+=(S.shiftKey?-1:1)}if(G.autoAddCells&&T.col>C.sheetSize().cols){C.controlFactory.addColumn()}}break;case t.HOME:T.col=1;break;case t.END:T.col=C.obj.tdActive().parent().children("td").length-1;break}T.col=T.col||1;T.row=T.row||1;if(!C.cellLast.isEdit||R){var U=C.getTd(-1,T.row,T.col);if(U){C.cellEdit(U,null,P);return false}}return true},incrementAndStayInGrid:function(R,S,P,I,Q){if(Q){S[P]--;if(S[P]<R.start[P]){S[P]=R.end[P];S[I]--}if(S[I]<R.start[I]){S[I]=R.end[I]}}else{S[P]++;if(S[P]>R.end[P]){S[P]=R.start[P];S[I]++}if(S[I]>R.end[I]){S[I]=R.start[I]}}return S},cellOnMouseDown:function(I){C.obj.formula().blur();if(I.shiftKey){C.getTdRange(I,C.obj.formula().val())}else{C.cellEdit(I.target,true)}},cellOnDblClick:function(I){if(C.isBusy()){return false}C.controlFactory.inPlaceEdit();return true},cellEdit:function(I){if(C.isBusy()){return false}C.controlFactory.inPlaceEdit(null,true);return true},barInteraction:{first:0,last:0,selecting:false,select:function(Q){if(!Q){return}if(!Q.type=="bar"){return}var I=Q.entity,P=C.getBarIndex[I](Q);if(P<0){return false}C[I+"Last"]=P;C.evt.barInteraction.last=C.evt.barInteraction.first=P;C.cellSetActiveBar(I,C.evt.barInteraction.first,C.evt.barInteraction.last);C.evt.barInteraction.first=C.evt.barInteraction.last=C[I+"Last"]=P;C.evt.barInteraction.selecting=true;O.one("mouseup",function(){C.evt.barInteraction.selecting=false});return false}}},refreshColumnLabels:function(T){T=T||0;var P=C.obj.barMenuParentTop();if((P)&&(P.length)){var S=P.get(0);if(d.isFunction(S.destroy)){S.destroy()}}var I=C.controls.bar.x.th[C.i],R;if(!I){return}for(var Q=g.max(T,0);Q<I.length;Q++){if(Q>0){R=I[Q];R.text(h.columnLabelString(R[0].cellIndex))}}},refreshRowLabels:function(S,I){S=S||0;var P=C.controls.bar.y.th[C.i],R;if(!P){return}I=I||P.length;for(var Q=S;Q<I;Q++){if(Q>0){R=P[Q];R.text(R[0].parentNode.rowIndex)}}},isCell:function(I){if(I&&I.tagName&&I.tagName=="TD"&&I.type&&I.type=="cell"){return true}return false},isBar:function(I){if(I&&I.tagName&&I.tagName=="TH"&&I.type&&I.type=="bar"){return true}return false},readOnly:[],isSheetEditable:function(I){I=I||C.i;return(G.editable==true&&!C.readOnly[I])},isFormulaEditable:function(I){if(G.lockFormulas){if(I.data("formula")!==F){return false}}return true},toggleFullScreen:function(){if(!C){return}C.evt.cellEditDone();var Q=C.obj.fullScreen(),T=C.obj.pane();if(Q.is(":visible")){H.unbind("jSResize");M.removeClass("bodyNoScroll");G.parent=Q[0].origParent;G.parent.prepend(Q.children());Q.remove();C.sheetSyncSize();T.resizeScroll();C.trigger("sheetFullScreen",[false])}else{M.addClass("bodyNoScroll");var R=d(G.parent),Q=l.createElement("div"),P=d._data(G.parent[0],"events");Q.className=C.cl.fullScreen+" "+C.theme.fullScreen+" "+C.cl.parent;Q.origParent=R;G.parent=C.controls.fullScreen=d(Q).append(R.children()).appendTo(M);H.bind("resize",function(){H.trigger("jSResize")}).bind("jSResize",function(){this.w=H.width();this.h=H.height();G.parent.width(this.w).height(this.h);C.sheetSyncSize();T.resizeScroll()}).trigger("jSResize");R.trigger("sheetFullScreen",[true]);for(var S in P){for(var I=0;I<P[S].length;I++){G.parent.bind(S,P[S][I].handler)}}}},renameSheet:function(I){if(L(I)){return false}if(I>-1){C.sheetTab()}return true},switchSheet:function(I){if(L(I)){return false}if(I==-1){C.addSheet()}else{if(I!=C.i){C.setActiveSheet(I);if(G.loader===null){C.calc(I)}}}return true},tuneTableForSheetUse:function(Q){var P=d(Q);C.controls.table[C.i]=P.addClass(C.cl.table).addClass(C.theme.table).attr("id",C.id+C.i).attr("border","1px").attr("cellpadding","0").attr("cellspacing","0");Q.spreadsheetIndex=C.i;C.formatTable(Q);C.sheetDecorateRemove(false,P);C.controls.tables=C.obj.tables().add(Q);var R=P.attr("data-frozenatrow")*1,I=P.attr("data-frozenatcol")*1;if(!C.s.frozenAt[C.i]){C.s.frozenAt[C.i]={row:0,col:0}}if(R){C.s.frozenAt[C.i].row=R}if(I){C.s.frozenAt[C.i].col=I}},createSpreadsheet:function(P,I){this.createSpreadsheetForArea(P,I)},createSpreadsheetForArea:function(Z,U,S,W,T,aa,V){var ac=C.rows(Z),ab,P,Y=(G.loader!==null?G.loader:null),I=G.colMargin+"px",R=(Y!==null?Y.setRowHeight:function(ae,ai,ah){var ag,af,ad=I;if((ag=ah.nextSibling)===undefined){return ad}if((af=ag.style)===undefined){return ad}if(af.height!==undefined){ad=af.height}ah.style.height=ad});S=S||0;W=W||ac.length-1;T=T||0;aa=aa||ac[0].children.length-1;if(S===0&&T===0){Z.spreadsheet=C.spreadsheets[U]=[]}ab=W;if(ab<0||P<0){return}do{var X=ac[ab];P=aa;if(X===undefined){if(V){C.controlFactory.addCells(null,false,ab-(ac.length-1),"row-init");X=ac[ab]}else{continue}}do{var Q=X.children[P];if(Q===undefined){if(V){C.controlFactory.addCells(null,false,P-(ac[0].children.length-1),"col-init");Q=X.children[P]}else{continue}}if(ab>0&&P>0){if(!Q.jSCell){C.createCell(U,ab,P)}}else{if(P==0&&ab>0){Q.type="bar";Q.entity="left";Q.innerHTML=ab;Q.className=C.cl.barLeft+" "+C.cl.barLeft+"_"+C.i+" "+C.theme.bar;R.call(Y,U,ab,Q)}if(ab==0&&P>0){Q.type="bar";Q.entity="top";Q.innerHTML=h.columnLabelString(P);Q.className=C.cl.barTop+" "+C.cl.barTop+"_"+C.i+" "+C.theme.bar}if(ab==0&&P==0){Q.type="bar";Q.entity="corner";Q.className=C.theme.bar+"  "+C.cl.barCorner;C.controls.bar.corner[C.i]=Q}}}while(P-->T)}while(ab-->S)},updateYBarWidthToCorner:function(I){var R=I.scrolledArea,W=I.table,T=W.tBody,U=W.corner,Q=g.min(G.initCalcRows+R.end.row,R.end.row+20,T.lastChild.rowIndex),S=T.children[Q],P,V;if(S===F){return}P=S.children[0];V=(P.innerText!==F?P.innerText:P.textContent);U.col.style.width=(f.defaultCharSize.width*V.length)+"px"},toggleHideRow:function(I){I=I||C.rowLast;if(!I){return}var P=C.obj.pane().actionUI;P.toggleHideRow(I);C.autoFillerGoToTd()},toggleHideRowRange:function(Q,P){var I=C.obj.pane().actionUI;I.toggleHideRowRange(Q,P);C.autoFillerGoToTd()},toggleHideColumn:function(I){I=I||C.colLast;if(!I){return}var P=C.obj.pane().actionUI;P.toggleHideColumn(I);C.autoFillerGoToTd()},toggleHideColumnRange:function(Q,P){var I=C.obj.pane().actionUI;I.toggleHideColumnRange(Q,P);C.autoFillerGoToTd()},rowShowAll:function(){C.obj.pane().actionUI.rowShowAll()},columnShowAll:function(){C.obj.pane().actionUI.columnShowAll()},merge:function(U){U=U||C.highlighted();if(!U.length){return}var S=[],I=U[0],R=U[U.length-1],Z=C.getTdLocation(I),P=C.getTdLocation(R),ab={},X={},W=0,Y=0,T=U.length-1,aa,ac,Q,V;if(Z.row){C.setDirty(true);C.setChanged(true);if(Z.row<P.row){ab.row=Z.row;X.row=P.row;Q=I}else{ab.row=P.row;X.row=Z.row;Q=R}if(Q.getAttribute("rowSpan")||Q.getAttribute("colSpan")){return false}if(Z.col<P.col){ab.col=Z.col;X.col=P.col}else{ab.col=P.col;X.col=Z.col}Y=(X.row-ab.row)+1;W=(X.col-ab.col)+1;V=C.getTdLocation(Q);do{ac=U[T];aa=ac.jSCell;if(aa.formula||aa.value){S.unshift(aa.formula?"("+aa.formula.substring(1)+")":aa.value)}G.parent.one("sheetPreCalculation",function(){if(ac.cellIndex!=V.col||ac.parentNode.rowIndex!=V.row){aa.formula=null;aa.value="";aa.defer=Q.jSCell;ac.removeAttribute("data-formula");ac.removeAttribute("data-celltype");ac.innerHTML="";ac.style.display="none";ac.colSpan=W-(ac.cellIndex-Q.cellIndex);ac.rowSpan=Y-(ac.parentNode.rowIndex-Q.parentNode.rowIndex)}});C.calcDependencies.call(aa)}while(T--);Q.jSCell.value=S.join(" ");Q.jSCell.formula=(Q.jSCell.formula?S.join(" "):"");Q.style.display="";Q.setAttribute("rowSpan",Y);Q.setAttribute("colSpan",W);C.calcDependencies.call(Q.jSCell);C.evt.cellEditDone();C.autoFillerGoToTd(Q);C.cellSetActive(Q,V)}return true},unmerge:function(P){P=P||C.highlighted();if(!P){return}var T=C.getTdLocation(P),U=new a(),W=x.max(P.getAttribute("rowSpan")*1,1)-1,I=x.max(P.getAttribute("colSpan")*1,1)-1,S=W+T.row,Q,V,R=[];if(W==0&&I==0){return false}do{Q=T.col+I;do{V=C.getTd(-1,S,Q);V.style.display="";V.removeAttribute("colSpan");V.removeAttribute("rowSpan");delete V.jSCell.defer;C.calcDependencies.call(V.jSCell,U);R.push(V)}while(Q-->T.col)}while(S-->T.row);C.evt.cellEditDone();C.autoFillerGoToTd(P);C.cellSetActive(P,T);C.highlighter.set(d(R));return true},fillUpOrDown:function(V,W,Y){C.evt.cellEditDone();Y=Y||C.highlighted(true);if(Y.length<1){return false}var S=C.obj.tdActive();if(Y.length<1){return false}var T=C.getTdLocation(Y[0].td),Z=C.getTdLocation(Y[Y.length-1].td),I=C.getTdLocation(S),Q={row:0,col:0},P=W||S.jSCell.value,X=false,R=Y.length-1,U=function(){};W=W||S.jSCell.value;if(R>=0){if(W.charAt&&W.charAt(0)=="="){if(R>=0){do{if(!V){Q.row=I.row-Z.row;Q.col=I.col-Z.col}else{Q.row=I.row-T.row;Q.col=I.col-T.col}P=C.reparseFormula(W,Q);G.parent.one("sheetPreCalculation",function(){Y[R].formula=P;Y[R].value="";Y[R].td.setAttribute("data-formula",P)});C.calcDependencies.call(Y[R])}while(R--);return true}}else{if((X=!L(P))||P.length>0){if(X&&P!=""){P*=1;if(V){P-=Y.length-1}U=function(){P++}}}do{G.parent.one("sheetPreCalculation",function(){Y[R].formula="";Y[R].value=P+"";Y[R].td.removeAttribute("data-formula")});C.calcDependencies.call(Y[R]);U()}while(R--);return true}}return false},toTsv:function(Y,R,W){Y=Y||C.highlighted(true);if(Y.type){Y=[Y]}W=W||function(ab,aa){if(R){G.parent.one("sheetPreCalculation",function(){aa.formula="";aa.value=""});C.calcDependencies.call(aa)}};var U=[],X,T,P={},Q=Y.length-1,Z,I;if(Q>=0){X=C.getTdLocation(Y[0].td);T=C.getTdLocation(Y[Y.length-1].td);P.row=x.min(X.row,T.row);P.col=x.min(X.col,T.col);do{var S=C.getTdLocation(Y[Q].td),V=(Y[Q].formula?"="+Y[Q].formula:Y[Q].value);Z=x.abs(S.row-P.row);I=x.abs(S.col-P.col);if(!U[Z]){U[Z]=[]}if((V+="").match(/\n/)){V='"'+V+'"'}U[Z][I]=(V||"");W.call(Y[Q].td,S,Y[Q])}while(Q-->0);Q=U.length-1;do{U[Q]=U[Q].join("\t")}while(Q-->0);return U.join("\n")}return""},offsetFormulas:function(U,T,Q,S){var P=C.sheetSize(),R={first:{row:1,col:1},last:{row:P.rows,col:P.cols}},I=[];C.cycleCells(function(){var V=this;if(this.formula&&typeof this.formula=="string"&&C.isFormulaEditable(this.td)){this.formula=C.reparseFormula(this.formula,T,U,Q,S);this.td.setAttribute("data-formula","="+this.formula)}I.push(function(){C.calcDependencies.call(V,true)})},R.first,R.last);while(I.length){I.pop()()}C.evt.cellEditDone()},reparseFormula:function(S,R,Q,I,P){return S.replace(h.regEx.cell,function(U,V,Z,aa){if(V=="SHEET"){return U}R=R||{loc:0,row:0};var T={row:Z*1,col:h.columnLabelIndex(V)},Y,X,W={row:Z,col:V,use:false};if(Q){if(P){if(I){if(T.col&&T.col==Q.col-1){W.col="#REF!";W.use=true}if(T.row&&T.row==Q.row-1){W.row="#REF!";W.use=true}if(T.col>=Q.col){Y=true}if(T.row>=Q.row){X=true}}else{if(Q.col&&T.col==Q.col){W.col="#REF!";W.use=true}if(Q.row&&T.row==Q.row){W.row="#REF!";W.use=true}if(Q.col&&T.col>Q.col){Y=true}if(Q.row&&T.row>Q.row){X=true}}if(W.use){return W.col+W.row}if(Y){T.col+=R.col;return C.makeFormula(T)}if(X){T.row+=R.row;return C.makeFormula(T)}}else{if(I){if(Q.col&&T.col>=Q.col){Y=true}if(Q.row&&T.row>=Q.row){X=true}}else{if(Q.col&&T.col>Q.col){Y=true}if(Q.row&&T.row>Q.row){X=true}}if(Y){T.col+=R.col;return C.makeFormula(T)}if(X){T.row+=R.row;return C.makeFormula(T)}}}else{return C.makeFormula(T,R)}return U})},makeFormula:function(P,I){I=d.extend({row:0,col:0},I);P.col+=I.col;P.row+=I.row;if(P.col<0){P.col=0}if(P.row<0){P.row=0}return h.parseCellName(P.col,P.row)},cycleCells:function(S,V,Q,P){P=P||C.i;V=V||{row:1,col:1};if(!Q){var X=C.sheetSize();Q={row:X.rows,col:X.cols}}var I=C.spreadsheets[P],R=Q.row,U,W,T;if(R<V.row){return}do{U=Q.col;W=I[R];do{T=W[U];S.call(T,P,R,U)}while(U-->V.col)}while(R-->V.row)},cycleCellsAll:function(R){var S=C.i,Q,P,I;for(Q=0;Q<=C.sheetCount;Q++){C.i=Q;P=C.sheetSize();I={row:P.rows,col:P.cols};C.cycleCells(R,{row:0,col:0},I,Q)}C.i=S},cycleCellArea:function(W,aa,T,S,X){var I={start:{},end:{}},V,Z,ab,Y,R=C.i,P={cell:[],td:[]},U=C.spreadsheets[R],Q=(X?"unshift":"push");if(S){I.start=aa;I.end=T}else{I.start.row=x.max(x.min(aa.row,T.row),1);I.start.col=x.max(x.min(aa.col,T.col),1);I.end.row=x.max(aa.row,T.row,1);I.end.col=x.max(aa.col,T.col,1)}V=I.end.row;do{Z=I.end.col;ab=U[V]||null;do{if(ab){Y=ab[Z]||null;if(Y){P.cell[Q](Y);P.td[Q](Y.td)}}}while(Z-->I.start.col)}while(V-->I.start.row);if(W){W(P)}},formatTable:function(ab){var Z=G.newColumnWidth+"px",U=G.colMargin+"px",P=ab.children,S=P.length-1,R,Q,X,I,V,aa,T,Y=(G.loader!==null?G.loader:null),W=(Y!==null?Y.getWidth:function(ac,ad){return G.newColumnWidth});if(S>-1){do{switch(P[S].nodeName){case"TBODY":aa=true;X=P[S];break;case"COLGROUP":T=true;I=P[S];break}}while(S--)}else{}if(!X){X=l.createElement("tbody");if(P.length>0){do{X.appendChild(P[0])}while(P.length)}}if(!I||I.children.length<1){I=l.createElement("colgroup");ab.appendChild(I);ab.appendChild(X);if(X.children.length>0){V=X.children[0];for(S=0,R=g.min(V.children.length,G.initCalcCols);S<R;S++){Q=l.createElement("col");Q.style.width=W(C.i,S)+"px";I.appendChild(Q)}for(S=0,R=g.min(X.children.length,G.initCalcRows);S<R;S++){X.children[S].style.height=U}}}ab.tBody=X;ab.colGroup=I;ab.removeAttribute("width");ab.style.width=""},checkMinSize:function(S){var Q=C.tableSize(S),T=G.minSize.rows||0,I=G.minSize.cols||0,R=C.obj.pane().actionUI,P=R.frozenAt;T=g.max((P.row>T?P.row+1:T),1,G.initScrollRows);I=g.max((P.col>I?P.col+1:I),1,G.initScrollCols);if(Q.cols<I){I-=Q.cols;C.controlFactory.addColumnMulti(null,I,false,true,true)}Q=C.tableSize(S);if(Q.rows<T){T-=Q.rows;C.controlFactory.addRowMulti(null,T,false,true,true)}},theme:null,highlighter:null,resizable:function(P,I){if(!P.data("resizable")){P.resizable(I)}},busy:[],setBusy:function(I){if(I){C.busy.push(I)}else{C.busy.pop()}},isBusy:function(){return(C.busy.length>0)},draggable:function(P,I){if(!P.data("jSdraggable")){P.data("jSdraggable",true).draggable(I)}},nearest:function(P,I){return d(P).nearest(I)},resizeBar:{top:function(T,Q,V,P){C.obj.barTopControls().remove();var R=l.createElement("div"),U=d(R).addClass(C.cl.barController+" "+C.theme.barResizer).width(T.width()).prependTo(T),I,S;C.controls.bar.x.controls[C.i]=C.obj.barTopControls().add(U);C.resizableCells(U,{handles:"e",start:function(X,W){C.autoFillerHide();C.setBusy(true);I=C.col(P,Q);if(V.freezeHandleTop){V.freezeHandleTop.remove()}I.removeAttribute("width")},resize:function(X,W){I.style.width=W.size.width+"px";if(V.inPlaceEdit){V.inPlaceEdit.goToTd()}},stop:function(X,W){C.setBusy(false);V.resizeScroll();C.followMe();C.setDirty(true)},minWidth:32});S=R.children[0];S.style.height=T.outerHeight()+"px";S.style.position="absolute"},left:function(R,U,Q,Y){C.obj.barLeftControls().remove();var T=R.offset(),Z=l.createElement("div"),W=d(Z).addClass(C.cl.barController+" "+C.theme.barResizer).prependTo(R).offset({top:T.top,left:T.left}),X=R[0],S=R.next()[0],aa=S.parentNode,P=l.createElement("div"),I=d(P).addClass(C.cl.barControllerChild).height(R.height()).prependTo(W),V;C.controls.bar.y.controls[C.i]=C.obj.barLeftControls().add(W);C.resizableCells(I,{handles:"s",start:function(){C.autoFillerHide();C.setBusy(true);if(Q.freezeHandleLeft){Q.freezeHandleLeft.remove()}aa.removeAttribute("height");X.removeAttribute("height");S.removeAttribute("height")},resize:function(ac,ab){Z.style.height=S.style.height=X.style.height=aa.style.height=ab.size.height+"px";if(Q.inPlaceEdit){Q.inPlaceEdit.goToTd()}},stop:function(ac,ab){C.setBusy(false);Q.resizeScroll();C.followMe();C.setDirty(true)},minHeight:15});V=P.children[0];V.style.width=R.outerWidth()+"px";V.style.position="absolute"},corner:function(){}},sheetDecorateRemove:function(P,I){I=I||C.obj.tables();I=(P?I.clone():I);I.find("td."+C.theme.tdActive).removeClass(C.theme.tdActive);I.find("td."+C.theme.tdHighlighted).removeClass(C.theme.tdHighlighted);return I},labelUpdate:function(P,I){if(!I){P=h.parseCellName(P.col,P.row);if(P){C.obj.label().text(P)}}else{C.obj.label().text(P)}},cellEdit:function(T,R,Q){C.autoFillerNotGroup=true;C.evt.cellEditDone();if(T===null){return}var S=C.getTdLocation(T),I=T.jSCell,P;if(I===F||I===null){return}if(I.uneditable){return}C.trigger("sheetCellEdit",[I]);if(T!==C.cellLast.td){C.followMe(T)}else{C.autoFillerGoToTd(T)}C.labelUpdate(S);if(I.formula.length>0){P="="+I.formula}else{P=I.value}C.obj.formula().val(P).blur();C.cellSetActive(T,S,R,false,null,Q)},cellSetActive:function(S,U,P,W,T,Q){U=U||C.getTdLocation(S);if(U.col!=F){C.cellLast.td=S;C.cellLast.row=C.rowLast=U.row;C.cellLast.col=C.colLast=U.col;if(!Q){C.highlighter.set(S).setStart(U).setEnd(U)}if(S===null){return}C.highlighter.setBar("left",S.barLeft).setBar("top",S.barTop);var V,X;switch(G.cellSelectModel){case k.excelSelectModel:case k.googleDriveSelectModel:V=function(){};X=function(){};break;case k.openOfficeSelectModel:V=function(Y){if(C.isCell(Y)){C.cellEdit(Y)}};X=function(){};break}if(P){var I={},R=C.obj.pane();I.last=U;R.onmousemove=function(ag){ag=ag||f.event;var ah=ag.target||ag.srcElement;if(C.isBusy()){return false}var Y=C.highlighter.end=C.getTdLocation(ah),ai=true,aj=C.highlighter;if(Y.col<1||Y.row<1||Y.col==A||Y.row==A){return false}if(W){ai=false;if(U.col==Y.col||U.row==Y.row){ai=true}}if((I.last.col!=Y.col||I.last.row!=Y.row)&&ai){V(ah);C.cycleCellArea(function(al){aj.set(al.td)},U,Y,false,true)}C.followMe(d(ah));var ab=ag.clientY,ac=ag.clientX,ad=R.$enclosure.offset(),ak=C.getTdLocation(ah),ae=ak.row,aa=ak.col,Z=false,af;if(L(ae)||L(aa)){return false}if(ab>ad.top){Z=true;ae--}if(ac>ad.left){Z=true;aa--}if(Z){if(ae<1||aa<1){return false}af=C.spreadsheets[C.i][ae][aa];C.followMe(d(af.td),true)}I.last=Y;return true};l.onmouseup=function(){R.onmousemove=null;R.onmousemove=null;R.onmouseup=null;l.onmouseup=null;if(T){T()}}}}},colLast:0,rowLast:0,cellLast:{td:[],row:0,col:0,isEdit:false},highlightedLastOrdered:function(){var P=this.highlighter,I={start:{},end:{}};I.start.row=g.min(P.start.row,P.end.row);I.start.col=g.min(P.start.col,P.end.col);I.end.row=g.max(P.start.row,P.end.row);I.end.col=g.max(P.start.col,P.end.col);return I},cellStyleToggle:function(U,T,R){R=R||C.highlighted();if(R.length<1){return false}C.setDirty(true);var V,S,Q=R.length-1,I=C.obj.cellsEdited(),P;if(Q>=0){P=R[0].className.match(U);do{V=R[Q];S=d(V);if(T){S.removeClass(T)}if(P){S.removeClass(U)}else{S.addClass(U)}if(!V.jSCell.edited){V.jSCell.edited=true;I.push(V.jSCell)}}while(Q--);return true}return false},cellTypeToggle:function(S,Q){Q=Q||C.highlighted(true);if(Q.length<1){return}var R=Q.length-1,P=Q[R].cellType==S,I;if(R>=0){do{I=Q[R];if(P){I.cellType=null}else{I.cellType=S}I.updateValue();I.updateDependencies()}while(R--)}},fontReSize:function(T,S){S=S||C.highlighted();if(S.length<1){return false}var P=0;switch(T){case"up":P=1;break;case"down":P=-1;break}var V,U,R=S.length-1,Q,I=C.obj.cellsEdited();if(R>=0){do{V=S[R];U=d(V);Q=(U.css("font-size")+"").replace("px","")*1;U.css("font-size",((Q||10)+P)+"px");if(!V.jSCell.edited){V.jSCell.edited=true;I.push(V.jSCell)}}while(R--);return true}return false},cellHandler:null,calc:function(I,Q){I=I||C.i;if(C.readOnly[I]||C.isChanged(I)===false&&!Q||!C.formulaParser){return false}if(G.loader!==null){G.loader.cycleCells(I)}else{var P=C.spreadsheetToArray(null,I);h.calc(I,P);C.trigger("sheetCalculation",[{which:"spreadsheet",sheet:P,index:I}])}C.setChanged(false);return true},calcAll:function(Q){var P=0,I;if(G.loader){I=G.loader.count;for(;P<I;P++){C.calc(P,Q)}}else{I=C.spreadsheets.length;for(;P<I;P++){C.calc(P,Q)}}},calcVisiblePos:{row:-1,col:-1},calcVisibleInit:function(W){W=W||C.i;var P=C.spreadsheetToArray(null,W)||[],Q=g.min,R=G.initCalcRows,I=G.initCalcCols,V=Q(P.length-1,R),X,S,U={row:-1,col:-1},T=[];if(V>0){U.row=V;do{if(V>0&&(X=P[V])!==undefined){U.col=S=Q(X.length-1,I);if(S>0){do{T.push({cell:X[S],rowIndex:V,columnIndex:S,make:function(){this.cell.rowIndex=this.rowIndex;this.cell.columnIndex=this.columnIndex;this.cell.updateValue()}})}while(S-->1)}}}while(V-->1)}y(T,{each:function(){this.make()},done:function(){C.trigger("sheetCalculation",[{which:"spreadsheet",sheet:P,index:W}])}});this.calcVisiblePos=U;C.setChanged(false)},calcVisibleRow:function(I,ad){ad=ad||C.i;var T=C.spreadsheetToArray(null,ad)||[],Q=I.scrolledArea.end,P=I.pane.size(),X=G.initCalcRows,R=G.initCalcCols,S=(Q.row+X)-1,W=(Q.col+R)-1,aa,ae,ac,U=this.calcVisiblePos,Y={row:aa,col:U.col},ab,Z=[];S=S<P.rows?S:P.rows;W=W<P.cols?W:P.cols;aa=S;if(aa>0){do{ac=W;if((ae=T[aa])!==undefined){if(ac>0){do{Z.push({row:ae,cell:ae!==F?ae[ac]:F,rowIndex:aa,colIndex:ac,make:function(){if((this.cell=this.row[this.colIndex])===undefined){C.createCell(C.i,this.rowIndex,this.colIndex);this.cell=T[this.rowIndex][this.colIndex]}this.cell.updateValue()}})}while(ac-->1)}}else{if(ac>0){do{var V=aa;Z.push({row:ae,cell:ae!==F?ae[ac]:F,rowIndex:aa,colIndex:ac,offset:V,make:function(){while(this.offset>0&&T[this.offset]===undefined){C.createSpreadsheetForArea(I.table,ad,this.offset,this.offset,this.colIndex,this.colIndex,true);this.offset--}if(this.cell!==F){this.cell.updateValue()}}})}while(ac-->1)}}}while(aa-->U.row)}this.calcVisiblePos=Y;y(Z,{each:function(){this.make()}});C.trigger("sheetCalculation",[{which:"spreadsheet",sheet:T,index:ad}]);C.setChanged(false)},calcVisibleCol:function(I,ac){ac=ac||C.i;var T=C.spreadsheetToArray(null,ac)||[],Q=I.scrolledArea.end,P=I.pane.size(),W=G.initCalcRows,R=G.initCalcCols,S=(Q.row+W)-1,V=(Q.col+R)-1,Z,ad,ab,aa,U=this.calcVisiblePos,X={row:U.row,col:U.col},Y=[];S=S<P.rows?S:P.rows;V=V<P.cols?V:P.cols;Z=S;if(Z>0&&V>0){do{ab=V;ad=T[Z];Y.push({row:ad,cell:ad!==F?ad[ab]:F,rowIndex:Z,colIndex:ab,make:function(){if(this.row===undefined||this.cell===undefined){C.createSpreadsheetForArea(I.table,ac,this.rowIndex,this.rowIndex,this.colIndex,this.colIndex,true);this.row=T[this.rowIndex]}aa=this.row[this.colIndex];aa.updateValue()}})}while(Z-->1)}this.calcVisiblePos=X;y(Y,{each:function(){this.make()}});C.trigger("sheetCalculation",[{which:"spreadsheet",sheet:T,index:ac}]);C.setChanged(false)},calcDependencies:function(P){if(!P){var I=this;C.undo.createCells([this],function(Q){C.trigger("sheetPreCalculation",[{which:"cell",cell:I}]);C.setDirty(true);C.setChanged(true);I.updateValue();I.updateDependencies();C.trigger("sheetCalculation",[{which:"cell",cell:I}]);return Q})}else{C.trigger("sheetPreCalculation",[{which:"cell",cell:this}]);C.setDirty(true);C.setChanged(true);this.updateValue();this.updateDependencies();C.trigger("sheetCalculation",[{which:"cell",cell:this}])}},addSheet:function(I){I=I||{rows:25,cols:10};C.evt.cellEditAbandon();C.setDirty(true);C.controlFactory.sheetUI(C.obj.ui,d.sheet.makeTable(I),C.sheetCount);C.setActiveSheet(C.sheetCount);C.sheetCount++;C.sheetSyncSize();C.obj.pane().resizeScroll();C.trigger("sheetAdd",[C.i])},insertSheet:null,deleteSheet:function(P){var S=P||C.i,R=C.controls.enclosures.toArray(),I;R.splice(S,1);C.obj.barHelper().remove();C.obj.enclosure().remove();C.controls.enclosures=d(R);C.obj.menus().remove();C.obj.tabContainer().children().eq(C.i).remove();C.spreadsheets.splice(S,1);C.controls.autoFiller.splice(S,1);C.controls.bar.helper.splice(S,1);C.controls.bar.corner.splice(S,1);C.controls.bar.x.controls.splice(S,1);C.controls.bar.x.handleFreeze.splice(S,1);C.controls.bar.x.controls.splice(S,1);C.controls.bar.x.menu.splice(S,1);if(C.controls.bar.x.menuParent&&C.controls.bar.x.menuParent[S]){C.controls.bar.x.menuParent.splice(S,1)}C.controls.bar.x.parent.splice(S,1);C.controls.bar.x.th.splice(S,1);C.controls.bar.y.controls.splice(S,1);C.controls.bar.y.handleFreeze.splice(S,1);C.controls.bar.y.controls.splice(S,1);C.controls.bar.y.menu.splice(S,1);if(C.controls.bar.y.menuParent&&C.controls.bar.y.menuParent[S]){C.controls.bar.y.menuParent.splice(S,1)}C.controls.bar.y.parent.splice(S,1);C.controls.bar.y.th.splice(S,1);C.controls.barMenuLeft.splice(S,1);C.controls.barMenuTop.splice(S,1);C.controls.barLeft.splice(S,1);C.controls.barTop.splice(S,1);C.controls.barTopParent.splice(S,1);C.controls.chart.splice(S,1);C.controls.tdMenu.splice(S,1);C.controls.enclosure.splice(S,1);C.controls.fullScreen=null;C.controls.inPlaceEdit.splice(S,1);C.controls.menus.splice(S,1);C.controls.menuLeft.splice(S,1);C.controls.menuRight.splice(S,1);C.controls.pane.splice(S,1);C.controls.tables.splice(S,1);C.controls.table.splice(S,1);for(I=S+1;I<C.controls.tab.length;++I){var Q=C.controls.tab[I].get(0);Q.i--}C.controls.tab.splice(S,1);C.controls.toggleHide.x.splice(S,1);C.controls.toggleHide.y.splice(S,1);C.readOnly.splice(S,1);C.i=0;C.sheetCount--;C.sheetCount=x.max(C.sheetCount,0);if(C.sheetCount==0){C.addSheet()}C.setActiveSheet(C.i);C.setDirty(true);C.setChanged(true);C.trigger("sheetDelete",[S])},deleteRow:function(T,S){var R,I,Q,V,X=C.sheetSize(),W,P=C.obj.pane(),U=P.table.tBody;if(T){I=Q=T}else{I=x.min(C.highlighter.start.row,C.highlighter.end.row);Q=x.max(C.highlighter.start.row,C.highlighter.end.row)}V=(Q-I)+1;if(I<1||X.cols<2||V>=X.rows){return}R=Q;do{W=C.getTd(-1,R,1).parentNode;U.removeChild(W)}while(I<R--);C.controls.bar.y.th[C.i].splice(I,V);C.spreadsheets[C.i].splice(I,V);C.refreshRowLabels(I);C.setChanged(true);C.offsetFormulas({row:I,col:0},{row:-V,col:0},false,true);C.setDirty(true);C.evt.cellEditAbandon();C.obj.pane().resizeScroll();C.trigger("sheetDeleteRow",R)},deleteColumn:function(U){var S,I,R,W,Y=C.sheetSize();if(U){I=R=U}else{I=x.min(C.highlighter.start.col,C.highlighter.end.col);R=x.max(C.highlighter.start.col,C.highlighter.end.col)}W=(R-I)+1;if(I<1||Y.cols<2||W>=Y.cols){return}S=R;C.obj.barHelper().remove();do{var X=C.obj.table(),P=C.col(X[0],S),V=C.obj.barTop(S).remove(),T=P.tds,Q=T.length-1;do{d(T[Q]).remove()}while(Q--);C.obj.barTop(S).remove();d(P).remove()}while(I<S--);C.controls.bar.x.th[C.i].splice(I,W);Q=C.spreadsheets[C.i].length-W;do{C.spreadsheets[C.i][Q].splice(I,W)}while(Q-->1);C.refreshColumnLabels(I);C.setChanged(true);C.offsetFormulas({row:0,col:I},{row:0,col:-W},false,true);C.setDirty(true);C.evt.cellEditAbandon();C.obj.pane().resizeScroll();C.trigger("sheetDeleteColumn",S)},sheetTab:function(P,R){var I="",Q;if(P){Q=C.obj.table();I=Q.attr("title")||C.msg.sheetTitleDefault.replace(/[{]index[}]/gi,C.i+1);if(R){Q.attr("title",I);R(I)}return I}else{if(C.isSheetEditable()&&G.editableNames){G.prompt(C.msg.newSheetTitle,function(S){if(!S){I=C.obj.table().attr("title");S=(I?I:C.msg.sheetTitleDefault.replace(/[{]index[}]/gi,C.i+1))}else{C.setDirty(true);C.obj.table().attr("title",S);C.obj.tab().html(S);I=S}if(R){R(d(l.createElement("div")).text(I).html())}},C.sheetTab(true));return null}}},followMe:function(R,I){R=R||C.obj.tdActive();if(R===null){return}var Q=C.obj.pane(),P=Q.actionUI;C.setBusy(true);P.putTdInView(R);C.setBusy(false);if(!I){C.autoFillerGoToTd(R)}},autoFillerGoToTd:function(R,P,I){if(!G.autoFiller){return}if(R===F){R=C.obj.tdActive()}if(R&&R.type=="cell"){P=P||R.clientHeight;I=I||R.clientWidth;if(!R.offsetHeight||!R.offsetWidth||!R.clientHeight||!R.clientWidth){C.autoFillerHide();return}var Q=d(R).position();C.obj.autoFiller().show().css("top",((Q.top+(P||R.clientHeight)-3)+"px")).css("left",((Q.left+(I||R.clientWidth)-3)+"px"))}},autoFillerHide:function(){if(!G.autoFiller){return}C.obj.autoFiller().hide()},setActiveSheet:function(R,I){if(I!==F){R=I.i}else{R=R||0}if(C.cellLast.row>0||C.cellLast.col>0){C.evt.cellEditDone();C.obj.formula().val("")}var Q=C.obj.enclosures(),P=Q.length-1,S;C.autoFillerHide();if(P>0){do{if(R!=P){S=Q[P];S._scrollLeft=S._scrollLeft||S.scrollUI.scrollLeft;S._scrollTop=S._scrollTop||S.scrollUI.scrollTop;S.style.display="none"}}while(P-->0)}C.i=R;if(I!==undefined){S=I.enclosure}else{S=C.controls.enclosure[R][0]}S.style.display="";C.highlighter.setTab(C.obj.tab());C.readOnly[R]=(S.table.className||"").match(/\breadonly\b/i)!=null;S.pane.resizeScroll(true);S.scrollUI.scrollLeft=S._scrollLeft||S.scrollUI.scrollLeft;S.scrollUI.scrollTop=S._scrollTop||S.scrollUI.scrollTop;S._scrollLeft=S._scrollTop=null;S.scrollUI.onscroll()},getSpreadsheetIndexByTitle:function(T){if(G.loader!==null){var S=G.loader.getSpreadsheetIndexByTitle(T);return S}var Q=C.obj.tables(),I=Q.length,R,P=0;for(;P<I;P++){R=Q[P];if(R.getAttribute("title")==T){return R.spreadsheetIndex}}return null},openSheet:function(P){var Q=P.length-1,I=function(){C.setBusy(true);var X=C.controlFactory.header(),W=C.controlFactory.ui(),R=C.controlFactory.sheetAdder(),T=C.controlFactory.tabContainer(),V,U={sizeCheck:function(Y){if(d.sheet.max){var Z=C.tableSize(Y.table);if(Z.rows>d.sheet.max||Z.cols>d.sheet.max){C.trigger("sheetMaxSize",[Y.table,Y.i]);G.confirm(C.msg.maxSizeBrowserLimitationOnOpen,function(){Y.load()})}else{Y.load()}}else{Y.load()}},initChildren:function(aa,Z,Y){C.controlFactory.sheetUI(aa,Z,Y);C.trigger("sheetOpened",[Y])},done:function(Y){C.sheetSyncSize();C.setActiveSheet(0);C.setDirty(false);C.setBusy(false);while(Y.length>0){C.calcVisibleInit(C.i=Y.pop())}C.trigger("sheetAllOpened")},lastIndex:Q},S;X.ui=W;X.tabContainer=T;W.header=X;W.sheetAdder=R;W.tabContainer=T;T.header=X;T.ui=W;G.parent.append(X).append(W).append(R).append(T);C.resizableSheet(G.parent,{minWidth:G.parent.width()*0.1,minHeight:G.parent.height()*0.1,start:function(){C.setBusy(true);C.obj.enclosure().hide();W.sheetAdder.hide();W.tabContainer.hide()},stop:function(){C.obj.enclosure().show();W.sheetAdder.show();W.tabContainer.show();C.setBusy(false);C.sheetSyncSize();C.obj.pane().resizeScroll()}});if(G.loader===null){for(V=0;V<P.length;V++){new k.SpreadsheetUI(V,W,P[V],U);C.sheetCount++}}else{C.insertSheet=function(ab,Y,aa,Z){C.sheetCount++;ab=ab||null;Z=Z||l.createElement("table");aa=aa!==undefined?aa:true;Y=Y||C.sheetCount-1;if(ab!==null){loader.addSpreadsheet(ab)}if(!Z.hasAttribute("title")){Z.setAttribute("title",loader.title(Y))}var ac=function(){C.obj.enclosure().hide();C.setBusy(true);var ad=new k.SpreadsheetUI(Y,W,Z,U);C.setActiveSheet(-1,ad);C.calcVisibleInit(Y);C.setBusy(false);C.sheetSyncSize()};if(aa){ac();return}C.controlFactory.customTab(G.loader.title(Y)).mousedown(function(){ac();C.obj.tab().insertBefore(this);d(this).remove();return false})};S=new k.SpreadsheetUI(0,W,P[0],U);C.sheetCount++;if(P.length>1){for(V=1;V<P.length;V++){C.insertSheet(null,V,false,P[V])}C.i=0;S.loaded()}}};if(C.isDirty){G.confirm(C.msg.openSheet,I)}else{I()}},newSheet:function(){G.parent.html(d.sheet.makeTable()).sheet(G)},sheetSyncSize:function(){var Y=G.parent,U=Y[0],aa=U.clientHeight,V=U.clientWidth,Z=C.obj.tabContainer(),ab=Z[0],I=ab.style,ae=f.scrollBarSize.width,P,ad,X,W,S=C.obj.ui.style,T,af,R,ac,Q;if(!aa){aa=400;Y.height(aa)}else{if(aa<200){aa=200;Y.height(aa)}}Q=ab.scrollLeft;I.width="";P=ab.clientWidth;ad=(V-(G.colMargin+ae));X=(V-G.colMargin*2)+"px";W=((G.colMargin+ae)+"px");if(P>ad){I.height=W;Z.addClass(C.cl.tabContainerScrollable);aa-=ae}else{I.height=null;Z.removeClass(C.cl.tabContainerScrollable)}I.width=X;ab.scrollLeft=Q;aa-=C.obj.header().outerHeight()+G.boxModelCorrection;aa-=ab.clientHeight+G.boxModelCorrection;T=(aa-f.scrollBarSize.height-G.boxModelCorrection)+"px";af=(V-f.scrollBarSize.width)+"px";R=(aa+"px");ac=(V+"px");C.obj.panes().each(function(){var ai=this.style,ah=this.actionUI.scrollUI.style,ag=this.enclosure.style;ai.height=T;ai.width=af;ag.height=ah.height=R;ag.width=ah.width=ac});S.height=R;S.width=ac},cellChangeStyle:function(Q,R,I){I=I||C.highlighted(true);if(I.length<1){return false}C.setDirty(this);var P=I.length-1;if(P>=0){C.undo.createCells(I,function(S){do{S[P].td.css(Q,R)}while(P--);return S});return true}return false},cellFind:function(I){function P(R){var Q=C.obj.table().children("tbody").children("tr");if(R){var S=Q.children('td:contains("'+R+'")');if(S.length<1){S=Q.children('td:contains("'+R.toLowerCase()+'")')}if(S.length<1){S=Q.children('td:contains("'+R.toUpperCase()+'")')}S=S.eq(0);if(S.length>0){C.cellEdit(S)}else{G.alert(C.msg.cellNoFind)}}}if(!I){G.prompt(C.msg.cellFind,P)}else{P(I)}},cellSetActiveBar:function(W,Q,R){var ab=C.sheetSize(),T=x.min(Q,R),Y=x.max(Q,R),I={},X={},aa=function(ac){switch(G.cellSelectModel){case k.openOfficeSelectModel:this.row=(ac?I.row:X.row);this.col=(ac?I.col:X.col);this.td=C.getTd(-1,this.row,this.col);if(this.td!==C.cellLast.td){C.cellEdit(this.td,false,true)}break;default:this.row=(ac?X.row:I.row);this.col=(ac?X.col:I.col);this.td=C.getTd(-1,this.row,this.col);if(this.td!==C.cellLast.td){C.cellEdit(this.td,false,true)}break}},S=[],U=C.obj.pane().actionUI.scrolledArea,V=C.obj.table(),P,Z;switch(W){case"top":I.row=U.end.row;I.col=T;X.row=U.end.row;X.col=Y;C.highlighter.start.row=1;C.highlighter.start.col=T;C.highlighter.end.row=ab.rows;C.highlighter.end.col=Y;P=Y;do{S.push(C.col(V[0],P))}while(P-->T);break;case"left":I.row=T;I.col=U.end.col;X.row=Y;X.col=U.end.col;C.highlighter.start.row=T;C.highlighter.start.col=1;C.highlighter.end.row=Y;C.highlighter.end.col=ab.cols;Z=Y;do{S.push(C.getTd(-1,Z,1).parentNode)}while(Z-->T);break;case"corner":I.row=1;I.col=1;X.col=ab.cols;X.row=ab.rows;S.push(V[0]);break}new aa(Q>R);C.highlighter.set(d(S))},getTdRange:function(R,W,U,V){C.cellLast.isEdit=true;var P=function(Y){if(Y.first.col>Y.last.col||Y.first.row>Y.last.row){return{first:h.parseCellName(Y.last.col,Y.last.row),last:h.parseCellName(Y.first.col,Y.first.row)}}else{return{first:h.parseCellName(Y.first.col,Y.first.row),last:h.parseCellName(Y.last.col,Y.last.row)}}},T=function(ab){var Y=P(ab),aa=W+"";aa=(aa.match(/=/)?aa:"="+aa);if(U||aa.charAt(aa.length-1)!="("){aa=aa+(U?U:"")+"("}var ac,Z="";if(Y.first!=Y.last){ac=Y.first+":"+Y.last}else{ac=Y.first}if(aa.charAt(aa.length-1)=="("){Z=")"}return aa+ac+Z},I="",Q,S,X;if(R){Q={first:C.getTdLocation([R.target])};S=C.obj.table().mousemove(function(Y){Q.last=C.getTdLocation([Y.target]);I=T(Q);if(!V){C.obj.formula().val(I);C.obj.inPlaceEdit().val(I)}});O.one("mouseup",function(){S.unbind("mousemove");return I})}else{X=C.highlighted().not(C.obj.tdActive());if(X.length){Q={first:C.getTdLocation(X.first()),last:C.getTdLocation(X.last())};I=T(Q);if(!V){C.obj.formula().val(I);C.obj.inPlaceEdit().val(I)}return I}else{return""}}return""},getTd:function(S,U,P){var Q=(S>-1?C.obj.tables()[S]:C.obj.table()[0]),I,R,T;if(!Q||!(I=Q.tBody)||!(R=I.children[U])||!(T=R.children[P])){T=l.createElement("td")}return T},getTdLocation:function(P){var I={col:0,row:0};if(P===F||P===null){return I}if(P.parentNode==F||P.parentNode.rowIndex<0){return I}return{col:parseInt(P.cellIndex),row:parseInt(P.parentNode.rowIndex)}},getBarIndex:{left:function(I){I=I||{};if(!I.parentNode||L(I.parentNode.rowIndex)){return -1}else{return I.parentNode.rowIndex}},top:function(I){I=I||{};if(L(I.cellIndex)){return -1}else{return I.cellIndex}},corner:function(){return 0}},time:{now:new a(),last:new a(),diff:function(){return x.abs(x.ceil(this.last.getTime()-this.now.getTime())/1000).toFixed(5)},set:function(){this.last=this.now;this.now=new a()},get:function(){return this.now.getHours()+":"+this.now.getMinutes()+":"+this.now.getSeconds()}},changed:[],isChanged:function(I){return C.changed[I||C.i]},setChanged:function(I){C.changed[C.i]=I},isDirty:false,setDirty:function(I){C.dirty=I},appendToFormula:function(I){var Q=C.obj.formula(),P=Q.val();if(P.charAt(0)!="="){P="="+P}Q.val(P+I)},undo:{manager:(f.UndoManager?new UndoManager():{undo:B,redo:B,register:B}),cells:[],id:-1,createCells:function(I,P,S){if(S===F){C.undo.id++;S=C.undo.id}var Q=(new k.CellRange(I)).clone().cells,R=(P!==F?(new k.CellRange(P(I)).clone()).cells:Q);Q.id=S;R.id=S;C.undo.manager.add({undo:function(){C.undo.removeCells(Q,S)},redo:function(){C.undo.createCells(R,null,S)}});if(S!==C.undo.id){C.undo.draw(R)}return true},removeCells:function(P,R){var Q=0,I=-1;if(P.id===R){I=Q}if(I!==-1){C.undo.cells.splice(I,1)}C.undo.draw(P)},draw:function(Q){var P,T,S,I,R;for(P=0;P<Q.length;P++){S=Q[P];R=C.getTdLocation(S.td);I=C.spreadsheets[S.sheetIndex][R.row][R.col];I.value=S.value;I.formula=S.formula;T=I.td=S.td;I.dependencies=S.dependencies;I.needsUpdated=S.needsUpdated;I.calcCount=S.calcCount;I.sheetIndex=S.sheetIndex;I.rowIndex=R.row;I.columnIndex=R.col;I.state=S.state;I.jS=S.jS;T.setAttribute("style",S.style);T.setAttribute("class",S.cl);I.setNeedsUpdated();I.updateValue()}}},cols:function(I){I=I||C.obj.table()[0];if(!I){return[]}if(!I.colGroup){return[]}if(!I.colGroup.children){return[]}return I.colGroup.children},tables:function(X,S){X=X||C.obj.tables();var W=[],Q=X.length-1,P,Z,V,I,aa,R,Y,T,U;do{Z=(S?l.body.removeChild(X[Q]):X[Q].cloneNode(true));if((I=Z.children[0])&&(aa=I.children[0])){I.removeChild(aa)}if(V=Z.children[1]){T=V.children;Y=T[0];V.removeChild(Y);P=T.length-1;do{U=T[P];R=U.children[0];U.removeChild(R)}while(P-->0)}W[Q]=Z}while(Q-->0);return C.sheetDecorateRemove(false,d(W))},col:function(P,I){P=P||C.obj.table()[0];var Q=C.cols(P);if(I===F){I=Q.length-1}return Q[I]},rowTds:function(P,I){P=P||C.obj.table();var Q=C.rows(P);if(!Q.length){return[]}if(I==F){I=Q.length-1}if(!Q[I]){return[]}if(!Q[I].children){return[]}return Q[I].children},rows:function(I){I=I||C.obj.table()[0];if(!I){return[]}if(!I.tBody){return[]}if(!I.tBody.children){return[]}return I.tBody.children},highlighted:function(P){var R=C.highlighter.last||d([]),S=[],I,Q;if(!(I=R)||!R.length||!(I=I[0])||!I.tagName){return P?S:d(S)}switch(I.tagName){case"TD":Q=R.length-1;do{S.unshift(P?R[Q].jSCell:R[Q])}while(Q-->0);break;case"TR":Q=R.length-1;do{if(R[Q].tds){S=S.concat(P?R[Q].jSCells:R[Q].tds)}}while(Q-->0);break;case"COL":R=R.filter("col");Q=R.length-1;do{if(R[Q].tds){S=S.concat(P?R[Q].jSCells:R[Q].tds)}}while(Q-->0);break;case"TABLE":S=(P?I.jSCells:I.tds);break}return P?S:d(S)},sheetSize:function(Q){var P,T,I={},R=G.minSize||{rows:1,cols:1},S;Q=Q||C.obj.table()[0];if((I.cols=G.initScrollCols)>0&&(I.rows=G.initScrollRows)>0){}else{P=C.rowTds(Q);T=C.getTdLocation(P[P.length-1]);I.cols=T.col;I.rows=T.row}if(G.loader!==null){S=G.loader.size(Q.spreadsheetIndex);I.rows=g.max(S.rows,I.rows,R.rows);I.cols=g.max(S.cols,I.cols,R.cols)}return I},test:function(){var I=C.highlighted(true);console.log(C.obj.enclosure())},sortVerticalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){C.sortVertical();return true}else{C.sortVerticalSingle(false);return true}},sortVerticalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){C.sortVertical();return false}else{C.sortVerticalSingle(true);return false}},sortVertical:function(X){var V=C.highlighted(true),S=V[0].td.parent().prev(),I=V.length,Q=new a(),U=true,Y=[],aa=[],T,W=0,Z,P,R;while(W<I){Z=V[W];R=Z.td;if(!isNaN(Z.value)){P=(new u(Z.value.valueOf()))}else{U=false;P=(new q(Z.value.valueOf()))}P.loc=C.getTdLocation(R);P.row=R.parentNode;P.col=R;P.cell=Z;Y.push(P);W++}if(X){if(U==false){Y.sort(function(ac,ab){return ab-ac})}else{Y.sort();Y.reverse()}}else{if(U==true){Y.sort(function(ac,ab){return ac-ab})}else{Y.sort()}}C.undo.createCells(V);while(T=Y.length){P=Y.pop();aa=C.spreadsheets[C.i].splice(P.row.rowIndex,1);Z=P.cell;Z.value=P.valueOf();P.row.parentNode.removeChild(P.row);S.after(P.row);P.row.children[0].innerHTML=S[0].rowIndex+T;C.spreadsheets[C.i].splice(S[0].rowIndex+1,0,aa[0]);C.calcDependencies.call(Z,true)}C.undo.createCells(V)},sortVerticalSingle:function(T){var R=C.highlighted(true),S=R.length,Q=0,P=[],I;while(Q<S){P.push(R[Q].value);Q++}if(T){P.sort(function(V,U){return U-V})}else{P.sort(function(V,U){return V-U})}while(R.length){I=R.pop();I.value=P[R.length];I.updateValue();I.updateDependencies()}},sortHorizontalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){C.sortHorizontal();return true}else{C.sortHorizontalSingle(false);return true}},sortHorizontalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){C.sortHorizontal();return false}else{C.sortHorizontalSingle(true);return false}},sortHorizontal:function(X){var V=C.highlighted(true),ad=V[0].td[0],Z=ad.cellIndex,I=ad.table.colGroup,ae=C.sheetSize().rows,P=V.length,R=new a(),U=true,aa=[],T,W=0,ab,ac,Q,Y,S;while(W<P){ab=0;ac=V[W];S=ac.td;if(!isNaN(ac.value)){Q=new u(ac.value.valueOf())}else{U=false;Q=new q(ac.value.valueOf())}Q.tds=[];Q.loc=C.getTdLocation(S);Q.tr=S.parentNode;Q.td=S;Q.cell=ac;while(ab<=ae){Q.tds.push(C.obj.pane().table.children[1].children[ab].children[S.cellIndex]);ab++}aa.push(Q);W++}if(X){if(U==false){aa.sort(function(ag,af){return af-ag})}else{aa.sort();aa.reverse()}}else{if(U==true){aa.sort(function(ag,af){return ag-af})}else{aa.sort()}}C.undo.createCells(V);while(aa.length){Q=aa.pop();while(Q.tds.length>1){S=Q.tds.pop();Y=S.parentNode;ac=C.spreadsheets[C.i][Y.rowIndex].splice(S.cellIndex,1);Y.insertBefore(S,Y.children[Z]);S.col=I.children[aa.length+S.cellIndex-1];S.barTop=S.col.bar;ac.value=S.jSCell.value;C.spreadsheets[C.i][Y.rowIndex].splice(S.cellIndex,0,ac[0]);C.calcDependencies.call(ac,true)}}C.undo.createCells(V)},sortHorizontalSingle:function(T){var R=C.highlighted(true),S=R.length,Q=0,P=[],I;while(Q<S){P.push(R[Q].value);Q++}if(T){P.sort(function(V,U){return U-V})}else{P.sort(function(V,U){return V-U})}while(R.length){I=R.pop();I.value=P[R.length];I.updateValue();I.updateDependencies()}},tableSize:function(Q){Q=Q||C.obj.table()[0];var I=Q.tBody||{},S=I.children||[],R=S[S.length-1]||{},P=R.children||[],T=P[P.length-1]||{};return{cols:T.cellIndex||0,rows:R.rowIndex||0}},toggleState:function(I){if(G.allowToggleState){var P=I||C.tables();if(G.editable){C.evt.cellEditAbandon();C.trigger("sheetSave",[P])}C.setDirty(false);C.setChanged(true);G.editable=!G.editable;C.kill();G.parent.html(P).sheet(G);G=null}},setCellRef:function(Q){function P(S){if(S){C.s.formulaVariables[S]=I.updateValue()}}var R=C.obj.tdActive(),I=R.jSCell;if(Q){P(Q)}else{G.prompt(C.msg.setCellRef,P)}},formulaParser:null,print:function(I,P){I=I||C.i;var R=f.open(),Q;if(R!==F){Q=R.document;Q.write('<html>	<head id="head"></head>	<body>		<div id="entry" class="'+C.cl.parent+'" style="overflow: show;">		</div>	</body></html>');if(P!==true){d(Q.getElementById("head")).append(d("style,link").clone())}d(Q.getElementById("entry")).append(C.obj.pane().cloneNode(true));Q.close();R.focus();R.print()}}},w=[],z;C.setBusy(true);G.parent[0].jS=C;if(!f.console){f.console={log:function(){}}}if(f.scrollBarSize===F){f.scrollBarSize=m()}if(f.defaultCharSize===F){f.defaultCharSize=j()}C.cellHandler=new k.CellHandler(C,h,d.sheet.fn);C.theme=new k.Theme(G.theme);C.highlighter=new k.Highlighter(C.theme.tdHighlighted,C.theme.barHighlight,C.theme.tabActive,function(){C.obj.pane().actionUI.redraw()});G.origHtml=G.parent.children().detach();G.parent.addClass(C.cl.parent);G.parent.bind("sheetSwitch",function(Q,P,I){C.switchSheet(I)}).bind("sheetRename",function(Q,P,I){C.renameSheet(I)});G.width=(G.width?G.width:G.parent.width());G.height=(G.height?G.height:G.parent.height());if(!d.nearest){C.nearest=B}C.resizableCells=C.resizableSheet=C.resizable;if(!d.ui){C.resizable=C.resizableCells=C.resizableSheet=C.draggable=B}else{if(!G.resizableCells){C.resizableCells=B}if(!G.resizableSheet){C.resizableSheet=B}}if(!d.support.boxModel){G.boxModelCorrection=0}if(!G.barMenus){C.controlFactory.barMenuTop=C.controlFactory.barMenuLeft=B}if(!G.freezableCells){C.controlFactory.barHandleFreeze.top=C.controlFactory.barHandleFreeze.left=B}if(G.calcOff){C.calc=B}if(!f.Raphael){h.chart=B}H.resize(function(){if(C&&!C.isBusy()){G.width=G.parent.width();G.height=G.parent.height();C.sheetSyncSize()}});if(d.sheet.fn){d.sheet.fn=d.extend(d.sheet.fn,G.formulaFunctions);if(d.sheet.advancedfn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.advancedfn)}if(d.sheet.financefn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.financefn)}}G.title=G.title||G.parent.attr("title")||"";C.s=G;G.parent.addClass(C.theme.parent);if(G.origHtml.length){C.openSheet(G.origHtml)}else{if(G.loader!==null){while(w.length<G.loader.count){z=l.createElement("table");z.setAttribute("title",G.loader.title(w.length));w.push(z)}C.openSheet(d(w))}else{C.openSheet(d(l.createElement("table")))}}C.setBusy(false);return C},makeTable:function(I,y,w){var G=l;I=I||{rows:25,cols:10};y=y||120;w=w||15;var H=l.createElement("table"),x=l.createElement("colgroup"),F=l.createElement("tbody"),C="width:"+y+"px;",A="height:"+w+"px;",E,z,D,B;D=I.cols;do{z=l.createElement("col");z.setAttribute("style",C);x.appendChild(z)}while(D-->1);D=I.rows;do{E=l.createElement("tr");E.setAttribute("style",A);B=I.cols;do{E.appendChild(l.createElement("td"))}while(B-->1);F.appendChild(E)}while(D-->1);H.appendChild(x);H.appendChild(F);return H},killAll:function(){if(d.sheet){var w=d.sheet.instance;if(w){for(var x=0;x<w.length;x++){if(w[x]&&w[x].kill){w[x].kill()}}d.sheet.instance=[]}}},scrollLocker:function(x){var w=d.sheet.instance;w[x].obj.panes().each(function(y){var z;d(z=this.scrollUI).scroll(function(B){var A=w.length-1,C;if(A>-1){do{C=w[A].controls.enclosure[y][0].scrollUI;if(this!==C){C.scrollLeft=z.scrollLeft;C.scrollTop=z.scrollTop}}while(A--)}})})},switchSheetLocker:function(w){d.each(d.sheet.instance,function(){this.s.parent.bind("sheetSwitch",function(z,y,x){d.each(d.sheet.instance,function(){this.setActiveSheet(x)})})})},I:function(){var w=0;if(this.instance){w=(this.instance.length===0?0:this.instance.length-1)}else{this.instance=[]}return w}};var h=d.sheet.engine={calc:function(z,x,A){x=x||[];var C=x.length-1,B,y,w;if(C>0){do{if(C>0&&x[C]){B=x[C];y=B.length-1;if(y>0){do{w=B[y];w.updateValue()}while(y-->1)}}}while(C-->1)}},parseLocation:function(w,x){return{row:parseInt(x),col:h.columnLabelIndex(w)}},parseSheetLocation:function(x){var w=((x+"").replace("SHEET","")*1)-1;return isNaN(w)?-1:w},parseCellName:function(w,x){return h.columnLabelString(w)+(x||"")},alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),columnLabels:{},columnLabelIndex:function(w){return this.columnLabels[w.toUpperCase()]},columnIndexes:[],columnLabelString:function(z){if(!this.columnIndexes.length){var B="",A,y,x,w;A=y=x=-1;for(w=1;w<16385;++w){B="";++x;if(x==26){x=0;++y;if(y==26){y=0;++A}}if(A>=0){B+=this.alphabet[A]}if(y>=0){B+=this.alphabet[y]}if(x>=0){B+=this.alphabet[x]}this.columnIndexes[w]=B;this.columnLabels[B]=w}}return this.columnIndexes[z]||""},regEx:{n:/[\$,\s]/g,cell:/\$?([a-zA-Z]+|[#]REF[!])\$?([0-9]+|[#]REF[!])/gi,range:/\$?([a-zA-Z]+)\$?([0-9]+):\$?([a-zA-Z]+)\$?([0-9]+)/gi,remoteCell:/\$?(SHEET+)\$?([0-9]+)[:!]\$?([a-zA-Z]+)\$?([0-9]+)/gi,remoteCellRange:/\$?(SHEET+)\$?([0-9]+)[:!]\$?([a-zA-Z]+)\$?([0-9]+):\$?([a-zA-Z]+)\$?([0-9]+)/gi,sheet:/SHEET/i,amp:/&/g,gt:/</g,lt:/>/g,nbsp:/&nbsp;/g},chart:function(y){var B=this.jS,E=l.createElement("div"),A=this.td,D,C=l.body;C.appendChild(E);function z(G,H){if(!G){if(H){G=0}else{G=""}}else{if(H){G=c.toNumbers(G)}else{G=c.flatten(G)}}return G}y=d.extend({x:{legend:"",data:[0]},y:{legend:"",data:[0]},title:"",data:[0],legend:""},y);E.className=B.cl.chart;E.onmousedown=function(){d(A).mousedown()};E.onmousemove=function(){d(A).mousemove();return false};B.controls.chart[B.i]=B.obj.chart().add(E);y.data=z(y.data,true);y.x.data=z(y.x.data,true);y.y.data=z(y.y.data,true);y.legend=z(y.legend);y.x.legend=z(y.x.legend);y.y.legend=z(y.y.legend);y.legend=(y.legend?y.legend:y.data);var x,F,w=Raphael(E);if(A.clientHeight>0){x=g.max(A.clientWidth,100);F=g.max(A.clientHeight,50)}if(y.title){w.text(x/2,10,y.title).attr({"font-size":20})}switch(y.type){case"bar":D=w.barchart(x/8,F/8,x*0.8,F*0.8,y.data,y.legend).hover(function(){this.flag=w.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"hbar":D=w.hbarchart(x/8,F/8,x*0.8,F*0.8,y.data,y.legend).hover(function(){this.flag=w.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"line":D=w.linechart(x/8,F/8,x*0.8,F*0.8,y.x.data,y.y.data,{nostroke:false,axis:"0 0 1 1",symbol:"circle",smooth:true}).hoverColumn(function(){this.tags=w.set();if(this.symbols.length){for(var G=0,H=this.y.length;G<H;G++){this.tags.push(w.tag(this.x,this.y[G],this.values[G],160,10).insertBefore(this).attr([{fill:"#fff"},{fill:this.symbols[G].attr("fill")}]))}}},function(){this.tags&&this.tags.remove()});break;case"pie":D=w.piechart(x/2,F/2,(x<F?x:F)/2,y.data,{legend:y.legend}).hover(function(){this.sector.stop();this.sector.scale(1.1,1.1,this.cx,this.cy);if(this.label){this.label[0].stop();this.label[0].attr({r:7.5});this.label[1].attr({"font-weight":800})}},function(){this.sector.animate({transform:"s1 1 "+this.cx+" "+this.cy},500,"bounce");if(this.label){this.label[0].animate({r:5},500,"bounce");this.label[1].attr({"font-weight":400})}});break;case"dot":D=w.dotchart(x/8,F/8,x*0.8,F*0.8,y.x.data,y.y.data,y.data,{symbol:"o",max:10,heat:true,axis:"0 0 1 1",axisxstep:y.x.data.length-1,axisystep:y.y.data.length-1,axisxlabels:(y.x.legend?y.x.legend:y.x.data),axisylabels:(y.y.legend?y.y.legend:y.y.data),axisxtype:" ",axisytype:" "}).hover(function(){this.marker=this.marker||w.tag(this.x,this.y,this.value,0,this.r+2).insertBefore(this);this.marker.show()},function(){this.marker&&this.marker.hide()});break}D.mousedown(function(){d(A).mousedown().mouseup()});C.removeChild(E);return E}};var o=d.sheet.fn={ISNUMBER:function(x){var w;if(!isNaN(x.valueOf())){w=new v(true);w.html="TRUE";return w}w=new v(false);w.html="FALSE";return w},N:function(w){if(w==null){return 0}if(w instanceof a){return w.getTime()}if(typeof(w)=="object"){w=w.toString()}if(typeof(w)=="string"){w=parseFloat(w.replace(h.regEx.n,""))}if(isNaN(w)){return 0}if(typeof(w)=="number"){return w}if(w==true){return 1}return 0},VERSION:function(){return this.jS.version},ABS:function(w){return g.abs(o.N(w))},CEILING:function(x,w){w=w||1;return(parseInt(x/w)*w)+w},EVEN:function(w){w=g.round(w);var x=(w%2==0);if(!x){if(w>0){w++}else{w--}}return w},EXP:function(w){return g.exp(w)},FLOOR:function(y,x){x=x||1;if((y<0&&x>0)||(y>0&&x<0)){var w=new u(0);w.html="#NUM";return w}if(y>=0){return g.floor(y/x)*x}else{return g.ceil(y/x)*x}},INT:function(w){return g.floor(o.N(w))},LN:function(w){return g.log(w)},LOG:function(w,x){x=x||10;return g.log(w)/g.log(x)},LOG10:function(w){return o.LOG(w)},MOD:function(w,A){var z=w%A;if(A<0){z*=-1}return z},ODD:function(w){var y=false;if(w>0){w=g.floor(g.round(w));y=true}else{w=g.ceil(w)}var x=g.abs(w);if((x%2)==0){x++}if(y){return x}else{return -x}},PI:function(){return g.PI},POWER:function(w,z){return g.pow(w,z)},SQRT:function(w){return g.sqrt(w)},RAND:function(){return g.random()},RND:function(){return g.random()},ROUND:function(y,x){var w=g.pow(10,x||0);return g.round(y*w)/w},ROUNDDOWN:function(x,w){var y=(x<0);x=g.abs(x);w=w||0;x=g.floor(x*g.pow(10,w))/g.pow(10,w);return(y?-x:x)},ROUNDUP:function(x,w){var y=(x<0);x=g.abs(x);w=w||0;x=g.ceil(x*g.pow(10,w))/g.pow(10,w);return(y?-x:x)},SUM:function(){var y=0,w=c.toNumbers(arguments),x=w.length-1;if(x<0){return 0}do{y+=w[x]*1}while(x--);return y},TRUNC:function(w,x){x=x||0;w=w+"";if(x==0){return w.split(".").shift()}if(w.match(".")){if(x==1){w=w.substr(0,w.length-1)}else{if(x==-1){w=w.split(".").shift();w=w.substr(0,w.length-1)+"0"}}}return w},AVERAGE:function(w){return o.SUM(arguments)/o.COUNT(arguments)},AVG:function(w){return o.AVERAGE(w)},COUNT:function(){var y=0,w=c.toNumbers(arguments),x=w.length-1;if(x<0){return y}do{if(w[x]!==null){y++}}while(x--);return y},COUNTA:function(){var y=0,w=c.flatten(arguments),x=w.length-1;if(x<0){return y}do{if(w[x]){y++}}while(x--);return y},MAX:function(){var x=c.toNumbers(arguments),w=x[0],y=x.length-1;if(y<0){return 0}do{w=(x[y]>w?x[y]:w)}while(y--);return w},MIN:function(){var w=c.toNumbers(arguments),y=w[0],x=w.length-1;if(x<0){return 0}do{y=(w[x]<y?w[x]:y)}while(x--);return y},ASC:function(w){return w.charCodeAt(0)},CHAR:function(w){return q.fromCharCode(w)},CLEAN:function(w){var x=new b("[cG\x1BcLcJcMcIcK\x07\x1B\f\n\r\t\v]","g");return w.replace(x,"")},CODE:function(w){return o.ASC(w)},CONCATENATE:function(){var y=c.flatten(arguments),x="",w=this;jQuery.each(y,function(z){x+=y[z]});return x},DOLLAR:function(y,x,A){x=x||2;A=A||"$";var w=new u(y),z=o.FIXED(y,x,false);if(y>=0){w.html=A+z}else{w.html="("+A+z.slice(1)+")"}return w},FIXED:function(z,y,x){y=(y===undefined?2:y);var A=g.pow(10,y),w,z=g.round(z*A)/A;w=new q(z.toFixed(y));w.html=Globalize.format(z,"n"+y);if(x){w.html=w.html.replace(Globalize.culture().numberFormat[","],"")}return w},LEFT:function(w,x){x=x||1;return w.substring(0,x)},LEN:function(w){if(!w){return 0}return w.length},LOWER:function(w){return w.toLowerCase()},MID:function(y,z,x){if(!y||!z||!x){var w=new u(0);w.html="ERROR";return w}return y.substring(z-1,x+z-1)},REPLACE:function(x,A,y,z){if(!x||!A||!y||!z){var w=new q("");w.html="ERROR";return w}var w=x.split("");w.splice(A-1,y);w.splice(A-1,0,z);return w.join("")},REPT:function(x,z){var w="";for(var y=0;y<z;y++){w+=x}return w},RIGHT:function(w,x){x=x||1;return w.substring(w.length-x,w.length)},SEARCH:function(z,x,A){A=A||0;if(A){x=x.split("");x.splice(0,A-1);x=x.join("")}var y=x.search(z);if(y<0){var w=new q("");w.html="#VALUE!";return w}return A+(A?0:1)+y},SUBSTITUTE:function(z,w,y,A){A=A||0;w=new b(w,"g");var x=1;z=z.replace(w,function(C,E,F,D){var B=C;if(A){if(x>=A){B=y}}else{B=y}x++;return B});return z},TEXT:function(x,w){return x},UPPER:function(w){return w.toUpperCase()},VALUE:function(x){if(jQuery.isNumeric(x)){return x*=1}else{var w=new q("");w.html="#VALUE!";return w}},NOW:function(){var w=new a();w.html=e.toString(w);return w},TODAY:function(){var x=new a(),w=new u(e.toCentury(x)-1);w.html=e.toString(x,"d");return w},WEEKENDING:function(x){var w=new a();w=new a(w.getFullYear(),w.getMonth(),w.getDate()+5-w.getDay()-((x||0)*7));w.html=e.toString(w,"d");return w},WEEKDAY:function(x,y){x=e.get(x);var w=x.getDay();y=(y?y:1);switch(y){case 3:switch(w){case 0:return 7;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6}break;case 2:switch(w){case 0:return 6;case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5}break;case 1:w++;break}return w},WEEKNUM:function(w){w=e.get(w);return e.week(w)+1},YEAR:function(w){w=e.get(w);return w.getFullYear()},DAYSFROM:function(x,y,w){return g.floor((new a()-new a(x,(y-1),w))/e.dayDiv)},DAYS:function(A,y){var x=e.get(A),w=e.get(y),z=1000*60*60*24;return g.round(g.abs(x.getTime()-w.getTime())/z)},DAY:function(w){w=e.get(w);return w.getDate()},DAYS360:function(B,y,D){B=e.get(B);y=e.get(y);var w=B.getDate(),A=y.getDate(),z=e.isLastDayOfMonth(B),C=e.isLastDayOfMonth(y),x=e.diffMonths(B,y);if(D){w=g.min(w,30);A=g.min(A,30)}else{if(z){w=30}if(C){if(w<30){x++;A=1}else{A=30}}}return(x*30)+(A-w)},DATE:function(z,A,x){var y=new a(z,A-1,x),w=new u(e.toCentury(y));w.html=e.toString(y,"d");return w},DATEVALUE:function(x){x=e.get(x);var w=new u(e.toCentury(x));w.html=e.toString(x,"d");return w},EDATE:function(y,x){y=e.get(y);y.setMonth(y.getMonth()+x);var w=new u(e.toCentury(y));w.html=e.toString(y,"d");return w},EOMONTH:function(y,x){y=e.get(y);y.setMonth(y.getMonth()+x+1);y=new a(y.getFullYear(),y.getMonth(),0);var w=new u(e.toCentury(y));w.html=e.toString(y,"d");return w},HOUR:function(w){w=i.fromMath(w);return w.hour},MINUTE:function(w){return i.fromMath(w).minute},MONTH:function(w){w=e.get(w);return w.getMonth()+1},SECOND:function(w){return i.fromMath(w).second},TIME:function(w,B,x){x=(x?x:0);B=(B?B:0);w=(w?w:0);if(x&&x>60){var y=(((x/60)+"").split(".")[0])*1;x=x-(y*60);B+=y}if(B&&B>60){var A=(((B/60)+"").split(".")[0])*1;B=B-(A*60);w+=A}var z=(w*60*60*1000)+(B*60*1000)+(x*1000);return z/e.dayDiv},TIMEVALUE:function(w){if(!isNaN(w)){return w}if(/([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm)/.test(w)){return i.fromString(w,true)}else{if(/([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?/.test(w)){return i.fromString(w)}}return 0},WORKDAY:function(x,A,z){var B={1:true,2:true,3:true,4:true,5:true},x=e.get(x),A=(A&&!isNaN(A)?A:0),C=0,y=0,w=x,E;if(z){if(!jQuery.isArray(z)){z=[z]}z=c.flatten(z);var D={};jQuery.each(z,function(F){if(z[F]){D[e.toString(e.get(z[F]),"d")]=true}});z=D}else{z={}}while(y<A){w=new a(w.setDate(w.getDate()+1));if(B[w.getDay()]){if(!z[e.toString(w,"d")]){y++}}C++}E=new u(e.toCentury(w));E.html=e.toString(w,"d");return E},YEARFRAC:function(x,B,A){x=e.get(x);B=e.get(B);if(!x||!B){var w=new q("");w.html="#VALUE!";return w}A=(A?A:0);this.html=[];var z=e.diff(x,B,A),y=e.calcAnnualBasis(x,B,A);return z/y},AND:function(){var x=arguments,y,w=this;d.each(x,function(z){if(x[z].valueOf()!==true&&y==undefined){y=o.FALSE()}});if(!y){y=o.TRUE()}return y},FALSE:function(){var w=new v(false);w.html="FALSE";return w},IF:function(y,x,w){if(y.valueOf()){return x}else{return w}},NOT:function(x){var w;if(!x.valueOf()){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},OR:function(){var y=arguments,w,z=y.length-1,x;if(z>-1){do{x=y[z].valueOf();if(x){w=new v(true);w.html="TRUE";return w}}while(z--)}w=new v(false);w.html="FALSE";return w},TRUE:function(){var w=new v(true);w.html="TRUE";return w},GREATER:function(y,x){var w;if(y>x){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},LESS:function(y,x){var w;if(y<x){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},EQUAL:function(y,x){var w;if(y.toString()===x.toString()){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},GREATER_EQUAL:function(y,x){var w;if(y>=x){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},LESS_EQUAL:function(y,x){var w;if(y<=x){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},IMG:function(x){var w=new q("");w.html=d(l.createElement("img")).attr("src",x);return w},TRIM:function(w){if(typeof(w)=="string"){w=d.trim(w)}return w},HYPERLINK:function(y,x){x=x||"LINK";var w=new q(x);w.html=d(l.createElement("a")).attr("href",y).attr("target","_new").text(x);return w},DROPDOWN:function(){var F=this,B=this.jS,y=this.td,E,A,D,x,G,z=0,C;if(y!==null){A=d(y).children().detach()}if(A===undefined||F.needsUpdated||A.length<1){E=c.flatten(arguments);E=c.unique(E);if(this.id!==null){x=this.id+"-dropdown"}else{if(y!==null){x="dropdown"+this.sheetIndex+"_"+this.rowIndex+"_"+this.colIndex+"_"+B.I}}D=l.createElement("select");D.setAttribute("name",x);D.setAttribute("id",x);D.className="jSDropdown";D.cell=this;D.onmouseup=function(){if(this.cell.td!==null){B.cellEdit(this.cell.td)}};D.onchange=function(){F.value=this.value;F.setNeedsUpdated();B.calcDependencies.call(F);B.trigger("sheetCellEdited",[F])};B.controls.inputs[B.i]=B.obj.inputs().add(D);C=(E.length<=50?E.length:50);for(;z<C;z++){if(E[z]){var w=l.createElement("option");w.setAttribute("value",E[z]);w.text=w.innerText=E[z];D.appendChild(w)}}if(!B.s.editable){D.setAttribute("disabled",true)}else{B.s.parent.bind("sheetKill",function(){y.innerText=y.textContent=F.value=D.value})}D.value=F.value||E[0]}if(typeof F.value!=="object"){G=new q(F.value)}else{G=F.value}G.html=D;return G},RADIO:function(){var H=this,C=this.jS,z=this.td,G,B,D,w,y,x,I;if(z!==null){B=d(z).children().detach()}if(B===undefined||B.length<1||H.needsUpdated){G=c.flatten(arguments);G=c.unique(G);D=[];if(this.id!==null){x=this.id+"-radio"}else{if(z!==null){x="radio"+this.sheetIndex+"_"+this.rowIndex+"_"+this.colIndex+"_"+C.I}}B=l.createElement("span");B.className="jSRadio";B.onmousedown=function(){if(this.cell.td!==null){C.cellEdit(this.cell.td)}};B.cell=H;C.controls.inputs[C.i]=C.obj.inputs().add(B);for(var A=0;A<(G.length<=25?G.length:25);A++){if(G[A]){var F=l.createElement("input"),E=l.createElement("span");F.setAttribute("type","radio");F.setAttribute("name",x);F.className=x;F.value=G[A];F.onchange=function(){H.value=jQuery(this).val();C.setCellNeedsUpdated(H);C.calcDependencies.call(H);C.trigger("sheetCellEdited",[H])};D.push(F);if(G[A]==H.value){F.setAttribute("checked","true")}E.textContent=E.innerText=G[A];B.appendChild(F);B.input=F;E.onclick=function(){d(this).prev().click()};B.appendChild(E);B.appendChild(l.createElement("br"))}}w=d(D);if(!C.s.editable){H.value=w.filter(":checked").val();w.attr("disabled",true)}else{C.s.parent.bind("sheetKill",function(){H.value=w.filter(":checked").val();z.textContent=z.innerText=H.value})}}if(typeof H.value!=="object"){I=new q(H.value)}else{I=H.value}I.html=B;return I},CHECKBOX:function(C){if(d.isArray(C)){C=C[0]}var D=this,z=this.jS,x=this.td,y,B,A,w,E;if(x!==null){y=d(x).children().detach()}if(y===undefined||y.length<1||D.needsUpdated){if(this.id!==null){w=this.id+"-checkbox"}else{if(x!==null){w="checkbox"+this.sheet+"_"+this.rowIndex+"_"+this.colIndex+"_"+z.I}}A=l.createElement("input");A.setAttribute("type","checkbox");A.setAttribute("name",w);A.setAttribute("id",w);A.className=w;A.value=C;A.onchange=function(){if(d(this).is(":checked")){D.value=C}else{D.value=""}z.setCellNeedsUpdated(D);z.calcDependencies.call(D);z.trigger("sheetCellEdited",[D])};if(!z.s.editable){A.setAttribute("disabled","true")}else{z.s.parent.bind("sheetKill",function(){D.value=(D.value=="true"||d(A).is(":checked")?C:"");if(D.td!==null){D.td.innerText=D.td.textContent=D.cell.value}})}y=l.createElement("span");y.className="jSCheckbox";y.appendChild(A);B=l.createElement("span");B.textContent=B.innerText=C;y.appendChild(B);y.appendChild(l.createElement("br"));y.onmousedown=function(){if(this.cell.td!==null){z.cellEdit(x)}};y.cell=D;z.controls.inputs[z.i]=z.obj.inputs().add(y);if(C==D.value||D.value==="true"){A.checked=true}}if(D.value==="true"||d(A).is(":checked")){E=new q(C)}else{E=new q("")}E.html=y;return E},BARCHART:function(x,y,z){var w=new q("");w.html=h.chart.call(this,{type:"bar",data:x,legend:y,title:z});return w},HBARCHART:function(x,y,z){var w=new q("");w.html=h.chart.call(this,{type:"hbar",data:x,legend:y,title:z});return w},LINECHART:function(y,x){var w=new q("");w.html=h.chart.call(this,{type:"line",x:{data:y},y:{data:x},title:""});return w},PIECHART:function(x,y,z){var w=new q("");w.html=h.chart.call(this,{type:"pie",data:x,legend:y,title:z});return w},DOTCHART:function(C,A,x,z,y,B){var w=new q("");w.html=h.chart.call(this,{type:"dot",data:(x?x:C),x:{data:C,legend:z},y:{data:(A?A:C),legend:(y?y:z)},title:B});return w},CELLREF:function(w){return(this.jS.spreadsheets[w]?this.jS.spreadsheets[w]:"Cell Reference Not Found")},CALCTIME:function(z,x){z=z||"";x=x||"";var w=this,y=this.jS;this.jS.s.parent.one("sheetCalculation",function(){y.time.last=y.calcLast;w.td.text(z+y.time.diff()+x)});return""},HLOOKUP:function(C,z,y,E){if(C===undefined){return null}var A=this.jS,D,w,F="",x=0,B=z.length;y=y||1;E=E!==undefined?E:true;if(C!==undefined||((isNaN(C)&&C!="#REF!")||C.length===0)){for(;x<B;x++){if(z[x].toString()==C){D=z[x];break}}}else{c.getClosestNum(C,z,function(H,G){if(E){D=H}else{if(H==C){D=H}}})}if(D!==undefined){w=D.cell;w=A.getCell(w.sheetIndex,y,w.columnIndex);if(w!==null){F=w.updateValue()}else{F=""}}else{F=new q();F.html="#N/A"}return F},VLOOKUP:function(C,z,y,E){if(C===undefined){return null}var A=this.jS,D,w,F,x=0,B=z.length;E=E!==undefined?E:true;if((isNaN(C)&&C!="#REF!")||C.length===0){for(;x<B;x++){if(z[x].toString()==C){D=z[x];break}}}else{c.getClosestNum(C,z,function(H,G){if(E){D=H}else{if(H==C){D=H}}})}if(D!==undefined){w=D.cell;w=A.getCell(w.sheetIndex,w.rowIndex,y);if(w!==null){F=w.updateValue()}else{F=""}}else{F=new q();F.html="#N/A"}return F},THISROWCELL:function(w){var x=this.jS;if(isNaN(w)){w=h.columnLabelIndex(w)}return x.getCell(this.sheetIndex,this.rowIndex,w).updateValue()},THISCOLCELL:function(x){var w=this.jS;return w.getCell(this.sheetIndex,x,this.colIndex).updateValue()}};var t={BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,ALT:18,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,C:67,F:70,V:86,X:88,Y:89,Z:90,UNKNOWN:229};var c=f.arrHelpers={math:g,toNumbers:function(w){w=this.flatten(w);var x=w.length-1;if(x<0){return[]}do{if(w[x]){w[x]=d.trim(w[x]);if(isNaN(w[x])){w[x]=0}else{w[x]=w[x]*1}}else{w[x]=0}}while(x--);return w},unique:function(w){var A={},y,x=w.length,z=[];for(y=0;y<x;y+=1){A[w[y]]=w[y]}for(y in A){z.push(A[y])}return z},flatten:function(x){var A=[],z,y=0,w=x.length;for(;y<w;y++){z=x[y];if(z instanceof Array){A=A.concat(this.flatten(z))}else{A=A.concat(z)}}return A},insertAt:function(w,y,x){d(y).each(function(){if(x>-1&&x<=w.length){w.splice(x,0,this)}});return w},closest:function(A,x,y,w){A=A||[];x=x||0;y=y||0;w=w||A.length-1;var z;while(true){z=((y+w)>>1);if(z===w||z===y){return A[z]}if(A[z]>x){w=z}else{if(A[z]<x){y=z}else{return A[z]}}}},getClosestNum:function(y,w,A){var z=0,x,D,C,B;if(w.length){D=w[0];x=z;for(z;z<w.length;z++){C=g.abs(y-D);B=g.abs(y-w[z]);if(B<C){x=z;D=w[z]}C=null;B=null}if(A){return A(D,x)}return D}return false},levenshtein:(function(){var w=[];return function(G,F){if(G===F){return 0}else{var D=G.length,B=F.length;if(D&&B){var y=0,x=0,E,C,A,z,H=w;while(y<D){H[y]=++y}while(x<B){z=F.charCodeAt(x);E=x;++x;C=x;for(y=0;y<D;++y){A=E+(G.charCodeAt(y)===z?0:1);E=H[y];C=C<E?(C<A?C+1:A):(E<A?E+1:A);H[y]=C}}return C}else{return D+B}}}})(),lSearch:function(x,B){var y=0,z,w=x.length,A=-1,C;for(;y<w;y++){z=x[y];C=new u(this.levenshtein(z,B));C.item=z;if(C<A){A=C}}return(C!==undefined?C.item:null)}};var e={dayDiv:86400000,math:g,toCentury:function(w,x){x=x||86400000;return this.math.round(this.math.abs((new a(1900,0,-1))-w)/x)},get:function(x,y){y=y||86400000;if(x.getMonth){return x}else{if(isNaN(x)){return new a(Globalize.parseDate(x))}else{x*=y;var w=(new a(1900,0,-1))*1;x+=w;x=new a(x);return x}}},week:function(w,y){y=y||86400000;var x=new a(w.getFullYear(),0,1);return this.math.ceil((((w-x)/y)+x.getDay()+1)/7)},toString:function(w,x){if(!x){return Globalize.format(w)}return Globalize.format(w,Globalize.culture().calendar.patterns[x])},diff:function(A,x,z,y){y=y||86400000;switch(z){case 0:return this.days360Nasd(A,x,0,true);case 1:case 2:case 3:var w=this.math.abs(x-A)/y;return w;case 4:return this.days360Euro(A,x)}return 0},diffMonths:function(y,x){var w;w=(x.getFullYear()-y.getFullYear())*12;w-=y.getMonth()+1;w+=x.getMonth()+1;return w},days360:function(y,B,z,x,w,A){return((B-y)*360)+((x-z)*30)+(A-w)},days360Nasd:function(x,A,w,y){var z=x.getDate(),E=x.getMonth(),D=x.getFullYear(),C=A.getDate(),B=A.getMonth(),F=A.getFullYear();if((B==2&&this.isEndOfMonth(C,B,F))&&((E==2&&this.isEndOfMonth(z,E,D))||w==3)){C=30}if(C==31&&(z>=30||w==3)){C=30}if(z==31){z=30}if(y&&E==2&&this.isEndOfMonth(z,E,D)){z=30}return this.days360(D,F,E,B,z,C)},days360Euro:function(D,y){var w=D.getDate(),A=D.getMonth(),z=D.getFullYear(),B=y.getDate(),x=y.getMonth(),C=y.getFullYear();if(w==31){w=30}if(B==31){B=30}return this.days360(z,C,A,x,w,B)},isEndOfMonth:function(w,y,x){return w==(new a(x,y+1,0,23,59,59)).getDate()},isLeapYear:function(w){return new a(w,1,29).getMonth()==1},calcAnnualBasis:function(w,y,C){switch(C){case 0:case 2:case 4:return 360;case 3:return 365;case 1:var x=w.getDate(),E=w.getMonth(),B=w.getFullYear(),z=y.getDate(),A=y.getMonth(),F=y.getFullYear(),G=0;if(B==F){if(this.isLeapYear(B)){G=366}else{G=365}}else{if(((F-1)==B)&&((E>A)||((E==A)&&x>=z))){if(this.isLeapYear(B)){if(E<2||(E==2&&x<=29)){G=366}else{G=365}}else{if(this.isLeapYear(F)){if(A>2||(A==2&&z==29)){G=366}else{G=365}}else{G=365}}}else{for(var D=B;D<=F;D++){if(this.isLeapYear(D)){G+=366}else{G+=365}}G=G/(F-B+1)}}return G}return 0},lastDayOfMonth:function(w){w.setDate(0);return w.getDate()},isLastDayOfMonth:function(w){return(w.getDate()==this.lastDayOfMonth(w))}};var i=f.times={math:g,fromMath:function(y){var w={},x=this;w.hour=((y*24)+"").split(".")[0]*1;w.minute=function(z){z=x.math.round(z*24*100)/100;z=(z+"").split(".");var A=0;if(z[1]){if(z[1].length<2){z[1]+="0"}A=z[1]*0.6}return x.math.round(A)}(y);w.second=function(C){C=x.math.round(C*24*10000)/10000;C=(C+"").split(".");var A=0;if(C[1]){for(var B=0;B<4;B++){if(!C[1].charAt(B)){C[1]+="0"}}var z=((C[1]*0.006)+"").split(".");if(z[1]){if(z[1]&&z[1].length>2){z[1]=z[1].substr(0,2)}return x.math.round(z[1]*0.6)}}return A}(y);return w},fromString:function(y,C){var z=new a(),D=y,w,B,A,x,E;if(C){E=D.substr(-2).toLowerCase();D=D.replace(/(am|pm)/i,"")}D=D.split(":");B=D[0]*1;A=D[1]*1;x=(D[2]?D[2]:0)*1;if(C&&E=="pm"){B+=12}return o.TIME(B,A,x)}};d.extend(g,{log10:function(w){return g.log(w)/2.302585092994046},signum:function(w){return(w/g.abs(w))||w},log1p:function(w){var y=0,A=50;if(w<=-1){return"-INF"}if(w<0||w>1){return g.log(1+w)}for(var z=1;z<A;z++){if((z%2)===0){y-=g.pow(w,z)/z}else{y+=g.pow(w,z)/z}}return y}});var m=function(){var C=l,F=d(l.createElement("p")).css({width:"100%",height:"100%"}),E=d(l.createElement("div")).css({position:"absolute",width:"100px",height:"100px",top:"0",left:"0",visibility:"hidden",overflow:"hidden"}).append(F);d(l.body).append(E);var z=F.width(),B=F.height();E.css("overflow","scroll");var x=F.width(),A=F.height();if(z==x&&E[0].clientWidth){x=E[0].clientWidth}if(B==A&&E[0].clientHeight){A=E[0].clientHeight}E.detach();var D=z-x,y=B-A;return{width:D||15,height:y||15}};var j=function(){var w="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",y=d(l.createElement("span")).html(w).appendTo("body"),x={width:y.width()/w.length,height:y.height()};y.remove();return x};var p=function(w,D,A,z,C){z=z||"#"+g.floor(g.random()*16777215).toString(16);if(A){var B=d([]);B=B.add(p(A.left,A.top,null,z,"top-left"));B=B.add(p(A.right,A.top,null,z,"top-right"));B=B.add(p(A.left,A.bottom,null,z,"bottom-left"));B=B.add(p(A.right,A.bottom,null,z,"bottom-right"));return B}return d('<div style="width: 10px; height: 10px; position: absolute;"></div>').css("top",(D-5)+"px").css("left",(w+5)+"px").css("background-color",z).click(function(){console.log(C||"none")}).appendTo("body")};d.printSource=function(y){var x=win.open();x.document.write("<html><body><xmp>"+y+"\n</xmp></body></html>");x.document.close()};if(!Object.getPrototypeOf){Object.getPrototypeOf=function(w){return w||{}}}if(!Array.prototype.indexOf){d.sheet.max=60;Array.prototype.indexOf=function(y,z){for(var x=(z||0),w=this.length;x<w;x++){if(this[x]===y){return x}}return -1}}return k})(jQuery,document,window,Date,String,Number,Boolean,Math,RegExp,Error);var parser=(function(){var U=function(Y,X,Z,W){for(Z=Z||{},W=Y.length;W--;Z[Y[W]]=X){}return Z},m=[1,5],l=[1,6],k=[1,8],j=[1,9],i=[1,10],h=[1,13],f=[1,11],e=[1,12],d=[1,14],c=[1,15],T=[1,20],S=[1,18],R=[1,21],Q=[1,22],P=[1,17],O=[1,24],N=[1,25],M=[1,26],L=[1,27],K=[1,28],J=[1,29],I=[1,30],H=[1,31],G=[1,32],F=[1,33],E=[4,13,14,15,17,18,19,20,21,22,23,24,36,37],D=[1,36],B=[1,37],A=[1,38],z=[4,13,14,15,17,18,19,20,21,22,23,24,36,37,39],y=[4,13,14,15,17,18,19,20,21,22,23,24,36,37,40],x=[4,13,14,15,17,18,19,20,21,22,23,24,30,36,37],w=[4,14,15,17,18,19,20,21,36,37],v=[1,73],u=[4,14,17,18,19,20,36,37],t=[4,14,15,17,18,19,20,21,22,23,36,37],b=[17,36,37];var C={trace:function r(){},yy:{},symbols_:{error:2,expressions:3,EOF:4,expression:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,ESCAPED_STRING:11,LETTERS:12,"&":13,"=":14,"+":15,"(":16,")":17,"<":18,">":19,NOT:20,"-":21,"*":22,"/":23,"^":24,E:25,FUNCTION:26,expseq:27,cellRange:28,cell:29,":":30,SHEET:31,"!":32,NUMBER:33,"$":34,REF:35,";":36,",":37,VARIABLE:38,DECIMAL:39,"%":40,"$accept":0,"$end":1},terminals_:{2:"error",4:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"ESCAPED_STRING",12:"LETTERS",13:"&",14:"=",15:"+",16:"(",17:")",18:"<",19:">",20:"NOT",21:"-",22:"*",23:"/",24:"^",25:"E",26:"FUNCTION",30:":",31:"SHEET",32:"!",33:"NUMBER",34:"$",35:"REF",36:";",37:",",38:"VARIABLE",39:"DECIMAL",40:"%"},productions_:[0,[3,1],[3,2],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,3],[5,3],[5,3],[5,3],[5,4],[5,4],[5,4],[5,3],[5,3],[5,3],[5,3],[5,3],[5,3],[5,3],[5,2],[5,2],[5,1],[5,3],[5,4],[5,1],[28,1],[28,3],[28,3],[28,5],[29,2],[29,3],[29,3],[29,4],[29,1],[29,2],[29,2],[29,2],[29,3],[29,3],[29,3],[29,3],[29,3],[29,3],[29,4],[29,4],[29,4],[27,1],[27,2],[27,2],[27,3],[27,3],[6,1],[6,3],[9,1],[9,3],[9,2]],performAction:function q(Y,ab,o,ac,ad,ae,W){var X=ae.length-1;switch(ad){case 1:return null;break;case 2:return ae[X-1];break;case 3:this.$=ac.handler.variable.apply(ac.obj,ae[X]);break;case 4:this.$=ac.handler.time(ae[X],true);break;case 5:this.$=ac.handler.time(ae[X]);break;case 6:this.$=ac.handler.number(ae[X]);break;case 7:this.$=ae[X].substring(1,ae[X].length-1);break;case 8:this.$=ae[X].substring(2,ae[X].length-2);break;case 9:case 58:this.$=ae[X];break;case 10:this.$=ae[X-2].toString()+ae[X].toString();break;case 11:this.$=ac.handler.callFunction(ac.obj,"EQUAL",[ae[X-2],ae[X]]);break;case 12:this.$=ac.handler.performMath("+",ae[X-2],ae[X]);break;case 13:this.$=ac.handler.number(ae[X-1]);break;case 14:this.$=ac.handler.callFunction(ac.obj,"LESS_EQUAL",[ae[X-3],ae[X]]);break;case 15:this.$=ac.handler.callFunction(ac.obj,"GREATER_EQUAL",[ae[X-3],ae[X]]);break;case 16:this.$=(ae[X-3])!=(ae[X]);if(isNaN(this.$)){this.$=0}break;case 17:this.$=ae[X-2]!=ae[X];break;case 18:this.$=ac.handler.callFunction(ac.obj,"GREATER",[ae[X-2],ae[X]]);break;case 19:this.$=ac.handler.callFunction(ac.obj,"LESS",[ae[X-2],ae[X]]);break;case 20:this.$=ac.handler.performMath("-",ae[X-2],ae[X]);break;case 21:this.$=ac.handler.performMath("*",ae[X-2],ae[X]);break;case 22:this.$=ac.handler.performMath("/",ae[X-2],ae[X]);break;case 23:var aa=ac.handler.number(ae[X-2]),Z=ac.handler.number(ae[X]);this.$=ac.handler.performMath("^",ae[X-2],ae[X]);break;case 24:var aa=ac.handler.numberInverted(ae[X]);this.$=aa;if(isNaN(this.$)){this.$=0}break;case 25:var aa=ac.handler.number(ae[X]);this.$=aa;if(isNaN(this.$)){this.$=0}break;case 26:break;case 27:this.$=ac.handler.callFunction(ac.obj,ae[X-2]);break;case 28:this.$=ac.handler.callFunction(ac.obj,ae[X-3],ae[X-1]);break;case 30:this.$=ac.handler.cellValue(ac.obj,ae[X]);break;case 31:this.$=ac.handler.cellRangeValue(ac.obj,ae[X-2],ae[X]);break;case 32:this.$=ac.handler.remoteCellValue(ac.obj,ae[X-2],ae[X]);break;case 33:this.$=ac.handler.remoteCellRangeValue(ac.obj,ae[X-4],ae[X-2],ae[X]);break;case 34:this.$={colString:ae[X-1],rowString:ae[X]};break;case 35:this.$={colString:ae[X-1],rowString:ae[X]};break;case 36:case 37:this.$={colString:ae[X-2],rowString:ae[X]};break;case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:return"#REF!";break;case 51:this.$=[ae[X]];break;case 54:ae[X-2].push(ae[X]);this.$=ae[X-2];break;case 55:ae[X-2].push(ae[X]);this.$=ae[X-2];break;case 56:this.$=[ae[X]];break;case 57:this.$=($.isArray(ae[X-2])?ae[X-2]:[ae[X-2]]);this.$.push(ae[X]);break;case 59:this.$=(ae[X-2]+"."+ae[X])*1;break;case 60:this.$=ae[X-1]*0.01;break}},table:[{3:1,4:[1,2],5:3,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{1:[3]},{1:[2,1]},{4:[1,23],13:O,14:N,15:M,18:L,19:K,20:J,21:I,22:H,23:G,24:F},U(E,[2,3],{39:[1,34]}),U(E,[2,4]),U(E,[2,5]),U(E,[2,6],{40:[1,35]}),U(E,[2,7]),U(E,[2,8]),U(E,[2,9],{33:D,34:B,35:A}),{5:39,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:40,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:41,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},U(E,[2,26]),{16:[1,42]},U(E,[2,29]),U(z,[2,56]),U(y,[2,58],{39:[1,43]}),U(E,[2,30],{30:[1,44]}),{32:[1,45]},{12:[1,46],35:[1,47]},U(x,[2,38],{33:[1,48],34:[1,50],35:[1,49]}),{1:[2,2]},{5:51,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:52,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:53,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:56,6:4,7:m,8:l,9:7,10:k,11:j,12:i,14:[1,54],15:h,16:f,19:[1,55],21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:58,6:4,7:m,8:l,9:7,10:k,11:j,12:i,14:[1,57],15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:59,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:60,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:61,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:62,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:63,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{38:[1,64]},U(y,[2,60]),U(x,[2,34]),{33:[1,65],35:[1,66]},U(x,[2,40]),{13:O,14:N,15:M,17:[1,67],18:L,19:K,20:J,21:I,22:H,23:G,24:F},U(w,[2,24],{13:O,22:H,23:G,24:F}),U(w,[2,25],{13:O,22:H,23:G,24:F}),{5:70,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,17:[1,68],21:e,25:d,26:c,27:69,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{33:[1,71]},{12:v,29:72,34:R,35:Q},{12:v,29:74,34:R,35:Q},{33:[1,75],34:[1,76],35:[1,77]},{33:[1,78],34:[1,80],35:[1,79]},U(x,[2,39]),U(x,[2,41]),{33:[1,81],35:[1,82]},U([4,17,36,37],[2,10],{13:O,14:N,15:M,18:L,19:K,20:J,21:I,22:H,23:G,24:F}),U([4,14,17,36,37],[2,11],{13:O,15:M,18:L,19:K,20:J,21:I,22:H,23:G,24:F}),U(w,[2,12],{13:O,22:H,23:G,24:F}),{5:83,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},{5:84,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},U(u,[2,19],{13:O,15:M,21:I,22:H,23:G,24:F}),{5:85,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:T,33:S,34:R,35:Q,38:P},U(u,[2,18],{13:O,15:M,21:I,22:H,23:G,24:F}),U([4,14,17,20,36,37],[2,17],{13:O,15:M,18:L,19:K,21:I,22:H,23:G,24:F}),U(w,[2,20],{13:O,22:H,23:G,24:F}),U(t,[2,21],{13:O,24:F}),U(t,[2,22],{13:O,24:F}),U([4,14,15,17,18,19,20,21,22,23,24,36,37],[2,23],{13:O}),U(z,[2,57]),U(x,[2,36]),U(x,[2,46]),U(E,[2,13]),U(E,[2,27]),{17:[1,86],36:[1,87],37:[1,88]},U(b,[2,51],{13:O,14:N,15:M,18:L,19:K,20:J,21:I,22:H,23:G,24:F}),U(y,[2,59]),U(E,[2,31]),{33:D,34:B,35:A},U(E,[2,32],{30:[1,89]}),U(x,[2,35]),{33:[1,90]},U(x,[2,43]),U(x,[2,42]),U(x,[2,44]),{33:[1,91],35:[1,92]},U(x,[2,45]),U(x,[2,47]),U(u,[2,14],{13:O,15:M,21:I,22:H,23:G,24:F}),U(u,[2,16],{13:O,15:M,21:I,22:H,23:G,24:F}),U(u,[2,15],{13:O,15:M,21:I,22:H,23:G,24:F}),U(E,[2,28]),U(b,[2,52],{6:4,9:7,28:16,29:19,5:93,7:m,8:l,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,31:T,33:S,34:R,35:Q,38:P}),U(b,[2,53],{6:4,9:7,28:16,29:19,5:94,7:m,8:l,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,31:T,33:S,34:R,35:Q,38:P}),{12:v,29:95,34:R,35:Q},U(x,[2,37]),U(x,[2,48]),U(x,[2,50]),U(b,[2,54],{13:O,14:N,15:M,18:L,19:K,20:J,21:I,22:H,23:G,24:F}),U(b,[2,55],{13:O,14:N,15:M,18:L,19:K,20:J,21:I,22:H,23:G,24:F}),U(E,[2,33])],defaultActions:{2:[2,1],23:[2,2]},parseError:function g(W,o){if(o.recoverable){this.trace(W)}else{throw new Error(W)}},parse:function p(ah){var ap=this,ae=[0],ao=[],aA=[null],aj=[],aC=this.table,X="",ai=0,ay=0,Z=0,ag=2,an=1;var aa=aj.slice.call(arguments,1);var o=Object.create(this.lexer);var aB={yy:{}};for(var ax in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,ax)){aB.yy[ax]=this.yy[ax]}}o.setInput(ah,aB.yy);aB.yy.lexer=o;aB.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var Y=o.yylloc;aj.push(Y);var ab=o.options&&o.options.ranges;if(typeof aB.yy.parseError==="function"){this.parseError=aB.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function am(aF){ae.length=ae.length-2*aF;aA.length=aA.length-aF;aj.length=aj.length-aF}_token_stack:function al(){var aF;aF=o.lex()||an;if(typeof aF!=="number"){aF=ap.symbols_[aF]||aF}return aF}var aw,ar,ad,av,aE,ak,au={},aq,az,W,af;while(true){ad=ae[ae.length-1];if(this.defaultActions[ad]){av=this.defaultActions[ad]}else{if(aw===null||typeof aw=="undefined"){aw=al()}av=aC[ad]&&aC[ad][aw]}_handle_error:if(typeof av==="undefined"||!av.length||!av[0]){var ac;var at="";function aD(aG){var aF=ae.length-1;var aH=0;for(;;){if((ag.toString()) in aC[aG]){return aH}if(aG===0||aF<2){return false}aF-=2;aG=ae[aF];++aH}}if(!Z){ac=aD(ad);af=[];for(aq in aC[ad]){if(this.terminals_[aq]&&aq>ag){af.push("'"+this.terminals_[aq]+"'")}}if(o.showPosition){at="Parse error on line "+(ai+1)+":\n"+o.showPosition()+"\nExpecting "+af.join(", ")+", got '"+(this.terminals_[aw]||aw)+"'"}else{at="Parse error on line "+(ai+1)+": Unexpected "+(aw==an?"end of input":("'"+(this.terminals_[aw]||aw)+"'"))}return this.parseError(at,{text:o.match,token:this.terminals_[aw]||aw,line:o.yylineno,loc:Y,expected:af,recoverable:(ac!==false)})}else{if(ar!==an){ac=aD(ad)}}if(Z==3){if(aw===an||ar===an){throw new Error(at||"Parsing halted while starting to recover from another error.")}ay=o.yyleng;X=o.yytext;ai=o.yylineno;Y=o.yylloc;aw=al()}if(ac===false){throw new Error(at||"Parsing halted. No suitable error recovery rule available.")}am(ac);ar=(aw==ag?null:aw);aw=ag;ad=ae[ae.length-1];av=aC[ad]&&aC[ad][ag];Z=3}if(av[0] instanceof Array&&av.length>1){throw new Error("Parse Error: multiple actions possible at state: "+ad+", token: "+aw)}switch(av[0]){case 1:ae.push(aw);aA.push(o.yytext);aj.push(o.yylloc);ae.push(av[1]);aw=null;if(!ar){ay=o.yyleng;X=o.yytext;ai=o.yylineno;Y=o.yylloc;if(Z>0){Z--}}else{aw=ar;ar=null}break;case 2:az=this.productions_[av[1]][1];au.$=aA[aA.length-az];au._$={first_line:aj[aj.length-(az||1)].first_line,last_line:aj[aj.length-1].last_line,first_column:aj[aj.length-(az||1)].first_column,last_column:aj[aj.length-1].last_column};if(ab){au._$.range=[aj[aj.length-(az||1)].range[0],aj[aj.length-1].range[1]]}ak=this.performAction.apply(au,[X,ay,ai,aB.yy,av[1],aA,aj].concat(aa));if(typeof ak!=="undefined"){return ak}if(az){ae=ae.slice(0,-1*az*2);aA=aA.slice(0,-1*az);aj=aj.slice(0,-1*az)}ae.push(this.productions_[av[1]][0]);aA.push(au.$);aj.push(au._$);W=aC[ae[ae.length-2]][ae[ae.length-1]];ae.push(W);break;case 3:return true}}return true}};if(typeof(window)!=="undefined"){window.Formula=function(X){var Y=function(){};Y.prototype=C.lexer;var W=function(){this.lexer=new Y();this.yy={parseError:function(ab,aa){this.done=true;var Z=new String();Z.html="<pre>"+ab+"</pre>";Z.hash=aa;return Z},lexerError:function(ab,aa){this.done=true;var Z=new String();Z.html="<pre>"+ab+"</pre>";Z.hash=aa;return Z}}};W.prototype=C;var o=new W;o.setObj=function(Z){o.yy.obj=Z};o.yy.handler=X;return o}}var V=(function(){var X=({EOF:1,parseError:function Y(ag,af){if(this.yy.parser){this.yy.parser.parseError(ag,af)}else{throw new Error(ag)}},setInput:function(af,ag){this.yy=ag||this.yy||{};this._input=new a.InputReader(af);this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var ag=this._input.ch();this.yytext+=ag;this.yyleng++;this.offset++;this.match+=ag;var af=ag.match(/(?:\r\n?|\n).*/g);if(af){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}return ag},unput:function(ah){var af=ah.length;var ag=ah.split(/(?:\r\n?|\n)/g);this._input.unCh(af,ah);this.yytext=this.yytext.substr(0,this.yytext.length-af);this.offset-=af;var aj=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);if(ag.length-1){this.yylineno-=ag.length-1}var ai=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:ag?(ag.length===aj.length?this.yylloc.first_column:0)+aj[aj.length-ag.length].length-ag[0].length:this.yylloc.first_column-af};if(this.options.ranges){this.yylloc.range=[ai[0],ai[0]+this.yyleng-af]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(af){this.unput(this.match.slice(af))},pastInput:function(){var af=this._input.toString();var ag=af.substr(0,af.length-this.match.length);return(ag.length>20?"...":"")+ag.substr(-20).replace(/\n/g,"")},upcomingInput:function(){if(!this.done){var af=this.match;if(af.length<20){af+=this._input.toString().substr(0,20-af.length)}return(af.substr(0,20)+(af.length>20?"...":"")).replace(/\n/g,"")}return""},showPosition:function(){var af=this.pastInput();var ag=new Array(af.length+1).join("-");return af+this.upcomingInput()+"\n"+ag+"^"},test_match:function(aj,ah){var ak,af,ai,ag;if(this.options.backtrack_lexer){ai={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,yyleng:this.yyleng,offset:this.offset,_more:this._more,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){ai.yylloc.range=this.yylloc.range.slice(0)}}af=aj.match(/(?:\r\n?|\n).*/g);if(af){this.yylineno+=af.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:af!==null?af[af.length-1].length-af[af.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+aj.length};this.yytext+=aj;this.match+=aj;this.matches=aj;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input.addMatch(aj);ak=this.performAction.call(this,this.yy,this,ah,this.conditionStack[this.conditionStack.length-1]);if(this.done&&!this._input.done){this.done=false}if(ak){return ak}else{if(this._backtrack){for(ag in ai){if(ai.hasOwnProperty(ag)){this[ag]=ai[ag]}}return null}}return null},next:function(){if(this.done){return this.EOF}if(this._input.done){this.done=true}var aj,ah,af,ag;if(!this._more){this.yytext="";this.match=""}var ak=this._currentRules();for(var ai=0;ai<ak.length;ai++){af=this._input.match(this.rules[ak[ai]]);if(af!==null&&(ah===undefined||af[0].length>ah.length)){ah=af[0];ag=ai;if(this.options.backtrack_lexer){aj=this.test_match(af[0],ak[ai]);if(aj!==null){return aj}else{if(this._backtrack){ah=undefined;continue}else{return null}}}else{if(!this.options.flex){break}}}}if(ah!==undefined){aj=this.test_match(ah,ak[ag]);if(aj!==null){return aj}return null}if(this._input.done){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var af=this.next();if(af!==null){return af}else{return this.lex()}},begin:function W(af){this.conditionStack.push(af)},popState:function Z(){var af=this.conditionStack.length-1;if(af>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function ae(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function ac(af){af=this.conditionStack.length-1-Math.abs(af||0);if(af>=0){return this.conditionStack[af]}else{return"INITIAL"}},pushState:function ab(af){this.begin(af)},stateStackSize:function aa(){return this.conditionStack.length},options:{},performAction:function ad(aj,ag,ai,af){var ah=af;switch(ai){case 0:break;case 1:return 26;break;case 2:return 7;break;case 3:return 8;break;case 4:if(aj.obj.typeName=="Sheet.Cell"){return 31}return 38;break;case 5:ag.yytext=ag.yytext.substring(1,ag.yytext.length-1);if(aj.obj.typeName=="Sheet.Cell"){return 31}return 38;break;case 6:return 10;break;case 7:return 10;break;case 8:return 11;break;case 9:return 11;break;case 10:return 12;break;case 11:return 38;break;case 12:return 38;break;case 13:return 33;break;case 14:return 34;break;case 15:return 13;break;case 16:return" ";break;case 17:return 39;break;case 18:return 30;break;case 19:return 36;break;case 20:return 37;break;case 21:return 22;break;case 22:return 23;break;case 23:return 21;break;case 24:return 15;break;case 25:return 24;break;case 26:return 16;break;case 27:return 17;break;case 28:return 19;break;case 29:return 18;break;case 30:return 20;break;case 31:return"PI";break;case 32:return 25;break;case 33:return'"';break;case 34:return"'";break;case 35:return'"';break;case 36:return"'";break;case 37:return"!";break;case 38:return 14;break;case 39:return 40;break;case 40:return 35;break;case 41:return"#";break;case 42:return 4;break}},rules:[/^(?:\s+)/,/^(?:([A-Za-z]{1,})([A-Za-z_0-9]+)?(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:(([A-Za-z0-9]+))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])|(["](\\["]|[^"])*["]))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])))/,/^(?:((["](\\["]|[^"])*["])))/,/^(?:(([\\]['].+?[\\]['])))/,/^(?:(([\\]["].+?[\\]["])))/,/^(?:[A-Z]+(?=[0-9$]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\$)/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:PI\b)/,/^(?:E\b)/,/^(?:")/,/^(?:')/,/^(?:\\")/,/^(?:\\')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:#REF!)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:true}}});return X})();C.lexer=V;function a(){this.yy={}}a.prototype=C;a.InputReader=(function(X,W,aa){var Z=RegExp.prototype.sticky!==undefined,ai,af,ag,ab;function aj(ak){this.done=false;this.input=ak;this.length=ak.length;this.matches=[];this.position=0}if(Z){aj.prototype={addMatch:function ah(ak){this.matches.push(ak);this.position+=ak.length;this.done=(this.position>=this.length)},ch:function o(){var ak=this.input[this.position];this.addMatch(ak);return ak},unCh:function ae(ak){this.position-=ak;this.position=X.max(0,this.position);this.done=(this.position>=this.length)},substring:function ad(al,ak){al=(al!=0?this.position+al:this.position);ak=(ak!=0?al+ak:this.length);return this.input.substring(al,ak)},match:function ac(al){var ak;al.lastIndex=this.position;if((ak=al.exec(this.input))!==null){return ak}return null},toString:function Y(){return this.matches.join("")}};ai=aa.rules;ag=ai.length;ab=0;for(;ab<ag;ab++){af=ai[ab];ai[ab]=new RegExp(af.source.substring(1),"y")}}else{aj.prototype={addMatch:function ah(ak){this.input=this.input.slice(ak.length);this.matches.push(ak);this.position+=ak.length;this.done=(this.position>=this.length)},ch:function o(){var ak=this.input[0];this.addMatch(ak);return ak},unCh:function ae(al,ak){this.position-=al;this.position=X.max(0,this.position);this.input=ak+this.input;this.done=(this.position>=this.length)},substring:function ad(al,ak){al=(al!=0?this.position+al:this.position);ak=(ak!=0?al+ak:this.length);return this.input.substring(al,ak)},match:function ac(am){var al,ak=this.input;if((al=ak.match(am))!==null){return al}return null},toString:function Y(){return this.matches.join("")}}}return aj})(Math,C,V);C.Parser=a;return new a})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}}var parser=(function(){var p=function(y,x,z,w){for(z=z||{},w=y.length;w--;z[y[w]]=x){}return z},l=[1,10],j=[1,11],i=[1,12],h=[1,13],g=[5,7,8,9,10],f=[1,19],c=[1,20],a=[5,7,8,9,10,12,13],u=[1,21],t=[5,7,8,9,10,12,13,14,16];var k={trace:function q(){},yy:{},symbols_:{error:2,grid:3,rows:4,EOF:5,row:6,END_OF_LINE:7,END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN:8,END_OF_LINE_WITH_NO_COLUMNS:9,END_OF_LINE_WITH_EMPTY_COLUMN:10,string:11,COLUMN_EMPTY:12,COLUMN_STRING:13,CHAR:14,QUOTE_ON:15,QUOTE_OFF:16,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",7:"END_OF_LINE",8:"END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN",9:"END_OF_LINE_WITH_NO_COLUMNS",10:"END_OF_LINE_WITH_EMPTY_COLUMN",12:"COLUMN_EMPTY",13:"COLUMN_STRING",14:"CHAR",15:"QUOTE_ON",16:"QUOTE_OFF"},productions_:[0,[3,2],[3,1],[4,1],[4,1],[4,1],[4,1],[4,1],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[6,1],[6,1],[6,2],[6,3],[6,1],[6,2],[6,3],[11,1],[11,2],[11,3]],performAction:function e(o,x,y,B,A,w,z){var v=w.length-1;switch(A){case 1:return w[v-1];break;case 2:return[[""]];break;case 3:this.$=[w[v]];break;case 4:this.$=[];break;case 5:this.$=[""];break;case 6:this.$=[""];break;case 7:this.$=[""];break;case 8:this.$=w[v-1];break;case 9:w[v-1].push([""]);this.$=w[v-1];break;case 10:w[v-1].push([""]);this.$=w[v-1];break;case 11:w[v-1][w[v-1].length-1].push("");this.$=w[v-1];break;case 12:w[v-2].push(w[v]);this.$=w[v-2];break;case 13:w[v].unshift("");w[v-2].push(w[v]);this.$=w[v-2];break;case 14:w[v-2].push([""]);w[v-2].push(w[v]);this.$=w[v-2];break;case 15:w[v-2][w[v-2].length-1].push("");w[v-2].push(w[v]);this.$=w[v-2];break;case 16:this.$=[w[v].join("")];break;case 17:this.$=[""];break;case 18:w[v-1].push("");this.$=w[v-1];break;case 19:w[v-2].push("");w[v-2].push(w[v].join(""));this.$=w[v-2];break;case 20:break;case 21:break;case 22:w[v-2].push(w[v].join(""));this.$=w[v-2];break;case 23:this.$=[w[v]];break;case 24:w[v-1].push(w[v]);this.$=w[v-1];break;case 25:this.$=w[v-1];break}},table:[{3:1,4:2,5:[1,3],6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:l,13:j,14:i,15:h},{1:[3]},{5:[1,14],7:[1,15],8:[1,16],9:[1,17],10:[1,18]},{1:[2,2]},p(g,[2,3],{12:f,13:c}),p(g,[2,4]),p(g,[2,5]),p(g,[2,6]),p(g,[2,7]),p(a,[2,16],{14:u}),p(a,[2,17]),p(a,[2,20]),p(t,[2,23]),{11:22,14:i,15:h},{1:[2,1]},p(g,[2,8],{11:9,6:23,12:l,13:j,14:i,15:h}),p(g,[2,9],{11:9,6:24,12:l,13:j,14:i,15:h}),p(g,[2,10],{11:9,6:25,12:l,13:j,14:i,15:h}),p(g,[2,11],{11:9,6:26,12:l,13:j,14:i,15:h}),p(a,[2,18],{11:27,14:i,15:h}),p(a,[2,21],{11:28,14:i,15:h}),p(t,[2,24]),{14:u,16:[1,29]},p(g,[2,12],{12:f,13:c}),p(g,[2,13],{12:f,13:c}),p(g,[2,14],{12:f,13:c}),p(g,[2,15],{12:f,13:c}),p(a,[2,19],{14:u}),p(a,[2,22],{14:u}),p(t,[2,25])],defaultActions:{3:[2,2],14:[2,1]},parseError:function r(v,o){if(o.recoverable){this.trace(v)}else{throw new Error(v)}},parse:function m(F){var N=this,C=[0],M=[],X=[null],H=[],Z=this.table,w="",G=0,V=0,y=0,E=2,L=1;var z=H.slice.call(arguments,1);var o=Object.create(this.lexer);var Y={yy:{}};for(var U in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,U)){Y.yy[U]=this.yy[U]}}o.setInput(F,Y.yy);Y.yy.lexer=o;Y.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var x=o.yylloc;H.push(x);var A=o.options&&o.options.ranges;if(typeof Y.yy.parseError==="function"){this.parseError=Y.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function K(ab){C.length=C.length-2*ab;X.length=X.length-ab;H.length=H.length-ab}_token_stack:function J(){var ab;ab=o.lex()||L;if(typeof ab!=="number"){ab=N.symbols_[ab]||ab}return ab}var T,P,B,S,aa,I,R={},O,W,v,D;while(true){B=C[C.length-1];if(this.defaultActions[B]){S=this.defaultActions[B]}else{if(T===null||typeof T=="undefined"){T=J()}S=Z[B]&&Z[B][T]}if(typeof S==="undefined"||!S.length||!S[0]){var Q="";D=[];for(O in Z[B]){if(this.terminals_[O]&&O>E){D.push("'"+this.terminals_[O]+"'")}}if(o.showPosition){Q="Parse error on line "+(G+1)+":\n"+o.showPosition()+"\nExpecting "+D.join(", ")+", got '"+(this.terminals_[T]||T)+"'"}else{Q="Parse error on line "+(G+1)+": Unexpected "+(T==L?"end of input":"'"+(this.terminals_[T]||T)+"'")}this.parseError(Q,{text:o.match,token:this.terminals_[T]||T,line:o.yylineno,loc:x,expected:D})}if(S[0] instanceof Array&&S.length>1){throw new Error("Parse Error: multiple actions possible at state: "+B+", token: "+T)}switch(S[0]){case 1:C.push(T);X.push(o.yytext);H.push(o.yylloc);C.push(S[1]);T=null;if(!P){V=o.yyleng;w=o.yytext;G=o.yylineno;x=o.yylloc;if(y>0){y--}}else{T=P;P=null}break;case 2:W=this.productions_[S[1]][1];R.$=X[X.length-W];R._$={first_line:H[H.length-(W||1)].first_line,last_line:H[H.length-1].last_line,first_column:H[H.length-(W||1)].first_column,last_column:H[H.length-1].last_column};if(A){R._$.range=[H[H.length-(W||1)].range[0],H[H.length-1].range[1]]}I=this.performAction.apply(R,[w,V,G,Y.yy,S[1],X,H].concat(z));if(typeof I!=="undefined"){return I}if(W){C=C.slice(0,-1*W*2);X=X.slice(0,-1*W);H=H.slice(0,-1*W)}C.push(this.productions_[S[1]][0]);X.push(R.$);H.push(R._$);v=Z[C[C.length-2]][C[C.length-1]];C.push(v);break;case 3:return true}}return true}};if(typeof GLOBAL!=="undefined"){GLOBAL.window=GLOBAL}if(typeof window.TSV==="undefined"){var m=k.parse;k.parse=function(o){var v=this.lexer.setInput;this.lexer.setInput=function(w){v.call(this,w);this.begin("BOF");return this};this.parse=m;return m.call(this,o)};window.TSV=function(v){var x=function(){};x.prototype=k.lexer;var w=function(){this.lexer=new x();this.yy={}};w.prototype=k;var o=new w;o.setObj=function(y){o.yy.obj=y};o.yy.handler=v;return o}}var b=(function(){var w=({EOF:1,parseError:function x(F,E){if(this.yy.parser){this.yy.parser.parseError(F,E)}else{throw new Error(F)}},setInput:function(E,F){this.yy=F||this.yy||{};this._input=E;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var F=this._input[0];this.yytext+=F;this.yyleng++;this.offset++;this.match+=F;this.matched+=F;var E=F.match(/(?:\r\n?|\n).*/g);if(E){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return F},unput:function(G){var E=G.length;var F=G.split(/(?:\r\n?|\n)/g);this._input=G+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-E);this.offset-=E;var I=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(F.length-1){this.yylineno-=F.length-1}var H=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:F?(F.length===I.length?this.yylloc.first_column:0)+I[I.length-F.length].length-F[0].length:this.yylloc.first_column-E};if(this.options.ranges){this.yylloc.range=[H[0],H[0]+this.yyleng-E]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(E){this.unput(this.match.slice(E))},pastInput:function(){var E=this.matched.substr(0,this.matched.length-this.match.length);return(E.length>20?"...":"")+E.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var E=this.match;if(E.length<20){E+=this._input.substr(0,20-E.length)}return(E.substr(0,20)+(E.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var E=this.pastInput();var F=new Array(E.length+1).join("-");return E+this.upcomingInput()+"\n"+F+"^"},test_match:function(I,G){var J,E,H;if(this.options.backtrack_lexer){H={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){H.yylloc.range=this.yylloc.range.slice(0)}}E=I[0].match(/(?:\r\n?|\n).*/g);if(E){this.yylineno+=E.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:E?E[E.length-1].length-E[E.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+I[0].length};this.yytext+=I[0];this.match+=I[0];this.matches=I;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(I[0].length);this.matched+=I[0];J=this.performAction.call(this,this.yy,this,G,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(J){return J}else{if(this._backtrack){for(var F in H){this[F]=H[F]}return false}}return false},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var I,G,E,F;if(!this._more){this.yytext="";this.match=""}var J=this._currentRules();for(var H=0;H<J.length;H++){E=this._input.match(this.rules[J[H]]);if(E&&(!G||E[0].length>G[0].length)){G=E;F=H;if(this.options.backtrack_lexer){I=this.test_match(E,J[H]);if(I!==false){return I}else{if(this._backtrack){G=false;continue}else{return false}}}else{if(!this.options.flex){break}}}}if(G){I=this.test_match(G,J[F]);if(I!==false){return I}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var E=this.next();if(E){return E}else{return this.lex()}},begin:function v(E){this.conditionStack.push(E)},popState:function y(){var E=this.conditionStack.length-1;if(E>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function D(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function B(E){E=this.conditionStack.length-1-Math.abs(E||0);if(E>=0){return this.conditionStack[E]}else{return"INITIAL"}},pushState:function A(E){this.begin(E)},stateStackSize:function z(){return this.conditionStack.length},options:{},performAction:function C(I,F,H,E){var G=E;switch(H){case 0:return 14;break;case 1:this.popState();return 16;break;case 2:if(F.yytext==this.quoteChar){this.popState();this.begin("STRING");return 16}else{return 14}break;case 3:this.popState();this.begin("STRING");return 14;break;case 4:this.popState();this.quoteChar=F.yytext.substring(0);this.begin("QUOTE");return 15;break;case 5:this.quoteChar=F.yytext;this.popState();this.begin("QUOTE");return 15;break;case 6:this.begin("PRE_QUOTE");return 13;break;case 7:this.begin("PRE_QUOTE");return 7;break;case 8:return 14;break;case 9:this.popState();return 8;break;case 10:this.popState();return 9;break;case 11:this.popState();return 7;break;case 12:this.popState();return 13;break;case 13:return 14;break;case 14:this.popState();break;case 15:return"BUFFIN";break;case 16:return 9;break;case 17:return 10;break;case 18:return 12;break;case 19:return 7;break;case 20:this.begin("STRING");return 14;break;case 21:return 5;break}},rules:[/^(?:(\n|\\n))/,/^(?:([\'\"])(?=$))/,/^(?:([\'\"]))/,/^(?:(?=(\t)))/,/^(?:([\'\"]))/,/^(?:([\'\"]))/,/^(?:(\t|\\t)(?=[\'\"]))/,/^(?:(\n|\\n)(?=[\'\"]))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:(\n\t|\\n\\t))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\n|\\n))/,/^(?:(\t|\\t))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:)/,/^(?:(\n\t|\\n\\t)(?=.))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\t\n))/,/^(?:(\t))/,/^(?:(\n))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:$)/],conditions:{BOF:{rules:[4,6,7,14,15,16,17,18,19,20,21],inclusive:true},PRE_QUOTE:{rules:[5,6,7,15,16,17,18,19,20,21],inclusive:true},QUOTE:{rules:[0,1,2,3,6,7,8,15,16,17,18,19,20,21],inclusive:true},STRING:{rules:[6,7,9,10,11,12,13,15,16,17,18,19,20,21],inclusive:true},INITIAL:{rules:[6,7,15,16,17,18,19,20,21],inclusive:true}}});return w})();k.lexer=b;function d(){this.yy={}}d.prototype=k;k.Parser=d;return new d})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}};