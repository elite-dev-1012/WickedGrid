var jQuery=window.jQuery||{};var Sheet=(function(d,k,f,a,o,r,s,g,b,p){var j={defaultTheme:0,themeRollerTheme:0,bootstrapTheme:1,customTheme:2,excelSelectModel:0,googleDriveSelectModel:1,openOfficeSelectModel:2};j.CellRange=(function(){function t(u){this.cells=u||[]}t.prototype={clone:function(){var y=[],w=this.cells,v=w.length,u,z;for(var x=0;x<v;x++){u=w[x];z={value:u.value,formula:u.formula,td:u.td,dependencies:u.dependencies,needsUpdated:u.needsUpdated,calcCount:u.calcCount,sheet:u.sheet,calcLast:u.calcLast,html:u.html,state:u.state,jS:u.jS,calcDependenciesLast:u.calcDependenciesLast,style:u.style,cl:u.cl,id:u.id};y.push(z)}return new t(y)}};return t})();j.ActionUI=(function(t,w,u,v,x){var y=function(E,I,O,F,A,K){this.enclosure=E;this.pane=I;this.table=O;this.max=K;this.xIndex=0;this.yIndex=0;this.scrollAxis={x:{},y:{}};this.scrollSize={};this.hiddenColumns=[];this.hiddenRows=[];if(!(this.frozenAt=A)){this.frozenAt={row:0,col:0}}this.frozenAt.row=u.max(this.frozenAt.row,0);this.frozenAt.col=u.max(this.frozenAt.col,0);this.scrolledArea={start:{row:u.max(this.frozenAt.row,1),col:u.max(this.frozenAt.col,1)},end:{row:u.max(this.frozenAt.row,1),col:u.max(this.frozenAt.col,1)}};var D=this,H="#"+O.getAttribute("id"),P=this.scrollUI=I.scrollOuter=t.createElement("div"),M=I.scrollInner=t.createElement("div"),C=I.scrollStyleX=this.scrollStyleX=new j.StyleUpdater(function(S,T){S=S||[];if(S.length!==D.xIndex||T){D.xIndex=S.length||D.xIndex;T=T||this.nthCss("col",H,S,D.frozenAt.col+1)+this.nthCss("*",H+" tr",S,D.frozenAt.col+1);this.setStyle(T);if(S.length){D.scrolledArea.start.col=u.max(S.pop()||1,1);D.scrolledArea.end.col=u.max(S.shift()||1,1)}return true}return false},K),B=I.scrollStyleY=this.scrollStyleY=new j.StyleUpdater(function(S,T){S=S||[];if(S.length!==D.yIndex||T){D.yIndex=S.length||D.yIndex;T=T||this.nthCss("tr",H,S,D.frozenAt.row+1);this.setStyle(T);if(S.length){D.scrolledArea.start.row=u.max(S.pop()||1,1);D.scrolledArea.end.row=u.max(S.shift()||1,1)}return true}return false});P.setAttribute("class",F);P.appendChild(M);x(P).disableSelectionSpecial();I.appendChild(C.styleElement);I.appendChild(B.styleElement);var L,Q,N,R,G,J,z=O.tBody.children[0];I.resizeScroll=function(S){if(S){L=C.getStyle();Q=B.getStyle()}else{L=(O.clientWidth<=E.clientWidth?"":C.getStyle());Q=(O.clientHeight<=E.clientHeight?"":B.getStyle())}C.update(null," ");B.update(null," ");if(z===undefined){z=O.tBody.children[0]}N=(z.clientWidth||O.clientWidth)+"px";R=O.clientHeight+"px";G=E.clientWidth+"px";J=E.clientHeight+"px";M.style.width=N;M.style.height=R;P.style.width=G;P.style.height=J;D.scrollStart("x");D.scrollStart("y");C.update(null,L);B.update(null,Q);if(I.inPlaceEdit){I.inPlaceEdit.goToTd()}};new MouseWheel(I,P)};y.prototype={putTdInView:function(E){var A=0,z=0,D=0,C,B;this.xIndex=0;this.yIndex=0;while((C=this.directionToSeeTd(E))!==null){B=this.scrolledArea.end;if(C.left){z--;this.scrollTo({axis:"x",value:B.col-1})}else{if(C.right){z++;this.scrollTo({axis:"x",value:B.col+1})}}if(C.up){D--;this.scrollTo({axis:"y",value:B.row-1})}else{if(C.down){D++;this.scrollTo({axis:"y",value:B.row+1})}}A++;if(A<25){break}this.scrollStop()}},directionToSeeTd:function(A){var z=this.pane,J={top:0,bottom:z.clientHeight,left:0,right:z.clientWidth},F=A.clientWidth,D=A.clientHeight,H={top:A.offsetTop,bottom:A.offsetTop+D,left:A.offsetLeft,right:A.offsetLeft+F},B=A.parentNode,G=this.scrolledArea.end;if(!A.col){return null}var I=A.barTop.cellIndex<G.col,C=B.rowIndex<G.row,E={up:C,down:H.bottom>J.bottom&&D<=z.clientHeight,left:I,right:H.right>J.right&&F<=z.clientWidth};if(E.up||E.down||E.left||E.right){return E}return null},redraw:function(){var z=this.pane.style;z.opacity=0.9999;setTimeout(function(){z.opacity=1},0)},hide:function(z,G,J,B){var E=this,F="#"+this.table.getAttribute("id"),I=this.toggleHideStyleX=new j.StyleUpdater(function(){var K=this.nthCss("col",F,E.hiddenColumns,0)+this.nthCss("td",F+" tr",E.hiddenColumns,0);this.setStyle(K)}),H=this.toggleHideStyleY=new j.StyleUpdater(function(){var K=this.nthCss("tr",F,E.hiddenRows,0);this.setStyle(K)}),D,C,A=this.pane;A.appendChild(I.styleElement);A.appendChild(H.styleElement);this.hiddenRows=[];this.hiddenColumns=[];if(z){D=z.length-1;if(D>-1){do{C=z[D];this.toggleHideRow(J[C],C)}while(D--)}}if(G){D=G.length-1;if(D>-1){do{C=G[D];this.toggleHideColumn(B[C],C)}while(D--)}}},remove:function(){},scrollStart:function(E){var F=this.pane,C=F.scrollOuter,D=this.scrollAxis[E],B=this.scrollSize=F.size();D.v=[];D.name=E;switch(E||"x"){case"x":D.value=0;D.max=B.cols;D.min=0;D.size=B.cols;F.scrollStyleX.update();D.scrollStyle=F.scrollStyleX;D.area=C.scrollWidth-C.clientWidth;D.sheetArea=F.table.clientWidth-F.table.corner.clientWidth;D.scrollUpdate=function(){C.scrollLeft=(D.value)*(D.area/D.size)};D.gridSize=100/D.size;break;case"y":D.value=0;D.max=B.rows;D.min=0;D.size=B.rows;F.scrollStyleY.update();D.scrollStyle=F.scrollStyleY;D.area=C.scrollHeight-C.clientHeight;D.sheetArea=F.table.clientHeight-F.table.corner.clientHeight;D.scrollUpdate=function(){C.scrollTop=(D.value)*(D.area/D.size)};D.gridSize=100/D.size;break}var A=D.max;do{var z=new v(D.gridSize*A);z.index=A+1;D.v.unshift(z)}while(A--)},scrollTo:function(C){C=C||{};C.axis=C.axis||"x";C.value=C.value||0;C.pixel=C.pixel||0;if(!this.scrollAxis){this.scrollStart(C.axis)}var B=this.scrollAxis[C.axis];if(!C.value){C.value=c.closest(B.v,u.abs(C.pixel/B.area)*100,B.min).index}C.max=C.max||B.max;var A=((C.value>C.max?C.max:C.value)-B.min),z=[];if(A>=0){do{z.push(A+B.min)}while(A-->0)}B.value=C.value;if(z.length){if(B.scrollStyle){return B.scrollStyle.update(z)}}else{if(B.scrollStyle){return B.scrollStyle.update()}}return false},scrollStop:function(){if(this.scrollAxis.x.scrollUpdate){this.scrollAxis.x.scrollUpdate()}if(this.scrollAxis.y.scrollUpdate){this.scrollAxis.y.scrollUpdate()}},toggleHideRow:function(B,A){var z=x(B);A=u.max(A+1,1);if(z.length&&x.inArray(A,this.hiddenRows)<0){this.hiddenRows.push(A)}else{this.hiddenRows.splice(this.hiddenRows.indexOf(A),1)}this.toggleHideStyleY.update()},rowShowAll:function(){x.each(this.hiddenRows||[],function(z){x(this).removeData("hidden")});this.toggleHideStyleY.setStyle("");this.hiddenRows=[]},toggleHideColumn:function(z,A){var B=x(z);A=u.max(A+1,1);if(B.length&&x.inArray(A,this.hiddenColumns)<0){this.hiddenColumns.push(A)}else{this.hiddenColumns.splice(this.hiddenColumns.indexOf(A),1)}this.toggleHideStyleX.update()},columnShowAll:function(){this.toggleHideStyleX.setStyle("");this.hiddenColumns=[]}};return y})(k,f,g,r,d);j.SpreadsheetUI=(function(){var t=[];function u(w,y,x,v){v=v||{};this.i=w;this.ui=y;this.table=x;this.isLast=v.lastIndex===w;this.enclosure=null;this.pane=null;this.spreadsheet=null;this.sizeCheck=v.sizeCheck||function(){};this.initChildren=v.initChildren||function(){};this.done=v.done||function(){};this.sizeCheck(this)}u.prototype={load:function(){var v=this.table;this.initChildren(this.ui,v,this.i);v.pane.ui=this.ui;this.enclosure=v.enclosure;this.pane=v.pane;this.spreadsheet=v.spreadsheet;t.push(this.i);if(this.isLast){this.loaded()}},loaded:function(){this.done(t,this)}};return u})();j.Theme=(function(t){function u(v){v=v||j.defaultTheme;switch(v){case j.customTheme:this.cl=u.customClasses;break;case j.bootstrapTheme:this.cl=u.bootstrapClasses;break;default:case j.themeRollerTheme:this.cl=u.themeRollerClasses;break}t.extend(this,this.cl)}u.themeRollerClasses={autoFiller:"ui-state-active",bar:"ui-widget-header",barHighlight:"ui-state-active",barHandleFreezeLeft:"ui-state-default",barHandleFreezeTop:"ui-state-default",barMenuTop:"ui-state-default",tdActive:"ui-state-active",tdHighlighted:"ui-state-highlight",control:"ui-widget-header ui-corner-top",controlTextBox:"ui-widget-content",fullScreen:"ui-widget-content ui-corner-all",inPlaceEdit:"ui-state-highlight",menu:"ui-widget-header",menuFixed:"",menuUl:"ui-widget-header",menuLi:"ui-widget-header",menuHover:"ui-state-highlight",pane:"ui-widget-content",parent:"ui-widget-content ui-corner-all",table:"ui-widget-content",tab:"ui-widget-header",tabActive:"ui-state-highlight",barResizer:"ui-state-highlight",barFreezer:"ui-state-highlight",barFreezeIndicator:"ui-state-highlight"};u.bootstrapClasses={autoFiller:"btn-info",bar:"bg-primary",barHighlight:"label-info",barHandleFreezeLeft:"bg-warning",barHandleFreezeTop:"bg-warning",barMenuTop:"bg-warning",tdActive:"active",tdHighlighted:"bg-info",control:"bg-primary",controlTextBox:"form-control",fullScreen:"",inPlaceEdit:"form-control",menu:"panel panel-default",menuFixed:"nav navbar-nav",menuUl:"panel-info",menuLi:"active",menuHover:"bg-primary active",pane:"well",parent:"panel panel-default",table:"table table-bordered table-condensed",tab:"btn-default btn-xs",tabActive:"active",barResizer:"bg-info",barFreezer:"bg-warning",barFreezeIndicator:"bg-warning"};u.customClasses={autoFiller:"",bar:"",barHighlight:"",barHandleFreezeLeft:"",barHandleFreezeTop:"",barMenuTop:"",tdActive:"",tdHighlighted:"",control:"",controlTextBox:"",fullScreen:"",inPlaceEdit:"",menu:"",menuFixed:"",menuUl:"",menuLi:"",menuHover:"",pane:"",parent:"",table:"",tab:"",tabActive:"",barResizer:"",barFreezer:"",barFreezeIndicator:""};return u})(jQuery);j.Highlighter=(function(t,u,v){var w=function(y,A,x,z){this.cssClass=y;this.cssClassBars=A;this.cssClassTabs=x;this.callBack=z||function(){};this.last=v([]);this.lastTop=v([]);this.lastLeft=v([]);this.lastTab=v([]);this.start={row:0,col:0};this.end={row:0,col:0}};w.prototype={set:function(z){z=z||v([]);var x,y=this.last;if(y&&y.length>0){x=y.length-1;do{y[x].isHighlighted=false}while(x-->0)}if(z.length>0){x=z.length-1;do{if(!z[x].isHighlighted){z[x].isHighlighted=true;if(!z[x].className.match(this.cssClass)){z[x].className+=" "+this.cssClass}}}while(x-->0)}this.clear(y);this.last=z;this.callBack();return this},is:function(){return this.last.length>0},clear:function(y){if(this.is()){y=y||this.last;if(y&&y.length){var x=y.length-1;do{if(!y[x].isHighlighted){y[x].className=y[x].className.replace(this.cssClass,"");y[x].isHighlighted=false}}while(x-->0)}}this.last=v([]);return this},setBar:function(x,y){switch(x){case"top":this.lastTop.removeClass(this.cssClassBars);this.lastTop=v(y).addClass(this.cssClassBars);break;case"left":this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=v(y).addClass(this.cssClassBars);break}return this},clearBar:function(){this.lastTop.removeClass(this.cssClassBars);this.lastTop=v([]);this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=v([]);return this},setTab:function(x){this.clearTab();this.lastTab=x.addClass(this.cssClassTabs);return this},clearTab:function(){this.lastTab.removeClass(this.cssClassTabs);return this},setStart:function(x){this.start=x;return this},setEnd:function(x){this.end=x;return this}};return w})(k,f,jQuery);j.ColumnAdder=(function(){function t(){this.qty=-1;this.addedFinishedFn=null;this.createBarFn=null;this.createCellFn=null}t.prototype={setQty:function(w,v){var u=d.sheet.max;if(u){if(u>v.cols&&u<=v.cols+w){this.qty=u-v.cols}else{if(u&&u<=v.cols+w){return false}}}else{this.qty=w}return true},setAddedFinishedFn:function(u){this.addedFinishedFn=u},setCreateBarFn:function(u){this.createBarFn=u},setCreateCellFn:function(u){this.createCellFn=u},createCells:function(z,C,y){var x=(y?0:1),u=C.rows||1,w=z+this.qty,B,v=z,A;for(;v<w;v++){A=this.createBarFn(v+x);for(B=1;B<=u;B++){this.createCellFn(B,v+x,A)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:0,col:this.qty})}}};return t})();j.RowAdder=(function(){function t(){this.qty=-1;this.addedFinishedFn=null;this.createBar=null;this.createCell=null}t.prototype={setQty:function(x,v,w){var u=d.sheet.max;if(u){if(u>v.rows&&u<=v.rows+x){this.qty=u-v.rows}else{if(u&&u<=v.rows+x){return false}}}else{this.qty=x}return true},setAddedFinishedFn:function(u){this.addedFinishedFn=u},setCreateBarFn:function(u){this.createBar=u},setCreateCellFn:function(u){this.createCell=u},createCells:function(z,C,y){var x=(y?0:1),u=z+this.qty,w=C.cols||1,A,B=z,v;for(;B<u;B++){A=this.createBar(B+x);for(v=1;v<=w;v++){this.createCell(B+x,v,A)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:this.qty,col:0})}}};return t})();j.StyleUpdater=(function(t){function u(w,v){var x=this.styleElement=t.createElement("style");x.styleUpdater=this;this.update=w;if(j.StyleUpdater.prototype.nthCss===null){if(v){j.StyleUpdater.prototype.nthCss=function(y,F,A,C,B){var D=[],z=A.length,E=this.repeat;B=B||"{display: none;}";do{if(A[z]>C){D.push(F+" "+y+":first-child"+E("+"+y,A[z]-1))}}while(z--);if(D.length){return D.join(",")+B}return""}}else{j.StyleUpdater.prototype.nthCss=function(y,E,A,C,B){var D=[],z=A.length;B=B||"{display: none;}";do{if(A[z]>C){D.push(E+" "+y+":nth-child("+A[z]+")")}}while(z--);if(D.length){return D.join(",")+B}return""}}}}if(t.createElement("style").styleSheet){u.prototype={setStyle:function(w){var x=this.styleElement,v=x.styleSheet;v.disabled=false;if(!v.disabled){v.cssText=w}},getStyle:function(){var w=this.styleElement,v=w.styleSheet;v.disabled=false;if(!v.disabled){return v.cssText}return""}}}else{u.prototype={setStyle:function(v){this.styleElement.innerHTML=v},getStyle:function(){return this.styleElement.innerHTML}}}u.prototype.nthCss=null;u.prototype.repeat=function(x,w){var v="";while(w>0){if(w&1){v+=x}w>>=1;x+=x}return v};return u})(k);j.JSONLoader=(function(v,t,u){function w(x){if(x!==undefined){this.json=x;this.count=x.length}else{this.json=[];this.count=0}}w.prototype={size:function(A){var z={cols:0,rows:0},y=this.json,C,B,D,x;if((C=y[A])===undefined){return z}if((B=C.rows)===undefined){return z}if((D=B[0])===undefined){return z}if((x=D.columns)===undefined){return z}return{rows:B.length,cols:x.length}},setWidth:function(x,B,E){var z=this.json,D=z[x],y=D.metadata||{},C=y.widths||[],A=C[B];E.style.width=A+"px"},setRowHeight:function(y,E,B){var z=this.json,C,A,D,x;if((C=z[y])===undefined){return}if((A=C.rows)===undefined){return}if((D=A[E])===undefined){return}if((x=D.height)===undefined){return}B.style.height=x+"px"},setupCell:function(z,E,A,y){var D=t.createElement("td"),C=v(D),B=this.getCell(z,E,A),x;if(B!==null){if(B.getCell!==undefined){x=B.getCell();if(x.formula){D.setAttribute("data-formula",x.formula||"");if(x.hasOwnProperty("result")&&x.result!==null){C.html(x.result.hasOwnProperty("html")?x.result.html:x.result)}}else{C.html(x.value)}}else{x=y(D);x.value=B.value;if(B.formula){x.formula=B.formula||"";D.setAttribute("data-formula",B.formula||"")}else{C.html(B.value)}}D.className=B["class"]||"";D.setAttribute("style",B.style||"");if(B.rowspan){D.setAttribute("rowspan",B.rowspan||"")}if(B.colspan){D.setAttribute("colspan",B.colspan||"")}if(B.uneditable){D.setAttribute("data-uneditable",B.uneditable||"")}if(B.id){D.setAttribute("id",B.id)}}else{x=y(D)}D.jSCell=x;x.td=C;return x},getCell:function(y,E,A){var z=this.json,C,B,D,x;if((C=z[y])===undefined){return null}if((B=C.rows)===undefined){return null}if((D=B[E-1])===undefined){return null}if((x=D.columns[A-1])===undefined){return null}return x},jitCell:function(y,D,z,B){var x,C,A;if(B===undefined){B=this.getCell(y,D,z)}if(B===null){return null}if(B.getCell!==undefined){return B.getCell()}x={cellIndex:z,parentNode:{rowIndex:D},html:function(){}};A=B.value;C={td:{0:x},html:[],state:[],calcCount:0,calcLast:-1,calcDependenciesLast:-1,cellType:B.cellType||"",formula:B.formula||"",value:(A!==undefined&&A!==null?new u(A):new u()),uneditable:B.uneditable,type:"cell",sheet:y,dependencies:[],id:null,loadedFrom:B};C.value.cell=C;B.getCell=function(){return C};return C},title:function(x){var y=this.json,z;if((z=y[x])===undefined){return""}return z.title||""},hasSpreadsheetAtIndex:function(x){return(this.json[x]!==undefined)},getSpreadsheetIndexByTitle:function(A){var z=this.json,x=this.count,y=0;for(;y<x;y++){if(z[y].title==A){return y}}return -1},addSpreadsheet:function(y,x){if(x===undefined){this.json.push(y)}else{this.json.splice(x,0,y)}this.count=this.json.length},getCellAttribute:function(x,y){return x[y]},setCellAttribute:function(x,y,z){x[y]=z},cycleCells:function(D,C){var E=this.json,A,G,y,x,F,B,z;if((A=E[D])===undefined){return}if((B=(G=A.rows).length)<1){return}if(G[0].columns.length<1){return}B--;do{F=G[B];y=F.columns;z=y.length-1;do{x=y[z];C.call(this.jitCell(D,B,z,x),D,B,z)}while(z-->0)}while(B-->0)},cycleCellsAll:function(z){var y=this.json,x=y.length-1;if(x<0){return}do{this.cycleCells(x,z)}while(x-->0)},toTables:function(){var P=this.json,F=v([]),C,H,D,z,A,J,I,L,x,K,Q,G,B,y,E,O,N,M;for(O=0;O<P.length;O++){C=P[O];Q=v(t.createElement("table"));if(C.title){Q.attr("title",C.title||"")}F=F.add(Q);H=C.rows;for(N=0;N<H.length;N++){D=H[N];if(K=(D.height+"").replace("px","")){y=v(t.createElement("tr")).attr("height",K).css("height",K+"px").appendTo(Q)}z=D.columns;for(M=0;M<z.length;M++){A=z[M];E=v(t.createElement("td")).appendTo(y);if(A["class"]){E.attr("class",A["class"]||"")}if(A.style){E.attr("style",A.style||"")}if(A.formula){E.attr("data-formula",(A.formula?"="+A.formula:""))}if(A.cellType){E.attr("data-celltype",A.cellType||"")}if(A.value){E.html(A.value||"")}if(A.uneditable){E.html(A.uneditable||"")}if(A.rowspan){E.attr("rowspan",A.rowspan||"")}if(A.colspan){E.attr("colspan",A.colspan||"")}if(A.id){E.attr("id",A.id||"")}if(A.cache){E.html(A.cache)}}}if(J=C.metadata){if(I=J.widths){G=v(t.createElement("colgroup")).prependTo(Q);for(M=0;M<I.length;M++){L=(I[M]+"").replace("px","");B=v(t.createElement("col")).attr("width",L).css("width",L+"px").appendTo(G)}}if(x=J.frozenAt){if(x.row){Q.attr("data-frozenatrow",x.row)}if(x.col){Q.attr("data-frozenatcol",x.col)}}}}return F},fromSheet:function(G,B){B=(B==undefined?false:B);var J=[],O=1*G.i,C=G.spreadsheets.length-1,P,E,F,A,H,N,z,x,L,I,K,M,D,y;if(C<0){return J}do{M=false;G.i=C;G.evt.cellEditDone();P={title:(G.obj.table().attr("title")||""),rows:[],metadata:{widths:[],frozenAt:v.extend({},G.obj.pane().actionUI.frozenAt)}};J.unshift(P);E=G.spreadsheets[C];F=E.length-1;do{D=E[F][1].td[0].parentNode;y=D.style.height;N={columns:[],height:(y?y.replace("px",""):G.s.colMargin)};A=E[F].length-1;do{x=E[F][A];z={};L=x.td[0].attributes;if(B||M||L["class"]||x.formula||x.value||L.style){M=true;I=(L["class"]?v.trim((L["class"].value||"").replace(G.cl.uiCellActive,"").replace(G.cl.uiCellHighlighted,"")):"");K=x.td[0].parentNode;N.columns.unshift(z);if(!N.height){N.height=(K.style.height?K.style.height.replace("px",""):G.s.colMargin)}if(x.formula){z.formula=x.formula}if(x.cellType){z.cellType=x.cellType}if(x.value){z.value=x.value}if(x.uneditable){z.uneditable=x.uneditable}if(x.cache){z.cache=x.cache}if(x.id){z.id=x.id}if(L.style&&L.style.value){z.style=L.style.value}if(I.length){z["class"]=I}if(L.rowspan){z.rowspan=L.rowspan.value}if(L.colspan){z.colspan=L.colspan.value}if(F*1==1){P.metadata.widths.unshift(v(G.col(null,A)).css("width").replace("px",""))}}}while(A-->1);if(M){P.rows.unshift(N)}}while(F-->1)}while(C--);G.i=O;return this.json=J}};return w})(jQuery,k,o);j.XMLLoader=(function(u,t){function v(w){if(w!==undefined){this.xml=u.parseXML(w);this.spreadsheets=this.xml.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet");this.count=this.xml.length}else{this.xml=null;this.spreadsheets=null;this.count=0}}v.prototype={size:function(y){var w=this.xml[y],z=w.rows,A=z[0],x=A.columns;return{rows:z.length,cols:x.length}},setWidth:function(E,B,z){var A=this.spreadsheets,D=A[E],C=D.getElementsByTagName("metadata")[0]||{},x=C.getElementsByTagName("width")||[],y=x[B],w=(y.textContent||y.text);z.style.width=w+"px"},setRowHeight:function(x,D,B){var z=this.spreadsheets,y,A,C,w;if((y=z[x])===undefined){return}if((A=y.getElementsByTagName("rows")[0].getElementsByTagName("row"))===undefined){return}if((C=A[D])===undefined){return}if((w=C.attributes.height.nodeValue)===undefined){return}B.style.height=w+"px"},setupCell:function(E,z,y,w,A){var x=this.spreadsheets,D,F,B,C;if((D=x[E])===undefined){return false}if((F=D.getElementsByTagName("rows")[0].getElementsByTagName("row")[z-1])===undefined){return false}if((B=F.getElementsByTagName("columns")[0].getElementsByTagName("column")[y-1])===undefined){return false}w.cellType=B.attributes.cellType.nodeValue||"";if((C=B.jitCell)!==undefined){w.html=C.html;w.state=C.state;w.calcLast=C.calcLast;w.calcDependenciesLast=C.calcDependenciesLast;w.cellType=C.cellType;w.value=C.value;w.uneditable=C.uneditable;w.sheet=C.sheet;w.dependencies=C.dependencies}if(B.attributes.formula){w.formula=B.attributes.formula.nodeValue||"";A.setAttribute("data-formula",B.attributes.formula.nodeValue||"")}else{A.innerHTML=w.value=B.attributes.value.nodeValue||""}A.className=B.attributes["class"].nodeValue||"";A.setAttribute("style",B.attributes.style.nodeValue||"");if(B.attributes.rowspan){A.setAttribute("rowspan",B.attributes.rowspan.nodeValue||"")}if(B.attributes.colspan){A.setAttribute("colspan",B.attributes.colspan.nodeValue||"")}return true},getCell:function(w,y,x){return null},jitCell:function(x,C,A){var z=this.spreadsheets,y,B,w;if((y=z[x])===undefined){return false}if((B=y.getElementsByTagName("rows")[0].getElementsByTagName("row")[C-1])===undefined){return false}if((w=B.getElementsByTagName("columns")[0].getElementsByTagName("column")[A-1])===undefined){return false}return{td:{cellIndex:A,parentNode:{rowIndex:C},html:function(){}},html:[],state:[],calcLast:-1,calcDependenciesLast:-1,cellType:w.attributes.cellType.nodeValue||"",formula:w.attributes.formula.nodeValue||"",value:w.attributes.value.nodeValue||"",type:"cell",sheet:x,id:null}},title:function(x){var y=this.spreadsheets,w;if((w=y[x])===undefined){return""}return(w.attributes.title?w.attributes.title.nodeValue:"")},getSpreadsheetIndexByTitle:function(w){},addSpreadsheet:function(w,x){if(x===undefined){this.spreadsheets.append.push(jsonSpreadsheet)}else{this.json.splice(x,0,jsonSpreadsheet)}this.count=this.json.length},setCellAttribute:function(w,x,y){},toTables:function(){var D=this.xml,H=u([]),B=D.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet"),E,L,F,z,C,U,O,aa,N,K,M,R,P;for(var X=0;X<B.length;X++){E=B[X];var Z=u(t.createElement("table")).attr("title",(E.attributes.title?E.attributes.title.nodeValue:"")),J=u(t.createElement("colgroup")).appendTo(Z),x=u(t.createElement("tbody")).appendTo(Z);H=H.add(Z);L=E.getElementsByTagName("rows")[0].getElementsByTagName("row");O=E.getElementsByTagName("metadata")[0];for(var V=0;V<L.length;V++){F=L[V];var y=u(t.createElement("tr")).appendTo(x);if(P=F.attributes.height){P=(P.nodeValue||"").replace("px","");y.css("height",P).attr("height",P+"px")}z=F.getElementsByTagName("columns")[0].getElementsByTagName("column");for(var T=0;T<z.length;T++){C=z[T];var G=u(t.createElement("td")).appendTo(y),w=C.getElementsByTagName("formula")[0],W=C.getElementsByTagName("cellType")[0],S=C.getElementsByTagName("value")[0],Y=C.getElementsByTagName("style")[0],I=C.getElementsByTagName("class")[0],ab=C.getElementsByTagName("rowspan")[0],A=C.getElementsByTagName("colspan")[0],Q=C.getElementsByTagName("id")[0];if(w){G.attr("data-formula","="+(w.textContent||w.text))}if(W){G.attr("data-celltype",W.textContent||W.text)}if(S){G.html(S.textContent||S.text)}if(Y){G.attr("style",Y.textContent||Y.text)}if(I){G.attr("class",I.textContent||I.text)}if(ab){G.attr("rowspan",ab.textContent||ab.text)}if(A){G.attr("colspan",A.textContent||A.text)}if(Q){G.attr("id",Q.textContent||Q.text)}}}M=O.getElementsByTagName("width");for(var V=0;V<M.length;V++){R=(M[V].textContent||M[V].text).replace("px","");u(t.createElement("col")).attr("width",R).css("width",R+"px").appendTo(J)}aa=O.getElementsByTagName("frozenAt")[0];if(aa){K=aa.getElementsByTagName("col")[0];N=aa.getElementsByTagName("row")[0];if(K){Z.attr("data-frozenatcol",(K.textContent||K.text)*1)}if(N){Z.attr("data-frozenatrow",(N.textContent||N.text)*1)}}}return H},fromSheet:function(I,C,D){C=(C==undefined?false:C);var L="",S=1*I.i,E=I.spreadsheets.length-1,x,G,H,B,J,Q,R,z,y,O,K,M,w,P,N,F,A;if(E<0){return L}do{P=false;I.i=E;I.evt.cellEditDone();w=u.extend({},I.obj.pane().actionUI.frozenAt);N=[];G=I.spreadsheets[E];H=G.length-1;Q="";do{z="";B=G[H].length-1;do{R="";y=G[H][B];O=y.td[0].attributes;K=(O["class"]?u.trim((O["class"].value||"").replace(I.cl.uiCellActive,"").replace(I.cl.uiCellHighlighted,"")):"");if(C||P||K||y.formula||y.value||O.style){P=true;R+="<column>";if(y.formula){R+="<formula>"+y.formula+"</formula>"}if(y.cellType){R+="<cellType>"+y.cellType+"</cellType>"}if(y.value){R+="<value>"+y.value+"</value>"}if(O.style){R+="<style>"+O.style.value+"</style>"}if(K){R+="<class>"+K+"</class>"}if(O.rowspan){R+="<rowspan>"+O.rowspan.value+"</rowspan>"}if(O.colspan){R+="<colspan>"+O.colspan.value+"</colspan>"}if(O.id){R+="<id>"+O.id.value+"</id>"}R+="</column>";z=R+z;if(H*1==1){N[B]="<width>"+u(I.col(null,B)).css("width").replace("px","")+"</width>"}}}while(B-->1);if(z){F=G[H][1].td[0].parentNode;A=F.style.height;Q='<row height="'+(A?A.replace("px",""):I.s.colMargin)+'"><columns>'+z+"</columns></row>"+Q}}while(H-->1);x='<spreadsheet title="'+(I.obj.table().attr("title")||"")+'"><rows>'+Q+"</rows><metadata>"+(w.row||w.col?"<frozenAt>"+(w.row?"<row>"+w.row+"</row>":"")+(w.col?"<col>"+w.col+"</col>":"")+"</frozenAt>":"")+"<widths>"+N.join("")+"</widths></metadata></spreadsheet>";L=x+L}while(E--);I.i=S;L='<?xml version="1.0" encoding="UTF-8"?><spreadsheets xmlns="http://www.w3.org/1999/xhtml">'+L+"</spreadsheets>";if(D!==true){this.xml=u.parseXML(L)}return L}};return v})(jQuery,k);d.fn.extend({sheet:function(u){var v=isNaN,t=d.sheet.events;u=u||{};d(this).each(function(){var C=Globalize,z=d(this),B={editable:true,editableNames:true,barMenus:true,freezableCells:true,allowToggleState:true,menuLeft:null,menuRight:null,newColumnWidth:120,title:null,calcOff:false,lockFormulas:false,parent:z,colMargin:20,boxModelCorrection:2,formulaFunctions:{},formulaVariables:{},cellSelectModel:j.excelSelectModel,autoAddCells:true,resizableCells:true,resizableSheet:true,autoFiller:true,minSize:{rows:1,cols:1},error:function(D){return D.error},endOfNumber:false,encode:function(D){switch(typeof D){case"object":if(D.getMonth){return C.format(D,"d")}return D}if(!D){return D||""}if(!D.replace){return D||""}return D.replace(/&/gi,"&amp;").replace(/>/gi,"&gt;").replace(/</gi,"&lt;").replace(/\n/g,"\n<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp ").replace(/  /g,"&nbsp; ")},frozenAt:[],contextmenuTop:{"Toggle freeze columns to here":function(F){var D=F.getTdLocation(F.obj.tdActive()).col,E=F.obj.pane().actionUI;E.frozenAt.col=(E.frozenAt.col==D?0:D)},"Insert column after":function(D){D.controlFactory.addColumn(D.colLast);return false},"Insert column before":function(D){D.controlFactory.addColumn(D.colLast,true);return false},"Add column to end":function(D){D.controlFactory.addColumn();return false},"Delete this column":function(D){D.deleteColumn();return false},"Hide column":function(D){D.toggleHideColumn();return false}},contextmenuLeft:{"Toggle freeze rows to here":function(E){var F=E.getTdLocation(E.obj.tdActive()).row,D=E.obj.pane().actionUI;D.frozenAt.row=(D.frozenAt.row==F?0:F)},"Insert row after":function(D){D.controlFactory.addRow(D.rowLast);return false},"Insert row before":function(D){D.controlFactory.addRow(D.rowLast,true);return false},"Add row to end":function(D){D.controlFactory.addRow();return false},"Delete this row":function(D){D.deleteRow();return false},"Hide row":function(D){D.toggleHide.row();return false}},contextmenuCell:{Copy:false,Cut:false,"Insert column after":function(D){D.controlFactory.addColumn(D.colLast);return false},"Insert column before":function(D){D.controlFactory.addColumn(D.colLast,true);return false},"Add column to end":function(D){D.controlFactory.addColumn();return false},"Delete this column":function(D){D.deleteColumn();return false},line1:"line","Insert row after":function(D){D.controlFactory.addRow(D.rowLast);return false},"Insert row before":function(D){D.controlFactory.addRow(D.rowLast,true);return false},"Add row to end":function(D){D.controlFactory.addRow();return false},"Delete this row":function(D){D.deleteRow();return false},line2:"line","Add spreadsheet":function(D){D.addSheet()},"Delete spreadsheet":function(D){D.deleteSheet()}},hiddenRows:[],hiddenColumns:[],cellStartingHandlers:{"$":function(E,D){return m.DOLLAR.call(this,E.substring(1).replace(C.culture().numberFormat[","],""),2,D||"$")},"£":function(D){return A.s.cellStartingHandlers["$"].call(this,D,"£")}},cellEndHandlers:{"%":function(D){return D.substring(0,this.value.length-1)/100}},cellTypeHandlers:{percent:function(F){var E=(v(F)?C.parseFloat(F):F*1),D;if(!v(E)){D=new r(E);D.html=C.format(E,"p");return D}return F},date:function(E){var D=C.parseDate(E);if(D===null){return E}else{D.html=C.format(D,"d");return D}},time:function(E){var D=C.parseDate(E);if(D===null){return E}else{D.html=C.format(D,"t");return D}},currency:function(F){var E=(v(F)?C.parseFloat(F):F*1),D;if(!v(E)){D=new r(E);D.html=C.format(E,"c");return D}return F},number:function(F){var E,D;if(!u.endOfNumber){E=C.culture().numberFormat["."];u.endOfNumber=new b("(["+(E=="."?".":E)+"])([0-9]*?[1-9]+)?(0)*$")}if(!v(F)){D=new r(F);D.html=C.format(F+"","n10").replace(u.endOfNumber,function(I,H,G){return(G?H:"")+(G||"")});return D}return F}},alert:function(D){alert(D)},prompt:function(E,F,D){F(prompt(E,D))},confirm:function(F,D,E){if(confirm(F)){D()}else{if(E){E()}}},initCalcRows:40,initCalcCols:20,initScrollRows:0,initScrollCols:0,loader:null};var A=this.jS;if(A){var x=z.children().detach();A.kill();z.html(x);for(var y in t){if(t.hasOwnProperty(y)){z.unbind(t[y])}}}if((this.className||"").match(/\bnot-editable\b/i)!=null){u.editable=false}for(var w in t){if(t.hasOwnProperty(w)){z.bind(t[w],u[t[w]])}}if(!d.sheet.instance.length){d.sheet.instance=[]}this.jS=A=d.sheet.createInstance(d.extend(B,u),d.sheet.instance.length);d.sheet.instance.push(A)});return this},disableSelectionSpecial:function(){this.each(function(){this.onselectstart=function(){return false};this.unselectable="on";this.style["-moz-user-select"]="none"});return this},getSheet:function(){var t=this[0],u=(t.jS||{});return u},getCellValue:function(y,u,t){var v=this[0],w=(v.jS||{});t=(t||0);if(w.updateCellValue){try{return w.updateCellValue(t,y,u)}catch(x){}}return null},setCellValue:function(y,A,v,u){var w=this[0],x=(w.jS||{}),t;u=(u||0);if(x.getCell&&(t=x.getCell(A,v,u))){try{if((y+"").charAt(0)=="="){t.valueOverride=t.value="";t.formula=y.substring(1)}else{t.value=y;t.valueOverride=t.formula=""}t.calcLast=t.calcDependenciesLast=0;x.updateCellValue.call(t,u,A,v);x.updateCellDependencies.call(t);return true}catch(z){}}return false},setCellFormula:function(A,z,v,u){var w=this[0],x=(w.jS||{}),t;u=(u||0);if(x.getCell&&(t=x.getCell(z,v,u))){try{t.formula=A;t.valueOverride=t.value="";t.calcLast=t.calcDependenciesLast=0;x.updateCellValue.call(t,u,z,v)}catch(y){}}return this},setCellHtml:function(w,A,v,u){var x=this[0],y=(x.jS||{}),t;u=(u||0);if(y.getCell&&(t=y.getCell(A,v,u))){try{t.html=[w];t.calcLast=t.calcDependenciesLast=0;y.updateCellValue.call(t,u,A,v)}catch(z){}}return this},isSheetFullScreen:function(){var t=this[0],u=(t.jS||{});if(u.obj){return u.obj.fullScreen().is(":visible")}return false},serializeCellInputs:function(u){var v=this[0],w=(v.jS||{}),t=w.obj.tables().find(":input");if(u){return t.serializeArray()}else{return t.serialize()}},viewSource:function(t){var u="";d(this).each(function(){if(t){u+=d(this).toPrettySource()}else{u+=d(this).toCompactSource()}});d.printSource(u);return u},toCompactSource:function(){var x=this[0];var u="";if(x.nodeType==1){u+="<"+x.tagName.toLowerCase();var z=x.attributes.length;for(var w=0;w<z;w++){var v=x.attributes[w].name,y=x.getAttribute(v);if(y){if(v=="contentEditable"&&y=="inherit"){continue}if(typeof(y)=="string"){u+=" "+v+'="'+y.replace(/"/g,"'")+'"'}else{if(v=="style"&&y.cssText){u+=' style="'+y.cssText+'"'}}}}if(x.tagName=="COL"){u+="/>"}else{u+=">";var t="";d(x.childNodes).each(function(){t+=d(this).toCompactSource()});u+=t;u+="</"+x.tagName.toLowerCase()+">"}}else{if(x.nodeType==3){u+=x.data.replace(/^\s*(.*)\s*$/g,"$1")}}return u},toPrettySource:function(y){var x=this[0],A,w;y=y||"";var u="";if(x.nodeType==1){u+="\n"+y+"<"+x.tagName.toLowerCase();A=x.attributes.length;for(w=0;w<A;w++){var v=x.attributes[w].name,z=x.getAttribute(v);if(z){if(v=="contentEditable"&&z=="inherit"){continue}if(typeof(z)=="string"){u+=" "+v+'="'+d.trim(z.replace(/"/g,"'"))+'"'}else{if(v=="style"&&z.cssText){u+=' style="'+d.trim(z.cssText)+'"'}}}}if(x.childNodes.length<=0){if(x.tagName=="COL"){u+="/>"}else{u+="></"+x.tagName.toLowerCase()+">"}}else{u+=">";var t="";A=x.childNodes.length;for(w=0;w<A;w++){t+=d(x.childNodes[w]).toPrettySource(y+"  ")}u+=t;if(t.indexOf("\n")>=0){u+="\n"+y}u+="</"+x.tagName.toLowerCase()+">"}}else{if(x.nodeType==3){u+=x.data.replace(/^\s*(.*)\s*$/g,"$1")}}return u}});d.sheet={instance:[],dependencies:{coreCss:{css:"jquery.sheet.css"},jQueryUI:{script:"jquery-ui/jquery-ui.min.js",thirdParty:true},jQueryUIThemeRoller:{css:"jquery-ui/themes/smoothness/jquery-ui.min.css",thirdParty:true},globalize:{script:"globalize/lib/globalize.js",thirdParty:true},nearest:{script:"jquery-nearest/src/jquery.nearest.min.js",thirdParty:true},mousewheel:{script:"MouseWheel/MouseWheel.js",thirdParty:true}},optional:{advancedFn:{script:"plugins/jquery.sheet.advancedfn.js"},financeFn:{script:"plugins/jquery.sheet.financefn.js"},colorPicker:{css:"really-simple-color-picker/colorPicker.css",script:"really-simple-color-picker/jquery.colorPicker.min.js",thirdParty:true},elastic:{script:"jquery-elastic/jquery.elastic.source.js",thirdParty:true},globalizeCultures:{script:"globalize/lib/cultures/globalize.cultures.js",thirdParty:true},raphael:{script:"raphael/raphael-min.js",thirdParty:true},gRaphael:{script:"graphael/g.raphael.js",thirdParty:true},gRaphaelBar:{script:"graphael/g.bar.js",thirdParty:true},gRaphaelDot:{script:"graphael/g.dot.js",thirdParty:true},gRaphaelLine:{script:"graphael/g.line.js",thirdParty:true},gRaphaelPie:{script:"graphael/g.pie.js",thirdParty:true},thaw:{script:"thaw.js/thaw.js",thirdParty:true},undoManager:{script:"Javascript-Undo-Manager/js/undomanager.js",thirdParty:true},zeroClipboard:{script:"zeroclipboard/dist/ZeroClipboard.min.js",thirdParty:true}},events:["sheetAddRow","sheetAddColumn","sheetSwitch","sheetRename","sheetTabSortStart","sheetTabSortUpdate","sheetCellEdit","sheetCellEdited","sheetCalculation","sheetAdd","sheetDelete","sheetDeleteRow","sheetDeleteColumn","sheetOpen","sheetAllOpened","sheetSave","sheetFullScreen","sheetFormulaKeydown"],preLoad:function(w,v){w=w||"";v=d.extend({skip:["globalizeCultures"],thirdPartyDirectory:"bower_components/"},v);var u=function(){if(this.script!==undefined){k.write('<script src="'+w+(this.thirdParty?v.thirdPartyDirectory:"")+this.script+'"><\/script>')}if(this.css!==undefined){k.write('<link rel="stylesheet" type="text/css" href="'+w+(this.thirdParty?v.thirdPartyDirectory:"")+this.css+'"></link>')}};for(var t in v.skip){if(this.dependencies[v.skip[t]]){delete this.dependencies[v.skip[t]]}if(this.optional[v.skip[t]]){delete this.optional[v.skip[t]]}}d.each(this.dependencies,function(){u.call(this)});d.each(this.optional,function(){u.call(this)})},createInstance:function(L,E){var K=this,B=function(M,u){var I=u.parentNode;if(I.lastchild==u){I.appendChild(M)}else{I.insertBefore(M,u.nextSibling)}},t=d(f),w=d(k),C=k.body,y=d(C),F=function(){},J=undefined,D=g,v=isNaN,H=NaN,z=f.thaw,A={version:"4.x",i:0,I:E,sheetCount:0,spreadsheets:[],controls:{autoFiller:[],bar:{helper:[],corner:[],x:{controls:[],handleFreeze:[],menu:[],menuParent:[],parent:[],th:[],ths:function(){var u=d([]);for(var I in this.th[A.i]){u.pushStack(this.th[A.i][I])}return u}},y:{controls:[],handleFreeze:[],menu:[],parent:[],th:[],ths:function(){var u=d([]);for(var I in this.th[A.i]){u.pushStack(this.th[A.i][I])}return u}}},barMenuLeft:[],barMenuTop:[],barLeft:[],barTop:[],barTopParent:[],chart:[],tdMenu:[],cellsEdited:[],enclosure:[],enclosures:null,formula:null,fullScreen:null,header:null,inPlaceEdit:[],inputs:[],label:null,menuLeft:[],menuRight:[],menus:[],pane:[],panes:null,scrolls:null,sheetAdder:null,table:[],tables:null,tab:[],tabContainer:null,tabs:null,title:null,toggleHide:{x:[],y:[]},ui:null},obj:{autoFiller:function(){return A.controls.autoFiller[A.i]||d([])},barCorner:function(){return A.controls.bar.corner[A.i]||d([])},barHelper:function(){return A.controls.bar.helper[A.i]||(A.controls.bar.helper[A.i]=d([]))},barLeft:function(u){return(A.controls.bar.y.th[A.i]&&A.controls.bar.y.th[A.i][u]?A.controls.bar.y.th[A.i][u]:d([]))},barLeftControls:function(){return A.controls.bar.y.controls[A.i]||d([])},barLefts:function(){return A.controls.bar.y.ths()},barHandleFreezeLeft:function(){return A.controls.bar.y.handleFreeze[A.i]||d([])},barMenuLeft:function(){return A.controls.bar.y.menu[A.i]||d([])},barTop:function(u){return(A.controls.bar.x.th[A.i]&&A.controls.bar.x.th[A.i][u]?A.controls.bar.x.th[A.i][u]:d([]))},barTopControls:function(){return A.controls.bar.x.controls[A.i]||d([])},barTops:function(){return A.controls.bar.x.ths()},barTopParent:function(){return A.controls.bar.x.parent[A.i]||d([])},barHandleFreezeTop:function(){return A.controls.bar.x.handleFreeze[A.i]||d([])},barMenuParentTop:function(){return A.controls.bar.x.menuParent[A.i]||d([])},barMenuTop:function(){return A.controls.bar.x.menu[A.i]||d([])},tdActive:function(){return A.cellLast.td||d([])},tdMenu:function(){return A.controls.tdMenu[A.i]||d([])},cellsEdited:function(){return(A.controls.cellsEdited!==J?A.controls.cellsEdited:A.controls.cellsEdited=[])},chart:function(){return A.controls.chart[A.i]||d([])},enclosure:function(){return A.controls.enclosure[A.i]||d([])},enclosures:function(){return A.controls.enclosures||d([])},formula:function(){return A.controls.formula||d([])},fullScreen:function(){return A.controls.fullScreen||d([])},header:function(){return A.controls.header||d([])},highlighted:function(){return A.highlighter.last||d([])},menuRight:function(){return A.controls.menuRight[A.i]||d([])},inPlaceEdit:function(){return A.controls.inPlaceEdit[A.i]||d([])},inputs:function(){return A.controls.inputs[A.i]||d([])},label:function(){return A.controls.label||d([])},menus:function(){return A.controls.menus[A.i]||d([])},menuLeft:function(){return A.controls.menuLeft[A.i]||d([])},pane:function(){return A.controls.pane[A.i]||{}},panes:function(){return A.controls.panes||d([])},parent:function(){return L.parent},scrolls:function(){return A.controls.scrolls||d([])},sheetAdder:function(){return A.controls.sheetAdder||d([])},table:function(){return A.controls.table[A.i]||d([])},tables:function(){return A.controls.tables||d([])},tab:function(){return A.controls.tab[A.i]||d([])},tabs:function(){return A.controls.tabs||d([])},tabContainer:function(){return A.controls.tabContainer||d([])},title:function(){return A.controls.title||d([])}},id:"jS_"+E+"_",cl:{autoFiller:"jSAutoFiller",autoFillerHandle:"jSAutoFillerHandle",autoFillerCover:"jSAutoFillerCover",barCorner:"jSBarCorner",barController:"jSBarController",barControllerChild:"jSBarControllerChild",barHelper:"jSBarHelper",barLeft:"jSBarLeft",barHandleFreezeLeft:"jSBarHandleFreezeLeft",barTop:"jSBarTop",barTopMenuButton:"jSBarTopMenuButton",barHandleFreezeTop:"jSBarHandleFreezeTop",barTopParent:"jSBarTopParent",chart:"jSChart",formula:"jSFormula",formulaParent:"jSFormulaParent",header:"jSHeader",fullScreen:"jSFullScreen",inPlaceEdit:"jSInPlaceEdit",menu:"jSMenu",menuFixed:"jSMenuFixed",parent:"jSParent",scroll:"jSScroll",sheetAdder:"jSSheetAdder",table:"jS",label:"jSLoc",pane:"jSEditPane",tab:"jSTab",tabContainer:"jSTabContainer",tabContainerScrollable:"jSTabContainerScrollable",tdMenu:"jSTdMenu",title:"jSTitle",enclosure:"jSEnclosure",ui:"jSUI"},msg:{addRowMulti:"How many rows would you like to add?",addColumnMulti:"How many columns would you like to add?",cellFind:"What are you looking for in this spreadsheet?",cellNoFind:"No results found.",dragToFreezeCol:"Drag to freeze column",dragToFreezeRow:"Drag to freeze row",addSheet:"Add a spreadsheet",openSheet:"Are you sure you want to open a different sheet?  All unsaved changes will be lost.",toggleHideRow:"No row selected.",toggleHideColumn:"No column selected.",loopDetected:"Loop Detected",newSheetTitle:"What would you like the sheet's title to be?",notFoundColumn:"Column not found",notFoundRow:"Row not found",notFoundSheet:"Sheet not found",setCellRef:"Enter the name you would like to reference the cell by.",sheetTitleDefault:"Spreadsheet {index}",maxRowsBrowserLimitation:"You've reached the maximum amount of rows this browser supports. Try using Chrome, FireFox, or Internet Explorer 9+",maxColsBrowserLimitation:"You've reached the maximum amount of columns this browser supports. Try using Chrome, FireFox, or Internet Explorer 9+",maxSizeBrowserLimitationOnOpen:"The spreadsheet you are loading is larger than the maximum size of cells this browser supports. Try using Chrome, Firefox, or Internet Explorer 9+. You can an proceed, but the spreadsheet may not work as intended."},kill:function(){if(!A){return false}d(k).unbind("keydown");this.obj.fullScreen().remove();(this.obj.inPlaceEdit().destroy||F)();L.parent.trigger("sheetKill").removeClass(A.theme.parent).html("");L.parent[0].jS=J;this.obj.menus().remove();var u=d.sheet.events.length;for(var I=0;I<u;I++){L.parent.unbind(d.sheet.events[I])}d.sheet.instance.splice(E,1);return true},trigger:function(u,I){I=I||[];return L.parent.triggerHandler(u,[A].concat(I))},spreadsheetsToArray:function(u){if(u||A.spreadsheets.length==0){A.cycleCellsAll(function(M,N,I){A.createCell(M,N,I)})}return A.spreadsheets},spreadsheetToArray:function(I,u){u=(u?u:A.i);if(!A.spreadsheets[u]){A.cycleCells(function(N,O,M){A.createCell(N,O,M)})}return A.spreadsheets[u]},createCell:function(P,S,U,X,W,aa){var I,Q,T,Z,V,M,N,u,R,O,ab,Y;if(!(I=A.spreadsheets[P])){I=A.spreadsheets[P]=[]}if(!(Q=I[S])){Q=I[S]=[]}if(!(Z=A.controls.tables[P])||!(N=Z.tBody)||!(u=N.children[S])||!(R=u.children[U])){return}O=d(R);T=Q[U]=R.jSCell={td:O,dependencies:[],formula:R.getAttribute("data-formula")||"",cellType:R.getAttribute("data-celltype")||null,value:R.textContent||R.innerText||"",calcCount:X||0,calcLast:W||-1,calcDependenciesLast:aa||-1,sheet:P,type:"cell",jS:A,state:[],needsUpdated:true,uneditable:R.getAttribute("data-uneditable")||false,id:R.getAttribute("id")||null};if(T.formula&&T.formula.charAt(0)=="="){T.formula=T.formula.substring(1)}V=Z.colGroup;while(!(M=V.children[U])){M=k.createElement("col");M.setAttribute("style","width:"+A.s.newColumnWidth+"px;");V.appendChild(M)}A.shortenCellLookupTime(U,T,R,M,u,N,Z);if(!(Y=A.controls.bar.y.th[P])){Y=A.controls.bar.y.th[P]=[]}if(!Y[S]){Y[S]=d(u.children[0])}if(!(ab=A.controls.bar.x.th[P])){ab=A.controls.bar.x.th[P]=[]}if(!ab[U]){ab[U]=d(N.children[0].children[U])}return T},shortenCellLookupTime:function(M,P,R,I,Q,u,O){var N;if(!(N=I.jSCells)){N=I.jSCells=[]}N.unshift(P);if(!I.tds){I.tds=[]}I.tds.unshift(R);R.col=I;R.type="cell";R.barLeft=R.barLeft||Q.children[0];R.barTop=R.barTop||u.children[0].children[M];if(!Q.jSCells){Q.jSCells=[]}Q.jSCells.unshift(P);if(!Q.tds){Q.tds=[]}Q.tds.unshift(R);if(!O.jSCells){O.jSCells=[]}O.jSCells.unshift(P);if(!O.tds){O.tds=[]}O.tds.unshift(R);R.table=O},createUnboundCell:function(u,I){return I.jSCell={td:d(I),dependencies:[],formula:"",cellType:null,value:"",calcCount:0,calcLast:-1,calcDependenciesLast:-1,sheet:u,type:"cell",jS:A,state:[],needsUpdated:true,uneditable:false,id:null}},getCell:function(P,N,M){var I,O,u;M=(M||0);if(A.spreadsheets&&(I=A.spreadsheets[M])&&(O=I[P])&&(u=O[N])){return u}return null},getAllCellDependencies:function(I){function M(S,Q){var P=0,R=S.dependencies,O,N=R.length;for(;P<N;P++){O=R[P];Q(O);M(O,Q)}}var u=[];M(I,function(N){u.push(N)});return u},nav:false,setNav:function(M){var u=d.sheet.instance;for(var I=0;I<u.length;I++){(u[I]||{}).nav=false}A.nav=M},controlFactory:{addRowMulti:function(N,Q,M,u,P){var I=(P?"row-init":"row");function O(R){if(R){if(!v(R)){A.controlFactory.addCells(N,M,parseInt(R),I,u);A.trigger("sheetAddRow",[N,M,R])}}}if(!Q){L.prompt(A.msg.addRowMulti,O)}else{O(Q)}},addColumnMulti:function(N,Q,M,u,P){var I=(P?"col-init":"col");function O(R){if(R){if(!v(R)){A.controlFactory.addCells(N,M,parseInt(R),I,u);A.trigger("sheetAddColumn",[N,M,R])}}}if(!Q){L.prompt(A.msg.addColumnMulti,O)}else{O(Q)}},rowAdder:new j.RowAdder(),columnAdder:new j.ColumnAdder(),addCells:function(af,ai,S,N,W){A.autoFillerHide();A.setDirty(true);A.setChanged(true);A.obj.barHelper().remove();var U=A.obj.table(),ag=U[0],O=ag.tBody,ac=ag.colGroup,V=false,aa=A.obj.tdActive(),Q=A.spreadsheets[A.i]||(A.spreadsheets[A.i]=[]),ab,P,ad=L.newColumnWidth+"px",Z=L.colMargin+"px",X=A.cl.barLeft+" "+A.theme.bar,ah=A.cl.barTop+" "+A.theme.bar,R,T=(L.loader!==null?L.loader:null),Y=(T!==null?T.setupCell:null),M=A.controls.bar.x.th[A.i]||(A.controls.bar.x.th[A.i]=[]),I=A.controls.bar.y.th[A.i]||(A.controls.bar.y.th[A.i]=[]),ae=ag.size(),u=k.createDocumentFragment();S=S||1;N=N||"col";switch(N){case"row":Y=null;case"row-init":if(!af){af=ae.rows;V=true}R={row:af,col:0};ab=this.rowAdder;if(ab.setQty(S,ae)===false){if(!A.isBusy()){L.alert(A.msg.maxRowsBrowserLimitation)}return}ab.setCreateBarFn(function(aj){var ak=k.createElement("tr"),al=k.createElement("th");al.setAttribute("class",X);al.entity="left";al.type="bar";al.style.height=Z;ak.appendChild(al);u.appendChild(ak);al.innerHTML=ak.rowIndex;I.splice(aj,0,d(al));Q.splice(aj,0,[]);return ak});if(Y!==null){ab.setCreateCellFn(function(an,al,ak){var aj=Y.call(T,A.i,an,al,function(ap){return A.createUnboundCell(A.i,ap)}),ao=aj.td[0],am=Q[an];am[al]=aj;if(aj.calcLast<0){A.updateCellValue.call(aj,A.i,an,al);A.updateCellDependencies.call(aj)}ak.insertBefore(ao,ak.children[al]);A.shortenCellLookupTime(al,aj,ao,ac.children[al],ak,O,ag)})}else{ab.setCreateCellFn(function(al,ak,aj){var am=k.createElement("td");aj.insertBefore(am,aj.children[ak]);A.createCell(A.i,al,ak)})}ab.setAddedFinishedFn(function(aj){O.insertBefore(u,O.children[af].nextSibling);A.refreshRowLabels(af);P=aj});break;case"col":Y=null;case"col-init":if(!af){af=ae.cols;V=true}R={row:0,col:af};ab=this.columnAdder;if(ab.setQty(S,ae)===false){if(!A.isBusy()){L.alert(A.msg.maxColsBrowserLimitation)}return}ab.setCreateBarFn(function(al){var am=O.children[0],an=k.createElement("col"),ao=k.createElement("th"),ak,aj=O.children[1];an.style.width=ad;ao.entity="top";ao.type="bar";ao.innerHTML=h.columnLabelString(al);ao.className=ah;if(aj===undefined){ak=k.createElement("th");ak.setAttribute("class",X);ak.entity="left";ak.type="bar";aj=k.createElement("tr");aj.style.height=Z;aj.appendChild(ak);O.appendChild(aj);ak.innerHTML=aj.rowIndex;I.splice(0,0,d(ak))}ac.insertBefore(an,ac.children[al]);am.insertBefore(ao,am.children[al]);M.splice(al,0,d(ao));return{bar:ao,col:an,barParent:am}});if(Y!==null){ab.setCreateCellFn(function(ao,al,am){var ak=Y.call(T,A.i,ao,al,function(aq){return A.createUnboundCell(A.i,aq)}),ap=ak.td[0],aj=O.children[ao],an=Q[ao];if(an===undefined){Q[ao]=an=[]}an[al]=ak;if(ak.calcLast<0){A.updateCellValue.call(ak,A.i,ao,al);A.updateCellDependencies.call(ak)}aj.insertBefore(ap,aj.children[al]);A.shortenCellLookupTime(al,ak,ap,am.col,aj,O,ag)})}else{ab.setCreateCellFn(function(an,ak,al){var ao=k.createElement("td"),aj=O.children[an],am=Q[an];if(am===undefined){Q[an]=am=[]}aj.insertBefore(ao,aj.children[ak]);Q[an].splice(ak,0,{});A.createCell(A.i,an,ak)})}ab.setAddedFinishedFn(function(aj){A.refreshColumnLabels(af);P=aj});break}ab.createCells(af,ae,ai);if(!W&&V!=true){A.offsetFormulas(R,P,ai)}A.obj.pane().resizeScroll(true);if(aa&&aa[0]&&aa[0].cellIndex&&aa[0].parentNode){A.colLast=aa[0].cellIndex;A.rowLast=aa[0].parentNode.rowIndex}return true},addRow:function(I,u){A.controlFactory.addCells(I,u,1,"row");A.trigger("sheetAddRow",[I,u,1])},addColumn:function(I,u){A.controlFactory.addCells(I,u,1,"col");A.trigger("sheetAddColumn",[I,u,1])},barLeft:function(I){var M=I.tBody.children,u=M.length-1;if(u>0){do{M[u].insertBefore(k.createElement("th"),M[u].children[0])}while(u-->1)}},barTop:function(T){var I=T.colGroup,S=I.children,O,M=T.tBody.children[0],Q=k.createElement("col"),R=k.createElement("th"),P=k.createElement("tr"),N=0;if(M===undefined){I.innerHTML=""}else{N=M.children.length;while(S.length>N){I.removeChild(S[S.length-1])}}Q.style.width=Q.style.minWidth=L.colMargin+"px";I.insertBefore(Q,I.children[0]);P.appendChild(R);P.className=A.cl.barTopParent;T.tBody.insertBefore(P,T.tBody.children[0]);T.barTopParent=P;T.corner=R;R.col=Q;A.controls.barTopParent[A.i]=d(P);O=g.min(N,L.initCalcCols);if(O>0){do{var u=k.createElement("th");if(!S[O]){S[O]=k.createElement("col");I.insertBefore(S[O],Q.nextSibling)}S[O].bar=u;u.col=S[O];P.insertBefore(u,R.nextSibling)}while(O-->1)}T.barTop=A.controls.barTopParent[A.i].children();return P},barHandleFreeze:{top:function(M){if(A.isBusy()){return false}var u=A.obj.pane().actionUI,W=u.frozenAt,S=u.scrolledArea;if(!(S.end.col<=(W.col+1))){return false}A.obj.barHelper().remove();var X=M.table,V=X.tBody,N=V.children[0],P=N.children,R=d(P[W.col+1]),U=R.position(),T,O=d(M).offset(),Q=k.createElement("div"),I=M.freezeHandleTop=d(Q).appendTo(M).addClass(A.theme.barHandleFreezeTop+" "+A.cl.barHelper+" "+A.cl.barHandleFreezeTop).height(R.height()).css("left",(U.left-Q.clientWidth)+"px").attr("title",A.msg.dragToFreezeCol);A.controls.bar.helper[A.i]=A.obj.barHelper().add(Q);A.controls.bar.x.handleFreeze[A.i]=I;A.draggable(I,{axis:"x",start:function(){A.setBusy(true);T=d(k.createElement("div")).appendTo(M).css("position","absolute").addClass(A.theme.barFreezeIndicator+" "+A.cl.barHelper).height(M.table.corner.clientHeight).fadeTo(0,0.33)},drag:function(){var Y=A.nearest(I,P).prev();if(Y.length&&Y.position){T.width(Y.position().left+Y.width())}},stop:function(aa,Y){T.remove();A.setBusy(false);A.setDirty(true);var Z=A.nearest(I,P);A.obj.barHelper().remove();S.end.col=u.frozenAt.col=A.getTdLocation(Z).col-1;A.autoFillerHide();u.scrollStart("x",A.sheetSize(M.table))},containment:[O.left,O.top,D.min(O.left+M.table.clientWidth,O.left+M.clientWidth-f.scrollBarSize.width),O.top]});return true},left:function(M){if(A.isBusy()){return false}var M=A.obj.pane(),u=M.actionUI,V=u.frozenAt,R=u.scrolledArea;if(!(R.end.row<=(V.row+1))){return false}A.obj.barHelper().remove();var W=M.table,U=W.tBody,Q=d(U.children[V.row+1].children[0]),T=Q.position(),S,N=d(M).offset(),P=k.createElement("div"),O=U.children,I=M.freezeHandleLeft=d(P).appendTo(M).addClass(A.theme.barHandleFreezeLeft+" "+A.cl.barHelper+" "+A.cl.barHandleFreezeLeft).width(Q.width()).css("top",(T.top-P.clientHeight+1)+"px").attr("title",A.msg.dragToFreezeRow);A.controls.bar.helper[A.i]=A.obj.barHelper().add(P);A.controls.bar.y.handleFreeze[A.i]=I;A.draggable(I,{axis:"y",start:function(){A.setBusy(true);S=d(k.createElement("div")).appendTo(M).css("position","absolute").addClass(A.theme.barFreezeIndicator+" "+A.cl.barHelper).width(P.clientWidth).fadeTo(0,0.33)},drag:function(){var X=A.nearest(I,O).prev();if(X.length&&X.position){S.height(X.position().top+X.height())}},stop:function(Z,X){S.remove();A.setBusy(false);A.setDirty(true);var Y=A.nearest(I,O);A.obj.barHelper().remove();R.end.row=u.frozenAt.row=D.max(A.getTdLocation(Y.children(0)).row-1,0);A.autoFillerHide();M.actionUI.scrollStart("y",A.sheetSize(M.table))},containment:[N.left,N.top,N.left,D.min(N.top+M.table.clientHeight,N.top+M.clientHeight-f.scrollBarSize.height)]});return true},corner:function(){}},menu:function(M,u){var P,I=d([]),O=A.theme.menuHover;switch(M){case"top":P=d(k.createElement("div")).addClass(A.theme.menu+" "+A.cl.tdMenu);A.controls.bar.x.menu[A.i]=P;break;case"left":P=d(k.createElement("div")).addClass(A.theme.menu+" "+A.cl.tdMenu);A.controls.bar.y.menu[A.i]=P;break;case"cell":P=d(k.createElement("div")).addClass(A.theme.menu+" "+A.cl.tdMenu);A.controls.tdMenu[A.i]=P;break}A.controls.menus[A.i]=A.obj.menus().add(P);P.mouseleave(function(){P.hide()}).bind("contextmenu",function(){return false}).appendTo(y).hide().disableSelectionSpecial();for(var N in u){if(u[N]){if(d.isFunction(u[N])){I.pushStack(d(k.createElement("div")).text(N).data("msg",N).click(function(){u[d(this).data("msg")].call(this,A);P.hide();return false}).appendTo(P).hover(function(){I.removeClass(O);d(this).addClass(O)},function(){d(this).removeClass(O)}))}else{if(u[N]=="line"){d(k.createElement("hr")).appendTo(P)}}}}return P},barMenu:{top:function(M,u,I){if(A.isBusy()){return false}var O=A.obj.barMenuTop().hide();if(!O.length){O=A.controlFactory.menu("top",L.contextmenuTop)}A.obj.menus().hide();if(!I){O.css("left",(M.pageX-5)+"px").css("top",(M.pageY-5)+"px").show();return O}var N=A.obj.barMenuParentTop().hide();if(!N.length){N=d(k.createElement("div")).addClass(A.theme.barMenuTop+" "+A.cl.barHelper+" "+A.cl.barTopMenuButton).append(d(k.createElement("span")).addClass("ui-icon ui-icon-triangle-1-s")).mousedown(function(P){N.parent().mousedown().mouseup();var Q=N.offset();O.css("left",(P.pageX-5)+"px").css("top",(P.pageY-5)+"px").show()}).blur(function(){if(O){O.hide()}});N.get(0).destroy=function(){N.remove();A.controls.bar.x.menuParent[A.i]=null};A.controls.bar.x.menuParent[A.i]=N}N.prependTo(I).show()},left:function(I,u){if(A.isBusy()){return false}A.obj.barMenuLeft().hide();if(u){A.obj.barHandleFreezeLeft().remove()}var M;M=A.obj.barMenuLeft();if(!M.length){M=A.controlFactory.menu("left",L.contextmenuLeft)}A.obj.menus().hide();M.css("left",(I.pageX-5)+"px").css("top",(I.pageY-5)+"px").show();return true},corner:function(){}},tdMenu:function(u){if(A.isBusy()){return false}A.obj.tdMenu().hide();var I=A.obj.tdMenu();if(!I.length){I=A.controlFactory.menu("cell",L.contextmenuCell)}A.obj.menus().hide();I.css("left",(u.pageX-5)+"px").css("top",(u.pageY-5)+"px").show();return true},header:function(){A.obj.header().remove();A.obj.sheetAdder().remove();A.obj.tabContainer().remove();var S=k.createElement("div"),M=k.createElement("table"),P=k.createElement("tr"),V,N,W=k.createElement("td"),X,O,I,T,u;S.appendChild(M);M.appendChild(P);S.className=A.cl.header+" "+A.theme.control;A.controls.header=d(S);if(L.title){if(d.isFunction(L.title)){L.title=A.title(A,E)}W.className=A.cl.title;A.controls.title=d(W).html(L.title)}else{d(W).hide()}P.appendChild(W);function U(Z){if(d.isFunction(Z)){Z=d(Z.call(A))}else{Z=d(Z)}if(Z.is("ul")){Z.find("ul").hide().addClass(A.theme.menuUl);Z.find("li").addClass(A.theme.menuLi).hover(function(){d(this).find("ul:first").hide().show()},function(){d(this).find("ul:first").hide()})}return Z}if(A.isSheetEditable()){if(L.menuLeft){O=k.createElement("td");O.className=A.cl.menu+" "+A.cl.menuFixed+" "+A.theme.menuFixed;P.insertBefore(O,W);A.controls.menuLeft[A.i]=d(O).append(U(L.menuLeft)).children().addClass(A.theme.menuFixed);A.controls.menuLeft[A.i].find("img").load(function(){A.sheetSyncSize()})}if(L.menuRight){I=k.createElement("td");I.className=A.cl.menu+" "+A.cl.menuFixed;P.appendChild(I);A.controls.menuRight[A.i]=d(I).append(U(L.menuRight)).children().addClass(A.theme.menuFixed);A.controls.menuRight[A.i].find("img").load(function(){A.sheetSyncSize()})}X=k.createElement("td");X.className=A.cl.label+" "+A.theme.control;A.controls.label=d(X);T=k.createElement("textarea");T.className=A.cl.formula+" "+A.theme.controlTextBox;T.onkeydown=A.evt.formula.keydown;T.onkeyup=function(){A.obj.inPlaceEdit().value=this.value};T.onchange=function(){A.obj.inPlaceEdit().value=this.value};T.onpaste=A.evt.pasteOverCells;T.onfocus=function(){A.setNav(false)};T.onfocusout=function(){A.setNav(true)};T.onblur=function(){A.setNav(true)};A.controls.formula=d(T);var R=k.createElement("span");R.appendChild(T);V=k.createElement("table");N=k.createElement("tr");V.appendChild(N);S.appendChild(V);u=k.createElement("td");u.className=A.cl.formulaParent;u.appendChild(R);N.appendChild(X);N.appendChild(u);N.appendChild(k.createElement("td"));A.resizableSheet(d(R),{minHeight:A.controls.formula.height(),maxHeight:78,handles:"s",resize:function(aa,Z){A.controls.formula.height(Z.size.height)},stop:function(){A.sheetSyncSize()}});var Y=d.sheet.instance;for(var Q=0;Q<Y.length;Q++){(Y||{}).nav=false}A.setNav(true);d(k).keydown(A.evt.document.keydown)}return S},ui:function(){var u=k.createElement("div");u.setAttribute("class",A.cl.ui);A.obj.ui=u;return u},sheetAdder:function(){var u=k.createElement("span");if(A.isSheetEditable()){u.setAttribute("class",A.cl.sheetAdder+" "+A.cl.tab+" "+A.theme.tab);u.setAttribute("title",A.msg.addSheet);u.innerHTML="+";u.onmousedown=function(){A.addSheet();return false};u.i=-1}return A.controls.sheetAdder=d(u)},tabContainer:function(){var u=k.createElement("span"),I;u.setAttribute("class",A.cl.tabContainer);u.onmousedown=function(N){N=N||f.event;var M=(N.target||N.srcElement).i;if(M>=0){A.trigger("sheetSwitch",[M])}return false};u.ondblclick=function(N){N=N||f.event;var M=(N.target||N.srcElement).i;if(M>=0){A.trigger("sheetRename",[M])}return false};if(A.isSheetEditable()&&d.fn.sortable){return A.controls.tabContainer=d(u).sortable({placeholder:"ui-state-highlight",axis:"x",forceHelperSize:true,forcePlaceholderSize:true,opacity:0.6,start:function(N,M){I=M.item.index();A.trigger("sheetTabSortStart",[N,M])},update:function(N,M){A.trigger("sheetTabSortUpdate",[N,M,I])}})}return A.controls.tabContainer=d(u)},sheetUI:function(U,V,O){A.i=O;A.tuneTableForSheetUse(V);A.readOnly[O]=(V.className||"").match(/\breadonly\b/i)!=null;var Q=V.tBody.children.length>0,P=A.controlFactory.enclosure(V),M=P.pane,I=d(M),R=function(Z){Z=Z||f.event;if(A.isBusy()){return false}if(A.isBar(Z.target)){var X=Z.target.entity,Y=A.getBarIndex[X](Z.target);if(Y<0){return false}if(A.evt.barInteraction.first==A.evt.barInteraction.last){A.controlFactory.barMenu[X](Z,Y)}}else{A.controlFactory.tdMenu(Z)}return false};U.appendChild(P);A.controlFactory.barTop(V);A.controlFactory.barLeft(V);M.appendChild(V);if(A.isSheetEditable()){A.controlFactory.autoFiller(M)}if(A.isSheetEditable()){var S=A.obj.formula(),W="";I.mousedown(function(X){A.setNav(true);if(A.isBusy()){return false}if(A.isCell(X.target)){if(X.button==2){R.call(this,X);A.evt.cellOnMouseDown(X);return true}A.evt.cellOnMouseDown(X);return false}if(A.isBar(X.target)){if(X.button==2){R.call(this,X)}W=X.target.entity;A.evt.barInteraction.select(X.target);return false}return true});M.onmouseup=function(){W=""};M.onmouseover=function(ab){ab=ab||f.event;var aa=ab.target||ab.srcElement;if(A.isBusy()){return false}if(!A.isBar(aa)){return false}var Z=d(aa),X=aa.entity,Y=A.getBarIndex[X](aa);if(Y<0){return false}if(A.evt.barInteraction.selecting&&X==W){A.evt.barInteraction.last=Y;A.cellSetActiveBar(X,A.evt.barInteraction.first,A.evt.barInteraction.last)}else{A.resizeBar[X](Z,Y,M,V);if(A.isSheetEditable()){A.controlFactory.barHandleFreeze[X](M);if(X=="top"){A.controlFactory.barMenu[X](ab,Y,Z)}}}return true};M.ondblclick=A.evt.cellOnDblClick;I.bind("contextmenu",R).disableSelectionSpecial().bind("cellEdit",A.evt.cellEdit)}A.createSpreadsheet(V,O);A.checkMinSize(V);A.controlFactory.tab();var N=A.s,u=N.hiddenRows,T=N.hiddenColumns;if(!u.length||!T.length){u=V.attributes["data-hiddenrows"]||{value:""};T=V.attributes["data-hiddencolumns"]||{value:""};if(u.value.length>0){u=c.toNumbers(u.value.split(","))}if(T.value.length>0){T=c.toNumbers(T.value.split(","))}}P.actionUI.hide(u,T,A.rows(V),A.cols(V));A.setChanged(true)},enclosure:function(O){var R=k.createElement("div"),Q=k.createElement("div"),N=d(Q),M=new j.ActionUI(Q,R,O,A.cl.scroll,A.s.frozenAt[A.i],d.sheet.max),P=M.scrollUI,I=0,u=0;O.size=function(){return A.tableSize(O)};R.size=function(){return A.sheetSize(O)};P.onscroll=function(){if(!A.isBusy()){var T=M.scrollTo({axis:"x",pixel:this.scrollLeft}),S=M.scrollTo({axis:"y",pixel:this.scrollTop});if(T||S){if(T&&this.scrollLeft>I){I=this.scrollLeft;A.calcVisibleCol(M)}if(S){if(this.scrollTop>u){u=this.scrollTop;A.calcVisibleRow(M)}A.updateYBarWidthToCorner(M)}A.obj.barHelper().remove();A.autoFillerGoToTd();if(R.inPlaceEdit){R.inPlaceEdit.goToTd()}}}};P.onmousedown=function(){A.obj.barHelper().remove()};Q.actionUI=R.actionUI=M;Q.scrollUI=R.scrollUI=P;Q.appendChild(Q.scrollUI);R.setAttribute("class",A.cl.pane+" "+A.theme.pane);Q.appendChild(R);Q.setAttribute("class",A.cl.enclosure);Q.pane=R;Q.table=O;R.table=O;R.enclosure=Q;R.$enclosure=N;O.pane=R;O.enclosure=Q;O.$enclosure=N;A.controls.pane[A.i]=R;A.controls.panes=A.obj.panes().add(R);A.controls.enclosure[A.i]=N;A.controls.enclosures=A.obj.enclosures().add(Q);return Q},tab:function(){var u=k.createElement("span"),I=A.controls.tab[A.i]=d(u).appendTo(A.obj.tabContainer());u.setAttribute("class",A.cl.tab+" "+A.theme.tab);A.sheetTab(true,function(M){u.innerHTML=M});u.i=A.i;A.controls.tabs=A.obj.tabs().add(I);return u},customTab:function(M){var u=k.createElement("span"),I=d(u).appendTo(A.obj.tabContainer());u.setAttribute("class",A.cl.tab+" "+A.theme.tab);u.innerHTML=M;return I},inPlaceEdit:function(Q,I){Q=Q||A.obj.tdActive();if(!Q.length){Q=d(A.rowTds(null,1)[1]);A.cellEdit(Q)}if(!Q.length){return}(A.obj.inPlaceEdit().destroy||F)();var P=A.obj.formula(),M=P.val(),u,O,N=A.obj.pane();if(!Q[0].isHighlighted){return}u=k.createElement("textarea");O=d(u);N.inPlaceEdit=u;u.i=A.i;u.className=A.cl.inPlaceEdit+" "+A.theme.inPlaceEdit;u.td=Q[0];u.goToTd=function(){this.offset=Q.position();if(!this.offset.left&&!this.offset.right){d(u).hide()}else{this.setAttribute("style","left:"+(this.offset.left-1)+"px;top:"+(this.offset.top-1)+"px;width:"+this.td.clientWidth+"px;height:"+this.td.clientHeight+"px;min-width:"+this.td.clientWidth+"px;min-height:"+this.td.clientHeight+"px;")}};u.goToTd();u.onkeydown=A.evt.inPlaceEdit.keydown;u.onchange=u.onkeyup=function(){P[0].value=u.value};u.onfocus=function(){A.setNav(false)};u.onblur=u.onfocusout=function(){A.setNav(true)};u.onpaste=A.evt.pasteOverCells;u.destroy=function(){N.inPlaceEdit=null;A.cellLast.isEdit=(u.value!=M);u.parentNode.removeChild(u);A.controls.inPlaceEdit[u.i]=false};N.appendChild(u);u.onfocus();A.controls.inPlaceEdit[A.i]=u;O.focus().val("").val(P[0].value);if(I){O.select()}if(d.fn.elastic){d(u).elastic()}},autoFiller:function(N){if(!L.autoFiller){return false}var I=k.createElement("div"),u=k.createElement("div"),M=k.createElement("div");I.i=A.i;I.className=A.cl.autoFiller+" "+A.theme.autoFiller;u.className=A.cl.autoFillerHandle;M.className=A.cl.autoFillerCover;I.onmousedown=function(){var P=A.obj.tdActive();if(P){var O=A.getTdLocation(P);A.cellSetActive(P,O,true,A.autoFillerNotGroup,function(){var R=A.highlighted(),Q=A.getTdLocation(R.last());A.fillUpOrDown(Q.row<O.row||Q.col<O.col);A.autoFillerGoToTd(P);A.autoFillerNotGroup=false})}return false};N.autoFiller=A.controls.autoFiller[A.i]=d(I);N.appendChild(I);return true}},autoFillerNotGroup:true,tsv:new TSV(),updateCellsAfterPasteToFormula:function(T){var S=0,R=A.obj.formula(),V=new a();T=T||R.val();var Q={row:A.cellLast.row,col:A.cellLast.col},I=R.val(),N=I;if(Q.row==0&&Q.col==0){return false}var W=A.tsv.parse(I);if(!d.isArray(W)){R.val(W);A.fillUpOrDown(false,W);return true}for(var P=0;P<W.length;P++){A.cellLast.isEdit=true;var u=W[P];for(var O=0;O<u.length;O++){S++;var M=A.getTd(A.i,P+Q.row,O+Q.col);M.row=Q.row;M.col=Q.col;if(M.length){if(!A.spreadsheets[A.i]||!A.spreadsheets[A.i][P+Q.row]||!A.spreadsheets[A.i][P+Q.row][O+Q.col]){continue}var U=A.spreadsheets[A.i][P+Q.row][O+Q.col];if(U){L.parent.one("sheetPreCalculation",function(){if((u[O]+"").charAt(0)=="="){U.formula=u[O].substring(1);U.value="";M.data("formula",u[O])}else{U.formula="";U.value=u[O];M.removeData("formula")}});A.calcDependencies.call(U);if(P==0&&O==0){N=u[O]}}}}}if(I!=N){R.val(N)}A.fillUpOrDown(false,N);A.evt.cellEditDone(true);return true},evt:{inPlaceEdit:{enter:function(u){if(u.shiftKey){return true}return A.evt.cellSetActiveFromKeyCode(u,true)},tab:function(u){if(u.shiftKey){return true}return A.evt.cellSetActiveFromKeyCode(u,true)},keydown:function(u){u=u||f.event;A.trigger("sheetFormulaKeydown",[true]);switch(u.keyCode){case q.ENTER:return A.evt.inPlaceEdit.enter(u);break;case q.TAB:return A.evt.inPlaceEdit.tab(u);break;case q.ESCAPE:A.evt.cellEditAbandon();return false;break}}},formula:{keydown:function(u){u=u||f.event;if(A.readOnly[A.i]){return false}if(A.cellLast.row<0||A.cellLast.col<0){return false}A.trigger("sheetFormulaKeydown",[false]);switch(u.keyCode){case q.C:if(u.ctrlKey){return A.evt.document.copy(u)}case q.X:if(u.ctrlKey){return A.evt.document.cut(u)}case q.Y:if(u.ctrlKey){A.evt.document.redo(u);return false}break;case q.Z:if(u.ctrlKey){A.evt.document.undo(u);return false}break;case q.ESCAPE:A.evt.cellEditAbandon();return true;break;case q.ENTER:A.evt.cellSetActiveFromKeyCode(u,true);return false;break;case q.UNKNOWN:return false}A.cellLast.isEdit=true},If:function(I,u){if(I){A.obj.tdActive().dblclick();return true}return false}},document:{enter:function(u){if(!A.cellLast.isEdit&&!u.ctrlKey){A.obj.tdActive().dblclick()}return false},tab:function(u){A.evt.cellSetActiveFromKeyCode(u)},findCell:function(u){if(u.ctrlKey){A.cellFind();return false}return true},redo:function(u){if(u.ctrlKey&&!A.cellLast.isEdit){A.undo.manager.redo();return false}return true},undo:function(u){if(u.ctrlKey&&!A.cellLast.isEdit){A.undo.manager.undo();return false}return true},copy:function(O,I){var N=A.highlighted(true),P=A.obj.formula(),M=P.val(),u=A.toTsv(N,I);P.val(u).focus().select();w.one("keyup",function(){if(I){P.val("")}else{P.val(M)}});return true},cut:function(u){return this.copy(u,true)},pageUpDown:function(u){var N=A.sheetSize(),R=A.obj.pane(),M=R.clientHeight,O=0,P=0,Q,I;if(u){for(I=A.cellLast.row;I>0&&O<M;I--){Q=A.getTd(A.i,I,1);if(!Q.data("hidden")&&Q.is(":hidden")){Q.show()}O+=Q.parent().height()}}else{for(I=A.cellLast.row;I<N.rows&&O<M;I++){Q=A.getTd(A.i,I,1);O+=Q.parent().height()}}A.cellEdit(Q);return false},keydown:function(u){u=u||f.event;if(A.readOnly[A.i]){return false}if(A.cellLast.row<0||A.cellLast.col<0){return false}var I=A.cellLast.td;if(A.nav){switch(u.keyCode){case q.DELETE:A.toTsv(null,true);A.obj.formula().val("");break;case q.TAB:A.evt.document.tab(u);break;case q.ENTER:A.evt.cellSetActiveFromKeyCode(u);break;case q.LEFT:case q.UP:case q.RIGHT:case q.DOWN:(u.shiftKey?A.evt.cellSetHighlightFromKeyCode(u):A.evt.cellSetActiveFromKeyCode(u));break;case q.PAGE_UP:A.evt.document.pageUpDown(true);break;case q.PAGE_DOWN:A.evt.document.pageUpDown();break;case q.HOME:case q.END:A.evt.cellSetActiveFromKeyCode(u);break;case q.V:if(u.ctrlKey){return A.evt.formula.If(!A.evt.pasteOverCells(u),u)}else{I.trigger("cellEdit");return true}break;case q.Y:if(u.ctrlKey){A.evt.document.redo(u);return false}else{I.trigger("cellEdit");return true}break;case q.Z:if(u.ctrlKey){A.evt.document.undo(u);return false}else{I.trigger("cellEdit");return true}break;case q.ESCAPE:A.evt.cellEditAbandon();break;case q.F:if(u.ctrlKey){return A.evt.formula.If(A.evt.document.findCell(u),u)}else{I.trigger("cellEdit");return true}break;case q.CAPS_LOCK:case q.SHIFT:case q.ALT:break;case q.CONTROL:A.obj.formula().focus().select();return true;break;default:I.trigger("cellEdit");return true;break}return false}}},pasteOverCells:function(I){I=I||f.event;if(I.ctrlKey||I.type=="paste"){var u=function(){A.updateCellsAfterPasteToFormula()};var M=w.one("keyup",function(){u();u=function(){};M.mouseup()}).one("mouseup",function(){u();u=function(){};M.keyup()});A.setDirty(true);A.setChanged(true);return true}return false},cellEditDone:function(M){(A.obj.inPlaceEdit().destroy||F)();if(A.cellLast.isEdit||M){var O=A.obj.formula(),N=A.obj.tdActive();if(A.isFormulaEditable(N)){if(N&&A.cellLast.row>0&&A.cellLast.col>0){var I=O.val(),u=N[0].jSCell;if(!u.edited){u.edited=true;A.obj.cellsEdited().push(u)}L.parent.one("sheetPreCalculation",function(){if(I.charAt(0)=="="&&A.formulaParser){N.data("formula",I);u.value=I;u.formula=I}else{N.removeData("formula");u.value=I;u.formula=""}});A.calcDependencies.call(u);A.cellLast.isEdit=false;A.trigger("sheetCellEdited",[u])}}}},cellEditAbandon:function(u){(A.obj.inPlaceEdit().destroy||F)();A.highlighter.clearBar().clear();if(!u){A.calc()}A.cellLast.td=d([]);A.cellLast.row=0;A.cellLast.col=0;A.rowLast=0;A.colLast=0;A.highlighter.start={row:0,col:0};A.highlighter.end={row:0,col:0};A.labelUpdate("",true);A.obj.formula().val("").blur();A.autoFillerHide();return false},cellSetHighlightFromKeyCode:function(O){var N=A.highlightedLastOrdered(),M=A.sheetSize(),R=A.obj.tdActive(),P=A.getTdLocation(R),Q=N.start,u=N.end,I=A.highlighter;switch(O.keyCode){case q.UP:if(Q.row<P.row){Q.row--;Q.row=D.max(Q.row,1);break}u.row--;u.row=D.max(u.row,1);break;case q.DOWN:if(Q.row===Q.end){Q.row++;Q.row=D.min(Q.row,M.rows);break}if(Q.row<P.row){Q.row++;Q.row=D.max(Q.row,1);break}u.row++;u.row=D.min(u.row,M.rows);break;case q.LEFT:if(Q.col<P.col){Q.col--;Q.col=D.max(Q.col,1);break}u.col--;u.col=D.max(u.col,1);break;case q.RIGHT:if(Q.col<P.col){Q.col++;Q.col=D.min(Q.col,M.cols);break}u.col++;u.col=D.min(u.col,M.cols);break}A.highlighter.start=Q;A.highlighter.end=u;A.cycleCellArea(function(S){I.set(S.td)},Q,u);return false},cellSetActiveFromKeyCode:function(O,u){var P={row:A.cellLast.row,col:A.cellLast.col},N=false,M,I=false;switch(O.keyCode){case q.UP:P.row--;break;case q.DOWN:P.row++;break;case q.LEFT:P.col--;break;case q.RIGHT:P.col++;break;case q.ENTER:P=A.evt.incrementAndStayInGrid(A.highlightedLastOrdered(),P,"row","col",O.shiftKey);N=true;M=A.highlighted();if(M.length>1){I=true}else{if(!u){P.row+=(O.shiftKey?-1:1)}if(L.autoAddCells&&P.row>A.sheetSize().rows){A.controlFactory.addRow()}}break;case q.TAB:P=A.evt.incrementAndStayInGrid(A.highlightedLastOrdered(),P,"col","row",O.shiftKey);N=true;M=A.highlighted();if(M.length>1){I=true}else{if(!u){P.col+=(O.shiftKey?-1:1)}if(L.autoAddCells&&P.col>A.sheetSize().cols){A.controlFactory.addColumn()}}break;case q.HOME:P.col=1;break;case q.END:P.col=A.obj.tdActive().parent().children("td").length-1;break}P.col=P.col||1;P.row=P.row||1;if(!A.cellLast.isEdit||N){var Q=A.getTd(A.i,P.row,P.col);if(Q){A.cellEdit(Q,null,I);return false}}return true},incrementAndStayInGrid:function(N,O,I,u,M){if(M){O[I]--;if(O[I]<N.start[I]){O[I]=N.end[I];O[u]--}if(O[u]<N.start[u]){O[u]=N.end[u]}}else{O[I]++;if(O[I]>N.end[I]){O[I]=N.start[I];O[u]++}if(O[u]>N.end[u]){O[u]=N.start[u]}}return O},cellOnMouseDown:function(u){A.obj.formula().blur();if(u.shiftKey){A.getTdRange(u,A.obj.formula().val())}else{A.cellEdit(d(u.target),true)}},cellOnDblClick:function(u){if(A.isBusy()){return false}A.controlFactory.inPlaceEdit();return true},cellEdit:function(u){if(A.isBusy()){return false}A.controlFactory.inPlaceEdit(null,true);return true},barInteraction:{first:0,last:0,selecting:false,select:function(M){if(!M){return}if(!M.type=="bar"){return}var u=M.entity,I=A.getBarIndex[u](M);if(I<0){return false}A[u+"Last"]=I;A.evt.barInteraction.last=A.evt.barInteraction.first=I;A.cellSetActiveBar(u,A.evt.barInteraction.first,A.evt.barInteraction.last);A.evt.barInteraction.first=A.evt.barInteraction.last=A[u+"Last"]=I;A.evt.barInteraction.selecting=true;w.one("mouseup",function(){A.evt.barInteraction.selecting=false});return false}}},refreshColumnLabels:function(P){P=P||0;var I=A.obj.barMenuParentTop();if((I)&&(I.length)){var O=I.get(0);if(d.isFunction(O.destroy)){O.destroy()}}var u=A.controls.bar.x.th[A.i],N;if(!u){return}for(var M=g.max(P,0);M<u.length;M++){if(M>0){N=u[M];N.text(h.columnLabelString(N[0].cellIndex))}}},refreshRowLabels:function(O,u){O=O||0;var I=A.controls.bar.y.th[A.i],N;if(!I){return}u=u||I.length;for(var M=O;M<u;M++){if(M>0){N=I[M];N.text(N[0].parentNode.rowIndex)}}},isCell:function(u){if(u&&u.tagName&&u.tagName=="TD"&&u.type&&u.type=="cell"){return true}return false},isBar:function(u){if(u&&u.tagName&&u.tagName=="TH"&&u.type&&u.type=="bar"){return true}return false},readOnly:[],isSheetEditable:function(u){u=u||A.i;return(L.editable==true&&!A.readOnly[u])},isFormulaEditable:function(u){if(L.lockFormulas){if(u.data("formula")!==J){return false}}return true},toggleFullScreen:function(){if(!A){return}A.evt.cellEditDone();var M=A.obj.fullScreen(),P=A.obj.pane();if(M.is(":visible")){t.unbind("jSResize");y.removeClass("bodyNoScroll");L.parent=M[0].origParent;L.parent.prepend(M.children());M.remove();A.sheetSyncSize();P.resizeScroll();A.trigger("sheetFullScreen",[false])}else{y.addClass("bodyNoScroll");var N=d(L.parent),M=k.createElement("div"),I=d._data(L.parent[0],"events");M.className=A.cl.fullScreen+" "+A.theme.fullScreen+" "+A.cl.parent;M.origParent=N;L.parent=A.controls.fullScreen=d(M).append(N.children()).appendTo(y);t.bind("resize",function(){t.trigger("jSResize")}).bind("jSResize",function(){this.w=t.width();this.h=t.height();L.parent.width(this.w).height(this.h);A.sheetSyncSize();P.resizeScroll()}).trigger("jSResize");N.trigger("sheetFullScreen",[true]);for(var O in I){for(var u=0;u<I[O].length;u++){L.parent.bind(O,I[O][u].handler)}}}},renameSheet:function(u){if(v(u)){return false}if(u>-1){A.sheetTab()}return true},switchSheet:function(u){if(v(u)){return false}if(u==-1){A.addSheet()}else{if(u!=A.i){A.setActiveSheet(u);A.calc(u)}}return true},tuneTableForSheetUse:function(M){var I=d(M);A.controls.table[A.i]=I.addClass(A.cl.table).addClass(A.theme.table).attr("id",A.id+A.i).attr("border","1px").attr("cellpadding","0").attr("cellspacing","0");M.spreadsheetIndex=A.i;A.formatTable(M);A.sheetDecorateRemove(false,I);A.controls.tables=A.obj.tables().add(M);var N=I.attr("data-frozenatrow")*1,u=I.attr("data-frozenatcol")*1;if(!A.s.frozenAt[A.i]){A.s.frozenAt[A.i]={row:0,col:0}}if(N){A.s.frozenAt[A.i].row=N}if(u){A.s.frozenAt[A.i].col=u}},createSpreadsheet:function(I,u){this.createSpreadsheetForArea(I,u)},createSpreadsheetForArea:function(V,Q,O,S,P,W,R){var Y=A.rows(V),X,I,U=(L.loader!==null?L.loader:null),u=L.colMargin+"px",N=(U!==null?U.setRowHeight:function(aa,ae,ad){var ac,ab,Z=u;if((ac=ad.nextSibling)===undefined){return Z}if((ab=ac.style)===undefined){return Z}if(ab.height!==undefined){Z=ab.height}ad.style.height=Z});O=O||0;S=S||Y.length-1;P=P||0;W=W||Y[0].children.length-1;if(O===0&&P===0){V.spreadsheet=A.spreadsheets[Q]=[]}X=S;if(X<0||I<0){return}do{var T=Y[X];I=W;if(T===undefined){if(R){A.controlFactory.addCells(null,false,X-(Y.length-1),"row-init");T=Y[X]}else{continue}}do{var M=T.children[I];if(M===undefined){if(R){A.controlFactory.addCells(null,false,I-(Y[0].children.length-1),"col-init");M=T.children[I]}else{continue}}if(X>0&&I>0){if(!M.jSCell){A.createCell(Q,X,I)}}else{if(I==0&&X>0){M.type="bar";M.entity="left";M.innerHTML=X;M.className=A.cl.barLeft+" "+A.cl.barLeft+"_"+A.i+" "+A.theme.bar;N.call(U,Q,X,M)}if(X==0&&I>0){M.type="bar";M.entity="top";M.innerHTML=h.columnLabelString(I);M.className=A.cl.barTop+" "+A.cl.barTop+"_"+A.i+" "+A.theme.bar}if(X==0&&I==0){M.type="bar";M.entity="corner";M.className=A.theme.bar+"  "+A.cl.barCorner;A.controls.bar.corner[A.i]=M}}}while(I-->P)}while(X-->O)},updateYBarWidthToCorner:function(P){var I=P.scrolledArea,O=P.table,u=O.tBody,N=O.corner,R=g.min(L.initCalcRows+I.end.row,u.lastChild.rowIndex),Q=u.children[R],M;if(Q===J){return}M=Q.children[0];N.col.style.width=L.colMargin+"px";N.col.style.width=M.scrollWidth+"px"},toggleHideRow:function(u){u=u||A.rowLast;if(!u){return}var M=A.rows()[u],I=A.obj.pane().actionUI;I.toggleHideRow(M,u);A.autoFillerGoToTd()},toggleHideColumn:function(I){I=I||A.colLast;if(!I){return}var u=A.cols()[I],M=A.obj.pane().actionUI;M.toggleHideColumn(u,I);A.autoFillerGoToTd()},rowShowAll:function(){A.obj.pane().actionUI.rowShowAll()},columnShowAll:function(){A.obj.pane().actionUI.columnShowAll()},merge:function(R){R=R||A.highlighted();if(!R.length){return}var P=[],I=R[0],O=R[R.length-1],W=A.getTdLocation(I),M=A.getTdLocation(O),Z={},U={},T=0,V=0,Y=new a(),Q=R.length-1,X,aa,N,u,S;if(W.row){A.setDirty(true);A.setChanged(true);if(W.row<M.row){Z.row=W.row;U.row=M.row;N=I}else{Z.row=M.row;U.row=W.row;N=O}if(N.getAttribute("rowSpan")||N.getAttribute("colSpan")){return false}u=d(N);if(W.col<M.col){Z.col=W.col;U.col=M.col}else{Z.col=M.col;U.col=W.col}V=(U.row-Z.row)+1;T=(U.col-Z.col)+1;S=A.getTdLocation(N);do{aa=R[Q];X=aa.jSCell;if(X.formula||X.value){P.unshift(X.formula?"("+X.formula.substring(1)+")":X.value)}L.parent.one("sheetPreCalculation",function(){if(aa.cellIndex!=S.col||aa.parentNode.rowIndex!=S.row){X.formula=null;X.value="";X.html="";X.defer=N.jSCell;X.calcLast=Y;aa.removeAttribute("data-formula");aa.removeAttribute("data-celltype");aa.innerHTML="";aa.style.display="none";aa.colSpan=T-(aa.cellIndex-N.cellIndex);aa.rowSpan=V-(aa.parentNode.rowIndex-N.parentNode.rowIndex)}});A.calcDependencies.call(X)}while(Q--);N.jSCell.value=P.join(" ");N.jSCell.formula=(N.jSCell.formula?P.join(" "):"");N.jSCell.calcLast=Y;N.style.display="";N.setAttribute("rowSpan",V);N.setAttribute("colSpan",T);A.calcDependencies.call(N.jSCell);A.evt.cellEditDone();A.autoFillerGoToTd(u);A.cellSetActive(u,S)}return true},unmerge:function(u){u=u||A.highlighted();if(!u){return}var M=u[0],Q=A.getTdLocation(M),R=new a(),T=D.max(M.getAttribute("rowSpan")*1,1)-1,I=D.max(M.getAttribute("colSpan")*1,1)-1,P=T+Q.row,N,S,O=[];if(T==0&&I==0){return false}do{N=Q.col+I;do{S=A.getTd(A.i,P,N)[0];S.style.display="";S.removeAttribute("colSpan");S.removeAttribute("rowSpan");S.jSCell.defer=null;A.calcDependencies.call(S.jSCell,R);O.push(S)}while(N-->Q.col)}while(P-->Q.row);A.evt.cellEditDone();A.autoFillerGoToTd(u);A.cellSetActive(u,Q);A.highlighter.set(d(O));return true},fillUpOrDown:function(R,T,V){A.evt.cellEditDone();V=V||A.highlighted(true);if(V.length<1){return false}var O=A.obj.tdActive(),S=new a();if(V.length<1){return false}var P=A.getTdLocation(V[0].td),W=A.getTdLocation(V[V.length-1].td),u=A.getTdLocation(O),M={row:0,col:0},I=T||O[0].jSCell.value,U=false,N=V.length-1,Q=function(){};T=T||O[0].jSCell.value;if(N>=0){if(T.charAt&&T.charAt(0)=="="){if(N>=0){do{if(!R){M.row=u.row-W.row;M.col=u.col-W.col}else{M.row=u.row-P.row;M.col=u.col-P.col}I=A.reparseFormula(T,M);L.parent.one("sheetPreCalculation",function(){V[N].formula=I;V[N].value="";V[N].td.data("formula",I)});A.calcDependencies.call(V[N],S)}while(N--);return true}}else{if((U=!v(I))||I.length>0){if(U&&I!=""){I*=1;if(R){I-=V.length-1}Q=function(){I++}}}do{L.parent.one("sheetPreCalculation",function(){V[N].formula="";V[N].value=I+"";V[N].td.removeData("formula")});A.calcDependencies.call(V[N],S);Q()}while(N--);return true}}return false},toTsv:function(V,N,T){V=V||A.highlighted(true);if(V.type){V=[V]}T=T||function(Y,X){if(N){L.parent.one("sheetPreCalculation",function(){X.formula="";X.value=""});A.calcDependencies.call(X,S)}};var Q=[],U,P,I={},S=new a(),M=V.length-1,W,u;if(M>=0){U=A.getTdLocation(V[0].td);P=A.getTdLocation(V[V.length-1].td);I.row=D.min(U.row,P.row);I.col=D.min(U.col,P.col);do{var O=A.getTdLocation(V[M].td),R=(V[M].formula?"="+V[M].formula:V[M].value);W=D.abs(O.row-I.row);u=D.abs(O.col-I.col);if(!Q[W]){Q[W]=[]}if((R+="").match(/\n/)){R='"'+R+'"'}Q[W][u]=(R||"");T.call(V[M].td,O,V[M])}while(M-->0);M=Q.length-1;do{Q[M]=Q[M].join("\t")}while(M-->0);return Q.join("\n")}return""},offsetFormulas:function(R,Q,M,P){var I=A.sheetSize(),O={first:{row:1,col:1},last:{row:I.rows,col:I.cols}},N=new a(),u=[];A.cycleCells(function(){var S=this;if(this.formula&&typeof this.formula=="string"&&A.isFormulaEditable(this.td)){this.formula=A.reparseFormula(this.formula,Q,R,M,P);this.td.data("formula","="+this.formula)}u.push(function(){A.calcDependencies.call(S,N,true)})},O.first,O.last);while(u.length){u.pop()()}A.evt.cellEditDone()},reparseFormula:function(O,N,M,u,I){return O.replace(h.regEx.cell,function(Q,R,V,W){if(R=="SHEET"){return Q}N=N||{loc:0,row:0};var P={row:V*1,col:h.columnLabelIndex(R)},U,T,S={row:V,col:R,use:false};if(M){if(I){if(u){if(P.col&&P.col==M.col-1){S.col="#REF!";S.use=true}if(P.row&&P.row==M.row-1){S.row="#REF!";S.use=true}if(P.col>=M.col){U=true}if(P.row>=M.row){T=true}}else{if(M.col&&P.col==M.col){S.col="#REF!";S.use=true}if(M.row&&P.row==M.row){S.row="#REF!";S.use=true}if(M.col&&P.col>M.col){U=true}if(M.row&&P.row>M.row){T=true}}if(S.use){return S.col+S.row}if(U){P.col+=N.col;return A.makeFormula(P)}if(T){P.row+=N.row;return A.makeFormula(P)}}else{if(u){if(M.col&&P.col>=M.col){U=true}if(M.row&&P.row>=M.row){T=true}}else{if(M.col&&P.col>M.col){U=true}if(M.row&&P.row>M.row){T=true}}if(U){P.col+=N.col;return A.makeFormula(P)}if(T){P.row+=N.row;return A.makeFormula(P)}}}else{return A.makeFormula(P,N)}return Q})},makeFormula:function(I,u){u=d.extend({row:0,col:0},u);I.col+=u.col;I.row+=u.row;if(I.col<0){I.col=0}if(I.row<0){I.row=0}return h.parseCellName(I.col,I.row)},cycleCells:function(O,R,M,I){I=I||A.i;R=R||{row:1,col:1};if(!M){var T=A.sheetSize();M={row:T.rows,col:T.cols}}var u=A.spreadsheets[I],N=M.row,Q,S,P;if(N<R.row){return}do{Q=M.col;S=u[N];do{P=S[Q];O.call(P,I,N,Q)}while(Q-->R.col)}while(N-->R.row)},cycleCellsAll:function(N){var O=A.i,M,I,u;for(M=0;M<=A.sheetCount;M++){A.i=M;I=A.sheetSize();u={row:I.rows,col:I.cols};A.cycleCells(N,{row:0,col:0},u,M)}A.i=O},cycleCellArea:function(S,W,P,O,T){var u={start:{},end:{}},R,V,X,U,N=A.i,I={cell:[],td:[]},Q=A.spreadsheets[N],M=(T?"unshift":"push");if(O){u.start=W;u.end=P}else{u.start.row=D.max(D.min(W.row,P.row),1);u.start.col=D.max(D.min(W.col,P.col),1);u.end.row=D.max(W.row,P.row,1);u.end.col=D.max(W.col,P.col,1)}R=u.end.row;do{V=u.end.col;X=Q[R]||null;do{if(X){U=X[V]||null;if(U){I.cell[M](U);I.td[M](U.td[0])}}}while(V-->u.start.col)}while(R-->u.start.row);if(S){S(I)}},formatTable:function(X){var V=L.newColumnWidth+"px",Q=L.colMargin+"px",I=X.children,O=I.length-1,N,M,T,u,S,W,P,U=(L.loader!==null?L.loader:null),R=(U!==null?U.setWidth:function(Y,Z,aa){aa.style.width=V});if(O>-1){do{switch(I[O].nodeName){case"TBODY":W=true;T=I[O];break;case"COLGROUP":P=true;u=I[O];break}}while(O--)}else{}if(!T){T=k.createElement("tbody");if(I.length>0){do{T.appendChild(I[0])}while(I.length)}}if(!u||u.children.length<1){u=k.createElement("colgroup");X.appendChild(u);X.appendChild(T);if(T.children.length>0){S=T.children[0];for(O=0,N=g.min(S.children.length,L.initCalcCols);O<N;O++){M=k.createElement("col");R.call(U,A.i,O,M);u.appendChild(M)}for(O=0,N=g.min(T.children.length,L.initCalcRows);O<N;O++){T.children[O].style.height=Q}}}X.tBody=T;X.colGroup=u;X.removeAttribute("width");X.style.width=""},checkMinSize:function(O){var M=A.tableSize(O),P=L.minSize.rows||0,u=L.minSize.cols||0,N=A.obj.pane().actionUI,I=N.frozenAt;P=g.max((I.row>P?I.row+1:P),1,L.initScrollRows);u=g.max((I.col>u?I.col+1:u),1,L.initScrollCols);if(M.cols<u){u-=M.cols;A.controlFactory.addColumnMulti(null,u,false,true,true)}M=A.tableSize(O);if(M.rows<P){P-=M.rows;A.controlFactory.addRowMulti(null,P,false,true,true)}},theme:null,highlighter:null,resizable:function(I,u){if(!I.data("resizable")){I.resizable(u)}},busy:[],setBusy:function(u){if(u){A.busy.push(u)}else{A.busy.pop()}},isBusy:function(){return(A.busy.length>0)},draggable:function(I,u){if(!I.data("jSdraggable")){I.data("jSdraggable",true).draggable(u)}},nearest:function(I,u){return d(I).nearest(u)},resizeBar:{top:function(P,M,R,I){A.obj.barTopControls().remove();var N=k.createElement("div"),Q=d(N).addClass(A.cl.barController+" "+A.theme.barResizer).width(P.width()).prependTo(P),u,O;A.controls.bar.x.controls[A.i]=A.obj.barTopControls().add(Q);A.resizableCells(Q,{handles:"e",start:function(T,S){A.autoFillerHide();A.setBusy(true);u=A.col(I,M);if(R.freezeHandleTop){R.freezeHandleTop.remove()}u.removeAttribute("width")},resize:function(T,S){u.style.width=S.size.width+"px";if(R.inPlaceEdit){R.inPlaceEdit.goToTd()}},stop:function(T,S){A.setBusy(false);R.resizeScroll();A.followMe();A.setDirty(true)},minWidth:32});O=N.children[0];O.style.height=P.outerHeight()+"px";O.style.position="absolute"},left:function(N,Q,M,U){A.obj.barLeftControls().remove();var P=N.offset(),V=k.createElement("div"),S=d(V).addClass(A.cl.barController+" "+A.theme.barResizer).prependTo(N).offset({top:P.top,left:P.left}),T=N[0],O=N.next()[0],W=O.parentNode,I=k.createElement("div"),u=d(I).addClass(A.cl.barControllerChild).height(N.height()).prependTo(S),R;A.controls.bar.y.controls[A.i]=A.obj.barLeftControls().add(S);A.resizableCells(u,{handles:"s",start:function(){A.autoFillerHide();A.setBusy(true);if(M.freezeHandleLeft){M.freezeHandleLeft.remove()}W.removeAttribute("height");T.removeAttribute("height");O.removeAttribute("height")},resize:function(Y,X){V.style.height=O.style.height=T.style.height=W.style.height=X.size.height+"px";if(M.inPlaceEdit){M.inPlaceEdit.goToTd()}},stop:function(Y,X){A.setBusy(false);M.resizeScroll();A.followMe();A.setDirty(true)},minHeight:15});R=I.children[0];R.style.width=N.outerWidth()+"px";R.style.position="absolute"},corner:function(){}},sheetDecorateRemove:function(I,u){u=u||A.obj.tables();u=(I?u.clone():u);u.find("td."+A.theme.tdActive).removeClass(A.theme.tdActive);u.find("td."+A.theme.tdHighlighted).removeClass(A.theme.tdHighlighted);return u},labelUpdate:function(I,u){if(!u){I=h.parseCellName(I.col,I.row);if(I){A.obj.label().text(I)}}else{A.obj.label().text(I)}},cellEdit:function(Q,N,M){if(A.cellLast.td.length<1){}A.autoFillerNotGroup=true;A.evt.cellEditDone();if(!Q.length){return}var O=A.getTdLocation(Q),u=Q[0].jSCell,I;if(!u){return}if(u.uneditable){return}A.trigger("sheetCellEdit",[u]);if(!Q.is(A.cellLast.td)){A.followMe(Q)}else{A.autoFillerGoToTd(Q)}A.labelUpdate(O);if(u.formula){I="="+u.formula}else{I=u.value}var P=A.obj.formula().val(I).blur();A.cellSetActive(Q,O,N,false,null,M)},cellSetActive:function(O,Q,I,S,P,M){Q=Q||A.getTdLocation(O);if(Q.col!=J){A.cellLast.td=O;A.cellLast.row=A.rowLast=Q.row;A.cellLast.col=A.colLast=Q.col;if(!M){A.highlighter.set(O).setStart(Q).setEnd(Q)}if(!O.length){return}A.highlighter.setBar("left",O[0].barLeft).setBar("top",O[0].barTop);var R,T;switch(L.cellSelectModel){case j.excelSelectModel:case j.googleDriveSelectModel:R=function(){};T=function(){};break;case j.openOfficeSelectModel:R=function(U){if(A.isCell(U)){A.cellEdit(d(U))}};T=function(){};break}if(I){var u={},N=A.obj.pane();u.last=Q;N.onmousemove=function(ac){ac=ac||f.event;var ad=ac.target||ac.srcElement;if(A.isBusy()){return false}var U=A.highlighter.end=A.getTdLocation(ad),ae=true,af=A.highlighter;if(U.col<1||U.row<1||U.col==H||U.row==H){return false}if(S){ae=false;if(Q.col==U.col||Q.row==U.row){ae=true}}if((u.last.col!=U.col||u.last.row!=U.row)&&ae){R(ad);A.cycleCellArea(function(ah){af.set(ah.td)},Q,U,false,true)}A.followMe(d(ad));var X=ac.clientY,Y=ac.clientX,Z=N.$enclosure.offset(),ag=A.getTdLocation(ad),aa=ag.row,W=ag.col,V=false,ab;if(v(aa)||v(W)){return false}if(X>Z.top){V=true;aa--}if(Y>Z.left){V=true;W--}if(V){if(aa<1||W<1){return false}ab=A.spreadsheets[A.i][aa][W];A.followMe(d(ab.td),true)}u.last=U;return true};k.onmouseup=function(){N.onmousemove=null;N.onmousemove=null;N.onmouseup=null;k.onmouseup=null;if(P){P()}}}}},colLast:0,rowLast:0,cellLast:{td:d([]),row:0,col:0,isEdit:false},highlightedLastOrdered:function(){var I=this.highlighter,u={start:{},end:{}};u.start.row=g.min(I.start.row,I.end.row);u.start.col=g.min(I.start.col,I.end.col);u.end.row=g.max(I.start.row,I.end.row);u.end.col=g.max(I.start.col,I.end.col);return u},cellStyleToggle:function(Q,P,N){N=N||A.highlighted();if(N.length<1){return false}A.setDirty(true);var R,O,M=N.length-1,u=A.obj.cellsEdited(),I;if(M>=0){I=N[0].className.match(Q);do{R=N[M];O=d(R);if(P){O.removeClass(P)}if(I){O.removeClass(Q)}else{O.addClass(Q)}if(!R.jSCell.edited){R.jSCell.edited=true;u.push(R.jSCell)}}while(M--);return true}return false},cellTypeToggle:function(N,I){I=I||A.highlighted(true);if(I.length<1){return}var M=I.length-1,u=I[M].cellType==N;if(M>=0){do{if(u){I[M].cellType=null}else{I[M].cellType=N}I[M].calcLast=0;A.updateCellValue.call(I[M])}while(M--)}},fontReSize:function(P,O){O=O||A.highlighted();if(O.length<1){return false}var I=0;switch(P){case"up":I=1;break;case"down":I=-1;break}var R,Q,N=O.length-1,M,u=A.obj.cellsEdited();if(N>=0){do{R=O[N];Q=d(R);M=(Q.css("font-size")+"").replace("px","")*1;Q.css("font-size",((M||10)+I)+"px");if(!R.jSCell.edited){R.jSCell.edited=true;u.push(R.jSCell)}}while(N--);return true}return false},callStack:0,updateCellValue:function(X,S,V){var R,Y,W,T,I,u,N,P,M,U="";if(this===J||this===null||this.jS===J){u=false;if((R=A.spreadsheets[X])===undefined){U=new o(U);U.html="#REF!";U.cell=null}else{if((Y=R[S])!==undefined){if((W=Y[V])!==undefined){u=true}}}if(u===false){if(L.loader!==null){if((W=L.loader.jitCell(X,S,V))===null){if(L.loader.hasSpreadsheetAtIndex(X)){return""}else{return"#REF!"}}else{if(typeof W.value==="string"){W.td[0].innerHTML=W.value;return W.value}}}else{return U}}}else{W=this}if(W===undefined){return""}W.oldValue=W.value;if(W.result){delete W.result}switch(W.state[W.state.length-1]){case"updating":return L.error({error:A.msg.loopDetected});case"updatingDependencies":return(W.valueOverride!=J?W.valueOverride:W.value)}if(W.defer){return A.updateCellValue.call(W.defer)}W.state.push("updating");W.fnCount=0;W.result=null;if(W.calcLast!=A.calcLast||W.calcDependenciesLast!=A.calcDependenciesLast){W.valueOverride=null;W.calcLast=A.calcLast;W.calcDependenciesLast=A.calcDependenciesLast;W.needsUpdated=true;W.calcCount++;if(W.formula){try{if(W.formula.charAt(0)=="="){W.formula=W.formula.substring(1)}var O;if(A.callStack){if(!W.formulaParser){W.formulaParser=f.Formula(A.cellHandler)}O=W.formulaParser}else{O=A.formulaParser}A.callStack++;O.setObj(W);W.result=O.parse(W.formula);W.result.cell=W;if(W.hasOwnProperty("loadedFrom")){L.loader.setCellAttribute(W.loadedFrom,"cache",W.result)}}catch(Q){W.result=Q.toString()}A.callStack--;if(W.result&&W.cellType&&L.cellTypeHandlers[W.cellType]){W.result=L.cellTypeHandlers[W.cellType].call(W,W.result)}I=A.filterValue.call(W)}else{if(W.value&&W.cellType&&L.cellTypeHandlers[W.cellType]){W.result=L.cellTypeHandlers[W.cellType].call(W,W.value);I=A.filterValue.call(W)}else{if(typeof W.value==="string"){T=A.s.cellStartingHandlers[W.value.charAt(0)];if(T){W.valueOverride=T.call(W,W.value)}else{T=A.s.cellEndHandlers[W.value.charAt(W.value.length-1)];if(T){W.valueOverride=T.call(W,W.value)}}}I=A.filterValue.call(W)}}if(L.loader!==null){N=W.td[0];if(X===J){X=W.sheet}if(S===J||V===J){P=A.getTdLocation(N);S=P.row;V=P.col}if((M=L.loader.getCell(X,S,V))!==null){M.formula=W.formula;M.cellType=W.cellType;M.value=W.value+"";M.cache=I;if(W.uneditable===true){M.uneditable=true}}}}if(W.value===J){W.value=new o("")}W.value.cell=W;if(W.value.cell===J){switch(typeof(W.value)){case"string":default:W.value=new o(W.value);W.value.cell=W}}W.needsUpdated=false;W.state.pop();return(W.valueOverride!=J?W.valueOverride:W.value)},updateCellDependencies:function(){if((this.state||(this.state=[])).length){return}var O,I,N,M,u=this.calcLast,P=this.calcDependenciesLast;this.state.push("updatingDependencies");O=this.dependencies||[];this.dependencies=[];M=O.length-1;if(M>-1){do{I=O[M];if(I.jSCell!==undefined){I=I.jSCell}N=A.getTdLocation(I.td);I.calcDependenciesLast=0;A.updateCellValue.call(I,I.sheet,N.row,N.col);if(N.row>0&&N.col>0){A.updateCellDependencies.call(I)}}while(M--)}if(this.dependencies.length===0&&this.calcLast===u&&this.calcDependenciesLast===P){this.dependencies=O}this.state.pop()},filterValue:function(){var I,M,u=this.result,N=this.td;if(u!==J&&u!==null){this.value=u.valueOf();M=u.html}if(typeof this.value==="string"&&this.value.length>0){I=L.encode(this.value)}if(N.html===J){return this.result}N.html(M||I||this.value);return N[0].innerHTML},cellHandler:{variable:function(){if(arguments.length){var N=arguments[0],I=arguments[1],O=A.s.formulaVariables,M,u;switch(N.toLowerCase()){case"true":u=new s(true);u.html="TRUE";return u;case"false":u=new s(false);u.html="FALSE";return u}if(M=O[N]&&!I){return M}else{if(M&&I){return M[I]}else{return""}}}},time:function(I,u){return i.fromString(I,u)},number:function(u){switch(typeof u){case"number":return u;case"string":if(!v(u)){return u*1}case"object":if(u.getMonth){return e.toCentury(u)}}return u},numberInverted:function(M){var I=A.cellHandler.number(M),u=new r(I.valueOf()*-1);if(I.html){u.html=I.html}return u},performMath:function(Q,P,O){var N,M,R=true,u=true,T=[],S,I=function(U){return U};switch(N=(typeof P.valueOf())){case"number":break;case"string":if(!v(P)){P*=1}else{R=false}break;case"object":if(P.getMonth){P=e.toCentury(P);I=e.get}else{R=false}break;default:R=false}switch(M=(typeof O.valueOf())){case"number":break;case"string":if(!v(O)){O*=1}else{u=false}break;case"object":if(O.getMonth){O=e.toCentury(O)}else{u=false}break;default:u=false}if(!R&&Q!=="+"){T.push("not a number: "+P);P=0}if(!u){T.push("not a number: "+O);O=0}if(T.length){}switch(Q){case"+":S=P+O;break;case"-":S=P-O;break;case"/":S=P/O;if(S==Infinity||S==H){S=0}break;case"*":S=P*O;break;case"^":S=D.pow(P,O);break}return I(S)},cellValue:function(I){var M=h.parseLocation(I.colString,I.rowString),u;u=A.cellHandler.createDependencyOnLocation.call(this,this.sheet,M.row,M.col);if(u!==null){A.updateCellValue.call(u,this.sheet,M.row,M.col);return(u.valueOverride!=J?u.valueOverride:u.value)}else{return""}},createDependencyOnLocation:function(I,P,M){var N,O,u;if((N=A.spreadsheets[I])===J||(O=N[P])===J||(u=O[M])===J){if(L.loader!==null){u=L.loader.jitCell(I,P,M)}}if(u===J||u===null){return null}if(!u.dependencies){u.dependencies=[]}if(d.inArray(this,u.dependencies)<0){u.dependencies.push(this)}u.jS=A;return u},createDependencyOnCell:function(u){if(!u.dependencies){u.dependencies=[]}if(d.inArray(this,u.dependencies)<0){u.dependencies.push(this)}u.jS=A},cellRangeValue:function(N,P){var O=h.parseLocation(N.colString,N.rowString),R=h.parseLocation(P.colString,P.rowString),T=D.max(O.row,R.row),U=D.min(O.row,R.row),M=D.max(O.col,R.col),I=D.min(O.col,R.col),S=A.spreadsheets[this.sheet],Q=A.cellHandler.createDependencyOnLocation,Z=A.cellHandler.createDependencyOnCell,u=A.updateCellValue,Y=[],W,V,X;if(S===J){A.spreadsheets[this.sheet]=S={}}if(T>=U||M>=I){do{W=M;X=(S[T]!==J?S[T]:null);do{if(X===null||(V=X[W])===J){V=Q.call(this,this.sheet,T,W)}else{Z.call(this,V)}Y.unshift(u.call(V,this.sheet,T,W))}while(W-->I)}while(T-->U);return Y}return Y},fixedCellValue:function(I,u){return A.cellHandler.cellValue.call(this,I.colString,I.rowString,u.colString,u.rowString)},fixedCellRangeValue:function(I,u){return A.cellHandler.cellRangeValue.call(this,I.colString,I.rowString,u.colString,u.rowString)},remoteCellValue:function(N,M){var O=h.parseLocation(M.colString,M.rowString),I=h.parseSheetLocation(N),u;if(I<0){I=A.getSpreadsheetIndexByTitle(N)}u=A.cellHandler.createDependencyOnLocation.call(this,I,O.row,O.col);return A.updateCellValue.call(u,I,O.row,O.col)},remoteCellRangeValue:function(Q,u,M){var I=h.parseLocation(u.colString,u.rowString),P=h.parseLocation(M.colString,M.rowString),R=h.parseSheetLocation(Q);if(R<0){R=A.getSpreadsheetIndexByTitle(Q)}var S=[];for(var O=I.row;O<=P.row;O++){for(var N=I.col;N<=P.col;N++){S.push(A.updateCellValue(R,O,N))}}return[S]},callFunction:function(M,I){M=M.toUpperCase();I=I||[];var N=d.sheet.fn[M],u;if(N!==J){this.fnCount++;u=N.apply(this,I);return u}else{return L.error({error:"Function "+M+" Not Found"})}}},calcLast:0,calcDependenciesLast:0,calc:function(u,M){u=u||A.i;if(A.readOnly[u]||A.isChanged(u)===false&&!M||!A.formulaParser){return false}A.calcLast=new a();if(L.loader!==null){L.loader.cycleCells(u,A.updateCellValue)}else{var I=A.spreadsheetToArray(null,u);h.calc(u,I,A.updateCellValue);A.trigger("sheetCalculation",[{which:"spreadsheet",sheet:I,index:u}])}A.setChanged(false);return true},calcAll:function(M){var I=0,u;if(L.loader){u=L.loader.count;for(;I<u;I++){A.calc(I,M)}}else{u=A.spreadsheets.length;for(;I<u;I++){A.calc(I,M)}}},calcVisiblePos:{row:-1,col:-1},calcVisibleInit:function(T){T=T||A.i;A.calcLast=A.calcLast||new a();var I=A.spreadsheetToArray(null,T)||[],O=A.updateCellValue,M=g.min,N=L.initCalcRows,u=L.initCalcCols,R=M(I.length-1,N),U,S,Q={row:-1,col:-1},P=[];if(R>0){Q.row=R;do{if(R>0&&(U=I[R])!==undefined){Q.col=S=M(U.length-1,u);if(S>0){do{P.push({cell:U[S],rowIndex:R,colIndex:S,make:function(){O.call(this.cell,T,this.rowIndex,this.colIndex)}})}while(S-->1)}}}while(R-->1)}this.calcVisiblePos=Q;A.trigger("sheetCalculation",[{which:"spreadsheet",sheet:I,index:T}]);A.setChanged(false)},calcVisibleRow:function(U,R){R=R||A.i;var Q=A.spreadsheetToArray(null,R)||[],V=U.scrolledArea.end,Z=U.pane.size(),O=A.updateCellValue,W=L.initCalcRows,Y=L.initCalcCols,N=(V.row+W)-1,M=(V.col+Y)-1,X,S,aa,ab=this.calcVisiblePos,I={row:X,col:ab.col},u,T=[];N=N<Z.rows?N:Z.rows;M=M<Z.cols?M:Z.cols;X=N;if(X>0){do{aa=M;if((S=Q[X])!==undefined){if(aa>0){do{T.push({row:S,cell:S[aa],rowIndex:X,colIndex:aa,make:function(){var ac=this;if((this.cell=this.row[this.colIndex])===undefined){A.createCell(A.i,this.rowIndex,this.colIndex);this.cell=Q[this.rowIndex][this.colIndex]}O.call(ac.cell,R,ac.rowIndex,ac.colIndex)}})}while(aa-->1)}}else{if(aa>0){do{var P=X;T.push({row:S,cell:S!==J?S[aa]:J,rowIndex:X,colIndex:aa,offset:P,make:function(){while(this.offset>0&&Q[this.offset]===undefined){A.createSpreadsheetForArea(U.table,R,this.offset,this.offset,this.colIndex,this.colIndex,true);this.offset--}if((this.row=Q[this.rowIndex])!==undefined){O.call(this.row[this.colIndex]!==J?this.row[this.colIndex]:(this.row[this.colIndex]={}),R,this.rowIndex,this.colIndex)}}})}while(aa-->1)}}}while(X-->ab.row)}this.calcVisiblePos=I;z(T,{each:function(){this.make()}});A.trigger("sheetCalculation",[{which:"spreadsheet",sheet:Q,index:R}]);A.setChanged(false)},calcVisibleCol:function(u,Z){Z=Z||A.i;var P=A.spreadsheetToArray(null,Z)||[],M=u.scrolledArea.end,I=u.pane.size(),T=A.updateCellValue,S=L.initCalcRows,N=L.initCalcCols,O=(M.row+S)-1,R=(M.col+N)-1,W,aa,Y,X,Q=this.calcVisiblePos,U={row:Q.row,col:Q.col},V=[];O=O<I.rows?O:I.rows;R=R<I.cols?R:I.cols;W=O;if(W>0&&R>0){do{Y=R;aa=P[W];V.push({row:aa,cell:aa[Y],rowIndex:W,colIndex:Y,make:function(){if(this.row===undefined||this.cell===undefined){A.createSpreadsheetForArea(u.table,Z,this.rowIndex,this.rowIndex,this.colIndex,this.colIndex,true);this.row=P[this.rowIndex]}X=this.row[this.colIndex];T.call(X,Z,this.rowIndex,this.colIndex)}})}while(W-->1)}this.calcVisiblePos=U;z(V,{each:function(){this.make()}});A.trigger("sheetCalculation",[{which:"spreadsheet",sheet:P,index:Z}]);A.setChanged(false)},calcDependencies:function(M,I){M=M||new a();A.calcDependenciesLast=M;if(!I){var u=this;A.undo.createCells([this],function(N){A.trigger("sheetPreCalculation",[{which:"cell",cell:u}]);A.setDirty(true);A.setChanged(true);A.updateCellValue.call(u);A.updateCellDependencies.call(u);A.trigger("sheetCalculation",[{which:"cell",cell:u}]);return N})}else{A.trigger("sheetPreCalculation",[{which:"cell",cell:this}]);A.setDirty(true);A.setChanged(true);A.updateCellValue.call(this);A.updateCellDependencies.call(this);A.trigger("sheetCalculation",[{which:"cell",cell:this}])}},addSheet:function(u){u=u||{rows:25,cols:10};A.evt.cellEditAbandon();A.setDirty(true);A.controlFactory.sheetUI(A.obj.ui,d.sheet.makeTable(u),A.sheetCount);A.setActiveSheet(A.sheetCount);A.sheetCount++;A.sheetSyncSize();A.obj.pane().resizeScroll();A.trigger("sheetAdd",[A.i])},insertSheet:null,deleteSheet:function(I){var O=I||A.i,N=A.controls.enclosures.toArray(),u;N.splice(O,1);A.obj.barHelper().remove();A.obj.enclosure().remove();A.controls.enclosures=d(N);A.obj.menus().remove();A.obj.tabContainer().children().eq(A.i).remove();A.spreadsheets.splice(O,1);A.controls.autoFiller.splice(O,1);A.controls.bar.helper.splice(O,1);A.controls.bar.corner.splice(O,1);A.controls.bar.x.controls.splice(O,1);A.controls.bar.x.handleFreeze.splice(O,1);A.controls.bar.x.controls.splice(O,1);A.controls.bar.x.menu.splice(O,1);if(A.controls.bar.x.menuParent&&A.controls.bar.x.menuParent[O]){A.controls.bar.x.menuParent.splice(O,1)}A.controls.bar.x.parent.splice(O,1);A.controls.bar.x.th.splice(O,1);A.controls.bar.y.controls.splice(O,1);A.controls.bar.y.handleFreeze.splice(O,1);A.controls.bar.y.controls.splice(O,1);A.controls.bar.y.menu.splice(O,1);if(A.controls.bar.y.menuParent&&A.controls.bar.y.menuParent[O]){A.controls.bar.y.menuParent.splice(O,1)}A.controls.bar.y.parent.splice(O,1);A.controls.bar.y.th.splice(O,1);A.controls.barMenuLeft.splice(O,1);A.controls.barMenuTop.splice(O,1);A.controls.barLeft.splice(O,1);A.controls.barTop.splice(O,1);A.controls.barTopParent.splice(O,1);A.controls.chart.splice(O,1);A.controls.tdMenu.splice(O,1);A.controls.enclosure.splice(O,1);A.controls.fullScreen=null;A.controls.inPlaceEdit.splice(O,1);A.controls.menus.splice(O,1);A.controls.menuLeft.splice(O,1);A.controls.menuRight.splice(O,1);A.controls.pane.splice(O,1);A.controls.tables.splice(O,1);A.controls.table.splice(O,1);for(u=O+1;u<A.controls.tab.length;++u){var M=A.controls.tab[u].get(0);M.i--}A.controls.tab.splice(O,1);A.controls.toggleHide.x.splice(O,1);A.controls.toggleHide.y.splice(O,1);A.readOnly.splice(O,1);A.i=0;A.sheetCount--;A.sheetCount=D.max(A.sheetCount,0);if(A.sheetCount==0){A.addSheet()}A.setActiveSheet(A.i);A.setDirty(true);A.setChanged(true);A.trigger("sheetDelete",[O])},deleteRow:function(O,I){var N,Q,u,P,M=A.sheetSize();if(O){Q=u=O}else{Q=D.min(A.highlighter.start.row,A.highlighter.end.row);u=D.max(A.highlighter.start.row,A.highlighter.end.row)}P=(u-Q)+1;if(Q<1||M.cols<2||P>=M.rows){return}N=u;do{A.getTd(A.i,N,1).parent().remove()}while(Q<N--);A.controls.bar.y.th[A.i].splice(Q,P);A.spreadsheets[A.i].splice(Q,P);A.refreshRowLabels(Q);A.setChanged(true);A.offsetFormulas({row:Q,col:0},{row:-P,col:0},false,true);A.setDirty(true);A.evt.cellEditAbandon();A.obj.pane().resizeScroll();A.trigger("sheetDeleteRow",N)},deleteColumn:function(Q){var O,u,N,S,U=A.sheetSize();if(Q){u=N=Q}else{u=D.min(A.highlighter.start.col,A.highlighter.end.col);N=D.max(A.highlighter.start.col,A.highlighter.end.col)}S=(N-u)+1;if(u<1||U.cols<2||S>=U.cols){return}O=N;A.obj.barHelper().remove();do{var T=A.obj.table(),I=A.col(T[0],O),R=A.obj.barTop(O).remove(),P=I.tds,M=P.length-1;do{d(P[M]).remove()}while(M--);A.obj.barTop(O).remove();d(I).remove()}while(u<O--);A.controls.bar.x.th[A.i].splice(u,S);M=A.spreadsheets[A.i].length-S;do{A.spreadsheets[A.i][M].splice(u,S)}while(M-->1);A.refreshColumnLabels(u);A.setChanged(true);A.offsetFormulas({row:0,col:u},{row:0,col:-S},false,true);A.setDirty(true);A.evt.cellEditAbandon();A.obj.pane().resizeScroll();A.trigger("sheetDeleteColumn",O)},sheetTab:function(I,N){var u="",M;if(I){M=A.obj.table();u=M.attr("title")||A.msg.sheetTitleDefault.replace(/[{]index[}]/gi,A.i+1);if(N){M.attr("title",u);N(u)}return u}else{if(A.isSheetEditable()&&L.editableNames){L.prompt(A.msg.newSheetTitle,function(O){if(!O){u=A.obj.table().attr("title");O=(u?u:A.msg.sheetTitleDefault.replace(/[{]index[}]/gi,A.i+1))}else{A.setDirty(true);A.obj.table().attr("title",O);A.obj.tab().html(O);u=O}if(N){N(d(k.createElement("div")).text(u).html())}},A.sheetTab(true));return null}}},followMe:function(M,u){M=M||A.obj.tdActive();if(!M.length){return}var N=A.obj.pane(),I=N.actionUI;A.setBusy(true);I.putTdInView(M[0]);A.setBusy(false);if(!u){A.autoFillerGoToTd(M)}},autoFillerGoToTd:function(N,I,u){if(!L.autoFiller){return}N=N||A.obj.tdActive();var O=N[0];if(O&&O.type=="cell"){I=I||O.clientHeight;u=u||O.clientWidth;if(!O.offsetHeight||!O.offsetWidth||!O.clientHeight||!O.clientWidth){A.autoFillerHide();return}var M=N.position();A.obj.autoFiller().show().css("top",((M.top+(I||N.height())-3)+"px")).css("left",((M.left+(u||N.width())-3)+"px"))}},autoFillerHide:function(){if(!L.autoFiller){return}A.obj.autoFiller().hide()},setActiveSheet:function(N,u){if(u!==undefined){N=u.i}else{N=N||0}if(A.cellLast.row>0||A.cellLast.col>0){A.evt.cellEditDone();A.obj.formula().val("")}var M=A.obj.enclosures(),I=M.length-1,O;A.autoFillerHide();if(I>0){do{if(N!=I){O=M[I];O._scrollLeft=O._scrollLeft||O.scrollUI.scrollLeft;O._scrollTop=O._scrollTop||O.scrollUI.scrollTop;O.style.display="none"}}while(I-->0)}A.i=N;if(u!==undefined){O=u.enclosure}else{O=A.controls.enclosure[N][0]}O.style.display="";A.highlighter.setTab(A.obj.tab());A.readOnly[N]=(O.table.className||"").match(/\breadonly\b/i)!=null;O.pane.resizeScroll(true);O.scrollUI.scrollLeft=O._scrollLeft||O.scrollUI.scrollLeft;O.scrollUI.scrollTop=O._scrollTop||O.scrollUI.scrollTop;O._scrollLeft=O._scrollTop=null;O.scrollUI.onscroll()},getSpreadsheetIndexByTitle:function(P){if(L.loader!==null){var O=L.loader.getSpreadsheetIndexByTitle(P);return O}var M=A.obj.tables(),u=M.length,N,I=0;for(;I<u;I++){N=M[I];if(N.getAttribute("title")==P){return N.spreadsheetIndex}}return null},openSheet:function(I){var M=I.length-1,u=function(){A.setBusy(true);var T=A.controlFactory.header(),S=A.controlFactory.ui(),N=A.controlFactory.sheetAdder(),P=A.controlFactory.tabContainer(),R,Q={sizeCheck:function(U){if(d.sheet.max){var V=A.tableSize(U.table);if(V.rows>d.sheet.max||V.cols>d.sheet.max){A.trigger("sheetMaxSize",[U.table,U.i]);L.confirm(A.msg.maxSizeBrowserLimitationOnOpen,function(){U.load()})}else{U.load()}}else{U.load()}},initChildren:function(W,V,U){A.controlFactory.sheetUI(W,V,U);A.trigger("sheetOpened",[U])},done:function(U){A.sheetSyncSize();A.setActiveSheet(0);A.setDirty(false);A.setBusy(false);while(U.length){A.calcVisibleInit(A.i=U.pop())}A.trigger("sheetAllOpened")},lastIndex:M},O;T.ui=S;T.tabContainer=P;S.header=T;S.sheetAdder=N;S.tabContainer=P;P.header=T;P.ui=S;L.parent.append(T).append(S).append(N).append(P);A.resizableSheet(L.parent,{minWidth:L.parent.width()*0.1,minHeight:L.parent.height()*0.1,start:function(){A.setBusy(true);A.obj.enclosure().hide();S.sheetAdder.hide();S.tabContainer.hide()},stop:function(){A.obj.enclosure().show();S.sheetAdder.show();S.tabContainer.show();A.setBusy(false);A.sheetSyncSize();A.obj.pane().resizeScroll()}});if(L.loader===null){for(R=0;R<I.length;R++){new j.SpreadsheetUI(R,S,I[R],Q);A.sheetCount++}}else{A.insertSheet=function(X,U,W,V){A.sheetCount++;X=X||null;V=V||k.createElement("table");W=W!==undefined?W:true;U=U||A.sheetCount;if(X!==null){loader.addSpreadsheet(X)}if(!V.hasAttribute("title")){V.setAttribute("title",loader.title(U))}var Y=function(){A.obj.enclosure().hide();A.setBusy(true);var Z=new j.SpreadsheetUI(U,S,V,Q);A.setActiveSheet(-1,Z);A.calcVisibleInit(U);A.setBusy(false);A.sheetSyncSize()};if(W){Y();return}A.controlFactory.customTab(L.loader.title(U)).mousedown(function(){Y();A.obj.tab().insertBefore(this);d(this).remove();return false})};O=new j.SpreadsheetUI(0,S,I[0],Q);A.sheetCount++;if(I.length>1){for(R=1;R<I.length;R++){A.insertSheet(null,R,false,I[R])}A.i=0;O.loaded()}}};if(A.isDirty){L.confirm(A.msg.openSheet,u)}else{u()}},newSheet:function(){L.parent.html(d.sheet.makeTable()).sheet(L)},sheetSyncSize:function(){var U=L.parent,Q=U[0],W=Q.clientHeight,R=Q.clientWidth,V=A.obj.tabContainer(),X=V[0],u=X.style,aa=f.scrollBarSize.width,I,Z,T,S,O=A.obj.ui.style,P,ab,N,Y,M;if(!W){W=400;U.height(W)}else{if(W<200){W=200;U.height(W)}}M=X.scrollLeft;u.width="";I=X.clientWidth;Z=(R-(L.colMargin+aa));T=(R-L.colMargin*2)+"px";S=((L.colMargin+aa)+"px");if(I>Z){u.height=S;V.addClass(A.cl.tabContainerScrollable);W-=aa}else{u.height=null;V.removeClass(A.cl.tabContainerScrollable)}u.width=T;X.scrollLeft=M;W-=A.obj.header().outerHeight()+L.boxModelCorrection;W-=X.clientHeight+L.boxModelCorrection;P=(W-f.scrollBarSize.height-L.boxModelCorrection)+"px";ab=(R-f.scrollBarSize.width)+"px";N=(W+"px");Y=(R+"px");A.obj.panes().each(function(){var ae=this.style,ad=this.actionUI.scrollUI.style,ac=this.enclosure.style;ae.height=P;ae.width=ab;ac.height=ad.height=N;ac.width=ad.width=Y});O.height=N;O.width=Y},cellChangeStyle:function(M,N,u){u=u||A.highlighted(true);if(u.length<1){return false}A.setDirty(this);var I=u.length-1;if(I>=0){A.undo.createCells(u,function(O){do{O[I].td.css(M,N)}while(I--);return O});return true}return false},cellFind:function(u){function I(N){var M=A.obj.table().children("tbody").children("tr");if(N){var O=M.children('td:contains("'+N+'")');if(O.length<1){O=M.children('td:contains("'+N.toLowerCase()+'")')}if(O.length<1){O=M.children('td:contains("'+N.toUpperCase()+'")')}O=O.eq(0);if(O.length>0){A.cellEdit(O)}else{L.alert(A.msg.cellNoFind)}}}if(!u){L.prompt(A.msg.cellFind,I)}else{I(u)}},cellSetActiveBar:function(S,M,N){var X=A.sheetSize(),P=D.min(M,N),U=D.max(M,N),u={},T={},W=function(Y){switch(L.cellSelectModel){case j.openOfficeSelectModel:this.row=(Y?u.row:T.row);this.col=(Y?u.col:T.col);this.td=A.getTd(A.i,this.row,this.col);if(!this.td.is(A.cellLast.td)){A.cellEdit(this.td,false,true)}break;default:this.row=(Y?T.row:u.row);this.col=(Y?T.col:u.col);this.td=A.getTd(A.i,this.row,this.col);if(!this.td.is(A.cellLast.td[0])){A.cellEdit(this.td,false,true)}break}},O=[],Q=A.obj.pane().actionUI.scrolledArea,R=A.obj.table(),I,V;switch(S){case"top":u.row=Q.end.row;u.col=P;T.row=Q.end.row;T.col=U;A.highlighter.start.row=1;A.highlighter.start.col=P;A.highlighter.end.row=X.rows;A.highlighter.end.col=U;I=U;do{O.push(A.col(R[0],I))}while(I-->P);break;case"left":u.row=P;u.col=Q.end.col;T.row=U;T.col=Q.end.col;A.highlighter.start.row=P;A.highlighter.start.col=1;A.highlighter.end.row=U;A.highlighter.end.col=X.cols;V=U;do{O.push(A.getTd(A.i,V,1)[0].parentNode)}while(V-->P);break;case"corner":u.row=1;u.col=1;T.col=X.cols;T.row=X.rows;O.push(R[0]);break}new W(M>N);A.highlighter.set(d(O))},getTdRange:function(N,S,Q,R){A.cellLast.isEdit=true;var I=function(U){if(U.first.col>U.last.col||U.first.row>U.last.row){return{first:h.parseCellName(U.last.col,U.last.row),last:h.parseCellName(U.first.col,U.first.row)}}else{return{first:h.parseCellName(U.first.col,U.first.row),last:h.parseCellName(U.last.col,U.last.row)}}},P=function(X){var U=I(X),W=S+"";W=(W.match(/=/)?W:"="+W);if(Q||W.charAt(W.length-1)!="("){W=W+(Q?Q:"")+"("}var Y,V="";if(U.first!=U.last){Y=U.first+":"+U.last}else{Y=U.first}if(W.charAt(W.length-1)=="("){V=")"}return W+Y+V},u="",M,O,T;if(N){M={first:A.getTdLocation([N.target])};O=A.obj.table().mousemove(function(U){M.last=A.getTdLocation([U.target]);u=P(M);if(!R){A.obj.formula().val(u);A.obj.inPlaceEdit().val(u)}});w.one("mouseup",function(){O.unbind("mousemove");return u})}else{T=A.highlighted().not(A.obj.tdActive());if(T.length){M={first:A.getTdLocation(T.first()),last:A.getTdLocation(T.last())};u=P(M);if(!R){A.obj.formula().val(u);A.obj.inPlaceEdit().val(u)}return u}else{return""}}return""},getTd:function(O,Q,I){var M=A.obj.tables()[O],u,N,P;if(!M||!(u=M.tBody)||!(N=u.children[Q])||!(P=N.children[I])){P=k.createElement("td")}return d(P)},getTdLocation:function(I){var u={col:0,row:0};I=I||"";if(!I&&!I[0]){return u}I=I[0]||I;if(I.parentNode==J||I.parentNode.rowIndex<0){return u}return{col:parseInt(I.cellIndex),row:parseInt(I.parentNode.rowIndex)}},getBarIndex:{left:function(u){u=u||{};if(!u.parentNode||v(u.parentNode.rowIndex)){return -1}else{return u.parentNode.rowIndex}},top:function(u){u=u||{};if(v(u.cellIndex)){return -1}else{return u.cellIndex}},corner:function(){return 0}},time:{now:new a(),last:new a(),diff:function(){return D.abs(D.ceil(this.last.getTime()-this.now.getTime())/1000).toFixed(5)},set:function(){this.last=this.now;this.now=new a()},get:function(){return this.now.getHours()+":"+this.now.getMinutes()+":"+this.now.getSeconds()}},changed:[],isChanged:function(u){return A.changed[u||A.i]},setChanged:function(u){A.changed[A.i]=u},isDirty:false,setDirty:function(u){A.dirty=u},appendToFormula:function(u){var M=A.obj.formula(),I=M.val();if(I.charAt(0)!="="){I="="+I}M.val(I+u)},undo:{manager:(f.UndoManager?new UndoManager():{undo:F,redo:F,register:F,notLoaded:true}),cells:[],id:0,createCells:function(u,I,O){if(A.undo.manager.notLoaded){this.createCells=function(P,Q,R){return Q(P)};return this.createCells(u,I,O)}if(O==J){A.undo.id++;O=A.undo.id}var M=(new j.CellRange(u)).clone().cells,N=(I?(new j.CellRange(I(u)).clone()).cells:M);M.id=O;N.id=O;A.undo.manager.add({undo:function(){A.undo.removeCells(M,O)},redo:function(){A.undo.createCells(N,null,O)}});if(O!=A.undo.id||!I){A.calcLast=new a();A.undo.draw(N)}return true},removeCells:function(I,N){var M=0,u=-1;if(I.id===N){u=M}if(u!==-1){A.undo.cells.splice(u,1)}A.undo.draw(I)},draw:function(M){var I;for(I=0;I<M.length;I++){var O=M[I],N=A.getTdLocation(O.td),u=A.spreadsheets[O.sheet][N.row][N.col];u.value=O.value;u.formula=O.formula;u.td=O.td;u.dependencies=O.dependencies;u.needsUpdated=O.needsUpdated;u.calcCount=O.calcCount;u.sheet=O.sheet;u.calcLast=O.calcLast;u.html=O.html;u.state=O.state;u.jS=O.jS;u.calcDependenciesLast=O.calcDependenciesLast;u.td.attr("style",O.style);u.td.attr("class",O.cl);A.updateCellValue.call(u)}}},cols:function(u){u=u||A.obj.table()[0];if(!u){return[]}if(!u.colGroup){return[]}if(!u.colGroup.children){return[]}return u.colGroup.children},tables:function(T,O){T=T||A.obj.tables();var S=[],M=T.length-1,I,V,R,u,W,N,U,P,Q;do{V=(O?k.body.removeChild(T[M]):T[M].cloneNode(true));if((u=V.children[0])&&(W=u.children[0])){u.removeChild(W)}if(R=V.children[1]){P=R.children;U=P[0];R.removeChild(U);I=P.length-1;do{Q=P[I];N=Q.children[0];Q.removeChild(N)}while(I-->0)}S[M]=V}while(M-->0);return A.sheetDecorateRemove(false,d(S))},col:function(I,u){I=I||A.obj.table()[0];var M=A.cols(I);if(u===J){u=M.length-1}return M[u]},rowTds:function(I,u){I=I||A.obj.table();var M=A.rows(I);if(!M.length){return[]}if(u==J){u=M.length-1}if(!M[u]){return[]}if(!M[u].children){return[]}return M[u].children},rows:function(u){u=u||A.obj.table()[0];if(!u){return[]}if(!u.tBody){return[]}if(!u.tBody.children){return[]}return u.tBody.children},highlighted:function(I){var N=A.highlighter.last||d([]),O=[],u,M;if(!(u=N)||!N.length||!(u=u[0])||!u.tagName){return I?O:d(O)}switch(u.tagName){case"TD":M=N.length-1;do{O.unshift(I?N[M].jSCell:N[M])}while(M-->0);break;case"TR":M=N.length-1;do{if(N[M].tds){O=O.concat(I?N[M].jSCells:N[M].tds)}}while(M-->0);break;case"COL":N=N.filter("col");M=N.length-1;do{if(N[M].tds){O=O.concat(I?N[M].jSCells:N[M].tds)}}while(M-->0);break;case"TABLE":O=(I?u.jSCells:u.tds);break}return I?O:d(O)},sheetSize:function(M){var I,P,u={},N=L.minSize||{rows:1,cols:1},O;M=M||A.obj.table()[0];if((u.cols=L.initScrollCols)>0&&(u.rows=L.initScrollRows)>0){}else{I=A.rowTds(M);P=A.getTdLocation(I[I.length-1]);u.cols=P.col;u.rows=P.row}if(L.loader!==null){O=L.loader.size(M.spreadsheetIndex);u.rows=g.max(O.rows,u.rows,N.rows);u.cols=g.max(O.cols,u.cols,N.cols)}return u},test:function(){var u=A.highlighted(true);console.log(A.obj.enclosure())},sortVerticalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){A.sortVertical();return true}else{A.sortVerticalSingle(false);return true}},sortVerticalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){A.sortVertical();return false}else{A.sortVerticalSingle(true);return false}},sortVertical:function(T){var R=A.highlighted(true),O=R[0].td.parent().prev(),u=R.length,M=new a(),Q=true,U=[],W=[],P,S=0,V,I,N;while(S<u){V=R[S];N=V.td[0];if(!isNaN(V.value)){I=(new r(V.value.valueOf()))}else{Q=false;I=(new o(V.value.valueOf()))}I.loc=A.getTdLocation(N);I.row=N.parentNode;I.col=N;I.cell=V;U.push(I);S++}if(T){if(Q==false){U.sort(function(Y,X){return X-Y})}else{U.sort();U.reverse()}}else{if(Q==true){U.sort(function(Y,X){return Y-X})}else{U.sort()}}A.undo.createCells(R);while(P=U.length){I=U.pop();W=A.spreadsheets[A.i].splice(I.row.rowIndex,1);V=I.cell;V.value=I.valueOf();V.calcLast=0;I.row.parentNode.removeChild(I.row);O.after(I.row);I.row.children[0].innerHTML=O[0].rowIndex+P;A.spreadsheets[A.i].splice(O[0].rowIndex+1,0,W[0]);A.calcDependencies.call(V,M,true)}A.undo.createCells(R)},sortVerticalSingle:function(P){var N=A.highlighted(true),O=N.length,M=0,I=[],u;while(M<O){I.push(N[M].value);M++}if(P){I.sort(function(R,Q){return Q-R})}else{I.sort(function(R,Q){return R-Q})}while(N.length){u=N.pop();u.value=I[N.length];u.calcLast=0;A.updateCellValue.call(u);A.updateCellDependencies.call(u)}},sortHorizontalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){A.sortHorizontal();return true}else{A.sortHorizontalSingle(false);return true}},sortHorizontalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){A.sortHorizontal();return false}else{A.sortHorizontalSingle(true);return false}},sortHorizontal:function(T){var R=A.highlighted(true),Z=R[0].td[0],V=Z.cellIndex,u=Z.table.colGroup,aa=A.sheetSize().rows,I=R.length,N=new a(),Q=true,W=[],P,S=0,X,Y,M,U,O;while(S<I){X=0;Y=R[S];O=Y.td[0];if(!isNaN(Y.value)){M=new r(Y.value.valueOf())}else{Q=false;M=new o(Y.value.valueOf())}M.tds=[];M.loc=A.getTdLocation(O);M.tr=O.parentNode;M.td=O;M.cell=Y;while(X<=aa){M.tds.push(A.obj.pane().table.children[1].children[X].children[O.cellIndex]);X++}W.push(M);S++}if(T){if(Q==false){W.sort(function(ac,ab){return ab-ac})}else{W.sort();W.reverse()}}else{if(Q==true){W.sort(function(ac,ab){return ac-ab})}else{W.sort()}}A.undo.createCells(R);while(W.length){M=W.pop();while(M.tds.length>1){O=M.tds.pop();U=O.parentNode;Y=A.spreadsheets[A.i][U.rowIndex].splice(O.cellIndex,1);U.insertBefore(O,U.children[V]);O.col=u.children[W.length+O.cellIndex-1];O.barTop=O.col.bar;Y.value=O.jSCell.value;Y.calcLast=N;A.spreadsheets[A.i][U.rowIndex].splice(O.cellIndex,0,Y[0]);A.calcDependencies.call(Y,N,true)}}A.undo.createCells(R)},sortHorizontalSingle:function(P){var N=A.highlighted(true),O=N.length,M=0,I=[],u;while(M<O){I.push(N[M].value);M++}if(P){I.sort(function(R,Q){return Q-R})}else{I.sort(function(R,Q){return R-Q})}while(N.length){u=N.pop();u.value=I[N.length];u.calcLast=0;A.updateCellValue.call(u);A.updateCellDependencies.call(u)}},tableSize:function(M){M=M||A.obj.table()[0];var u=M.tBody||{},O=u.children||[],N=O[O.length-1]||{},I=N.children||[],P=I[I.length-1]||{};return{cols:P.cellIndex||0,rows:N.rowIndex||0}},toggleState:function(u){if(L.allowToggleState){var I=u||A.tables();if(L.editable){A.evt.cellEditAbandon();A.trigger("sheetSave",[I])}A.setDirty(false);A.setChanged(true);L.editable=!L.editable;A.kill();L.parent.html(I).sheet(L);L=null}},setCellRef:function(I){function u(O){if(O){A.s.formulaVariables[O]=A.updateCellValue(A.i,M.row,M.col)}}var N=A.obj.tdActive(),M=A.getTdLocation(N);if(I){u(I)}else{L.prompt(A.msg.setCellRef,u)}},formulaParser:null,print:function(u,I){u=u||A.i;var N=f.open(),M;if(N!==J){M=N.document;M.write('<html>	<head id="head"></head>	<body>		<div id="entry" class="'+A.cl.parent+'" style="overflow: show;">		</div>	</body></html>');if(I!==true){d(M.getElementById("head")).append(d("style,link").clone())}d(M.getElementById("entry")).append(A.obj.pane().cloneNode(true));M.close();N.focus();N.print()}}},x=[],G;A.setBusy(true);L.parent[0].jS=A;if(!f.console){f.console={log:function(){}}}if(!f.scrollBarSize){f.scrollBarSize=l()}if(f.Formula){A.formulaParser=f.Formula(A.cellHandler)}A.theme=new j.Theme(L.theme);A.highlighter=new j.Highlighter(A.theme.tdHighlighted,A.theme.barHighlight,A.theme.tabActive,function(){A.obj.pane().actionUI.redraw()});L.origHtml=L.parent.children().detach();L.parent.addClass(A.cl.parent);L.parent.bind("sheetSwitch",function(M,I,u){A.switchSheet(u)}).bind("sheetRename",function(M,I,u){A.renameSheet(u)});L.width=(L.width?L.width:L.parent.width());L.height=(L.height?L.height:L.parent.height());if(!d.nearest){A.nearest=F}A.resizableCells=A.resizableSheet=A.resizable;if(!d.ui){A.resizable=A.resizableCells=A.resizableSheet=A.draggable=F}else{if(!L.resizableCells){A.resizableCells=F}if(!L.resizableSheet){A.resizableSheet=F}}if(!d.support.boxModel){L.boxModelCorrection=0}if(!L.barMenus){A.controlFactory.barMenuTop=A.controlFactory.barMenuLeft=F}if(!L.freezableCells){A.controlFactory.barHandleFreeze.top=A.controlFactory.barHandleFreeze.left=F}if(L.calcOff){A.calc=F}if(!f.Raphael){h.chart=F}t.resize(function(){if(A&&!A.isBusy()){L.width=L.parent.width();L.height=L.parent.height();A.sheetSyncSize()}});if(d.sheet.fn){d.sheet.fn=d.extend(d.sheet.fn,L.formulaFunctions);if(d.sheet.advancedfn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.advancedfn)}if(d.sheet.financefn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.financefn)}}L.title=L.title||L.parent.attr("title")||"";A.s=L;L.parent.addClass(A.theme.parent);if(L.origHtml.length){A.openSheet(L.origHtml)}else{if(L.loader!==null){while(x.length<L.loader.count){G=k.createElement("table");G.setAttribute("title",L.loader.title(x.length));x.push(G)}A.openSheet(d(x))}else{A.openSheet(d(k.createElement("table")))}}A.setBusy(false);return A},makeTable:function(F,v,t){var D=k;F=F||{rows:25,cols:10};v=v||120;t=t||15;var E=k.createElement("table"),u=k.createElement("colgroup"),C=k.createElement("tbody"),z="width:"+v+"px;",x="height:"+t+"px;",B,w,A,y;A=F.cols;do{w=k.createElement("col");w.setAttribute("style",z);u.appendChild(w)}while(A-->1);A=F.rows;do{B=k.createElement("tr");B.setAttribute("style",x);y=F.cols;do{B.appendChild(k.createElement("td"))}while(y-->1);C.appendChild(B)}while(A-->1);E.appendChild(u);E.appendChild(C);return E},killAll:function(){if(d.sheet){var t=d.sheet.instance;if(t){for(var u=0;u<t.length;u++){if(t[u]&&t[u].kill){t[u].kill()}}d.sheet.instance=[]}}},scrollLocker:function(u){var t=d.sheet.instance;t[u].obj.panes().each(function(v){var w;d(w=this.scrollUI).scroll(function(y){var x=t.length-1,z;if(x>-1){do{z=t[x].controls.enclosure[v][0].scrollUI;if(this!==z){z.scrollLeft=w.scrollLeft;z.scrollTop=w.scrollTop}}while(x--)}})})},switchSheetLocker:function(t){d.each(d.sheet.instance,function(){this.s.parent.bind("sheetSwitch",function(w,v,u){d.each(d.sheet.instance,function(){this.setActiveSheet(u)})})})},I:function(){var t=0;if(this.instance){t=(this.instance.length===0?0:this.instance.length-1)}else{this.instance=[]}return t}};var h=d.sheet.engine={calc:function(w,u,x){u=u||[];var z=u.length-1,y,v,t;if(z>0){do{if(z>0&&u[z]){y=u[z];v=y.length-1;if(v>0){do{t=y[v];x.call(t,w,z,v)}while(v-->1)}}}while(z-->1)}},parseLocation:function(t,u){return{row:parseInt(u),col:h.columnLabelIndex(t)}},parseSheetLocation:function(u){var t=((u+"").replace("SHEET","")*1)-1;return isNaN(t)?-1:t},parseCellName:function(t,u){return h.columnLabelString(t)+(u||"")},alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),columnLabels:{},columnLabelIndex:function(t){return this.columnLabels[t.toUpperCase()]},columnIndexes:[],columnLabelString:function(w){if(!this.columnIndexes.length){var y="",x,v,u,t;x=v=u=-1;for(t=1;t<16385;++t){y="";++u;if(u==26){u=0;++v;if(v==26){v=0;++x}}if(x>=0){y+=this.alphabet[x]}if(v>=0){y+=this.alphabet[v]}if(u>=0){y+=this.alphabet[u]}this.columnIndexes[t]=y;this.columnLabels[y]=t}}return this.columnIndexes[w]||""},regEx:{n:/[\$,\s]/g,cell:/\$?([a-zA-Z]+|[#]REF[!])\$?([0-9]+|[#]REF[!])/gi,range:/\$?([a-zA-Z]+)\$?([0-9]+):\$?([a-zA-Z]+)\$?([0-9]+)/gi,remoteCell:/\$?(SHEET+)\$?([0-9]+)[:!]\$?([a-zA-Z]+)\$?([0-9]+)/gi,remoteCellRange:/\$?(SHEET+)\$?([0-9]+)[:!]\$?([a-zA-Z]+)\$?([0-9]+):\$?([a-zA-Z]+)\$?([0-9]+)/gi,sheet:/SHEET/i,amp:/&/g,gt:/</g,lt:/>/g,nbsp:/&nbsp;/g},chart:function(w){var v=this.jS,t=this;function u(x,y){if(!x){if(y){x=0}else{x=""}}else{if(y){x=c.toNumbers(x)}else{x=c.flatten(x)}}return x}w=d.extend({x:{legend:"",data:[0]},y:{legend:"",data:[0]},title:"",data:[0],legend:"",td:this.td,chart:d(k.createElement("div")).addClass(v.cl.chart).mousedown(function(){w.td.mousedown()}),gR:{}},w);v.controls.chart[v.i]=v.obj.chart().add(w.chart);w.data=u(w.data,true);w.x.data=u(w.x.data,true);w.y.data=u(w.y.data,true);w.legend=u(w.legend);w.x.legend=u(w.x.legend);w.y.legend=u(w.y.legend);w.legend=(w.legend?w.legend:w.data);v.s.parent.one("sheetCalculation",function(){var y=w.chart.width(),x=w.chart.height(),z=Raphael(w.chart[0]);if(w.title){z.text(y/2,10,w.title).attr({"font-size":20})}switch(w.type){case"bar":w.gR=z.barchart(y/8,x/8,y*0.8,x*0.8,w.data,w.legend).hover(function(){this.flag=z.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"hbar":w.gR=z.hbarchart(y/8,x/8,y*0.8,x*0.8,w.data,w.legend).hover(function(){this.flag=z.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"line":w.gR=z.linechart(y/8,x/8,y*0.8,x*0.8,w.x.data,w.y.data,{nostroke:false,axis:"0 0 1 1",symbol:"circle",smooth:true}).hoverColumn(function(){this.tags=z.set();if(this.symbols.length){for(var A=0,B=this.y.length;A<B;A++){this.tags.push(z.tag(this.x,this.y[A],this.values[A],160,10).insertBefore(this).attr([{fill:"#fff"},{fill:this.symbols[A].attr("fill")}]))}}},function(){this.tags&&this.tags.remove()});break;case"pie":w.gR=z.piechart(y/2,x/2,(y<x?y:x)/2,w.data,{legend:w.legend}).hover(function(){this.sector.stop();this.sector.scale(1.1,1.1,this.cx,this.cy);if(this.label){this.label[0].stop();this.label[0].attr({r:7.5});this.label[1].attr({"font-weight":800})}},function(){this.sector.animate({transform:"s1 1 "+this.cx+" "+this.cy},500,"bounce");if(this.label){this.label[0].animate({r:5},500,"bounce");this.label[1].attr({"font-weight":400})}});break;case"dot":w.gR=z.dotchart(y/8,x/8,y*0.8,x*0.8,w.x.data,w.y.data,w.data,{symbol:"o",max:10,heat:true,axis:"0 0 1 1",axisxstep:w.x.data.length-1,axisystep:w.y.data.length-1,axisxlabels:(w.x.legend?w.x.legend:w.x.data),axisylabels:(w.y.legend?w.y.legend:w.y.data),axisxtype:" ",axisytype:" "}).hover(function(){this.marker=this.marker||z.tag(this.x,this.y,this.value,0,this.r+2).insertBefore(this);this.marker.show()},function(){this.marker&&this.marker.hide()});break}w.gR.mousedown(function(){w.td.mousedown().mouseup()});w.chart.mousemove(function(){w.td.mousemove();return false})});return w.chart}};var m=d.sheet.fn={ISNUMBER:function(u){var t;if(!isNaN(u.valueOf())){t=new s(true);t.html="TRUE";return t}t=new s(false);t.html="FALSE";return t},N:function(t){if(t==null){return 0}if(t instanceof a){return t.getTime()}if(typeof(t)=="object"){t=t.toString()}if(typeof(t)=="string"){t=parseFloat(t.replace(h.regEx.n,""))}if(isNaN(t)){return 0}if(typeof(t)=="number"){return t}if(t==true){return 1}return 0},VERSION:function(){return this.jS.version},ABS:function(t){return g.abs(m.N(t))},CEILING:function(u,t){t=t||1;return(parseInt(u/t)*t)+t},EVEN:function(t){t=g.round(t);var u=(t%2==0);if(!u){if(t>0){t++}else{t--}}return t},EXP:function(t){return g.exp(t)},FLOOR:function(v,u){u=u||1;if((v<0&&u>0)||(v>0&&u<0)){var t=new r(0);t.html="#NUM";return t}if(v>=0){return g.floor(v/u)*u}else{return g.ceil(v/u)*u}},INT:function(t){return g.floor(m.N(t))},LN:function(t){return g.log(t)},LOG:function(t,u){u=u||10;return g.log(t)/g.log(u)},LOG10:function(t){return m.LOG(t)},MOD:function(t,v){var u=t%v;if(v<0){u*=-1}return u},ODD:function(t){var w=false;if(t>0){t=g.floor(g.round(t));w=true}else{t=g.ceil(t)}var u=g.abs(t);if((u%2)==0){u++}if(w){return u}else{return -u}},PI:function(){return g.PI},POWER:function(t,u){return g.pow(t,u)},SQRT:function(t){return g.sqrt(t)},RAND:function(){return g.random()},RND:function(){return g.random()},ROUND:function(w,u){var t=g.pow(10,u||0);return g.round(w*t)/t},ROUNDDOWN:function(u,t){var w=(u<0);u=g.abs(u);t=t||0;u=g.floor(u*g.pow(10,t))/g.pow(10,t);return(w?-u:u)},ROUNDUP:function(u,t){var w=(u<0);u=g.abs(u);t=t||0;u=g.ceil(u*g.pow(10,t))/g.pow(10,t);return(w?-u:u)},SUM:function(){var w=0,t=c.toNumbers(arguments),u=t.length-1;if(u<0){return 0}do{w+=t[u]*1}while(u--);return w},TRUNC:function(t,u){u=u||0;t=t+"";if(u==0){return t.split(".").shift()}if(t.match(".")){if(u==1){t=t.substr(0,t.length-1)}else{if(u==-1){t=t.split(".").shift();t=t.substr(0,t.length-1)+"0"}}}return t},AVERAGE:function(t){return m.SUM(arguments)/m.COUNT(arguments)},AVG:function(t){return m.AVERAGE(t)},COUNT:function(){var w=0,t=c.toNumbers(arguments),u=t.length-1;if(u<0){return w}do{if(t[u]!==null){w++}}while(u--);return w},COUNTA:function(){var w=0,t=c.flatten(arguments),u=t.length-1;if(u<0){return w}do{if(t[u]){w++}}while(u--);return w},MAX:function(){var u=c.toNumbers(arguments),t=u[0],w=u.length-1;if(w<0){return 0}do{t=(u[w]>t?u[w]:t)}while(w--);return t},MIN:function(){var t=c.toNumbers(arguments),w=t[0],u=t.length-1;if(u<0){return 0}do{w=(t[u]<w?t[u]:w)}while(u--);return w},ASC:function(t){return t.charCodeAt(0)},CHAR:function(t){return o.fromCharCode(t)},CLEAN:function(t){var u=new b("[cG\x1BcLcJcMcIcK\x07\x1B\f\n\r\t\v]","g");return t.replace(u,"")},CODE:function(t){return m.ASC(t)},CONCATENATE:function(){var v=c.flatten(arguments),u="",t=this;jQuery.each(v,function(w){u+=v[w]});return u},DOLLAR:function(w,u,y){u=u||2;y=y||"$";var t=new r(w),x=m.FIXED(w,u,false);if(w>=0){t.html=y+x}else{t.html="("+y+x.slice(1)+")"}return t},FIXED:function(x,w,u){w=(w===undefined?2:w);var y=g.pow(10,w),t,x=g.round(x*y)/y;t=new o(x.toFixed(w));t.html=Globalize.format(x,"n"+w);if(u){t.html=t.html.replace(Globalize.culture().numberFormat[","],"")}return t},LEFT:function(t,u){u=u||1;return t.substring(0,u)},LEN:function(t){if(!t){return 0}return t.length},LOWER:function(t){return t.toLowerCase()},MID:function(u,w,t){if(!u||!w||!t){return this.jS.s.error({error:"ERROR"})}return u.substring(w-1,t+w-1)},REPLACE:function(u,x,v,w){if(!u||!x||!v||!w){return this.jS.s.error({error:"ERROR"})}var t=u.split("");t.splice(x-1,v);t.splice(x-1,0,w);return t.join("")},REPT:function(u,x){var t="";for(var w=0;w<x;w++){t+=u}return t},RIGHT:function(t,u){u=u||1;return t.substring(t.length-u,t.length)},SEARCH:function(v,t,w){w=w||0;if(w){t=t.split("");t.splice(0,w-1);t=t.join("")}var u=t.search(v);if(u<0){return this.jS.s.error({error:"#VALUE!"})}return w+(w?0:1)+u},SUBSTITUTE:function(w,t,v,x){x=x||0;t=new b(t,"g");var u=1;w=w.replace(t,function(z,B,C,A){var y=z;if(x){if(u>=x){y=v}}else{y=v}u++;return y});return w},TEXT:function(u,t){return u},UPPER:function(t){return t.toUpperCase()},VALUE:function(t){if(jQuery.isNumeric(t)){return t*=1}else{return this.jS.s.error({error:"#VALUE!"})}},NOW:function(){var t=new a();t.html=e.toString(t);return t},TODAY:function(){var u=new a(),t=new r(e.toCentury(u)-1);t.html=e.toString(u,"d");return t},WEEKENDING:function(u){var t=new a();t=new a(t.getFullYear(),t.getMonth(),t.getDate()+5-t.getDay()-((u||0)*7));t.html=e.toString(t,"d");return t},WEEKDAY:function(u,v){u=e.get(u);var t=u.getDay();v=(v?v:1);switch(v){case 3:switch(t){case 0:return 7;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6}break;case 2:switch(t){case 0:return 6;case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5}break;case 1:t++;break}return t},WEEKNUM:function(t){t=e.get(t);return e.week(t)+1},YEAR:function(t){t=e.get(t);return t.getFullYear()},DAYSFROM:function(u,v,t){return g.floor((new a()-new a(u,(v-1),t))/e.dayDiv)},DAYS:function(x,v){var u=e.get(x),t=e.get(v),w=1000*60*60*24;return g.round(g.abs(u.getTime()-t.getTime())/w)},DAY:function(t){t=e.get(t);return t.getDate()},DAYS360:function(y,v,A){y=e.get(y);v=e.get(v);var t=y.getDate(),x=v.getDate(),w=e.isLastDayOfMonth(y),z=e.isLastDayOfMonth(v),u=e.diffMonths(y,v);if(A){t=g.min(t,30);x=g.min(x,30)}else{if(w){t=30}if(z){if(t<30){u++;x=1}else{x=30}}}return(u*30)+(x-t)},DATE:function(w,x,u){var v=new a(w,x-1,u),t=new r(e.toCentury(v));t.html=e.toString(v,"d");return t},DATEVALUE:function(u){u=e.get(u);var t=new r(e.toCentury(u));t.html=e.toString(u,"d");return t},EDATE:function(v,u){v=e.get(v);v.setMonth(v.getMonth()+u);var t=new r(e.toCentury(v));t.html=e.toString(v,"d");return t},EOMONTH:function(v,u){v=e.get(v);v.setMonth(v.getMonth()+u+1);v=new a(v.getFullYear(),v.getMonth(),0);var t=new r(e.toCentury(v));t.html=e.toString(v,"d");return t},HOUR:function(t){t=i.fromMath(t);return t.hour},MINUTE:function(t){return i.fromMath(t).minute},MONTH:function(t){t=e.get(t);return t.getMonth()+1},SECOND:function(t){return i.fromMath(t).second},TIME:function(t,y,u){u=(u?u:0);y=(y?y:0);t=(t?t:0);if(u&&u>60){var v=(((u/60)+"").split(".")[0])*1;u=u-(v*60);y+=v}if(y&&y>60){var x=(((y/60)+"").split(".")[0])*1;y=y-(x*60);t+=x}var w=(t*60*60*1000)+(y*60*1000)+(u*1000);return w/e.dayDiv},TIMEVALUE:function(t){if(!isNaN(t)){return t}if(/([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm)/.test(t)){return i.fromString(t,true)}else{if(/([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?/.test(t)){return i.fromString(t)}}return 0},WORKDAY:function(u,x,w){var y={1:true,2:true,3:true,4:true,5:true},u=e.get(u),x=(x&&!isNaN(x)?x:0),z=0,v=0,t=u,B;if(w){if(!jQuery.isArray(w)){w=[w]}w=c.flatten(w);var A={};jQuery.each(w,function(C){if(w[C]){A[e.toString(e.get(w[C]),"d")]=true}});w=A}else{w={}}while(v<x){t=new a(t.setDate(t.getDate()+1));if(y[t.getDay()]){if(!w[e.toString(t,"d")]){v++}}z++}B=new r(e.toCentury(t));B.html=e.toString(t,"d");return B},YEARFRAC:function(t,x,w){t=e.get(t);x=e.get(x);if(!t||!x){return this.jS.s.error({error:"#VALUE!"})}w=(w?w:0);this.html=[];var v=e.diff(t,x,w),u=e.calcAnnualBasis(t,x,w);return v/u},AND:function(){var u=arguments,v,t=this;d.each(u,function(w){if(u[w].valueOf()!==true&&v==undefined){v=m.FALSE()}});if(!v){v=m.TRUE()}return v},FALSE:function(){var t=new s(false);t.html="FALSE";return t},IF:function(v,u,t){if(v.valueOf()){return u}else{return t}},NOT:function(u){var t;if(!u.valueOf()){t=new s(true);t.html="TRUE"}else{t=new s(false);t.html="FALSE"}return t},OR:function(){var w=arguments,t,x=w.length-1,u;if(x>-1){do{u=w[x].valueOf();if(u){t=new s(true);t.html="TRUE";return t}}while(x--)}t=new s(false);t.html="FALSE";return t},TRUE:function(){var t=new s(true);t.html="TRUE";return t},GREATER:function(v,u){var t;if(v>u){t=new s(true);t.html="TRUE"}else{t=new s(false);t.html="FALSE"}return t},LESS:function(v,u){var t;if(v<u){t=new s(true);t.html="TRUE"}else{t=new s(false);t.html="FALSE"}return t},EQUAL:function(v,u){var t;if(v.valueOf()==u.valueOf()){t=new s(true);t.html="TRUE"}else{t=new s(false);t.html="FALSE"}return t},GREATER_EQUAL:function(v,u){var t;if(v>=u){t=new s(true);t.html="TRUE"}else{t=new s(false);t.html="FALSE"}return t},LESS_EQUAL:function(v,u){var t;if(v<=u){t=new s(true);t.html="TRUE"}else{t=new s(false);t.html="FALSE"}return t},IMG:function(u){var t=new o("");t.html=d(k.createElement("img")).attr("src",u);return t},TRIM:function(t){if(typeof(t)=="string"){t=d.trim(t)}return t},HYPERLINK:function(v,u){u=u||"LINK";var t=new o(u);t.html=d(k.createElement("a")).attr("href",v).attr("target","_new").text(u);return t},DROPDOWN:function(){var E=this,A=this.jS,x=this.td,D,z=(x.children?x.children().detach():""),B,w=d(E.td),C,u,F;if(!z.length||E.needsUpdated){D=c.flatten(arguments);D=c.unique(D);B=A.getTdLocation(E.td);u=(this.id!==null?this.id+"-dropdown":"dropdown"+this.sheet+"_"+B.row+"_"+B.col+"_"+A.I);C=k.createElement("select");C.setAttribute("name",u);C.setAttribute("id",u);C.className="jSDropdown";C.cell=this;C.onmouseup=function(){A.cellEdit(w)};C.onchange=function(){E.value=this.value;A.calcDependencies.call(E,E.calcDependenciesLast)};A.controls.inputs[A.i]=A.obj.inputs().add(C);for(var y=0;y<(D.length<=50?D.length:50);y++){if(D[y]){var t=k.createElement("option");t.setAttribute("value",D[y]);t.text=t.innerText=D[y];C.appendChild(t)}}if(!A.s.editable){C.setAttribute("disabled",true)}else{A.s.parent.bind("sheetKill",function(){w.text(E.value=C.value)})}C.value=E.value||D[0];C.onchange()}if(typeof E.value!="object"){F=new o(E.value)}F.html=C;return F},RADIO:function(){var H=this,B=this.jS,y=this.td,G,A=(y.children?y.children().detach():""),D,w,C,t,x,u,I;if(!A.length||H.needsUpdated){G=c.flatten(arguments);G=c.unique(G);D=B.getTdLocation(H.td);w=d(H.td);C=[];u=(this.id!==null?this.id+"-radio":"radio"+this.sheet+"_"+D.row+"_"+D.col+"_"+B.I);x=k.createElement("span");x.className="jSRadio";x.onmousedown=function(){B.cellEdit(w)};x.jSCell=H;B.controls.inputs[B.i]=B.obj.inputs().add(x);for(var z=0;z<(G.length<=25?G.length:25);z++){if(G[z]){var F=k.createElement("input"),E=k.createElement("span");F.setAttribute("type","radio");F.setAttribute("name",u);F.className=u;F.value=G[z];F.onchange=function(){H.value=jQuery(this).val();B.calcDependencies.call(H,H.calcDependenciesLast)};C.push(F);if(G[z]==H.value){F.setAttribute("checked","true");F.onchange()}E.textContent=E.innerText=G[z];x.appendChild(F);x.input=F;E.onclick=function(){d(this).prev().click()};x.appendChild(E);x.appendChild(k.createElement("br"))}}t=d(C);if(!B.s.editable){H.value=t.filter(":checked").val();t.attr("disabled",true)}else{B.s.parent.bind("sheetKill",function(){H.value=t.filter(":checked").val();w.text(H.value)})}}if(typeof H.value!="object"){I=new o(H.value)}I.html=x;return I},CHECKBOX:function(C){if(d.isArray(C)){C=C[0]}var D=this,y=this.jS,w=this.td,x=(w.children?w.children().detach():""),A,z,u,B,t,E;if((!x.length||D.needsUpdated)){A=y.getTdLocation(D.td);z=d([]);u=d(D.td);t=(this.id!==null?this.id+"checkbox":"checkbox"+this.sheet+"_"+A.row+"_"+A.col+"_"+y.I);z=k.createElement("input");z.setAttribute("type","checkbox");z.setAttribute("name",t);z.setAttribute("id",t);z.className=t;z.value=C;z.onchange=function(){if(d(this).is(":checked")){D.value=C}else{D.value=""}y.calcDependencies.call(D,D.calcDependenciesLast)};if(!y.s.editable){z.setAttribute("disabled","true")}else{y.s.parent.bind("sheetKill",function(){D.value=(D.value=="true"||d(z).is(":checked")?C:"");u.text(D.value)})}x=k.createElement("span");x.className="jSCheckbox";x.appendChild(z);B=k.createElement("span");B.textContent=B.innerText=C;x.appendChild(B);x.appendChild(k.createElement("br"));x.onmousedown=function(){y.cellEdit(u)};x.cell=D;y.controls.inputs[y.i]=y.obj.inputs().add(x);if(C==D.value){z.setAttribute("checked",true);z.onchange()}}E=new o(D.value=="true"||d(z).is(":checked")?C:"");E.html=x;return E},BARCHART:function(u,v,w){var t=new o("");t.html=h.chart.call(this,{type:"bar",data:u,legend:v,title:w});return t},HBARCHART:function(u,v,w){var t=new o("");t.html=h.chart.call(this,{type:"hbar",data:u,legend:v,title:w});return t},LINECHART:function(v,u){var t=new o("");t.html=h.chart.call(this,{type:"line",x:{data:v},y:{data:u},title:""});return t},PIECHART:function(u,v,w){var t=new o("");t.html=h.chart.call(this,{type:"pie",data:u,legend:v,title:w});return t},DOTCHART:function(z,x,u,w,v,y){var t=new o("");t.html=h.chart.call(this,{type:"dot",data:(u?u:z),x:{data:z,legend:w},y:{data:(x?x:z),legend:(v?v:w)},title:y});return t},CELLREF:function(t){return(this.jS.spreadsheets[t]?this.jS.spreadsheets[t]:"Cell Reference Not Found")},CALCTIME:function(w,u){w=w||"";u=u||"";var t=this,v=this.jS;this.jS.s.parent.one("sheetCalculation",function(){v.time.last=v.calcLast;t.td.text(w+v.time.diff()+u)});return""},HLOOKUP:function(z,t,v,C){var x=this.jS,B=null,D={html:"#N/A",value:""},w=t[0],A,y;v=v||1;C=C!==undefined?C:true;if((isNaN(z)&&z!="#REF!")||z.length===0){if(C){B=c.lSearch(w,z)}else{var u=w.indexOf(z);if(u>-1){B=w[u]}}}else{c.getClosestNum(z,w,function(F,E){if(C){B=F}else{if(F==z){B=F}}})}if(B!==null&&(A=B.cell)!==undefined){y=x.getTdLocation(A.td);D=x.updateCellValue(A.sheet,y.row,v)}return D},VLOOKUP:function(z,t,v,C){var x=this.jS,B=null,D={html:"#N/A",value:""},w=t[0],A,y;C=C!==undefined?C:true;if((isNaN(z)&&z!="#REF!")||z.length===0){if(C){B=c.lSearch(w,z)}else{var u=w.indexOf(z);if(u>-1){B=w[u]}}}else{c.getClosestNum(z,w,function(F,E){if(C){B=F}else{if(F==z){B=F}}})}if(B!==null&&(A=B.cell)!==undefined){y=x.getTdLocation(A.td);D=x.updateCellValue(A.sheet,v,y.col)}return D},THISROWCELL:function(t){var u=this.jS,v=u.getTdLocation(this.td);if(isNaN(t)){t=h.columnLabelIndex(t)}return u.updateCellValue(this.sheet,v.row,t)},THISCOLCELL:function(v){var t=this.jS,u=t.getTdLocation(this.td);return t.updateCellValue(this.sheet,v,u.col)}};var q={BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,ALT:18,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,C:67,F:70,V:86,X:88,Y:89,Z:90,UNKNOWN:229};var c=f.arrHelpers={math:g,toNumbers:function(t){t=this.flatten(t);var u=t.length-1;if(u<0){return[]}do{if(t[u]){t[u]=d.trim(t[u]);if(isNaN(t[u])){t[u]=0}else{t[u]=t[u]*1}}else{t[u]=0}}while(u--);return t},unique:function(t){var v=[],u=t.length;for(var x=0;x<u;x++){for(var w=x+1;w<u;w++){if(t[x]===t[w]){w=++x}}v.push(t[x])}return v},flatten:function(t){var x=[];for(var v=0,u=t.length;v<u;v++){var w=Object.prototype.toString.call(t[v]).split(" ").pop().split("]").shift().toLowerCase();if(w){x=x.concat(/^(array|collection|arguments|object)$/.test(w)?this.flatten(t[v]):t[v])}}return x},insertAt:function(t,v,u){d(v).each(function(){if(u>-1&&u<=t.length){t.splice(u,0,this)}});return t},closest:function(x,u,v,t){x=x||[];u=u||0;v=v||0;t=t||x.length-1;var w;while(true){w=((v+t)>>1);if(w===t||w===v){return x[w]}if(x[w]>u){t=w}else{if(x[w]<u){v=w}else{return x[w]}}}},getClosestNum:function(v,t,x){var w=0,u,A,z,y;if(t.length){A=t[0];u=w;for(w;w<t.length;w++){z=g.abs(v-A);y=g.abs(v-t[w]);if(y<z){u=w;A=t[w]}z=null;y=null}if(x){return x(A,u)}return A}return false},levenshtein:(function(){var t=[];return function(D,C){if(D===C){return 0}else{var A=D.length,y=C.length;if(A&&y){var v=0,u=0,B,z,x,w,E=t;while(v<A){E[v]=++v}while(u<y){w=C.charCodeAt(u);B=u;++u;z=u;for(v=0;v<A;++v){x=B+(D.charCodeAt(v)===w?0:1);B=E[v];z=z<B?(z<x?z+1:x):(B<x?B+1:x);E[v]=z}}return z}else{return A+y}}}})(),lSearch:function(u,y){var v=0,w,t=u.length,x=-1,z;for(;v<t;v++){w=u[v];z=new r(this.levenshtein(w,y));z.item=w;if(z<x){x=z}}return(z!==undefined?z.item:null)}};var e={dayDiv:86400000,math:g,toCentury:function(t,u){u=u||86400000;return this.math.round(this.math.abs((new a(1900,0,-1))-t)/u)},get:function(u,v){v=v||86400000;if(u.getMonth){return u}else{if(isNaN(u)){return new a(Globalize.parseDate(u))}else{u*=v;var t=(new a(1900,0,-1))*1;u+=t;u=new a(u);return u}}},week:function(t,v){v=v||86400000;var u=new a(t.getFullYear(),0,1);return this.math.ceil((((t-u)/v)+u.getDay()+1)/7)},toString:function(t,u){if(!u){return Globalize.format(t)}return Globalize.format(t,Globalize.culture().calendar.patterns[u])},diff:function(x,u,w,v){v=v||86400000;switch(w){case 0:return this.days360Nasd(x,u,0,true);case 1:case 2:case 3:var t=this.math.abs(u-x)/v;return t;case 4:return this.days360Euro(x,u)}return 0},diffMonths:function(v,u){var t;t=(u.getFullYear()-v.getFullYear())*12;t-=v.getMonth()+1;t+=u.getMonth()+1;return t},days360:function(v,y,w,u,t,x){return((y-v)*360)+((u-w)*30)+(x-t)},days360Nasd:function(u,x,t,v){var w=u.getDate(),B=u.getMonth(),A=u.getFullYear(),z=x.getDate(),y=x.getMonth(),C=x.getFullYear();if((y==2&&this.isEndOfMonth(z,y,C))&&((B==2&&this.isEndOfMonth(w,B,A))||t==3)){z=30}if(z==31&&(w>=30||t==3)){z=30}if(w==31){w=30}if(v&&B==2&&this.isEndOfMonth(w,B,A)){w=30}return this.days360(A,C,B,y,w,z)},days360Euro:function(A,v){var t=A.getDate(),x=A.getMonth(),w=A.getFullYear(),y=v.getDate(),u=v.getMonth(),z=v.getFullYear();if(t==31){t=30}if(y==31){y=30}return this.days360(w,z,x,u,t,y)},isEndOfMonth:function(t,v,u){return t==(new a(u,v+1,0,23,59,59)).getDate()},isLeapYear:function(t){return new a(t,1,29).getMonth()==1},calcAnnualBasis:function(t,v,z){switch(z){case 0:case 2:case 4:return 360;case 3:return 365;case 1:var u=t.getDate(),B=t.getMonth(),y=t.getFullYear(),w=v.getDate(),x=v.getMonth(),C=v.getFullYear(),D=0;if(y==C){if(this.isLeapYear(y)){D=366}else{D=365}}else{if(((C-1)==y)&&((B>x)||((B==x)&&u>=w))){if(this.isLeapYear(y)){if(B<2||(B==2&&u<=29)){D=366}else{D=365}}else{if(this.isLeapYear(C)){if(x>2||(x==2&&w==29)){D=366}else{D=365}}else{D=365}}}else{for(var A=y;A<=C;A++){if(this.isLeapYear(A)){D+=366}else{D+=365}}D=D/(C-y+1)}}return D}return 0},lastDayOfMonth:function(t){t.setDate(0);return t.getDate()},isLastDayOfMonth:function(t){return(t.getDate()==this.lastDayOfMonth(t))}};var i=f.times={math:g,fromMath:function(v){var t={},u=this;t.hour=((v*24)+"").split(".")[0]*1;t.minute=function(w){w=u.math.round(w*24*100)/100;w=(w+"").split(".");var x=0;if(w[1]){if(w[1].length<2){w[1]+="0"}x=w[1]*0.6}return u.math.round(x)}(v);t.second=function(z){z=u.math.round(z*24*10000)/10000;z=(z+"").split(".");var x=0;if(z[1]){for(var y=0;y<4;y++){if(!z[1].charAt(y)){z[1]+="0"}}var w=((z[1]*0.006)+"").split(".");if(w[1]){if(w[1]&&w[1].length>2){w[1]=w[1].substr(0,2)}return u.math.round(w[1]*0.6)}}return x}(v);return t},fromString:function(v,z){var w=new a(),A=v,t,y,x,u,B;if(z){B=A.substr(-2).toLowerCase();A=A.replace(/(am|pm)/i,"")}A=A.split(":");y=A[0]*1;x=A[1]*1;u=(A[2]?A[2]:0)*1;if(z&&B=="pm"){y+=12}return m.TIME(y,x,u)}};d.extend(g,{log10:function(t){return g.log(t)/2.302585092994046},signum:function(t){return(t/g.abs(t))||t},log1p:function(t){var u=0,w=50;if(t<=-1){return"-INF"}if(t<0||t>1){return g.log(1+t)}for(var v=1;v<w;v++){if((v%2)===0){u-=g.pow(t,v)/v}else{u+=g.pow(t,v)/v}}return u}});var l=function(){var z=k,C=d(k.createElement("p")).css({width:"100%",height:"100%"}),B=d(k.createElement("div")).css({position:"absolute",width:"100px",height:"100px",top:"0",left:"0",visibility:"hidden",overflow:"hidden"}).append(C);d(k.body).append(B);var v=C.width(),y=C.height();B.css("overflow","scroll");var t=C.width(),x=C.height();if(v==t&&B[0].clientWidth){t=B[0].clientWidth}if(y==x&&B[0].clientHeight){x=B[0].clientHeight}B.detach();var A=v-t,u=y-x;return{width:A||15,height:u||15}};var n=function(t,A,v,u,z){u=u||"#"+g.floor(g.random()*16777215).toString(16);if(v){var w=d([]);w=w.add(n(v.left,v.top,null,u,"top-left"));w=w.add(n(v.right,v.top,null,u,"top-right"));w=w.add(n(v.left,v.bottom,null,u,"bottom-left"));w=w.add(n(v.right,v.bottom,null,u,"bottom-right"));return w}return d('<div style="width: 10px; height: 10px; position: absolute;"></div>').css("top",(A-5)+"px").css("left",(t+5)+"px").css("background-color",u).click(function(){console.log(z||"none")}).appendTo("body")};d.printSource=function(u){var t=win.open();t.document.write("<html><body><xmp>"+u+"\n</xmp></body></html>");t.document.close()};if(!Object.getPrototypeOf){Object.getPrototypeOf=function(t){return t||{}}}if(!Array.prototype.indexOf){d.sheet.max=60;Array.prototype.indexOf=function(v,w){for(var u=(w||0),t=this.length;u<t;u++){if(this[u]===v){return u}}return -1}}return j})(jQuery,document,window,Date,String,Number,Boolean,Math,RegExp,Error);var parser=(function(){var S=function(W,V,X,U){for(X=X||{},U=W.length;U--;X[W[U]]=V){}return X},m=[1,5],l=[1,6],k=[1,8],j=[1,9],i=[1,10],h=[1,13],f=[1,11],e=[1,12],d=[1,14],c=[1,15],R=[1,20],Q=[1,18],P=[1,21],O=[1,22],N=[1,17],M=[1,24],L=[1,25],K=[1,26],J=[1,27],I=[1,28],H=[1,29],G=[1,30],F=[1,31],E=[1,32],D=[1,33],C=[4,13,14,15,17,18,19,20,21,22,23,24,36,37],B=[1,36],z=[1,37],y=[1,38],x=[4,13,14,15,17,18,19,20,21,22,23,24,36,37,39],w=[4,13,14,15,17,18,19,20,21,22,23,24,36,37,40],v=[4,13,14,15,17,18,19,20,21,22,23,24,30,36,37],u=[4,14,15,17,18,19,20,21,36,37],t=[1,73],s=[4,14,17,18,19,20,36,37],r=[4,14,15,17,18,19,20,21,22,23,36,37],b=[17,36,37];var A={trace:function q(){},yy:{},symbols_:{error:2,expressions:3,EOF:4,expression:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,ESCAPED_STRING:11,LETTERS:12,"&":13,"=":14,"+":15,"(":16,")":17,"<":18,">":19,NOT:20,"-":21,"*":22,"/":23,"^":24,E:25,FUNCTION:26,expseq:27,cellRange:28,cell:29,":":30,SHEET:31,"!":32,NUMBER:33,"$":34,REF:35,";":36,",":37,VARIABLE:38,DECIMAL:39,"%":40,"$accept":0,"$end":1},terminals_:{2:"error",4:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"ESCAPED_STRING",12:"LETTERS",13:"&",14:"=",15:"+",16:"(",17:")",18:"<",19:">",20:"NOT",21:"-",22:"*",23:"/",24:"^",25:"E",26:"FUNCTION",30:":",31:"SHEET",32:"!",33:"NUMBER",34:"$",35:"REF",36:";",37:",",38:"VARIABLE",39:"DECIMAL",40:"%"},productions_:[0,[3,1],[3,2],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,3],[5,3],[5,3],[5,3],[5,4],[5,4],[5,4],[5,3],[5,3],[5,3],[5,3],[5,3],[5,3],[5,3],[5,2],[5,2],[5,1],[5,3],[5,4],[5,1],[28,1],[28,3],[28,3],[28,5],[29,2],[29,3],[29,3],[29,4],[29,1],[29,2],[29,2],[29,2],[29,3],[29,3],[29,3],[29,3],[29,3],[29,3],[29,4],[29,4],[29,4],[27,1],[27,2],[27,2],[27,3],[27,3],[6,1],[6,3],[9,1],[9,3],[9,2]],performAction:function p(W,Z,o,aa,ab,ac,U){var V=ac.length-1;switch(ab){case 1:return null;break;case 2:return ac[V-1];break;case 3:this.$=aa.handler.variable.apply(aa.obj,ac[V]);break;case 4:this.$=aa.handler.time.call(aa.obj,ac[V],true);break;case 5:this.$=aa.handler.time.call(aa.obj,ac[V]);break;case 6:this.$=aa.handler.number(ac[V]);break;case 7:this.$=ac[V].substring(1,ac[V].length-1);break;case 8:this.$=ac[V].substring(2,ac[V].length-2);break;case 9:case 58:this.$=ac[V];break;case 10:this.$=ac[V-2].toString()+ac[V].toString();break;case 11:this.$=aa.handler.callFunction.call(aa.obj,"EQUAL",[ac[V-2],ac[V]]);break;case 12:this.$=aa.handler.performMath("+",ac[V-2],ac[V]);break;case 13:this.$=aa.handler.number(ac[V-1]);break;case 14:this.$=aa.handler.callFunction.call(aa.obj,"LESS_EQUAL",[ac[V-3],ac[V]]);break;case 15:this.$=aa.handler.callFunction.call(aa.obj,"GREATER_EQUAL",[ac[V-3],ac[V]]);break;case 16:this.$=(ac[V-3])!=(ac[V]);if(isNaN(this.$)){this.$=0}break;case 17:this.$=ac[V-2]!=ac[V];break;case 18:this.$=aa.handler.callFunction.call(aa.obj,"GREATER",[ac[V-2],ac[V]]);break;case 19:this.$=aa.handler.callFunction.call(aa.obj,"LESS",[ac[V-2],ac[V]]);break;case 20:this.$=aa.handler.performMath("-",ac[V-2],ac[V]);break;case 21:this.$=aa.handler.performMath("*",ac[V-2],ac[V]);break;case 22:this.$=aa.handler.performMath("/",ac[V-2],ac[V]);break;case 23:var Y=aa.handler.number(ac[V-2]),X=aa.handler.number(ac[V]);this.$=aa.handler.performMath("^",ac[V-2],ac[V]);break;case 24:var Y=aa.handler.numberInverted(ac[V]);this.$=Y;if(isNaN(this.$)){this.$=0}break;case 25:var Y=aa.handler.number(ac[V]);this.$=Y;if(isNaN(this.$)){this.$=0}break;case 26:break;case 27:this.$=aa.handler.callFunction.call(aa.obj,ac[V-2]);break;case 28:this.$=aa.handler.callFunction.call(aa.obj,ac[V-3],ac[V-1]);break;case 30:this.$=aa.handler.cellValue.call(aa.obj,ac[V]);break;case 31:this.$=aa.handler.cellRangeValue.call(aa.obj,ac[V-2],ac[V]);break;case 32:this.$=aa.handler.remoteCellValue.call(aa.obj,ac[V-2],ac[V]);break;case 33:this.$=aa.handler.remoteCellRangeValue.call(aa.obj,ac[V-4],ac[V-2],ac[V]);break;case 34:this.$={colString:ac[V-1],rowString:ac[V]};break;case 35:this.$={colString:ac[V-1],rowString:ac[V]};break;case 36:case 37:this.$={colString:ac[V-2],rowString:ac[V]};break;case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:return"#REF!";break;case 51:this.$=[ac[V]];break;case 54:ac[V-2].push(ac[V]);this.$=ac[V-2];break;case 55:ac[V-2].push(ac[V]);this.$=ac[V-2];break;case 56:this.$=[ac[V]];break;case 57:this.$=($.isArray(ac[V-2])?ac[V-2]:[ac[V-2]]);this.$.push(ac[V]);break;case 59:this.$=(ac[V-2]+"."+ac[V])*1;break;case 60:this.$=ac[V-1]*0.01;break}},table:[{3:1,4:[1,2],5:3,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{1:[3]},{1:[2,1]},{4:[1,23],13:M,14:L,15:K,18:J,19:I,20:H,21:G,22:F,23:E,24:D},S(C,[2,3],{39:[1,34]}),S(C,[2,4]),S(C,[2,5]),S(C,[2,6],{40:[1,35]}),S(C,[2,7]),S(C,[2,8]),S(C,[2,9],{33:B,34:z,35:y}),{5:39,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:40,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:41,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},S(C,[2,26]),{16:[1,42]},S(C,[2,29]),S(x,[2,56]),S(w,[2,58],{39:[1,43]}),S(C,[2,30],{30:[1,44]}),{32:[1,45]},{12:[1,46],35:[1,47]},S(v,[2,38],{33:[1,48],34:[1,50],35:[1,49]}),{1:[2,2]},{5:51,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:52,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:53,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:56,6:4,7:m,8:l,9:7,10:k,11:j,12:i,14:[1,54],15:h,16:f,19:[1,55],21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:58,6:4,7:m,8:l,9:7,10:k,11:j,12:i,14:[1,57],15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:59,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:60,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:61,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:62,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:63,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{38:[1,64]},S(w,[2,60]),S(v,[2,34]),{33:[1,65],35:[1,66]},S(v,[2,40]),{13:M,14:L,15:K,17:[1,67],18:J,19:I,20:H,21:G,22:F,23:E,24:D},S(u,[2,24],{13:M,22:F,23:E,24:D}),S(u,[2,25],{13:M,22:F,23:E,24:D}),{5:70,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,17:[1,68],21:e,25:d,26:c,27:69,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{33:[1,71]},{12:t,29:72,34:P,35:O},{12:t,29:74,34:P,35:O},{33:[1,75],34:[1,76],35:[1,77]},{33:[1,78],34:[1,80],35:[1,79]},S(v,[2,39]),S(v,[2,41]),{33:[1,81],35:[1,82]},S([4,17,36,37],[2,10],{13:M,14:L,15:K,18:J,19:I,20:H,21:G,22:F,23:E,24:D}),S([4,14,17,36,37],[2,11],{13:M,15:K,18:J,19:I,20:H,21:G,22:F,23:E,24:D}),S(u,[2,12],{13:M,22:F,23:E,24:D}),{5:83,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},{5:84,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},S(s,[2,19],{13:M,15:K,21:G,22:F,23:E,24:D}),{5:85,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,28:16,29:19,31:R,33:Q,34:P,35:O,38:N},S(s,[2,18],{13:M,15:K,21:G,22:F,23:E,24:D}),S([4,14,17,20,36,37],[2,17],{13:M,15:K,18:J,19:I,21:G,22:F,23:E,24:D}),S(u,[2,20],{13:M,22:F,23:E,24:D}),S(r,[2,21],{13:M,24:D}),S(r,[2,22],{13:M,24:D}),S([4,14,15,17,18,19,20,21,22,23,24,36,37],[2,23],{13:M}),S(x,[2,57]),S(v,[2,36]),S(v,[2,46]),S(C,[2,13]),S(C,[2,27]),{17:[1,86],36:[1,87],37:[1,88]},S(b,[2,51],{13:M,14:L,15:K,18:J,19:I,20:H,21:G,22:F,23:E,24:D}),S(w,[2,59]),S(C,[2,31]),{33:B,34:z,35:y},S(C,[2,32],{30:[1,89]}),S(v,[2,35]),{33:[1,90]},S(v,[2,43]),S(v,[2,42]),S(v,[2,44]),{33:[1,91],35:[1,92]},S(v,[2,45]),S(v,[2,47]),S(s,[2,14],{13:M,15:K,21:G,22:F,23:E,24:D}),S(s,[2,16],{13:M,15:K,21:G,22:F,23:E,24:D}),S(s,[2,15],{13:M,15:K,21:G,22:F,23:E,24:D}),S(C,[2,28]),S(b,[2,52],{6:4,9:7,28:16,29:19,5:93,7:m,8:l,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,31:R,33:Q,34:P,35:O,38:N}),S(b,[2,53],{6:4,9:7,28:16,29:19,5:94,7:m,8:l,10:k,11:j,12:i,15:h,16:f,21:e,25:d,26:c,31:R,33:Q,34:P,35:O,38:N}),{12:t,29:95,34:P,35:O},S(v,[2,37]),S(v,[2,48]),S(v,[2,50]),S(b,[2,54],{13:M,14:L,15:K,18:J,19:I,20:H,21:G,22:F,23:E,24:D}),S(b,[2,55],{13:M,14:L,15:K,18:J,19:I,20:H,21:G,22:F,23:E,24:D}),S(C,[2,33])],defaultActions:{2:[2,1],23:[2,2]},parseError:function g(U,o){if(o.recoverable){this.trace(U)}else{throw new Error(U)}},parse:function n(W){var ad=this,am=[0],ah=[],aj=[null],ae=[],al=this.table,az="",ac=0,aB=0,aq=0,aC=2,an=1;var av=ae.slice.call(arguments,1);var ax=Object.create(this.lexer);var ar={yy:{}};for(var ay in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,ay)){ar.yy[ay]=this.yy[ay]}}ax.setInput(W,ar.yy);ar.yy.lexer=ax;ar.yy.parser=this;if(typeof ax.yylloc=="undefined"){ax.yylloc={}}var at=ax.yylloc;ae.push(at);var ai=ax.options&&ax.options.ranges;if(typeof ar.yy.parseError==="function"){this.parseError=ar.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function Z(aE){am.length=am.length-2*aE;aj.length=aj.length-aE;ae.length=ae.length-aE}_token_stack:function ag(){var aE;aE=ax.lex()||an;if(typeof aE!=="number"){aE=ad.symbols_[aE]||aE}return aE}var af,ab,aD,V,aA,au,aa={},aw,ak,U,ap;while(true){aD=am[am.length-1];if(this.defaultActions[aD]){V=this.defaultActions[aD]}else{if(af===null||typeof af=="undefined"){af=ag()}V=al[aD]&&al[aD][af]}_handle_error:if(typeof V==="undefined"||!V.length||!V[0]){var Y;var X="";function o(aF){var aE=am.length-1;var aG=0;for(;;){if((aC.toString()) in al[aF]){return aG}if(aF===0||aE<2){return false}aE-=2;aF=am[aE];++aG}}if(!aq){Y=o(aD);ap=[];for(aw in al[aD]){if(this.terminals_[aw]&&aw>aC){ap.push("'"+this.terminals_[aw]+"'")}}if(ax.showPosition){X="Parse error on line "+(ac+1)+":\n"+ax.showPosition()+"\nExpecting "+ap.join(", ")+", got '"+(this.terminals_[af]||af)+"'"}else{X="Parse error on line "+(ac+1)+": Unexpected "+(af==an?"end of input":("'"+(this.terminals_[af]||af)+"'"))}var ao=this.parseError(X,{text:ax.match,token:this.terminals_[af]||af,line:ax.yylineno,loc:at,expected:ap,recoverable:(Y!==false)});if(this.done){if(ao===undefined){return X}else{return ao}}}else{if(ab!==an){Y=o(aD)}}if(aq==3){if(af===an||ab===an){throw new Error(X||"Parsing halted while starting to recover from another error.")}aB=ax.yyleng;az=ax.yytext;ac=ax.yylineno;at=ax.yylloc;af=ag()}if(Y===false){throw new Error(X||"Parsing halted. No suitable error recovery rule available.")}Z(Y);ab=(af==aC?null:af);af=aC;aD=am[am.length-1];V=al[aD]&&al[aD][aC];aq=3}if(V[0] instanceof Array&&V.length>1){throw new Error("Parse Error: multiple actions possible at state: "+aD+", token: "+af)}switch(V[0]){case 1:am.push(af);aj.push(ax.yytext);ae.push(ax.yylloc);am.push(V[1]);af=null;if(!ab){aB=ax.yyleng;az=ax.yytext;ac=ax.yylineno;at=ax.yylloc;if(aq>0){aq--}}else{af=ab;ab=null}break;case 2:ak=this.productions_[V[1]][1];aa.$=aj[aj.length-ak];aa._$={first_line:ae[ae.length-(ak||1)].first_line,last_line:ae[ae.length-1].last_line,first_column:ae[ae.length-(ak||1)].first_column,last_column:ae[ae.length-1].last_column};if(ai){aa._$.range=[ae[ae.length-(ak||1)].range[0],ae[ae.length-1].range[1]]}au=this.performAction.apply(aa,[az,aB,ac,ar.yy,V[1],aj,ae].concat(av));if(typeof au!=="undefined"){return au}if(ak){am=am.slice(0,-1*ak*2);aj=aj.slice(0,-1*ak);ae=ae.slice(0,-1*ak)}am.push(this.productions_[V[1]][0]);aj.push(aa.$);ae.push(aa._$);U=al[am[am.length-2]][am[am.length-1]];am.push(U);break;case 3:return true}}return true}};if(typeof(window)!=="undefined"){window.Formula=function(V){var W=function(){};W.prototype=A.lexer;var U=function(){this.lexer=new W();this.yy={parseError:function(Z,Y){this.done=true;var X=new String(Z);X.hash=Y;return X},lexerError:function(Z,Y){this.done=true;var X=new String(Z);X.hash=Y;return X}}};U.prototype=A;var o=new U;o.setObj=function(X){o.yy.obj=X};o.yy.handler=V;return o}}var T=(function(){var V=({EOF:1,parseError:function W(ae,ad){if(this.yy.parser){this.yy.parser.parseError(ae,ad)}else{throw new Error(ae)}},setInput:function(ad,ae){this.yy=ae||this.yy||{};this._input=ad;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var ae=this._input[0];this.yytext+=ae;this.yyleng++;this.offset++;this.match+=ae;this.matched+=ae;var ad=ae.match(/(?:\r\n?|\n).*/g);if(ad){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return ae},unput:function(af){var ad=af.length;var ae=af.split(/(?:\r\n?|\n)/g);this._input=af+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-ad);this.offset-=ad;var ah=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(ae.length-1){this.yylineno-=ae.length-1}var ag=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:ae?(ae.length===ah.length?this.yylloc.first_column:0)+ah[ah.length-ae.length].length-ae[0].length:this.yylloc.first_column-ad};if(this.options.ranges){this.yylloc.range=[ag[0],ag[0]+this.yyleng-ad]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(ad){this.unput(this.match.slice(ad))},pastInput:function(){var ad=this.matched.substr(0,this.matched.length-this.match.length);return(ad.length>20?"...":"")+ad.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var ad=this.match;if(ad.length<20){ad+=this._input.substr(0,20-ad.length)}return(ad.substr(0,20)+(ad.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var ad=this.pastInput();var ae=new Array(ad.length+1).join("-");return ad+this.upcomingInput()+"\n"+ae+"^"},test_match:function(ah,af){var ai,ad,ag;if(this.options.backtrack_lexer){ag={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){ag.yylloc.range=this.yylloc.range.slice(0)}}ad=ah[0].match(/(?:\r\n?|\n).*/g);if(ad){this.yylineno+=ad.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:ad?ad[ad.length-1].length-ad[ad.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+ah[0].length};this.yytext+=ah[0];this.match+=ah[0];this.matches=ah;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(ah[0].length);this.matched+=ah[0];ai=this.performAction.call(this,this.yy,this,af,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(ai){return ai}else{if(this._backtrack){for(var ae in ag){this[ae]=ag[ae]}return false}}return false},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var ah,af,ad,ae;if(!this._more){this.yytext="";this.match=""}var ai=this._currentRules();for(var ag=0;ag<ai.length;ag++){ad=this._input.match(this.rules[ai[ag]]);if(ad&&(!af||ad[0].length>af[0].length)){af=ad;ae=ag;if(this.options.backtrack_lexer){ah=this.test_match(ad,ai[ag]);if(ah!==false){return ah}else{if(this._backtrack){af=false;continue}else{return false}}}else{if(!this.options.flex){break}}}}if(af){ah=this.test_match(af,ai[ae]);if(ah!==false){return ah}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var ad=this.next();if(ad){return ad}else{return this.lex()}},begin:function U(ad){this.conditionStack.push(ad)},popState:function X(){var ad=this.conditionStack.length-1;if(ad>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function ac(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function aa(ad){ad=this.conditionStack.length-1-Math.abs(ad||0);if(ad>=0){return this.conditionStack[ad]}else{return"INITIAL"}},pushState:function Z(ad){this.begin(ad)},stateStackSize:function Y(){return this.conditionStack.length},options:{},performAction:function ab(ah,ae,ag,ad){var af=ad;switch(ag){case 0:break;case 1:return 26;break;case 2:return 7;break;case 3:return 8;break;case 4:if(ah.obj.type=="cell"){return 31}return 38;break;case 5:ae.yytext=ae.yytext.substring(1,ae.yytext.length-1);if(ah.obj.type=="cell"){return 31}return 38;break;case 6:return 10;break;case 7:return 10;break;case 8:return 11;break;case 9:return 11;break;case 10:return 12;break;case 11:return 38;break;case 12:return 38;break;case 13:return 33;break;case 14:return 34;break;case 15:return 13;break;case 16:return" ";break;case 17:return 39;break;case 18:return 30;break;case 19:return 36;break;case 20:return 37;break;case 21:return 22;break;case 22:return 23;break;case 23:return 21;break;case 24:return 15;break;case 25:return 24;break;case 26:return 16;break;case 27:return 17;break;case 28:return 19;break;case 29:return 18;break;case 30:return 20;break;case 31:return"PI";break;case 32:return 25;break;case 33:return'"';break;case 34:return"'";break;case 35:return'"';break;case 36:return"'";break;case 37:return"!";break;case 38:return 14;break;case 39:return 40;break;case 40:return 35;break;case 41:return"#";break;case 42:return 4;break}},rules:[/^(?:\s+)/,/^(?:([A-Za-z]{1,})([A-Za-z_0-9]+)?(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:(([A-Za-z0-9]+))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])|(["](\\["]|[^"])*["]))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])))/,/^(?:((["](\\["]|[^"])*["])))/,/^(?:(([\\]['].+?[\\]['])))/,/^(?:(([\\]["].+?[\\]["])))/,/^(?:[A-Z]+(?=[0-9$]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\$)/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:PI\b)/,/^(?:E\b)/,/^(?:")/,/^(?:')/,/^(?:\\")/,/^(?:\\')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:#REF!)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:true}}});return V})();A.lexer=T;function a(){this.yy={}}a.prototype=A;A.Parser=a;return new a})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}}var parser=(function(){var n=function(w,u,x,t){for(x=x||{},t=w.length;t--;x[w[t]]=u){}return x},l=[1,10],j=[1,11],i=[1,12],h=[1,13],g=[5,7,8,9,10],f=[1,19],c=[1,20],a=[5,7,8,9,10,12,13],s=[1,21],r=[5,7,8,9,10,12,13,14,16];var k={trace:function p(){},yy:{},symbols_:{error:2,grid:3,rows:4,EOF:5,row:6,END_OF_LINE:7,END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN:8,END_OF_LINE_WITH_NO_COLUMNS:9,END_OF_LINE_WITH_EMPTY_COLUMN:10,string:11,COLUMN_EMPTY:12,COLUMN_STRING:13,CHAR:14,QUOTE_ON:15,QUOTE_OFF:16,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",7:"END_OF_LINE",8:"END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN",9:"END_OF_LINE_WITH_NO_COLUMNS",10:"END_OF_LINE_WITH_EMPTY_COLUMN",12:"COLUMN_EMPTY",13:"COLUMN_STRING",14:"CHAR",15:"QUOTE_ON",16:"QUOTE_OFF"},productions_:[0,[3,2],[3,1],[4,1],[4,1],[4,1],[4,1],[4,1],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[6,1],[6,1],[6,2],[6,3],[6,1],[6,2],[6,3],[11,1],[11,2],[11,3]],performAction:function e(o,v,w,z,y,u,x){var t=u.length-1;switch(y){case 1:return u[t-1];break;case 2:return[[""]];break;case 3:this.$=[u[t]];break;case 4:this.$=[];break;case 5:this.$=[""];break;case 6:this.$=[""];break;case 7:this.$=[""];break;case 8:this.$=u[t-1];break;case 9:u[t-1].push([""]);this.$=u[t-1];break;case 10:u[t-1].push([""]);this.$=u[t-1];break;case 11:u[t-1][u[t-1].length-1].push("");this.$=u[t-1];break;case 12:u[t-2].push(u[t]);this.$=u[t-2];break;case 13:u[t].unshift("");u[t-2].push(u[t]);this.$=u[t-2];break;case 14:u[t-2].push([""]);u[t-2].push(u[t]);this.$=u[t-2];break;case 15:u[t-2][u[t-2].length-1].push("");u[t-2].push(u[t]);this.$=u[t-2];break;case 16:this.$=[u[t].join("")];break;case 17:this.$=[""];break;case 18:u[t-1].push("");this.$=u[t-1];break;case 19:u[t-2].push("");u[t-2].push(u[t].join(""));this.$=u[t-2];break;case 20:break;case 21:break;case 22:u[t-2].push(u[t].join(""));this.$=u[t-2];break;case 23:this.$=[u[t]];break;case 24:u[t-1].push(u[t]);this.$=u[t-1];break;case 25:this.$=u[t-1];break}},table:[{3:1,4:2,5:[1,3],6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:l,13:j,14:i,15:h},{1:[3]},{5:[1,14],7:[1,15],8:[1,16],9:[1,17],10:[1,18]},{1:[2,2]},n(g,[2,3],{12:f,13:c}),n(g,[2,4]),n(g,[2,5]),n(g,[2,6]),n(g,[2,7]),n(a,[2,16],{14:s}),n(a,[2,17]),n(a,[2,20]),n(r,[2,23]),{11:22,14:i,15:h},{1:[2,1]},n(g,[2,8],{11:9,6:23,12:l,13:j,14:i,15:h}),n(g,[2,9],{11:9,6:24,12:l,13:j,14:i,15:h}),n(g,[2,10],{11:9,6:25,12:l,13:j,14:i,15:h}),n(g,[2,11],{11:9,6:26,12:l,13:j,14:i,15:h}),n(a,[2,18],{11:27,14:i,15:h}),n(a,[2,21],{11:28,14:i,15:h}),n(r,[2,24]),{14:s,16:[1,29]},n(g,[2,12],{12:f,13:c}),n(g,[2,13],{12:f,13:c}),n(g,[2,14],{12:f,13:c}),n(g,[2,15],{12:f,13:c}),n(a,[2,19],{14:s}),n(a,[2,22],{14:s}),n(r,[2,25])],defaultActions:{3:[2,2],14:[2,1]},parseError:function q(t,o){if(o.recoverable){this.trace(t)}else{throw new Error(t)}},parse:function m(D){var L=this,A=[0],K=[],V=[null],F=[],X=this.table,u="",E=0,T=0,w=0,C=2,J=1;var x=F.slice.call(arguments,1);var o=Object.create(this.lexer);var W={yy:{}};for(var S in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,S)){W.yy[S]=this.yy[S]}}o.setInput(D,W.yy);W.yy.lexer=o;W.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var v=o.yylloc;F.push(v);var y=o.options&&o.options.ranges;if(typeof W.yy.parseError==="function"){this.parseError=W.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function I(Z){A.length=A.length-2*Z;V.length=V.length-Z;F.length=F.length-Z}_token_stack:function H(){var Z;Z=o.lex()||J;if(typeof Z!=="number"){Z=L.symbols_[Z]||Z}return Z}var R,N,z,Q,Y,G,P={},M,U,t,B;while(true){z=A[A.length-1];if(this.defaultActions[z]){Q=this.defaultActions[z]}else{if(R===null||typeof R=="undefined"){R=H()}Q=X[z]&&X[z][R]}if(typeof Q==="undefined"||!Q.length||!Q[0]){var O="";B=[];for(M in X[z]){if(this.terminals_[M]&&M>C){B.push("'"+this.terminals_[M]+"'")}}if(o.showPosition){O="Parse error on line "+(E+1)+":\n"+o.showPosition()+"\nExpecting "+B.join(", ")+", got '"+(this.terminals_[R]||R)+"'"}else{O="Parse error on line "+(E+1)+": Unexpected "+(R==J?"end of input":"'"+(this.terminals_[R]||R)+"'")}this.parseError(O,{text:o.match,token:this.terminals_[R]||R,line:o.yylineno,loc:v,expected:B})}if(Q[0] instanceof Array&&Q.length>1){throw new Error("Parse Error: multiple actions possible at state: "+z+", token: "+R)}switch(Q[0]){case 1:A.push(R);V.push(o.yytext);F.push(o.yylloc);A.push(Q[1]);R=null;if(!N){T=o.yyleng;u=o.yytext;E=o.yylineno;v=o.yylloc;if(w>0){w--}}else{R=N;N=null}break;case 2:U=this.productions_[Q[1]][1];P.$=V[V.length-U];P._$={first_line:F[F.length-(U||1)].first_line,last_line:F[F.length-1].last_line,first_column:F[F.length-(U||1)].first_column,last_column:F[F.length-1].last_column};if(y){P._$.range=[F[F.length-(U||1)].range[0],F[F.length-1].range[1]]}G=this.performAction.apply(P,[u,T,E,W.yy,Q[1],V,F].concat(x));if(typeof G!=="undefined"){return G}if(U){A=A.slice(0,-1*U*2);V=V.slice(0,-1*U);F=F.slice(0,-1*U)}A.push(this.productions_[Q[1]][0]);V.push(P.$);F.push(P._$);t=X[A[A.length-2]][A[A.length-1]];A.push(t);break;case 3:return true}}return true}};if(typeof GLOBAL!=="undefined"){GLOBAL.window=GLOBAL}if(typeof window.TSV==="undefined"){var m=k.parse;k.parse=function(o){var t=this.lexer.setInput;this.lexer.setInput=function(u){t.call(this,u);this.begin("BOF");return this};this.parse=m;return m.call(this,o)};window.TSV=function(t){var v=function(){};v.prototype=k.lexer;var u=function(){this.lexer=new v();this.yy={}};u.prototype=k;var o=new u;o.setObj=function(w){o.yy.obj=w};o.yy.handler=t;return o}}var b=(function(){var u=({EOF:1,parseError:function v(D,C){if(this.yy.parser){this.yy.parser.parseError(D,C)}else{throw new Error(D)}},setInput:function(C,D){this.yy=D||this.yy||{};this._input=C;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var D=this._input[0];this.yytext+=D;this.yyleng++;this.offset++;this.match+=D;this.matched+=D;var C=D.match(/(?:\r\n?|\n).*/g);if(C){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return D},unput:function(E){var C=E.length;var D=E.split(/(?:\r\n?|\n)/g);this._input=E+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-C);this.offset-=C;var G=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(D.length-1){this.yylineno-=D.length-1}var F=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:D?(D.length===G.length?this.yylloc.first_column:0)+G[G.length-D.length].length-D[0].length:this.yylloc.first_column-C};if(this.options.ranges){this.yylloc.range=[F[0],F[0]+this.yyleng-C]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(C){this.unput(this.match.slice(C))},pastInput:function(){var C=this.matched.substr(0,this.matched.length-this.match.length);return(C.length>20?"...":"")+C.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var C=this.match;if(C.length<20){C+=this._input.substr(0,20-C.length)}return(C.substr(0,20)+(C.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var C=this.pastInput();var D=new Array(C.length+1).join("-");return C+this.upcomingInput()+"\n"+D+"^"},test_match:function(G,E){var H,C,F;if(this.options.backtrack_lexer){F={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){F.yylloc.range=this.yylloc.range.slice(0)}}C=G[0].match(/(?:\r\n?|\n).*/g);if(C){this.yylineno+=C.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:C?C[C.length-1].length-C[C.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+G[0].length};this.yytext+=G[0];this.match+=G[0];this.matches=G;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(G[0].length);this.matched+=G[0];H=this.performAction.call(this,this.yy,this,E,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(H){return H}else{if(this._backtrack){for(var D in F){this[D]=F[D]}return false}}return false},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var G,E,C,D;if(!this._more){this.yytext="";this.match=""}var H=this._currentRules();for(var F=0;F<H.length;F++){C=this._input.match(this.rules[H[F]]);if(C&&(!E||C[0].length>E[0].length)){E=C;D=F;if(this.options.backtrack_lexer){G=this.test_match(C,H[F]);if(G!==false){return G}else{if(this._backtrack){E=false;continue}else{return false}}}else{if(!this.options.flex){break}}}}if(E){G=this.test_match(E,H[D]);if(G!==false){return G}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var C=this.next();if(C){return C}else{return this.lex()}},begin:function t(C){this.conditionStack.push(C)},popState:function w(){var C=this.conditionStack.length-1;if(C>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function B(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function z(C){C=this.conditionStack.length-1-Math.abs(C||0);if(C>=0){return this.conditionStack[C]}else{return"INITIAL"}},pushState:function y(C){this.begin(C)},stateStackSize:function x(){return this.conditionStack.length},options:{},performAction:function A(G,D,F,C){var E=C;switch(F){case 0:return 14;break;case 1:this.popState();return 16;break;case 2:if(D.yytext==this.quoteChar){this.popState();this.begin("STRING");return 16}else{return 14}break;case 3:this.popState();this.begin("STRING");return 14;break;case 4:this.popState();this.quoteChar=D.yytext.substring(0);this.begin("QUOTE");return 15;break;case 5:this.quoteChar=D.yytext;this.popState();this.begin("QUOTE");return 15;break;case 6:this.begin("PRE_QUOTE");return 13;break;case 7:this.begin("PRE_QUOTE");return 7;break;case 8:return 14;break;case 9:this.popState();return 8;break;case 10:this.popState();return 9;break;case 11:this.popState();return 7;break;case 12:this.popState();return 13;break;case 13:return 14;break;case 14:this.popState();break;case 15:return"BUFFIN";break;case 16:return 9;break;case 17:return 10;break;case 18:return 12;break;case 19:return 7;break;case 20:this.begin("STRING");return 14;break;case 21:return 5;break}},rules:[/^(?:(\n|\\n))/,/^(?:([\'\"])(?=$))/,/^(?:([\'\"]))/,/^(?:(?=(\t)))/,/^(?:([\'\"]))/,/^(?:([\'\"]))/,/^(?:(\t|\\t)(?=[\'\"]))/,/^(?:(\n|\\n)(?=[\'\"]))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:(\n\t|\\n\\t))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\n|\\n))/,/^(?:(\t|\\t))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:)/,/^(?:(\n\t|\\n\\t)(?=.))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\t\n))/,/^(?:(\t))/,/^(?:(\n))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:$)/],conditions:{BOF:{rules:[4,6,7,14,15,16,17,18,19,20,21],inclusive:true},PRE_QUOTE:{rules:[5,6,7,15,16,17,18,19,20,21],inclusive:true},QUOTE:{rules:[0,1,2,3,6,7,8,15,16,17,18,19,20,21],inclusive:true},STRING:{rules:[6,7,9,10,11,12,13,15,16,17,18,19,20,21],inclusive:true},INITIAL:{rules:[6,7,15,16,17,18,19,20,21],inclusive:true}}});return u})();k.lexer=b;function d(){this.yy={}}d.prototype=k;k.Parser=d;return new d})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}};